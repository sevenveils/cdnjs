{"version":3,"sources":["dist/hyperapp.js"],"names":["hyperapp","exports","EMPTY_OBJ","EMPTY_ARR","map","isArray","Array","defer","requestAnimationFrame","setTimeout","createClass","obj","out","length","tmp","k","merge","a","b","batch","list","reduce","item","concat","isSameAction","shouldRestart","patchProperty","node","key","oldValue","newValue","listener","isSvg","setProperty","actions","slice","toLowerCase","addEventListener","removeEventListener","removeAttribute","setAttribute","createNode","vnode","type","document","createTextNode","name","createElementNS","createElement","props","i","len","children","appendChild","getVNode","getKey","patch","parent","oldVNode","newVNode","nodeValue","insertBefore","removeChild","tmpVKid","oldVKid","oldKey","newKey","oldVProps","newVProps","oldVKids","newVKids","oldHead","newHead","oldTail","newTail","keyed","newKeyed","propsChanged","lazy","view","createVNode","createTextVNode","value","recycleNode","nodeType","nodeName","call","childNodes","Lazy","h","rest","arguments","push","pop","app","enhance","state","lock","vdom","subscriptions","subs","event","dispatch","this","setState","newState","render","any","action","fx","oldSubs","newSubs","oldSub","newSub","patchSubs","parentNode","init"],"mappings":"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","sourcesContent":["var hyperapp = (function (exports) {\n  'use strict';\n\n  var RECYCLED_NODE = 1;\n  var LAZY_NODE = 2;\n  var TEXT_NODE = 3;\n  var EMPTY_OBJ = {};\n  var EMPTY_ARR = [];\n\n  var map = EMPTY_ARR.map;\n  var isArray = Array.isArray;\n  var defer = requestAnimationFrame || setTimeout;\n\n  var createClass = function(obj) {\n    var out = \"\";\n\n    if (typeof obj === \"string\") return obj\n\n    if (isArray(obj) && obj.length > 0) {\n      for (var k = 0, tmp; k < obj.length; k++) {\n        if ((tmp = createClass(obj[k])) !== \"\") {\n          out += (out && \" \") + tmp;\n        }\n      }\n    } else {\n      for (var k in obj) {\n        if (obj[k]) {\n          out += (out && \" \") + k;\n        }\n      }\n    }\n\n    return out\n  };\n\n  var merge = function(a, b) {\n    var out = {};\n\n    for (var k in a) out[k] = a[k];\n    for (var k in b) out[k] = b[k];\n\n    return out\n  };\n\n  var batch = function(list) {\n    return list.reduce(function(out, item) {\n      return out.concat(\n        !item || item === true\n          ? false\n          : typeof item[0] === \"function\"\n          ? [item]\n          : batch(item)\n      )\n    }, EMPTY_ARR)\n  };\n\n  var isSameAction = function(a, b) {\n    return isArray(a) && isArray(b) && a[0] === b[0] && typeof a[0] === \"function\"\n  };\n\n  var shouldRestart = function(a, b) {\n    for (var k in merge(a, b)) {\n      if (a[k] !== b[k] && !isSameAction(a[k], b[k])) return true\n      b[k] = a[k];\n    }\n  };\n\n  var patchSubs = function(oldSubs, newSubs, dispatch) {\n    for (\n      var i = 0, oldSub, newSub, subs = [];\n      i < oldSubs.length || i < newSubs.length;\n      i++\n    ) {\n      oldSub = oldSubs[i];\n      newSub = newSubs[i];\n      subs.push(\n        newSub\n          ? !oldSub ||\n            newSub[0] !== oldSub[0] ||\n            shouldRestart(newSub[1], oldSub[1])\n            ? [\n                newSub[0],\n                newSub[1],\n                newSub[0](dispatch, newSub[1]),\n                oldSub && oldSub[2]()\n              ]\n            : oldSub\n          : oldSub && oldSub[2]()\n      );\n    }\n    return subs\n  };\n\n  var patchProperty = function(node, key, oldValue, newValue, listener, isSvg) {\n    if (key === \"key\") ; else if (key === \"style\") {\n      for (var k in merge(oldValue, newValue)) {\n        oldValue = newValue == null || newValue[k] == null ? \"\" : newValue[k];\n        if (k[0] === \"-\") {\n          node[key].setProperty(k, oldValue);\n        } else {\n          node[key][k] = oldValue;\n        }\n      }\n    } else if (key[0] === \"o\" && key[1] === \"n\") {\n      if (\n        !((node.actions || (node.actions = {}))[\n          (key = key.slice(2).toLowerCase())\n        ] = newValue)\n      ) {\n        node.removeEventListener(key, listener);\n      } else if (!oldValue) {\n        node.addEventListener(key, listener);\n      }\n    } else if (!isSvg && key !== \"list\" && key in node) {\n      node[key] = newValue == null ? \"\" : newValue;\n    } else if (\n      newValue == null ||\n      newValue === false ||\n      (key === \"class\" && !(newValue = createClass(newValue)))\n    ) {\n      node.removeAttribute(key);\n    } else {\n      node.setAttribute(key, newValue);\n    }\n  };\n\n  var createNode = function(vnode, listener, isSvg) {\n    var node =\n      vnode.type === TEXT_NODE\n        ? document.createTextNode(vnode.name)\n        : (isSvg = isSvg || vnode.name === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", vnode.name)\n        : document.createElement(vnode.name);\n    var props = vnode.props;\n\n    for (var k in props) {\n      patchProperty(node, k, null, props[k], listener, isSvg);\n    }\n\n    for (var i = 0, len = vnode.children.length; i < len; i++) {\n      node.appendChild(\n        createNode(\n          (vnode.children[i] = getVNode(vnode.children[i])),\n          listener,\n          isSvg\n        )\n      );\n    }\n\n    return (vnode.node = node)\n  };\n\n  var getKey = function(vnode) {\n    return vnode == null ? null : vnode.key\n  };\n\n  var patch = function(parent, node, oldVNode, newVNode, listener, isSvg) {\n    if (oldVNode === newVNode) ; else if (\n      oldVNode != null &&\n      oldVNode.type === TEXT_NODE &&\n      newVNode.type === TEXT_NODE\n    ) {\n      if (oldVNode.name !== newVNode.name) node.nodeValue = newVNode.name;\n    } else if (oldVNode == null || oldVNode.name !== newVNode.name) {\n      node = parent.insertBefore(\n        createNode((newVNode = getVNode(newVNode)), listener, isSvg),\n        node\n      );\n      if (oldVNode != null) parent.removeChild(oldVNode.node);\n    } else {\n      var tmpVKid;\n      var oldVKid;\n\n      var oldKey;\n      var newKey;\n\n      var oldVProps = oldVNode.props;\n      var newVProps = newVNode.props;\n\n      var oldVKids = oldVNode.children;\n      var newVKids = newVNode.children;\n\n      var oldHead = 0;\n      var newHead = 0;\n      var oldTail = oldVKids.length - 1;\n      var newTail = newVKids.length - 1;\n\n      isSvg = isSvg || newVNode.name === \"svg\";\n\n      for (var i in merge(oldVProps, newVProps)) {\n        if (\n          (i === \"value\" || i === \"selected\" || i === \"checked\"\n            ? node[i]\n            : oldVProps[i]) !== newVProps[i]\n        ) {\n          patchProperty(node, i, oldVProps[i], newVProps[i], listener, isSvg);\n        }\n      }\n\n      while (newHead <= newTail && oldHead <= oldTail) {\n        if (\n          (oldKey = getKey(oldVKids[oldHead])) == null ||\n          oldKey !== getKey(newVKids[newHead])\n        ) {\n          break\n        }\n\n        patch(\n          node,\n          oldVKids[oldHead].node,\n          oldVKids[oldHead],\n          (newVKids[newHead] = getVNode(\n            newVKids[newHead++],\n            oldVKids[oldHead++]\n          )),\n          listener,\n          isSvg\n        );\n      }\n\n      while (newHead <= newTail && oldHead <= oldTail) {\n        if (\n          (oldKey = getKey(oldVKids[oldTail])) == null ||\n          oldKey !== getKey(newVKids[newTail])\n        ) {\n          break\n        }\n\n        patch(\n          node,\n          oldVKids[oldTail].node,\n          oldVKids[oldTail],\n          (newVKids[newTail] = getVNode(\n            newVKids[newTail--],\n            oldVKids[oldTail--]\n          )),\n          listener,\n          isSvg\n        );\n      }\n\n      if (oldHead > oldTail) {\n        while (newHead <= newTail) {\n          node.insertBefore(\n            createNode(\n              (newVKids[newHead] = getVNode(newVKids[newHead++])),\n              listener,\n              isSvg\n            ),\n            (oldVKid = oldVKids[oldHead]) && oldVKid.node\n          );\n        }\n      } else if (newHead > newTail) {\n        while (oldHead <= oldTail) {\n          node.removeChild(oldVKids[oldHead++].node);\n        }\n      } else {\n        for (var i = oldHead, keyed = {}, newKeyed = {}; i <= oldTail; i++) {\n          if ((oldKey = oldVKids[i].key) != null) {\n            keyed[oldKey] = oldVKids[i];\n          }\n        }\n\n        while (newHead <= newTail) {\n          oldKey = getKey((oldVKid = oldVKids[oldHead]));\n          newKey = getKey(\n            (newVKids[newHead] = getVNode(newVKids[newHead], oldVKid))\n          );\n\n          if (\n            newKeyed[oldKey] ||\n            (newKey != null && newKey === getKey(oldVKids[oldHead + 1]))\n          ) {\n            if (oldKey == null) {\n              node.removeChild(oldVKid.node);\n            }\n            oldHead++;\n            continue\n          }\n\n          if (newKey == null || oldVNode.type === RECYCLED_NODE) {\n            if (oldKey == null) {\n              patch(\n                node,\n                oldVKid && oldVKid.node,\n                oldVKid,\n                newVKids[newHead],\n                listener,\n                isSvg\n              );\n              newHead++;\n            }\n            oldHead++;\n          } else {\n            if (oldKey === newKey) {\n              patch(\n                node,\n                oldVKid.node,\n                oldVKid,\n                newVKids[newHead],\n                listener,\n                isSvg\n              );\n              newKeyed[newKey] = true;\n              oldHead++;\n            } else {\n              if ((tmpVKid = keyed[newKey]) != null) {\n                patch(\n                  node,\n                  node.insertBefore(tmpVKid.node, oldVKid && oldVKid.node),\n                  tmpVKid,\n                  newVKids[newHead],\n                  listener,\n                  isSvg\n                );\n                newKeyed[newKey] = true;\n              } else {\n                patch(\n                  node,\n                  oldVKid && oldVKid.node,\n                  null,\n                  newVKids[newHead],\n                  listener,\n                  isSvg\n                );\n              }\n            }\n            newHead++;\n          }\n        }\n\n        while (oldHead <= oldTail) {\n          if (getKey((oldVKid = oldVKids[oldHead++])) == null) {\n            node.removeChild(oldVKid.node);\n          }\n        }\n\n        for (var i in keyed) {\n          if (newKeyed[i] == null) {\n            node.removeChild(keyed[i].node);\n          }\n        }\n      }\n    }\n\n    return (newVNode.node = node)\n  };\n\n  var propsChanged = function(a, b) {\n    for (var k in a) if (a[k] !== b[k]) return true\n    for (var k in b) if (a[k] !== b[k]) return true\n  };\n\n  var getVNode = function(newVNode, oldVNode) {\n    return newVNode.type === LAZY_NODE\n      ? ((!oldVNode || propsChanged(oldVNode.lazy, newVNode.lazy)) &&\n          ((oldVNode = newVNode.lazy.view(newVNode.lazy)).lazy = newVNode.lazy),\n        oldVNode)\n      : newVNode\n  };\n\n  var createVNode = function(name, props, children, node, key, type) {\n    return {\n      name: name,\n      props: props,\n      children: children,\n      node: node,\n      type: type,\n      key: key\n    }\n  };\n\n  var createTextVNode = function(value, node) {\n    return createVNode(value, EMPTY_OBJ, EMPTY_ARR, node, null, TEXT_NODE)\n  };\n\n  var recycleNode = function(node) {\n    return node.nodeType === TEXT_NODE\n      ? createTextVNode(node.nodeValue, node)\n      : createVNode(\n          node.nodeName.toLowerCase(),\n          EMPTY_OBJ,\n          map.call(node.childNodes, recycleNode),\n          node,\n          null,\n          RECYCLED_NODE\n        )\n  };\n\n  var Lazy = function(props) {\n    return {\n      lazy: props,\n      type: LAZY_NODE\n    }\n  };\n\n  var h = function(name, props) {\n    for (var vnode, rest = [], children = [], i = arguments.length; i-- > 2; ) {\n      rest.push(arguments[i]);\n    }\n\n    while (rest.length > 0) {\n      if (isArray((vnode = rest.pop()))) {\n        for (var i = vnode.length; i-- > 0; ) {\n          rest.push(vnode[i]);\n        }\n      } else if (vnode === false || vnode === true || vnode == null) ; else {\n        children.push(typeof vnode === \"object\" ? vnode : createTextVNode(vnode));\n      }\n    }\n\n    props = props || EMPTY_OBJ;\n\n    return typeof name === \"function\"\n      ? name(props, children)\n      : createVNode(name, props, children, null, props.key)\n  };\n\n  var app = function(props, enhance) {\n    var state = {};\n    var lock = false;\n    var view = props.view;\n    var node = props.node;\n    var vdom = node && recycleNode(node);\n    var subscriptions = props.subscriptions;\n    var subs = [];\n\n    var listener = function(event) {\n      dispatch(this.actions[event.type], event);\n    };\n\n    var setState = function(newState) {\n      return (\n        state === newState || lock || defer(render, (lock = true)),\n        (state = newState)\n      )\n    };\n\n    var dispatch = (enhance ||\n      function(any) {\n        return any\n      })(function(action, props, obj) {\n      return typeof action === \"function\"\n        ? dispatch(action(state, props), obj || props)\n        : isArray(action)\n        ? typeof action[0] === \"function\"\n          ? dispatch(\n              action[0],\n              typeof (action = action[1]) === \"function\" ? action(props) : action,\n              props\n            )\n          : (batch(action.slice(1)).map(function(fx) {\n              fx && fx[0](dispatch, fx[1], props);\n            }, setState(action[0])),\n            state)\n        : setState(action)\n    });\n\n    var render = function() {\n      lock = false;\n      if (subscriptions) {\n        subs = patchSubs(subs, batch(subscriptions(state)), dispatch);\n      }\n      if (view) {\n        node = patch(\n          node.parentNode,\n          node,\n          vdom,\n          typeof (vdom = view(state)) === \"string\" ? createTextVNode(vdom) : vdom,\n          listener\n        );\n      }\n    };\n\n    dispatch(props.init);\n  };\n\n  exports.Lazy = Lazy;\n  exports.h = h;\n  exports.app = app;\n\n  return exports;\n\n}({}));\n//# sourceMappingURL=hyperapp.js.map\n"]}