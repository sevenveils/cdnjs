{"version":3,"sources":["dist/hyperapp.js"],"names":["global","factory","exports","module","define","amd","self","hyperapp","this","EMPTY_OBJECT","EMPTY_ARRAY","map","isArray","Array","defer","Promise","cb","resolve","then","setTimeout","merge","a","b","out","i","flatten","arr","reduce","obj","concat","isSameAction","shouldRestart","k","createClass","tmp","length","updateProperty","element","name","value","newValue","eventCb","isSvg","style","setProperty","events","slice","toLowerCase","addEventListener","removeEventListener","removeAttribute","setAttribute","removeElement","parent","node","removeChild","createElement","type","document","createTextNode","createElementNS","props","len","children","appendChild","getNode","getKey","key","patch","newNode","nodeValue","newElement","insertBefore","savedNode","childNode","newProps","updateElement","newKey","start","end","newChildren","newStart","newEnd","keyed","newKeyed","shouldUpdate","lazy","render","createVNode","createTextVNode","text","recycleChild","nodeType","recycleElement","nodeName","call","childNodes","Lazy","h","rest","arguments","push","pop","app","container","subs","subscriptions","view","lock","state","sub","event","dispatch","currentTarget","setState","newState","fx","newSub","patchSub","init"],"mappings":"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","sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = global || self, factory(global.hyperapp = {}));\n}(this, function (exports) { 'use strict';\n\n  var DEFAULT_NODE = 0;\n  var RECYCLED_NODE = 1;\n  var LAZY_NODE = 2;\n  var TEXT_NODE = 3;\n  var EMPTY_OBJECT = {};\n  var EMPTY_ARRAY = [];\n\n  var map = EMPTY_ARRAY.map;\n  var isArray = Array.isArray;\n\n  var defer =\n    typeof Promise === \"function\"\n      ? function(cb) {\n          Promise.resolve().then(cb);\n        }\n      : setTimeout;\n\n  var merge = function(a, b) {\n    var out = {};\n\n    for (var i in a) out[i] = a[i];\n    for (var i in b) out[i] = b[i];\n\n    return out\n  };\n\n  var flatten = function(arr) {\n    return arr.reduce(function(out, obj) {\n      return out.concat(\n        !obj || obj === true\n          ? false\n          : typeof obj[0] === \"function\"\n          ? [obj]\n          : flatten(obj)\n      )\n    }, EMPTY_ARRAY)\n  };\n\n  var isSameAction = function(a, b) {\n    return isArray(a) && isArray(b) && a[0] === b[0] && typeof a[0] === \"function\"\n  };\n\n  var shouldRestart = function(a, b) {\n    for (var k in merge(a, b)) {\n      if (a[k] === b[k] || isSameAction(a[k], b[k])) b[k] = a[k];\n      else return true\n    }\n  };\n\n  var patchSub = function(sub, newSub, dispatch) {\n    for (var i = 0, a, b, out = []; i < sub.length || i < newSub.length; i++) {\n      a = sub[i];\n      out.push(\n        (b = newSub[i])\n          ? !a || b[0] !== a[0] || shouldRestart(b[1], a[1])\n            ? [b[0], b[1], b[0](b[1], dispatch), a && a[2]()]\n            : a\n          : a && a[2]()\n      );\n    }\n    return out\n  };\n\n  var createClass = function(obj) {\n    var out = \"\";\n    var tmp = typeof obj;\n\n    if (tmp === \"string\" || tmp === \"number\") return obj\n\n    if (isArray(obj) && obj.length > 0) {\n      for (var i = 0; i < obj.length; i++) {\n        if ((tmp = createClass(obj[i])) !== \"\") out += (out && \" \") + tmp;\n      }\n    } else {\n      for (var i in obj) {\n        if (obj[i]) out += (out && \" \") + i;\n      }\n    }\n\n    return out\n  };\n\n  var updateProperty = function(element, name, value, newValue, eventCb, isSvg) {\n    if (name === \"key\") ; else if (name === \"style\") {\n      for (var i in merge(value, newValue)) {\n        var style = newValue == null || newValue[i] == null ? \"\" : newValue[i];\n        if (i[0] === \"-\") {\n          element[name].setProperty(i, style);\n        } else {\n          element[name][i] = style;\n        }\n      }\n    } else {\n      if (name[0] === \"o\" && name[1] === \"n\") {\n        if (\n          !((element.events || (element.events = {}))[\n            (name = name.slice(2).toLowerCase())\n          ] = newValue)\n        ) {\n          element.removeEventListener(name, eventCb);\n        } else if (!value) {\n          element.addEventListener(name, eventCb);\n        }\n      } else if (name !== \"list\" && !isSvg && name in element) {\n        element[name] = newValue == null ? \"\" : newValue;\n      } else if (\n        newValue == null ||\n        newValue === false ||\n        (name === \"class\" && !(newValue = createClass(newValue)))\n      ) {\n        element.removeAttribute(name);\n      } else {\n        element.setAttribute(name, newValue);\n      }\n    }\n  };\n\n  var removeElement = function(parent, node) {\n    parent.removeChild(node.element);\n  };\n\n  var createElement = function(node, eventCb, isSvg) {\n    var element =\n      node.type === TEXT_NODE\n        ? document.createTextNode(node.name)\n        : (isSvg = isSvg || node.name === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.name)\n        : document.createElement(node.name);\n    var props = node.props;\n\n    for (var i = 0, len = node.children.length; i < len; i++) {\n      element.appendChild(\n        createElement(\n          (node.children[i] = getNode(node.children[i])),\n          eventCb,\n          isSvg\n        )\n      );\n    }\n\n    for (var k in props) {\n      updateProperty(element, k, null, props[k], eventCb, isSvg);\n    }\n\n    return (node.element = element)\n  };\n\n  var updateElement = function(element, props, newProps, eventCb, isSvg) {\n    for (var k in merge(props, newProps)) {\n      if (\n        (k === \"value\" || k === \"checked\" ? element[k] : props[k]) !== newProps[k]\n      ) {\n        updateProperty(element, k, props[k], newProps[k], eventCb, isSvg);\n      }\n    }\n  };\n\n  var getKey = function(node) {\n    return node == null ? null : node.key\n  };\n\n  var patch = function(parent, element, node, newNode, eventCb, isSvg) {\n    if (newNode === node) ; else if (\n      node != null &&\n      node.type === TEXT_NODE &&\n      newNode.type === TEXT_NODE\n    ) {\n      if (node.name !== newNode.name) element.nodeValue = newNode.name;\n    } else if (node == null || node.name !== newNode.name) {\n      var newElement = parent.insertBefore(\n        createElement((newNode = getNode(newNode)), eventCb, isSvg),\n        element\n      );\n\n      if (node != null) removeElement(parent, node);\n\n      element = newElement;\n    } else {\n      updateElement(\n        element,\n        node.props,\n        newNode.props,\n        eventCb,\n        (isSvg = isSvg || newNode.name === \"svg\")\n      );\n\n      var savedNode;\n      var childNode;\n\n      var key;\n      var children = node.children;\n      var start = 0;\n      var end = children.length - 1;\n\n      var newKey;\n      var newChildren = newNode.children;\n      var newStart = 0;\n      var newEnd = newChildren.length - 1;\n\n      while (newStart <= newEnd && start <= end) {\n        key = getKey(children[start]);\n        newKey = getKey(newChildren[newStart]);\n\n        if (key == null || key !== newKey) break\n\n        patch(\n          element,\n          children[start].element,\n          children[start],\n          (newChildren[newStart] = getNode(\n            newChildren[newStart],\n            children[start]\n          )),\n          eventCb,\n          isSvg\n        );\n\n        start++;\n        newStart++;\n      }\n\n      while (newStart <= newEnd && start <= end) {\n        key = getKey(children[end]);\n        newKey = getKey(newChildren[newEnd]);\n\n        if (key == null || key !== newKey) break\n\n        patch(\n          element,\n          children[end].element,\n          children[end],\n          (newChildren[newEnd] = getNode(newChildren[newEnd], children[end])),\n          eventCb,\n          isSvg\n        );\n\n        end--;\n        newEnd--;\n      }\n\n      if (start > end) {\n        while (newStart <= newEnd) {\n          element.insertBefore(\n            createElement(\n              (newChildren[newStart] = getNode(newChildren[newStart++])),\n              eventCb,\n              isSvg\n            ),\n            (childNode = children[start]) && childNode.element\n          );\n        }\n      } else if (newStart > newEnd) {\n        while (start <= end) {\n          removeElement(element, children[start++]);\n        }\n      } else {\n        for (var i = start, keyed = {}, newKeyed = {}; i <= end; i++) {\n          if ((key = children[i].key) != null) {\n            keyed[key] = children[i];\n          }\n        }\n\n        while (newStart <= newEnd) {\n          key = getKey((childNode = children[start]));\n          newKey = getKey(\n            (newChildren[newStart] = getNode(newChildren[newStart], childNode))\n          );\n\n          if (\n            newKeyed[key] ||\n            (newKey != null && newKey === getKey(children[start + 1]))\n          ) {\n            if (key == null) {\n              removeElement(element, childNode);\n            }\n            start++;\n            continue\n          }\n\n          if (newKey == null || node.type === RECYCLED_NODE) {\n            if (key == null) {\n              patch(\n                element,\n                childNode && childNode.element,\n                childNode,\n                newChildren[newStart],\n                eventCb,\n                isSvg\n              );\n              newStart++;\n            }\n            start++;\n          } else {\n            if (key === newKey) {\n              patch(\n                element,\n                childNode.element,\n                childNode,\n                newChildren[newStart],\n                eventCb,\n                isSvg\n              );\n              newKeyed[newKey] = true;\n              start++;\n            } else {\n              if ((savedNode = keyed[newKey]) != null) {\n                patch(\n                  element,\n                  element.insertBefore(\n                    savedNode.element,\n                    childNode && childNode.element\n                  ),\n                  savedNode,\n                  newChildren[newStart],\n                  eventCb,\n                  isSvg\n                );\n                newKeyed[newKey] = true;\n              } else {\n                patch(\n                  element,\n                  childNode && childNode.element,\n                  null,\n                  newChildren[newStart],\n                  eventCb,\n                  isSvg\n                );\n              }\n            }\n            newStart++;\n          }\n        }\n\n        while (start <= end) {\n          if (getKey((childNode = children[start++])) == null) {\n            removeElement(element, childNode);\n          }\n        }\n\n        for (var key in keyed) {\n          if (newKeyed[key] == null) {\n            removeElement(element, keyed[key]);\n          }\n        }\n      }\n    }\n\n    return (newNode.element = element)\n  };\n\n  var shouldUpdate = function(a, b) {\n    for (var k in a) if (a[k] !== b[k]) return true\n    for (var k in b) if (a[k] !== b[k]) return true\n  };\n\n  var getNode = function(newNode, node) {\n    return newNode.type === LAZY_NODE\n      ? !node || shouldUpdate(newNode.lazy, node.lazy)\n        ? newNode.render()\n        : node\n      : newNode\n  };\n\n  var createVNode = function(name, props, children, element, key, type) {\n    return {\n      name: name,\n      props: props,\n      children: children,\n      element: element,\n      type: type,\n      key: key\n    }\n  };\n\n  var createTextVNode = function(text, element) {\n    return createVNode(text, EMPTY_OBJECT, EMPTY_ARRAY, element, null, TEXT_NODE)\n  };\n\n  var recycleChild = function(element) {\n    return element.nodeType === TEXT_NODE\n      ? createTextVNode(element.nodeValue, element)\n      : recycleElement(element)\n  };\n\n  var recycleElement = function(element) {\n    return createVNode(\n      element.nodeName.toLowerCase(),\n      EMPTY_OBJECT,\n      map.call(element.childNodes, recycleChild),\n      element,\n      null,\n      RECYCLED_NODE\n    )\n  };\n\n  var Lazy = function(props) {\n    return {\n      type: LAZY_NODE,\n      key: props.key,\n      lazy: props,\n      render: function() {\n        var node = props.render(props);\n        node.lazy = props;\n        return node\n      }\n    }\n  };\n\n  var h = function(name, props) {\n    for (var node, rest = [], children = [], i = arguments.length; i-- > 2; ) {\n      rest.push(arguments[i]);\n    }\n\n    while (rest.length > 0) {\n      if (isArray((node = rest.pop()))) {\n        for (i = node.length; i-- > 0; ) rest.push(node[i]);\n      } else if (node === false || node === true || node == null) ; else {\n        children.push(typeof node === \"object\" ? node : createTextVNode(node));\n      }\n    }\n\n    props = props || EMPTY_OBJECT;\n\n    return typeof name === \"function\"\n      ? name(props, children)\n      : createVNode(name, props, children, null, props.key, DEFAULT_NODE)\n  };\n\n  var app = function(props) {\n    var container = props.container;\n    var element = container && container.children[0];\n    var node = element && recycleElement(element);\n    var subs = props.subscriptions;\n    var view = props.view;\n    var lock = false;\n    var state = {};\n    var sub = [];\n\n    var eventCb = function(event) {\n      dispatch(event.currentTarget.events[event.type], event);\n    };\n\n    var setState = function(newState) {\n      if (!(state === newState || lock)) {\n        defer(render, (lock = true));\n      }\n      state = newState;\n    };\n\n    var dispatch = function(obj, props) {\n      if (typeof obj === \"function\") {\n        dispatch(obj(state, props));\n      } else if (isArray(obj)) {\n        if (typeof obj[0] === \"function\") {\n          dispatch(obj[0](state, obj[1], props));\n        } else {\n          flatten(obj.slice(1)).map(function(fx) {\n            fx && fx[0](fx[1], dispatch);\n          }, setState(obj[0]));\n        }\n      } else {\n        setState(obj);\n      }\n    };\n\n    var render = function() {\n      lock = false;\n      if (subs) sub = patchSub(sub, flatten(subs(state)), dispatch);\n      if (view) {\n        element = patch(container, element, node, (node = view(state)), eventCb);\n      }\n    };\n\n    dispatch(props.init);\n  };\n\n  exports.Lazy = Lazy;\n  exports.h = h;\n  exports.app = app;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n//# sourceMappingURL=hyperapp.js.map\n"]}