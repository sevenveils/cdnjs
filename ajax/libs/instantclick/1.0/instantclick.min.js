var InstantClick=function(){var i=location.pathname,a=0,l={},d=[],u=function(){return!0};function h(t){var e=t.indexOf("#");return-1==e?t:t.substr(0,e)}function r(t){for(var e,n,i,r=document.getElementsByTagName("a"),o=location.protocol+"//"+location.host,a=r.length-1;0<=a;a--)(e=r[a]).target||0!=e.href.indexOf(o+"/")||-1<e.href.indexOf("#")&&h(e.href)==h(location.href)||e.hasAttribute("data-no-instant")||!u(e.href.substr(o.length),e)||(e.addEventListener("mouseover",m),e.addEventListener("click",g));if(!t){var l,d,s,c,f=document.getElementsByTagName("script");for(a=f.length-1;0<=a;a--)l=f[a],d=document.createElement("script"),l.src&&(d.src=l.src),l.innerHTML&&(d.innerHTML=l.innerHTML),s=l.parentNode,c=l.nextSibling,s.removeChild(l),s.insertBefore(d,c)}n="page:change",(i=document.createEvent("HTMLEvents")).initEvent(n,!0,!0),dispatchEvent(i)}function m(t){!function(t){var e=a;"waiting"==d[a].state&&(e^=1);d[e].state="preloading",d[e].url=t,d[e].body=!1,d[e].timingStart=+new Date,d[e].timing=!1,d[e].xhr.open("GET",t,!0),d[e].xhr.send()}(t.target.href)}function e(t){var e=t.target.id;if(!(d[e].xhr.readyState<4)){var n=d[e].xhr.responseText;d[e].timing=+new Date-d[e].timingStart;var i=n.indexOf("<body");if(-1<i){d[e].body=n.substr(n.indexOf(">",i)+1);var r=d[e].body.indexOf("</body");-1<r&&(d[e].body=d[e].body.substr(0,r)),d[e].body=d[e].body.replace(/<script[^>]+data-no-instant[^>]*>[\s\S]*<\/script>/gi,"")}var o=n.indexOf("<title");-1<o&&(d[e].title=n.substr(n.indexOf(">",o)+1),d[e].title=d[e].title.substr(0,d[e].title.indexOf("</title"))),l[h(d[e].url)]={body:d[e].body,title:d[e].title},e==a&&"waiting"==d[a].state&&s(d[a].url)}}function g(t){1<t.which||t.metaKey||t.ctrlKey||(t.preventDefault(),s(t.target.href))}function s(t){if(d[a].url!=t){if(d[1^a].url!=t)throw new Error("Clicked on a link without hovering on it first");a^=1}if(d[a].body){if(d[a].state="displayed",document.body.innerHTML=d[a].body,document.title=d[a].title,d[a].url!=location.href){if(-1==d[a].url.indexOf("#"))scrollTo(0,0);else{var e=d[a].url.substr(d[a].url.indexOf("#")+1);if(document.getElementById(e)||0<document.getElementsByName(e).length){e=document.getElementById(e)||document.getElementsByTagName(e)[0];for(var n=0;e.offsetParent;e=e.offsetParent)n+=e.offsetTop;scrollTo(0,n)}else scrollTo(0,0)}history.pushState(null,null,d[a].url)}i=location.pathname,r()}else d[a].state="waiting"}return{init:function(){if("pushState"in history&&!d.length){0 in arguments&&(u=arguments[0]),l[h(location.href)]={body:document.body.innerHTML,title:document.title};for(var t=0;t<2;t++)d[t]={},d[t].xhr=new XMLHttpRequest,d[t].xhr.id=t,d[t].xhr.addEventListener("readystatechange",e),d[t].url=!1,d[t].body=!1,d[t].title=!1,d[t].state="",d[t].timingStart=!1,d[t].timing=!1;r(!0),addEventListener("popstate",function(){if(i!=location.pathname){var t=h(location.href);t in l?(i=location.pathname,document.body.innerHTML=l[t].body,document.title=l[t].title,r()):location.href=location.href}})}},debug:function(){return{currentPathname:i,p0:d[0],p1:d[1],pHistory:l,pId:a}}}}();