!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],e):"object"==typeof module&&module.exports?e(require("./load-image"),require("./load-image-meta")):e(window.loadImage)}(function(x){"use strict";x.ExifMap=function(){return this},x.ExifMap.prototype.map={Orientation:274},x.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},x.getExifThumbnail=function(e,i,t){if(t&&!(i+t>e.byteLength))return x.createObjectURL(new Blob([e.buffer.slice(i,i+t)]));console.log("Invalid Exif data: Invalid thumbnail data.")},x.exifTagTypes={1:{getValue:function(e,i){return e.getUint8(i)},size:1},2:{getValue:function(e,i){return String.fromCharCode(e.getUint8(i))},size:1,ascii:!0},3:{getValue:function(e,i,t){return e.getUint16(i,t)},size:2},4:{getValue:function(e,i,t){return e.getUint32(i,t)},size:4},5:{getValue:function(e,i,t){return e.getUint32(i,t)/e.getUint32(i+4,t)},size:8},9:{getValue:function(e,i,t){return e.getInt32(i,t)},size:4},10:{getValue:function(e,i,t){return e.getInt32(i,t)/e.getInt32(i+4,t)},size:8}},x.exifTagTypes[7]=x.exifTagTypes[1],x.getExifValue=function(e,i,t,a,n,f){var s,g,o,r,l,u,d=x.exifTagTypes[a];if(d){if(!((g=4<(s=d.size*n)?i+e.getUint32(t+8,f):t+8)+s>e.byteLength)){if(1===n)return d.getValue(e,g,f);for(o=[],r=0;r<n;r+=1)o[r]=d.getValue(e,g+r*d.size,f);if(d.ascii){for(l="",r=0;r<o.length&&"\0"!==(u=o[r]);r+=1)l+=u;return l}return o}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},x.parseExifTag=function(e,i,t,a,n){var f=e.getUint16(t,a);n.exif[f]=x.getExifValue(e,i,t,e.getUint16(t+2,a),e.getUint32(t+4,a),a)},x.parseExifTags=function(e,i,t,a,n){var f,s,g;if(t+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((s=t+2+12*(f=e.getUint16(t,a)))+4>e.byteLength)){for(g=0;g<f;g+=1)this.parseExifTag(e,i,t+2+12*g,a,n);return e.getUint32(s,a)}console.log("Invalid Exif data: Invalid directory size.")}},x.parseExifData=function(e,i,t,a,n){if(!n.disableExif){var f,s,g,o=i+10;if(1165519206===e.getUint32(i+4))if(o+8>e.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===e.getUint16(i+8)){switch(e.getUint16(o)){case 18761:f=!0;break;case 19789:f=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===e.getUint16(o+2,f)?(s=e.getUint32(o+4,f),a.exif=new x.ExifMap,(s=x.parseExifTags(e,o,o+s,f,a))&&!n.disableExifThumbnail&&(g={exif:{}},s=x.parseExifTags(e,o,o+s,f,g),g.exif[513]&&(a.exif.Thumbnail=x.getExifThumbnail(e,o+g.exif[513],g.exif[514]))),a.exif[34665]&&!n.disableExifSub&&x.parseExifTags(e,o,o+a.exif[34665],f,a),a.exif[34853]&&!n.disableExifGps&&x.parseExifTags(e,o,o+a.exif[34853],f,a)):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}},x.metaDataParsers.jpeg[65505].push(x.parseExifData)});