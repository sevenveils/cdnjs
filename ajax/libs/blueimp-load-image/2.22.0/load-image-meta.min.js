!function(e){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],e):"object"==typeof module&&module.exports?e(require("./load-image")):e(window.loadImage)}(function(u){"use strict";var e="undefined"!=typeof Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);u.blobSlice=e&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},u.metaDataParsers={jpeg:{65505:[],65517:[]}},u.parseMetaData=function(e,f,d,g){g=g||{};var p=this,t=(d=d||{}).maxMetaDataSize||262144;!!("undefined"!=typeof DataView&&e&&12<=e.size&&"image/jpeg"===e.type&&u.blobSlice)&&u.readFile(u.blobSlice.call(e,0,t),function(e){if(e.target.error)return console.log(e.target.error),void f(g);var t,a,i,o,r=e.target.result,n=new DataView(r),l=2,s=n.byteLength-4,c=l;if(65496===n.getUint16(0)){for(;l<s&&(65504<=(t=n.getUint16(l))&&t<=65519||65534===t);){if(l+(a=n.getUint16(l+2)+2)>n.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(i=u.metaDataParsers.jpeg[t])for(o=0;o<i.length;o+=1)i[o].call(p,n,l,a,g,d);c=l+=a}!d.disableImageHead&&6<c&&(r.slice?g.imageHead=r.slice(0,c):g.imageHead=new Uint8Array(r).subarray(0,c))}else console.log("Invalid JPEG file: Missing JPEG marker.");f(g)},"readAsArrayBuffer")||f(g)},u.hasMetaOption=function(e){return e&&e.meta};var r=u.transform;u.transform=function(t,a,i,o,e){u.hasMetaOption(a)?u.parseMetaData(o,function(e){r.call(u,t,a,i,o,e)},a,e):r.apply(u,arguments)}});