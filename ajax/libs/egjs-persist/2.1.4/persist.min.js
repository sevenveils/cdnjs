!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e.eg=e.eg||{},e.eg.Persist=t())}(this,function(){"use strict";var e,t,n,r,i,o="undefined"!=typeof window&&window||{},a=o.console,s=(o.document,o.history),u=o.localStorage,f=o.location,c=o.sessionStorage,l=o.navigator,g=o.parseFloat,p=o.performance,y=l?l.userAgent:"",d=p&&p.navigation&&p.navigation.TYPE_BACK_FORWARD||2,v=(e=new RegExp("iPhone|iPad","i").test(y),t=new RegExp("Mac","i").test(y)&&!new RegExp("Chrome","i").test(y)&&new RegExp("Apple","i").test(y),n=new RegExp("Android ","i").test(y),r=new RegExp("wv; |inapp;","i").test(y),i=n?g(new RegExp("(Android)\\s([\\d_\\.]+|\\d_0)","i").exec(y)[2]):void 0,!(e||t||n&&(i<=4.3&&r||i<3)));var h="___persist___",w=s&&"replaceState"in s&&"state"in s;function m(e){if(e){var t="__tmp__"+h;try{return e.setItem(t,h),e.getItem(t)===h}catch(e){return!1}}}var S,_=(m(c)?S=c:m(u)&&(S=u),S);function x(){console.warn("window.history or session/localStorage has no valid format data to be handled in persist.")}function E(){var t,e,n=f.href+h;if(_?e=_.getItem(n):s.state?"object"==typeof s.state&&null!==s.state?e=s.state[n]:x():e=s.state,null===e)return{};var r="string"==typeof e&&0<e.length&&"null"!==e;try{var i=!("object"!=typeof(t=JSON.parse(e))||t instanceof Array);if(!r||!i)throw new Error}catch(e){x(),t={}}return t}function R(e){if(w||_){var t=E()[e];return"null"!==t&&void 0!==t||(t=null),t}}function b(e){var t=(f?f.href:"")+h;if(_)e?_.setItem(t,JSON.stringify(e)):_.removeItem(t);else try{var n=s&&null!=s.state?s.state:{};s&&"object"==typeof n?(n[t]=JSON.stringify(e),s.replaceState(n,document.title,f.href)):console.warn("To use a history object, it must be an object that is not a primitive type.")}catch(e){console.warn(e.message)}e?o[h]=!0:delete o[h]}function N(e,t){if(w||_){var n=E();n[e]=t,b(n)}}function A(){b(null)}(p&&p.navigation&&p.navigation.type)!==d&&A();var k={reset:A,setStateByKey:N,getStateByKey:R,getStorageKey:function(){return _?f.href+h:void 0},getStorage:function(){return _}};return function(){var e=function(){function e(e,t){this.key=e}var t=e.prototype;return t.get=function(e){var t=R(this.key);if(!e||0===e.length)return t;for(var n=e.split("."),r=t,i=!0,o=0;o<n.length;o++){if(!r){i=!1;break}r=r[n[o]]}return i&&r?r:null},t.set=function(e,t){var n=R(this.key);return 0===e.length?N(this.key,t):N(this.key,function e(t,n,r){var i=t;i||(i=isNaN(n[0])?{}:[]);var o=n.shift();return 0===n.length?(i instanceof Array&&isNaN(o)&&a.warn("Don't use key string on array"),i[o]=r):i[o]=e(i[o],n,r),i}(n,e.split("."),t)),this},e.isNeeded=function(){return v},e}();return e.VERSION="2.1.4",e.StorageManager=k,e}()});
//# sourceMappingURL=persist.min.js.map
