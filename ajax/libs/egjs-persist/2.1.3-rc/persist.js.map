{"version":3,"file":"persist.js","sources":["../src/browser.js","../src/utils.js","../src/consts.js","../src/storageManager.js","../src/Persist.js"],"sourcesContent":["const win = (typeof window !== `undefined` && window) || {};\n\nexport {win as window};\nexport const console = win.console;\nexport const document = win.document;\nexport const history = win.history;\nexport const localStorage = win.localStorage;\nexport const location = win.location;\nexport const sessionStorage = win.sessionStorage;\nexport const navigator = win.navigator;\nexport const parseFloat = win.parseFloat;\nexport const performance = win.performance;\n","import {navigator, parseFloat, performance} from \"./browser\";\n\nconst userAgent = navigator ? navigator.userAgent : \"\";\nconst TYPE_BACK_FORWARD = (performance && performance.navigation.TYPE_BACK_FORWARD) || 2;\n\nconst isNeeded = (function() {\n\tconst isIOS = (new RegExp(\"iPhone|iPad\", \"i\")).test(userAgent);\n\tconst isMacSafari = (new RegExp(\"Mac\", \"i\")).test(userAgent) &&\n\t\t!(new RegExp(\"Chrome\", \"i\")).test(userAgent) &&\n\t\t(new RegExp(\"Apple\", \"i\")).test(userAgent);\n\tconst isAndroid = (new RegExp(\"Android \", \"i\")).test(userAgent);\n\tconst isWebview = (new RegExp(\"wv; |inapp;\", \"i\")).test(userAgent);\n\tconst androidVersion = isAndroid ? parseFloat(new RegExp(\n\t\t\"(Android)\\\\s([\\\\d_\\\\.]+|\\\\d_0)\", \"i\"\n\t).exec(userAgent)[2]) : undefined;\n\n\treturn !(isIOS ||\n\t\t\tisMacSafari ||\n\t\t\t(isAndroid &&\n\t\t\t\t((androidVersion <= 4.3 && isWebview) || androidVersion < 3)));\n})();\n\n// In case of IE8, TYPE_BACK_FORWARD is undefined.\nfunction isBackForwardNavigated() {\n\treturn performance && (performance.navigation.type === TYPE_BACK_FORWARD);\n}\n\nexport {\n\tisBackForwardNavigated,\n\tisNeeded,\n};\n","const CONST_PERSIST = \"___persist___\";\n\nexport default CONST_PERSIST;\n","import {window, history, location, sessionStorage, localStorage} from \"./browser\";\nimport {isBackForwardNavigated} from \"./utils\";\nimport CONST_PERSIST from \"./consts\";\n\nconst isSupportState = history && \"replaceState\" in history && \"state\" in history;\n\nfunction isStorageAvailable(storage) {\n\tif (!storage) {\n\t\treturn undefined;\n\t}\n\tconst TMP_KEY = `__tmp__${CONST_PERSIST}`;\n\n\ttry {\n\t\t// In case of iOS safari private mode, calling setItem on storage throws error\n\t\tstorage.setItem(TMP_KEY, CONST_PERSIST);\n\n\t\t// In Chrome incognito mode, can not get saved value\n\t\t// In IE8, calling storage.getItem occasionally makes \"Permission denied\" error\n\t\treturn storage.getItem(TMP_KEY) === CONST_PERSIST;\n\t} catch (e) {\n\t\treturn false;\n\t}\n}\n\nconst storage = (function() {\n\tlet strg;\n\n\tif (isStorageAvailable(sessionStorage)) {\n\t\tstrg = sessionStorage;\n\t} else if (isStorageAvailable(localStorage)) {\n\t\tstrg = localStorage;\n\t}\n\n\treturn strg;\n})();\n\nfunction warnInvalidStorageValue() {\n\t/* eslint-disable no-console */\n\tconsole.warn(\"window.history or session/localStorage has no valid \" +\n\t\t\t\"format data to be handled in persist.\");\n\t/* eslint-enable no-console */\n}\n\nfunction getStorageKey() {\n\treturn storage ? location.href + CONST_PERSIST : undefined;\n}\n\nfunction getStorage() {\n\treturn storage;\n}\n\n/*\n * Get state value\n */\nfunction getState() {\n\tlet state;\n\tconst PERSIST_KEY = location.href + CONST_PERSIST;\n\tlet stateStr;\n\n\tif (storage) {\n\t\tstateStr = storage.getItem(PERSIST_KEY);\n\t} else if (history.state) {\n\t\tif (typeof history.state === \"object\" && history.state !== null) {\n\t\t\tstateStr = history.state[PERSIST_KEY];\n\t\t} else {\n\t\t\twarnInvalidStorageValue();\n\t\t}\n\t} else {\n\t\tstateStr = history.state;\n\t}\n\n\t// the storage is clean\n\tif (stateStr === null) {\n\t\treturn {};\n\t}\n\n\t// \"null\" is not a valid\n\tconst isValidStateStr = typeof stateStr === \"string\" &&\n\t\t\t\t\t\t\t\tstateStr.length > 0 && stateStr !== \"null\";\n\n\ttry {\n\t\tstate = JSON.parse(stateStr);\n\n\t\t// like '[ ... ]', '1', '1.234', '\"123\"' is also not valid\n\t\tconst isValidType = !(typeof state !== \"object\" || state instanceof Array);\n\n\t\tif (!isValidStateStr || !isValidType) {\n\t\t\tthrow new Error();\n\t\t}\n\t} catch (e) {\n\t\twarnInvalidStorageValue();\n\t\tstate = {};\n\t}\n\n\t// Note2 (Android 4.3) return value is null\n\treturn state;\n}\n\nfunction getStateByKey(key) {\n\tif (!isSupportState && !storage) {\n\t\treturn undefined;\n\t}\n\n\tlet result = getState()[key];\n\n\t// some device returns \"null\" or undefined\n\tif (result === \"null\" || typeof result === \"undefined\") {\n\t\tresult = null;\n\t}\n\treturn result;\n}\n\n/*\n * Set state value\n */\nfunction setState(state) {\n\tconst PERSIST_KEY = (location ? location.href : \"\") + CONST_PERSIST;\n\n\tif (storage) {\n\t\tif (state) {\n\t\t\tstorage.setItem(\n\t\t\t\tPERSIST_KEY, JSON.stringify(state));\n\t\t} else {\n\t\t\tstorage.removeItem(PERSIST_KEY);\n\t\t}\n\t} else {\n\t\ttry {\n\t\t\tconst historyState = !history || history.state == null ? {} : history.state;\n\n\t\t\tif (history && typeof historyState === \"object\") {\n\t\t\t\thistoryState[PERSIST_KEY] = JSON.stringify(state);\n\t\t\t\thistory.replaceState(\n\t\t\t\t\thistoryState,\n\t\t\t\t\tdocument.title,\n\t\t\t\t\tlocation.href\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t/* eslint-disable no-console */\n\t\t\t\tconsole.warn(\"To use a history object, it must be an object that is not a primitive type.\");\n\t\t\t\t/* eslint-enable no-console */\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t/* eslint-disable no-console */\n\t\t\tconsole.warn(e.message);\n\t\t\t/* eslint-enable no-console */\n\t\t}\n\t}\n\n\tstate ? window[CONST_PERSIST] = true : delete window[CONST_PERSIST];\n}\n\nfunction setStateByKey(key, data) {\n\tif (!isSupportState && !storage) {\n\t\treturn;\n\t}\n\n\tconst beforeData = getState();\n\n\tbeforeData[key] = data;\n\tsetState(beforeData);\n}\n\n/*\n * flush current history state\n */\nfunction reset() {\n\tsetState(null);\n}\n\n// in case of reload\n!isBackForwardNavigated() && reset();\n\nexport {\n\treset,\n\tsetStateByKey,\n\tgetStateByKey,\n\tgetStorageKey,\n\tgetStorage,\n};\n","import * as StorageManager from \"./storageManager\";\nimport {isNeeded} from \"./utils\";\nimport {console} from \"./browser\";\n\nfunction setRec(obj, path, value) {\n\tlet _obj = obj;\n\n\tif (!_obj) {\n\t\t_obj = isNaN(path[0]) ? {} : [];\n\t}\n\n\tconst head = path.shift();\n\n\tif (path.length === 0) {\n\t\tif (_obj instanceof Array && isNaN(head)) {\n\t\t\tconsole.warn(\"Don't use key string on array\");\n\t\t}\n\t\t_obj[head] = value;\n\t\treturn _obj;\n\t}\n\n\t_obj[head] = setRec(_obj[head], path, value);\n\treturn _obj;\n}\n\n/**\n * Get or store the current state of the web page using JSON.\n * @ko 웹 페이지의 현재 상태를 JSON 형식으로 저장하거나 읽는다.\n * @alias eg.Persist\n *\n * @support {\"ie\": \"9+\", \"ch\" : \"latest\", \"ff\" : \"latest\",  \"sf\" : \"latest\" , \"edge\" : \"latest\", \"ios\" : \"7+\", \"an\" : \"2.3+ (except 3.x)\"}\n */\nclass Persist {\n\tstatic VERSION = \"#__VERSION__#\";\n\tstatic StorageManager = StorageManager;\n\t/**\n\t* Constructor\n\t* @param {String} key The key of the state information to be stored <ko>저장할 상태 정보의 키</ko>\n\t**/\n\tconstructor(key, value) {\n\t\tthis.key = key;\n\t}\n\n\t/**\n\t * Read value\n\t * @param {String?} path target path\n\t * @return {String|Number|Boolean|Object|Array}\n\t */\n\tget(path) {\n\t\t// find path\n\t\tconst globalState =\tStorageManager.getStateByKey(this.key);\n\n\t\tif (!path || path.length === 0) {\n\t\t\treturn globalState;\n\t\t}\n\n\t\tconst pathToken = path.split(\".\");\n\t\tlet currentItem = globalState;\n\t\tlet isTargetExist = true;\n\n\t\tfor (let i = 0; i < pathToken.length; i++) {\n\t\t\tif (!currentItem) {\n\t\t\t\tisTargetExist = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcurrentItem = currentItem[pathToken[i]];\n\t\t}\n\t\tif (!isTargetExist || !currentItem) {\n\t\t\treturn null;\n\t\t}\n\t\treturn currentItem;\n\t}\n\n\t/**\n\t * Save value\n\t * @param {String} path target path\n\t * @param {String|Number|Boolean|Object|Array} value value to save\n\t * @return {Persist}\n\t */\n\tset(path, value) {\n\t\t// find path\n\t\tconst globalState =\tStorageManager.getStateByKey(this.key);\n\n\t\tif (path.length === 0) {\n\t\t\tStorageManager.setStateByKey(this.key, value);\n\t\t} else {\n\t\t\tStorageManager.setStateByKey(\n\t\t\t\tthis.key,\n\t\t\t\tsetRec(globalState, path.split(\".\"), value)\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * @static\n\t * Return whether you need \"Persist\" module by checking the bfCache support of the current browser\n\t * @return {Boolean}\n\t */\n\tstatic isNeeded() {\n\t\treturn isNeeded;\n\t}\n}\n\nexport default Persist;\n"],"names":["win","window","console","document","history","localStorage","location","sessionStorage","navigator","parseFloat","performance","userAgent","TYPE_BACK_FORWARD","navigation","isNeeded","isIOS","RegExp","test","isMacSafari","isAndroid","isWebview","androidVersion","exec","undefined","isBackForwardNavigated","type","CONST_PERSIST","isSupportState","isStorageAvailable","storage","TMP_KEY","setItem","getItem","e","strg","warnInvalidStorageValue","warn","getStorageKey","href","getStorage","getState","state","PERSIST_KEY","stateStr","isValidStateStr","length","JSON","parse","isValidType","Array","Error","getStateByKey","key","result","setState","stringify","removeItem","historyState","replaceState","title","message","setStateByKey","data","beforeData","reset","setRec","obj","path","value","_obj","isNaN","head","shift","Persist","get","globalState","StorageManager","pathToken","split","currentItem","isTargetExist","i","set","VERSION"],"mappings":"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"}