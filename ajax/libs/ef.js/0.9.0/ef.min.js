!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).ef={})}(this,function(e){"use strict";var u="&",s=u+u,o=new RegExp("\\&[0-7]{1,3}","g"),i=new RegExp("\\&u\\[.*?\\]","g"),c=new RegExp("\\&u.{0,4}","g"),l=new RegExp("\\&x.{0,2}","g"),p=new RegExp("\\&","g"),f=new RegExp("\\&b","g"),h=new RegExp("\\&t","g"),d=new RegExp("\\&n","g"),v=new RegExp("\\&v","g"),b=new RegExp("\\&f","g"),g=new RegExp("\\&r","g"),y=function(){throw new SyntaxError("Octal escape sequences are not allowed in EFML.")},m=function(e){if(e=e.substr(3,e.length-4),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");try{return String.fromCodePoint(e)}catch(e){throw new SyntaxError("Undefined Unicode code-point")}},x=function(e){if(e=e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");return String.fromCharCode(e)},w=function(e){if(e="00"+e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid hexadecimal escape sequence");return String.fromCharCode(e)},q=function(e){for(var t=[],r=0,n=e.split(s);r<n.length;r+=1){var a=n[r].replace(o,y).replace(i,m).replace(c,x).replace(l,w).replace(f,"\b").replace(h,"\t").replace(d,"\n").replace(v,"\v").replace(b,"\f").replace(g,"\r").replace(p,"");t.push(a)}return t.join(u)},N=function(e,t){for(var r,n=[],a=!1,o=0,i=e.split(t);o<i.length;o+=1){var c=i[o];a?n[n.length-1]+=""+t+c:n.push(c),a=(r=c)[r.length-1]===u}return n},L=function(e,t){for(var r=e.split(s),n=N(r.shift(),t),a=0,o=r;a<o.length;a+=1){var i=o[a],c=N(i,t);n[n.length-1]+="&&"+c.shift(),n.push.apply(n,c)}return n},U=["$ctx","$data","$refs","$methods","$mount","$umount","$subscribe","$unsubscribe","$update","$destroy","__DIRECTMOUNT__"],a=/\{\{.+?\}\}/g,M=/^(\t*)( *).*/,B=/#([^}]|}[^}])*$/,K=function(e,t){return void 0===t&&(t=-2),"Failed to parse eft template: "+e+". at line "+(t+1)},k=function(e){return-1<["number","boolean","string"].indexOf(typeof e)},E=function(t){if(!t)return[t,!1];try{var e=JSON.parse(t);return-1===["number","boolean"].indexOf(typeof e)?[q(t),!0]:[e,!1]}catch(e){return[q(t),!0]}},$=function(e){e=e.slice(2,e.length-2);var t=L(e,"="),r=t[0],n=t.slice(1),a=L(r.trim(),".").map(q),o=E(n.join("=").trim()),i=o[0],c=o[1];return k(i)&&(c||!c&&""!==i)?[a,i]:[a]},V=function(e){var t=e.split(a);if(1===t.length)return E(e)[0];var r=[];2!==t.length||t[0]||t[1]?r.push(t.map(q)):r.push(0);var n=e.match(a);return n&&r.push.apply(r,n.map($)),r},D=function(e,t){t&&e.push(t)},Z=function(e){var t=V(e);if(k(t))return[""+t];for(var r=t[0],n=t.slice(1),a=[],o=0;o<n.length;o++)D(a,r[o]),a.push(n[o]);return D(a,r[r.length-1]),a},G=function(e){return e.replace(/\./g," ")},J=function(e){var t=L(e,"=");return{name:q(t.shift().trim()),value:V(t.join("=").trim())}},z=function(e,t,r){var n=parseInt(r,10);if(isNaN(n))return function(e,t){switch(t){case"stop":e.s=1;break;case"stopImmediate":e.i=1;break;case"prevent":e.p=1;break;case"shift":e.h=1;break;case"alt":e.a=1;break;case"ctrl":e.c=1;break;case"meta":e.t=1;break;case"capture":e.u=1;break;default:console.warn("Abandoned unsupported eft event option '"+t+"'.")}}(e,q(r));t.push(n)},T=function(e){var t,r,n=e.line,a=e.ast,o=e.parsingInfo,i=e.i;if(n.replace(/\s/,"")){var c,u;c=n,null===(u=o).offset&&(u.offset=c.match(/\s*/)[0],u.offset&&(u.offsetReg=u.offset));var s=function(e,t,r){if(t.offsetReg){var n=!1;if(e=e.replace(t.offsetReg,function(){return n=!0,""}),!n)throw new SyntaxError(K("Expected indent to be grater than 0 and less than "+(t.prevDepth+1)+", but got -1",r))}return e}(n,o,i);!function(e,t){if(!t.indentReg){var r=e.match(M)[2];r&&(t.indentReg=new RegExp(r,"g"))}}(s,o);var l,p,f,h,d,v,b,g,y,m=function(e,t,r){var n=0;t.indentReg&&(e=e.replace(/^\s*/,function(e){return e.replace(t.indentReg,"\t")}));var a=e.replace(/^\t*/,function(e){return n=e.length,""});if(/^\s/.test(a))throw new SyntaxError(K("Bad indent",r));return{depth:n,content:a}}(s,o,i),x=m.depth,w=m.content;if(w){if(x<0||1<x-o.prevDepth||x-o.prevDepth==1&&-1===["comment","tag"].indexOf(o.prevType)||"comment"!==o.prevType&&0===x&&o.topExists)throw new SyntaxError(K("Expected indent to be grater than 0 and less than "+(o.prevDepth+1)+", but got "+x,i));var N=w[0];if(!(w=w.slice(1))&&0<=">#%@.-+".indexOf(N))throw new SyntaxError(K("Empty content",i));switch((x<o.prevDepth||x===o.prevDepth&&"tag"===o.prevType)&&(o.currentNode=function(e,t){for(var r=e,n=0;n<t;n++)r=r[r.length-1];return r}(a,x)),o.prevDepth=x,N){case">":var k=(v={},b=L(w.replace(B,function(e){return v.ref=e.slice(1),""}),"."),g=b[0],y=b.slice(1),v.tag=q(g),v.class=V(y.join(".")),"string"==typeof v.class?v.class=G(v.class).trim():v.class[0]&&(v.class[0]=v.class[0].map(G)),v),E=[{t:k.tag}];k.class&&(E[0].a={},E[0].a.class=k.class),k.ref&&(E[0].r=k.ref),o.currentNode.push(E),o.currentNode=E,o.prevType="tag";break;case"#":var $=J(w),D=$.name,T=$.value;o.currentNode[0].a||(o.currentNode[0].a={}),o.currentNode[0].a[D]=T,o.prevType="attr";break;case"%":var _=J(w),O=_.name,S=_.value;o.currentNode[0].p||(o.currentNode[0].p={}),o.currentNode[0].p[O]=S,o.prevType="prop";break;case"@":var A={name:(d=L(w,"=")).shift().trim(),value:d.join("=").trim()},j=A.name,R=A.value;o.currentNode[0].e||(o.currentNode[0].e=[]);var P=function(e){var t={},r=[],n=L(e,"."),a=n[0],o=n.slice(1);t.l=q(a);for(var i=0,c=o;i<c.length;i+=1){var u=c[i];z(t,r,u)}return 0<r.length&&(t.k=r),t}(j),C=(l=L(R,":"),p=l[0],f=l.slice(1).join(":"),h=q(p.trim()),f?[h,V(f)]:[h]),I=C[0],F=C[1];P.m=I,F&&(P.v=F),o.currentNode[0].e.push(P),o.prevType="event";break;case".":(t=o.currentNode).push.apply(t,Z(w)),o.prevType="text";break;case"|":1<o.currentNode.length&&(w="\n"+w),(r=o.currentNode).push.apply(r,Z(w)),o.prevType="multiline-text";break;case"-":if(-1!==U.indexOf(w))throw new SyntaxError(K("Reserved name '"+w+"' should not be used",i));o.currentNode.push({n:w,t:0}),o.prevType="node";break;case"+":o.currentNode.push({n:w,t:1}),o.prevType="list";break;default:o.prevType="comment"}}}},n=function(e){if(!e)throw new TypeError(K("Template required, but nothing given"));var t=typeof e;if("string"!==t)throw new TypeError(K("Expected a string, but got a(n) "+t));for(var r=e.split(/\r?\n/),n=[{t:0}],a={indentReg:null,prevDepth:0,offset:null,offsetReg:null,prevType:"comment",currentNode:n,topExists:!1},o=0;o<r.length;o++)T({line:r[o],ast:n,parsingInfo:a,i:o});if(n.length<=1)throw new SyntaxError(K("Nothing to be parsed",r.length-1));return 2!==n.length||Array.isArray(n[1][0])?n:n[1]},S=function(e){return Array.isArray(e)?"array":typeof e},_=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var n="",a=0;a<t.length;a++)void 0===t[a]?n+=e[a]:n+=e[a]+t[a];return n+e[e.length-1]},O=function(e){return e.dataNode[e._key]},A=Array.prototype,j={copy:function(e){return A.slice.call(e,0)},empty:function(e){return e.length=0,e},equals:function(e,t){if(!Array.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0},pop:function(e){return A.pop.call(e)},push:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return A.push.apply(e,t)},remove:function(e,t){var r=A.indexOf.call(e,t);if(-1<r)return A.splice.call(e,r,1),t},reverse:function(e){return A.reverse.call(e)},rightUnique:function(e){for(var t=[],r=0;r<e.length;r++){for(var n=r+1;n<e.length;n++)e[r]===e[n]&&(n=r+=1);t.push(e[r])}return t},shift:function(e){return A.shift.call(e)},slice:function(e,t,r){return A.slice.call(e,t,r)},sort:function(e,t){return A.sort.call(e,t)},splice:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return A.splice.apply(e,t)},unshift:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return A.unshift.apply(e,t)}};window.Set&&Array.from?j.unique=function(e){return Array.from(new Set(e))}:j.unique=j.rightUnique;var t="[EF] %s",R={log:console.log.bind(console,t),info:console.info.bind(console,t),warn:console.warn.bind(console,t),error:console.error.bind(console,t)},r=[],P=[],C=[],I=0,F=function(e){return r.push.apply(r,e)},H=function(e){return P.push(e)},Q=function(){return I+=1},W=function(){if(0!==C.length){for(var e=0,t=j.unique(C);e<t.length;e+=1){(0,t[e])()}j.empty(C)}},X=function(e){return!e&&0<(I-=1)||((I=0)<r.length&&function(){for(var e=0,t=j.unique(r);e<t.length;e+=1)(0,t[e])();j.empty(r)}(),0<P.length&&function(){for(var e=0,t=j.rightUnique(P);e<t.length;e+=1)(0,t[e])();j.empty(P)}(),0<C.length&&setTimeout(W,0)),I},Y=function(e,t){for(var r in t)e[r]=t[r];return e},ee=Object.assign||Y,te=function(e){var t=e._path,r=e._key,n=e.data,a=e.handlers,o=e.subscribers,i=e.innerData,c=function(e,t,r){for(var n=0,a=e;n<a.length;n+=1){var o=a[n];if(!t[o]){var i={};Object.defineProperty(t,o,{get:function(){return i},set:function(e){Q(),ee(i,e),X()},configurable:!r,enumerable:r})}t=t[o]}return t}(t,n,!0),u=function(e){for(var t=e._path,r=e.handlers,n=e.subscribers,a=e.innerData,o=0,i=t;o<i.length;o+=1){var c=i[o];r[c]||(r[c]={}),n[c]||(n[c]={}),a[c]||(a[c]={}),r=r[c],n=n[c],a=a[c]}return{handlerNode:r,subscriberNode:n,dataNode:a}}({_path:t,handlers:a,subscribers:o,innerData:i}),s=u.handlerNode,l=u.subscriberNode,p=u.dataNode;return s[r]||(s[r]=[]),l[r]||(l[r]=[]),Object.prototype.hasOwnProperty.call(p,r)||(p[r]=void 0),{parentNode:c,handlerNode:s[r],subscriberNode:l[r],dataNode:p}},re=[],ne=function(e,t){var r,n;r=e,re.push(r),Q();try{for(var a=0,o=e;a<o.length;a+=1){(0,o[a])(t)}}catch(e){R.error("Error caught when executing subscribers:\n",e)}X(),n=e,j.remove(re,n)},ae=function(e){return e!=e},oe=function(e){var t,r,n,a,o,i,c,u=e.bind,s=e.ctx,l=e.handlers,p=e.subscribers,f=e.innerData,h=j.copy(u[0]),d=h.pop(),v=te({_path:h,_key:d,data:s.data,handlers:l,subscribers:p,innerData:f}),b=v.parentNode,g=v.handlerNode,y=v.subscriberNode,m=v.dataNode;return Object.prototype.hasOwnProperty.call(b,d)||(r=(t={parentNode:b,dataNode:m,handlerNode:g,subscriberNode:y,ctx:s,_key:d}).parentNode,n=t.dataNode,a=t.handlerNode,o=t.subscriberNode,i=t.ctx,c=t._key,Object.defineProperty(r,c,{get:function(){return n[c]},set:function(e){n[c]===e||ae(n[c])&&ae(e)||(n[c]=e,Q(),F(a),X(),0<o.length&&ne(o,{state:i.state,value:e}))},enumerable:!0})),1<u.length&&(b[d]=u[1]),{dataNode:m,parentNode:b,handlerNode:g,subscriberNode:y,_key:d}},ie=function(e,t){return e.constructor===t},ce=Node.prototype,ue={},se=function(e,t){var r=j.copy(e);return j.unshift(r,t),r},le=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.appendTo=function(e){ue.append.apply(null,se(this,e))},t.prototype.insertBeforeTo=function(e){var t=j.copy(this);j.unshift(t,e),ue.before.apply(null,se(this,e))},t.prototype.insertAfterTo=function(e){var t=j.copy(this);j.unshift(t,e),ue.after.apply(null,se(this,e))},t.prototype.remove=function(){for(var e=0;e<this.length;e+=1){var t=this[e];ue.remove(t)}},t}(Array);window.EFFragment=le,ue.before=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var n=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var i=o[a];ie(i,le)?i.appendTo(n):ce.appendChild.call(n,i)}ce.insertBefore.call(e.parentNode,n,e)},ue.after=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var n=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var i=o[a];ie(i,le)?i.appendTo(n):ce.appendChild.call(n,i)}e.nextSibling?ce.insertBefore.call(e.parentNode,n,e.nextSibling):ce.appendChild.call(e.parentNode,n)},ue.append=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];if(ie(e,le))return e.push.apply(e,t);if(-1!==[1,9,11].indexOf(e.nodeType)){for(var n=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var i=o[a];ie(i,le)?i.appendTo(n):ce.appendChild.call(n,i)}ce.appendChild.call(e,n)}},ue.remove=function(e){ie(e,le)?e.remove():ce.removeChild.call(e.parentNode,e)};for(var pe=function(e,t){void 0===t&&(t={bubbles:!1,cancelable:!1});var r=document.createEvent("Event");return r.initEvent(e,t.bubbles,t.cancelable),r},fe=function(e){return-1<["number","boolean","string"].indexOf(typeof e)},he="http://www.w3.org/1999/xlink",de=function(e){var t,r=e.tag,n=e.ref,a=e.refs,o=e.svg,i=(t=r,o?document.createElementNS("http://www.w3.org/2000/svg",t):"math"===t.toLowerCase()?document.createElementNS("http://www.w3.org/1998/Math/MathML",t):document.createElement(t));return n&&Object.defineProperty(a,n,{value:i,enumerable:!0}),i},ve=function(e){var t=e.val,o=e.ctx,i=e.handlers,c=e.subscribers,u=e.innerData,r=e.handler;if(Array.isArray(t)){var n=t[0],a=t.slice(1),s=[n],l=function(){return r(function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];if(!e)return O(t[0]);var n=[e];return n.push.apply(n,t.map(O)),_.apply(void 0,n)}.apply(void 0,s))};return s.push.apply(s,a.map(function(e){var t=oe({bind:e,ctx:o,handlers:i,subscribers:c,innerData:u}),r=t.dataNode,n=t.handlerNode,a=t._key;return n.push(l),{dataNode:r,_key:a}})),l}return function(){return t}},be=function(e){var t=e.parentNode,r=e.handlerNode,n=e._handler,a=e._key,o=e.value;j.remove(r,n),Q(),t[a]=o,X(),j.push(r,n)},ge=function(e){var t=e.element,r=e.attr,n=e.key,a=e.ctx,o=e.handlers,i=e.subscribers,c=e.innerData;if(fe(r))return 0===n.indexOf("xlink:")?t.setAttributeNS(he,n,r):t.setAttribute(n,r);var u,s,l=(u=t,"class"===(s=n)?function(e){if(!(e=(""+e).replace(/\s+/g," ").trim()))return u.removeAttribute(s);u.setAttribute(s,e)}:0===s.indexOf("xlink:")?function(e){if(""===e)return u.removeAttributeNS(he,s);u.setAttributeNS(he,s,e)}:function(e){if(""===e)return u.removeAttribute(s);u.setAttribute(s,e)});F([ve({val:r,ctx:a,handlers:o,subscribers:i,innerData:c,handler:l})])},ye=function(e){var t,r,n,a,o,i,c,u,s,l,p,f,h,d,v=e.element,b=e.prop,g=e.key,y=e.ctx,m=e.handlers,x=e.subscribers,w=e.innerData;if(fe(b))v[g]=b;else{var N=ve({val:b,ctx:y,handlers:m,subscribers:x,innerData:w,handler:function(e){v[g]=e}});"value"!==g&&"checked"!==g||b[0]||(t={_handler:N,ctx:y,handlers:m,subscribers:x,innerData:w,element:v,key:g,expr:b[1]},r=t._handler,n=t.ctx,a=t.handlers,o=t.subscribers,i=t.innerData,c=t.element,u=t.key,s=t.expr,l=oe({bind:s,ctx:n,handlers:a,subscribers:o,innerData:i}),p=l.parentNode,f=l.handlerNode,h=l._key,d=function(){return be({parentNode:p,handlerNode:f,_handler:r,_key:h,value:c.value})},"value"===u?(c.addEventListener("input",d,!0),c.addEventListener("keyup",d,!0),c.addEventListener("change",d,!0)):(c.addEventListener("change",function(){if(c.dispatchEvent(pe("ef-change-event")),"INPUT"===c.tagName&&"radio"===c.type&&""!==c.name){var e=document.querySelectorAll("input[name="+c.name+"]");if(e){var t=j.copy(e);j.remove(t,c);for(var r=0,n=t;r<n.length;r+=1)n[r].dispatchEvent(pe("ef-change-event"))}}},!0),c.addEventListener("ef-change-event",function(){return be({parentNode:p,handlerNode:f,_handler:r,_key:h,value:c.checked})}))),F([N])}},me=function(e){return e},xe=function(e){var t=e.element,r=e.event,n=e.ctx,a=e.handlers,o=e.subscribers,i=e.innerData,c=r.l,u=r.m,s=r.s,l=r.i,p=r.p,f=r.h,h=r.a,d=r.c,v=r.t,b=r.u,g=r.k,y=r.v,m=ve({val:y,ctx:n,handlers:a,subscribers:o,innerData:i,handler:me});t.addEventListener(c,function(e){!!f!=!!e.shiftKey||!!h!=!!e.altKey||!!d!=!!e.ctrlKey||!!v!=!!e.metaKey||g&&-1===g.indexOf(e.which)||(s&&e.stopPropagation(),l&&e.stopImmediatePropagation(),p&&e.preventDefault(),n.methods[u]&&n.methods[u]({e:e,value:m(),state:n.state}))},!!b)},we={empty:function(){Q();for(var e=0,t=j.copy(this);e<t.length;e+=1){t[e].$destroy()}X(),j.empty(this)},clear:function(){Q();for(var e=0,t=j.copy(this);e<t.length;e+=1){t[e].$umount()}X(),j.empty(this)},pop:function(){if(0!==this.length){var e=j.pop(this);return e.$umount(),e}},push:function(e){for(var t=e.ctx,r=e.key,n=e.anchor,a=[],o=arguments.length-1;0<o--;)a[o]=arguments[o+1];var i=[];Q();for(var c=0,u=a;c<u.length;c+=1){var s=u[c];j.push(i,s.$mount({parent:t.state,key:r}))}return 0===this.length?ue.after.apply(ue,[n].concat(i)):ue.after.apply(ue,[this[this.length-1].$ctx.nodeInfo.placeholder].concat(i)),X(),j.push.apply(j,[this].concat(a))},remove:function(e){if(-1!==this.indexOf(e))return e.$umount(),e},reverse:function(e){var t=e.ctx,r=e.key,n=e.anchor;if(0===this.length)return this;var a=j.copy(this),o=[];Q();for(var i=a.length-1;0<=i;i--)a[i].$umount(),j.push(o,a[i].$mount({parent:t.state,key:r}));return j.push.apply(j,[this].concat(j.reverse(a))),ue.after.apply(ue,[n].concat(o)),X(),this},shift:function(){if(0!==this.length){var e=j.shift(this);return e.$umount(),e}},sort:function(e,t){var r=e.ctx,n=e.key,a=e.anchor;if(0===this.length)return this;var o=j.copy(j.sort(this,t)),i=[];Q();for(var c=0,u=o;c<u.length;c+=1){var s=u[c];s.$umount(),j.push(i,s.$mount({parent:r.state,key:n}))}return j.push.apply(j,[this].concat(o)),ue.after.apply(ue,[a].concat(i)),X(),this},splice:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(0===this.length)return this;var r=j.splice.apply(j,[j.copy(this)].concat(e));Q();for(var n=0,a=r;n<a.length;n+=1){a[n].$umount()}return X(),r},unshift:function(e){for(var t,r=e.ctx,n=e.key,a=e.anchor,o=[],i=arguments.length-1;0<i--;)o[i]=arguments[i+1];if(0===this.length)return(t=this).push.apply(t,o).length;var c=[];Q();for(var u=0,s=o;u<s.length;u+=1){var l=s[u];j.push(c,l.$mount({parent:r.state,key:n}))}return ue.after.apply(ue,[a].concat(c)),X(),j.unshift.apply(j,[this].concat(o))}},Ne={BEFORE:"before",AFTER:"after",APPEND:"append",REPLACE:"replace"},ke=Object.create(null),Ee=[function(e){var t=e.ctx,r=e.key,n=e.value,a=t.children[r],o=a.anchor,i=a.node;i!==n&&(Q(),i&&(n===ke?n=null:i.$umount()),(a.node=n)&&n.$mount({target:o,parent:t.state,option:Ne.BEFORE,key:r}),X())},function(e){var t=e.ctx,r=e.key,n=e.value,a=t.children[r],o=a.anchor,i=a.node;if(!j.equals(i,n)){n=n?j.copy(n):[];var c=document.createDocumentFragment();if(Q(),i){i.clear();for(var u=0,s=n;u<s.length;u+=1){var l=s[u];l.$umount(),ue.append(c,l.$mount({parent:t.state,key:r}))}}else for(var p=0,f=n;p<f.length;p+=1){var h=f[p];ue.append(c,h.$mount({parent:t.state,key:r}))}i.length=0,j.push.apply(j,[i].concat(n)),ue.after(o,c),X()}}],$e=function(e){var t,r,n=e.ctx,a=e.key,o=e.children,i=e.anchor;o[a]={node:(t=[],r={ctx:n,key:a,anchor:i},Object.defineProperties(t,{empty:{value:we.empty},clear:{value:we.clear},pop:{value:we.pop},push:{value:we.push.bind(t,r)},remove:{value:we.remove},reverse:{value:we.reverse.bind(t,r)},shift:{value:we.shift},sort:{value:we.sort.bind(t,r)},splice:{value:we.splice},unshift:{value:we.unshift.bind(t,r)}}),t),anchor:i}},De=function(e){var t,r,n,a,o,i,c,u,s,l,p,f,h,d,v,b,g,y=e.node,m=e.nodeType,x=e.element,w=e.ctx,N=e.innerData,k=e.refs,E=e.handlers,$=e.subscribers,D=e.svg,T=e.create,_=e.State;switch(m){case"string":ue.append(x,document.createTextNode(y));break;case"array":"object"===S(y[0])?ue.append(x,T({node:y,ctx:w,innerData:N,refs:k,handlers:E,subscribers:$,svg:D,create:T,State:_})):(i=(o={node:y,ctx:w,handlers:E,subscribers:$,innerData:N,element:x}).node,c=o.ctx,u=o.handlers,s=o.subscribers,l=o.innerData,p=o.element,f=document.createTextNode(""),h=oe({bind:i,ctx:c,handlers:u,subscribers:s,innerData:l}),d=h.dataNode,v=h.handlerNode,b=h._key,g=function(){void 0!==d[b]?f.textContent=d[b]:f.textContent=""},v.push(g),F([g]),ue.append(p,f));break;case"object":var O=document.createTextNode("");0===y.t?(t={key:y.n,children:w.children,anchor:O},r=t.key,n=t.children,a=t.anchor,n[r]={anchor:a}):$e({ctx:w,key:y.n,children:w.children,anchor:O}),ue.append(x,O)}},Te=function(e){var t=e.node,r=e.ctx,n=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,c=e.svg,u=e.create,s=e.State,l=t[0],p=t.slice(1),f=0===l.t;f||c||"svg"!==l.t.toLowerCase()||(c=!0);var h=function(e){var t=e.info,r=e.ctx,n=e.innerData,a=e.refs,o=e.handlers,i=e.subscribers,c=e.svg,u=t.t,s=t.a,l=t.p,p=t.e,f=t.r;if(0===u)return new le;var h=de({tag:u,ref:f,refs:a,svg:c});for(var d in s)ge({element:h,attr:s[d],key:d,ctx:r,handlers:o,subscribers:i,innerData:n});for(var v in l)ye({element:h,prop:l[v],key:v,ctx:r,handlers:o,subscribers:i,innerData:n});for(var b in p)xe({element:h,event:p[b],ctx:r,handlers:o,subscribers:i,innerData:n});return h}({info:l,ctx:r,innerData:n,refs:a,handlers:o,subscribers:i,svg:c});c&&"foreignobject"===l.t.toLowerCase()&&(c=!1);for(var d=0,v=p;d<v.length;d+=1){var b=v[d];b instanceof s?b.$mount({target:h}):De({node:b,nodeType:S(b),element:h,ctx:r,innerData:n,refs:a,handlers:o,subscribers:i,svg:c,create:u,State:s})}return h},_e=function(){function s(e){var t={},r={},n={},a={},o={placeholder:document.createTextNode(""),replace:[],parent:null,key:null},i=document.createDocumentFragment(),c=function(){if(0<o.replace.length){for(var e=0,t=o.replace;e<t.length;e+=1){var r=t[e];ue.remove(r)}j.empty(o.replace)}ue.before(o.placeholder,o.element)},u={mount:c,refs:t,data:{},innerData:r,methods:{},handlers:n,subscribers:a,nodeInfo:o,safeZone:i,children:{},state:this};Object.defineProperty(this,"$ctx",{value:u,enumerable:!1,configurable:!0}),Q(),o.element=Te({node:e,ctx:u,innerData:r,refs:t,handlers:n,subscribers:a,svg:!1,create:Te,State:s}),ue.append(i,o.placeholder),H(c),X()}var e={$data:{configurable:!0},$methods:{configurable:!0},$refs:{configurable:!0}};return e.$data.get=function(){return this.$ctx.data},e.$data.set=function(e){Q(),ee(this.$ctx.data,e),X()},e.$methods.get=function(){return this.$ctx.methods},e.$methods.set=function(e){this.$ctx.methods=e},e.$refs.get=function(){return this.$ctx.refs},s.prototype.$mount=function(e){var t=e.target,r=e.option,n=e.parent,a=e.key,o=this.$ctx,i=o.nodeInfo,c=o.mount;if("string"==typeof t&&(t=document.querySelector(t)),Q(),i.parent&&this.$umount(),n||(n=t),a||(a="__DIRECTMOUNT__"),i.parent=n,i.key=a,H(c),!t)return X(),i.placeholder;switch(r){case Ne.BEFORE:ue.before(t,i.placeholder);break;case Ne.AFTER:ue.after(t,i.placeholder);break;case Ne.REPLACE:ue.before(t,i.placeholder),i.replace.push(t);break;case Ne.APPEND:default:ie(n,le)?ue.append(t,i.element):ue.append(t,i.placeholder)}return X()},s.prototype.$umount=function(){var e=this.$ctx,t=e.nodeInfo,r=e.safeZone,n=e.mount,a=t.parent,o=t.key;return t.parent=null,t.key=null,Q(),a&&"__DIRECTMOUNT__"!==o&&a[o]&&(Array.isArray(a[o])?j.remove(a[o],this):a[o]=ke),ue.append(r,t.placeholder),H(n),X()},s.prototype.$subscribe=function(e,t){var r=this.$ctx,n=r.handlers,a=r.subscribers,o=r.innerData,i=e.split("."),c=oe({bind:[i],ctx:r,handlers:n,subscribers:a,innerData:o}),u=c.dataNode,s=c.subscriberNode,l=c._key;Q();try{t({state:this,value:u[l]}),s.push(t)}catch(e){R.error("Error caught when registering subscriber:\n",e)}X()},s.prototype.$unsubscribe=function(e,t){var r,n,a=this.$ctx.subscribers;r=t,n=function(e,t){for(var r=e.split("."),n=r.pop(),a=0,o=r;a<o.length;a+=1){var i=o[a];t[i]||(t[i]={}),t=t[i]}return t[n]}(e,a),j.remove(n,r)},s.prototype.$update=function(e){Q(),Y(this,e),X()},s.prototype.$destroy=function(){var e=this.$ctx.nodeInfo;for(var t in Q(),this.$umount(),this)"array"===S(this[t])?this[t].clear():this[t]=null;return delete this.$ctx,H(function(){ue.remove(e.element),ue.remove(e.placeholder)}),X()},Object.defineProperties(s.prototype,e),s}(),Oe=0,Se=["$mount","$umount","$subscribe","$unsubscribe","$update","$destroy"];Oe<Se.length;Oe+=1){var Ae=Se[Oe];Object.defineProperty(_e.prototype,Ae,{enumerable:!1})}var je=Object.create(null),Re=function(e,t){var r=t.key,n=t.method,a=t.bool,o=t.trueVal,i=t.get,c=t.set;if(i){if(!c)throw new Error("Setter must be defined when getter exists");return i}var u=n?"$methods":"$data";return r=r||e,a?function(){return this[u][r]===o}:function(){return this[u][r]}},Pe=function(e,t){var r=t.key,n=t.method,a=t.bool,o=t.trueVal,i=t.falseVal,c=t.get,u=t.set;if(u){if(!c)throw new Error("Getter must be defined when setter exists");return u}var s=n?"$methods":"$data";return r=r||e,a?function(e){this[s][r]=e?o:i}:function(e){this[s][r]=e}},Ce=function(e,t){var r,n,a,o=S(e);switch(o){case"array":var i=e[0],c=e.slice(1);if("object"===S(i))for(var u=0,s=c;u<s.length;u+=1){var l=s[u];Ce(l,t)}break;case"object":if(1<e.t)throw new TypeError("[EF] Not a standard ef.js AST: Unknown mounting point type '"+e.t+"'");r=e.t,n=e.n,a=t,Object.defineProperty(a,n,{get:function(){return this.$ctx.children[n].node},set:function(e){var t=this.$ctx;Ee[r]({ctx:t,key:n,value:e})},enumerable:!0});break;case"string":break;default:throw new TypeError("Not a standard ef.js AST: Unknown node type '"+o+"'")}},Ie=function(e){var r=e,t=function(t){function e(e){Q(),t.call(this,r),e&&this.$update(e),X()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}(_e);return Ce(r,t.prototype),Object.defineProperty(t.prototype,"constructor",{enumerable:!1}),t},Fe=function(e,t){for(var r in t){var n=t[r],a=Re(r,n),o=Pe(r,n);Object.defineProperty(e.prototype,r,{get:a,set:o,enumerable:!0,configurable:!1})}return e}(Ie([{t:0},[["text"]]]),{text:{}}),qe=n,Le=function(e){var t,r=S(e);if("string"===r)(t=qe)||(t=n),e=t(e);else if("array"!==r)throw new TypeError("Cannot create new component without proper template or AST!");return Ie(e)};e.Fragment=je,e.TextFragment=Fe,e.bundle=function(e){Q();try{return X(e(Q,X))}catch(e){return R.error("Error caught when executing bundle:\n",e),X()}},e.create=Le,e.createElement=function(e,t){for(var r=[],n=arguments.length-2;0<n--;)r[n]=arguments[n+2];if(e===je)return new _e([{t:0}].concat(r));if(Object.isPrototypeOf.call(_e,e))return r.length<=0?new e(t):new e(ee({children:r},t||{}));var a=ee({},t);for(var o in a)!0===a[o]&&(a[o]="");return new _e([{t:e,a:a}].concat(r))},e.exec=X,e.inform=Q,e.isPaused=function(){return 0<I},e.mountOptions=Ne,e.onNextRender=function(e){return C.push(e)},e.parseEft=n,e.setParser=function(e){qe=e},e.t=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Le(_.apply(void 0,e))},e.version="0.9.0",Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ef.min.js.map
