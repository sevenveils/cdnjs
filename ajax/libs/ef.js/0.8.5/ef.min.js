!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).ef={})}(this,function(e){"use strict";var u="&",c=u+u,o=new RegExp("\\&[0-7]{1,3}","g"),s=new RegExp("\\&u\\[.*?\\]","g"),i=new RegExp("\\&u.{0,4}","g"),l=new RegExp("\\&x.{0,2}","g"),p=new RegExp("\\&","g"),f=new RegExp("\\&b","g"),h=new RegExp("\\&t","g"),d=new RegExp("\\&n","g"),v=new RegExp("\\&v","g"),b=new RegExp("\\&f","g"),g=new RegExp("\\&r","g"),y=function(){throw new SyntaxError("Octal escape sequences are not allowed in EFML.")},m=function(e){if(e=e.substr(3,e.length-4),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");try{return String.fromCodePoint(e)}catch(e){throw new SyntaxError("Undefined Unicode code-point")}},N=function(e){if(e=e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid Unicode escape sequence");return String.fromCharCode(e)},x=function(e){if(e="00"+e.substring(2),!(e=parseInt(e,16)))throw new SyntaxError("Invalid hexadecimal escape sequence");return String.fromCharCode(e)},L=function(e){for(var t=[],r=0,n=e.split(c);r<n.length;r+=1){var a=n[r].replace(o,y).replace(s,m).replace(i,N).replace(l,x).replace(f,"\b").replace(h,"\t").replace(d,"\n").replace(v,"\v").replace(b,"\f").replace(g,"\r").replace(p,"");t.push(a)}return t.join(u)},w=function(e,t){for(var r,n=[],a=!1,o=0,s=e.split(t);o<s.length;o+=1){var i=s[o];a?n[n.length-1]+=""+t+i:n.push(i),a=(r=i)[r.length-1]===u}return n},U=function(e,t){for(var r=e.split(c),n=w(r.shift(),t),a=0,o=r;a<o.length;a+=1){var s=o[a],i=w(s,t);n[n.length-1]+="&&"+i.shift(),n.push.apply(n,i)}return n},F=">#%@.-+",M=["$ctx","$data","$refs","$methods","$mount","$umount","$subscribe","$unsubscribe","$update","$destroy","__DIRECTMOUNT__"],a=/\{\{.+?\}\}/g,B=/^(\t*)( *).*/,K=/#([^}]|}[^}])*$/,Z=function(e,t){return void 0===t&&(t=-2),"Failed to parse eft template: "+e+". at line "+(t+1)},k=function(e){return-1<["number","boolean","string"].indexOf(typeof e)},E=function(t){if(!t)return[t,!1];try{var e=JSON.parse(t);return-1===["number","boolean"].indexOf(typeof e)?[L(t),!0]:[e,!1]}catch(e){return[L(t),!0]}},$=function(e){e=e.slice(2,e.length-2);var t=U(e,"="),r=t[0],n=t.slice(1),a=U(r.trim(),".").map(L),o=E(n.join("=").trim()),s=o[0],i=o[1];return k(s)&&(i||!i&&""!==s)?[a,s]:[a]},J=function(e){var t=e.split(a);if(1===t.length)return E(e)[0];var r=[];2!==t.length||t[0]||t[1]?r.push(t.map(L)):r.push(0);var n=e.match(a);return n&&r.push.apply(r,n.map($)),r},D=function(e,t){t&&e.push(t)},z=function(e){var t=J(e);if(k(t))return[""+t];for(var r=t[0],n=t.slice(1),a=[],o=0;o<n.length;o++)D(a,r[o]),a.push(n[o]);return D(a,r[r.length-1]),a},G=function(e){return e.replace(/\./g," ")},H=function(e){var t=U(e,"=");return{name:L(t.shift().trim()),value:J(t.join("=").trim())}},Q=function(e,t,r){var n=parseInt(r,10);if(isNaN(n))return function(e,t){switch(t){case"stop":e.s=1;break;case"stopImmediate":e.i=1;break;case"prevent":e.p=1;break;case"shift":e.h=1;break;case"alt":e.a=1;break;case"ctrl":e.c=1;break;case"meta":e.t=1;break;case"capture":e.u=1;break;default:console.warn("Abandoned unsupported eft event option '"+t+"'.")}}(e,L(r));t.push(n)},_=function(e){var t,r,n=e.line,a=e.ast,o=e.parsingInfo,s=e.i;if(n.replace(/\s/,"")){var i,u;i=n,null===(u=o).offset&&(u.offset=i.match(/\s*/)[0],u.offset&&(u.offsetReg=u.offset));var c=function(e,t,r){if(t.offsetReg){var n=!1;if(e=e.replace(t.offsetReg,function(){return n=!0,""}),!n)throw new SyntaxError(Z("Expected indent to be grater than 0 and less than "+(t.prevDepth+1)+", but got -1",r))}return e}(n,o,s);!function(e,t){if(!t.indentReg){var r=e.match(B)[2];r&&(t.indentReg=new RegExp(r,"g"))}}(c,o);var l,p,f,h,d,v,b,g,y,m=function(e,t,r){var n=0;t.indentReg&&(e=e.replace(/^\s*/,function(e){return e.replace(t.indentReg,"\t")}));var a=e.replace(/^\t*/,function(e){return n=e.length,""});if(/^\s/.test(a))throw new SyntaxError(Z("Bad indent",r));return{depth:n,content:a}}(c,o,s),N=m.depth,x=m.content;if(x){if(N<0||1<N-o.prevDepth||N-o.prevDepth==1&&-1===["comment","tag"].indexOf(o.prevType)||"comment"!==o.prevType&&0===N&&o.topExists)throw new SyntaxError(Z("Expected indent to be grater than 0 and less than "+(o.prevDepth+1)+", but got "+N,s));var w=x[0];if(x=x.slice(1),!o.topExists&&0<=F.indexOf(w)&&">"!==w)throw new SyntaxError(Z("No top level entry",s));if(!x&&0<=F.indexOf(w))throw new SyntaxError(Z("Empty content",s));switch((N<o.prevDepth||N===o.prevDepth&&"tag"===o.prevType)&&(o.currentNode=function(e,t){for(var r=e,n=0;n<t;n++)r=r[r.length-1];return r}(a,N)),o.prevDepth=N,w){case">":o.topExists||(o.topExists=!0,o.minDepth=N);var k=(v={},b=U(x.replace(K,function(e){return v.ref=e.slice(1),""}),"."),g=b[0],y=b.slice(1),v.tag=L(g),v.class=J(y.join(".")),"string"==typeof v.class?v.class=G(v.class).trim():v.class[0]&&(v.class[0]=v.class[0].map(G)),v),E=[{t:k.tag}];k.class&&(E[0].a={},E[0].a.class=k.class),k.ref&&(E[0].r=k.ref),o.currentNode.push(E),o.currentNode=E,o.prevType="tag";break;case"#":var $=H(x),D=$.name,_=$.value;o.currentNode[0].a||(o.currentNode[0].a={}),o.currentNode[0].a[D]=_,o.prevType="attr";break;case"%":var T=H(x),O=T.name,R=T.value;o.currentNode[0].p||(o.currentNode[0].p={}),o.currentNode[0].p[O]=R,o.prevType="prop";break;case"@":var A={name:(d=U(x,"=")).shift().trim(),value:d.join("=").trim()},S=A.name,j=A.value;o.currentNode[0].e||(o.currentNode[0].e=[]);var I=function(e){var t={},r=[],n=U(e,"."),a=n[0],o=n.slice(1);t.l=L(a);for(var s=0,i=o;s<i.length;s+=1){var u=i[s];Q(t,r,u)}return 0<r.length&&(t.k=r),t}(S),P=(l=U(j,":"),p=l[0],f=l.slice(1).join(":"),h=L(p.trim()),f?[h,J(f)]:[h]),C=P[0],q=P[1];I.m=C,q&&(I.v=q),o.currentNode[0].e.push(I),o.prevType="event";break;case".":(t=o.currentNode).push.apply(t,z(x)),o.prevType="text";break;case"|":1<o.currentNode.length&&(x="\n"+x),(r=o.currentNode).push.apply(r,z(x)),o.prevType="multiline-text";break;case"-":if(-1!==M.indexOf(x))throw new SyntaxError(Z("Reserved name '"+x+"' should not be used",s));o.currentNode.push({n:x,t:0}),o.prevType="node";break;case"+":o.currentNode.push({n:x,t:1}),o.prevType="list";break;default:o.prevType="comment"}}}},T=function(e){if(!e)throw new TypeError(Z("Template required, but nothing given"));var t=typeof e;if("string"!==t)throw new TypeError(Z("Expected a string, but got a(n) "+t));for(var r=e.split(/\r?\n/),n=[],a={indentReg:null,prevDepth:0,offset:null,offsetReg:null,prevType:"comment",currentNode:n,topExists:!1},o=0;o<r.length;o++)_({line:r[o],ast:n,parsingInfo:a,i:o});if(n[0])return n[0];throw new SyntaxError(Z("Nothing to be parsed",r.length-1))},O=function(e){return Array.isArray(e)?"array":typeof e},R=function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var n="",a=0;a<t.length;a++)n+=e[a]+t[a];return n+e[e.length-1]},A=function(e){return e.dataNode[e._key]},n=Array.prototype,S={copy:function(e){return n.slice.call(e,0)},empty:function(e){return e.length=0,e},equals:function(e,t){if(!Array.isArray(t))return!1;if(e===t)return!0;if(e.length!==t.length)return!1;for(var r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0},pop:function(e){return n.pop.call(e)},push:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return n.push.apply(e,t)},remove:function(e,t){var r=n.indexOf.call(e,t);if(-1<r)return n.splice.call(e,r,1),t},reverse:function(e){return n.reverse.call(e)},rightUnique:function(e){for(var t=[],r=0;r<e.length;r++){for(var n=r+1;n<e.length;n++)e[r]===e[n]&&(n=r+=1);t.push(e[r])}return t},shift:function(e){return n.shift.call(e)},slice:function(e,t,r){return n.slice.call(e,t,r)},sort:function(e,t){return n.sort.call(e,t)},splice:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return n.splice.apply(e,t)},unshift:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];return n.unshift.apply(e,t)}};window.Set&&Array.from?S.unique=function(e){return Array.from(new Set(e))}:S.unique=S.rightUnique;var t="[EF] %s",j={log:console.log.bind(console,t),info:console.info.bind(console,t),warn:console.warn.bind(console,t),error:console.error.bind(console,t)},r=[],I=[],P=[],C=0,q=function(e){return r.push.apply(r,e)},V=function(e){return I.push(e)},W=function(){return C+=1},X=function(){if(0!==P.length){for(var e=0,t=S.unique(P);e<t.length;e+=1){(0,t[e])()}S.empty(P)}},Y=function(e){return!e&&0<(C-=1)||((C=0)<r.length&&function(){for(var e=0,t=S.unique(r);e<t.length;e+=1)(0,t[e])();S.empty(r)}(),0<I.length&&function(){for(var e=0,t=S.rightUnique(I);e<t.length;e+=1)(0,t[e])();S.empty(I)}(),0<P.length&&setTimeout(X,0)),C},ee=Object.assign||function(e,t){for(var r in t)e[r]=t[r];return e},te=function(e,t,r){for(var n=0,a=e;n<a.length;n+=1){var o=a[n];if(!t[o]){var s={};Object.defineProperty(t,o,{get:function(){return s},set:function(e){W(),ee(s,e),Y()},configurable:!r,enumerable:r})}t=t[o]}return t},re=[],ne=function(e,t){var r,n;r=e,re.push(r),W();try{for(var a=0,o=e;a<o.length;a+=1){(0,o[a])(t)}}catch(e){j.error("Error caught when executing subscribers:\n",e)}Y(),n=e,S.remove(re,n)},ae=function(e){return e!=e},oe=function(e){var t,r,n,a,o,s,i,u,c,l,p,f,h,d,v,b,g,y,m,N=e.bind,x=e.state,w=e.handlers,k=e.subscribers,E=e.innerData,$=S.copy(N[0]),D=$.pop(),_=(t={_path:$,_key:D,data:x.$data,handlers:w,subscribers:k,innerData:E},r=t._path,n=t._key,a=t.data,o=t.handlers,s=t.subscribers,i=t.innerData,u=te(r,a,!0),c=function(e){for(var t=e._path,r=e.handlers,n=e.subscribers,a=e.innerData,o=0,s=t;o<s.length;o+=1){var i=s[o];r[i]||(r[i]={}),n[i]||(n[i]={}),a[i]||(a[i]={}),r=r[i],n=n[i],a=a[i]}return{handlerNode:r,subscriberNode:n,dataNode:a}}({_path:r,handlers:o,subscribers:s,innerData:i}),l=c.handlerNode,p=c.subscriberNode,f=c.dataNode,l[n]||(l[n]=[]),p[n]||(p[n]=[]),Object.prototype.hasOwnProperty.call(f,n)||(f[n]=""),{parentNode:u,handlerNode:l[n],subscriberNode:p[n],dataNode:f}),T=_.parentNode,O=_.handlerNode,R=_.subscriberNode,A=_.dataNode;return Object.prototype.hasOwnProperty.call(T,D)||(d=(h={parentNode:T,dataNode:A,handlerNode:O,subscriberNode:R,state:x,_key:D}).parentNode,v=h.dataNode,b=h.handlerNode,g=h.subscriberNode,y=h.state,m=h._key,Object.defineProperty(d,m,{get:function(){return v[m]},set:function(e){v[m]===e||ae(v[m])&&ae(e)||(v[m]=e,W(),q(b),Y(),0<g.length&&ne(g,{state:y,value:e}))},enumerable:!0})),1<N.length&&(T[D]=N[1]),{dataNode:A,parentNode:T,handlerNode:O,subscriberNode:R,_key:D}},se=function(e,t){void 0===t&&(t={bubbles:!1,cancelable:!1});var r=document.createEvent("Event");return r.initEvent(e,t.bubbles,t.cancelable),r},ie=function(e){return-1<["number","boolean","string"].indexOf(typeof e)},ue="http://www.w3.org/1999/xlink",ce=function(e){var t,r=e.tag,n=e.ref,a=e.refs,o=e.svg,s=(t=r,o?document.createElementNS("http://www.w3.org/2000/svg",t):"math"===t.toLowerCase()?document.createElementNS("http://www.w3.org/1998/Math/MathML",t):document.createElement(t));return n&&Object.defineProperty(a,n,{value:s,enumerable:!0}),s},le=function(e){var t=e.val,o=e.state,s=e.handlers,i=e.subscribers,u=e.innerData,r=e.handler;if(Array.isArray(t)){var n=t[0],a=t.slice(1),c=[n],l=function(){return r(function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];if(!e)return A(t[0]);var n=[e];return n.push.apply(n,t.map(A)),R.apply(void 0,n)}.apply(void 0,c))};return c.push.apply(c,a.map(function(e){var t=oe({bind:e,state:o,handlers:s,subscribers:i,innerData:u}),r=t.dataNode,n=t.handlerNode,a=t._key;return n.push(l),{dataNode:r,_key:a}})),l}return function(){return t}},pe=function(e){var t=e.parentNode,r=e.handlerNode,n=e._handler,a=e._key,o=e.value;S.remove(r,n),W(),t[a]=o,Y(),S.push(r,n)},fe=function(e){var t=e.element,r=e.attr,n=e.key,a=e.state,o=e.handlers,s=e.subscribers,i=e.innerData;if(ie(r))return 0===n.indexOf("xlink:")?t.setAttributeNS(ue,n,r):t.setAttribute(n,r);var u,c,l=(u=t,"class"===(c=n)?function(e){if(!(e=(""+e).replace(/\s+/g," ").trim()))return u.removeAttribute(c);u.setAttribute(c,e)}:0===c.indexOf("xlink:")?function(e){if(""===e)return u.removeAttributeNS(ue,c);u.setAttributeNS(ue,c,e)}:function(e){if(""===e)return u.removeAttribute(c);u.setAttribute(c,e)});q([le({val:r,state:a,handlers:o,subscribers:s,innerData:i,handler:l})])},he=function(e){var t,r,n,a,o,s,i,u,c,l,p,f,h,d,v=e.element,b=e.prop,g=e.key,y=e.state,m=e.handlers,N=e.subscribers,x=e.innerData;if(ie(b))v[g]=b;else{var w=le({val:b,state:y,handlers:m,subscribers:N,innerData:x,handler:function(e){v[g]=e}});"value"!==g&&"checked"!==g||b[0]||(t={_handler:w,state:y,handlers:m,subscribers:N,innerData:x,element:v,key:g,expr:b[1]},r=t._handler,n=t.state,a=t.handlers,o=t.subscribers,s=t.innerData,i=t.element,u=t.key,c=t.expr,l=oe({bind:c,state:n,handlers:a,subscribers:o,innerData:s}),p=l.parentNode,f=l.handlerNode,h=l._key,d=function(){return pe({parentNode:p,handlerNode:f,_handler:r,_key:h,value:i.value})},"value"===u?(i.addEventListener("input",d,!0),i.addEventListener("keyup",d,!0),i.addEventListener("change",d,!0)):(i.addEventListener("change",function(){if(i.dispatchEvent(se("ef-change-event")),"INPUT"===i.tagName&&"radio"===i.type&&""!==i.name){var e=document.querySelectorAll("input[name="+i.name+"]");if(e){var t=S.copy(e);S.remove(t,i);for(var r=0,n=t;r<n.length;r+=1)n[r].dispatchEvent(se("ef-change-event"))}}},!0),i.addEventListener("ef-change-event",function(){return pe({parentNode:p,handlerNode:f,_handler:r,_key:h,value:i.checked})}))),q([w])}},de=function(e){return e},ve=function(e){var t=e.element,r=e.event,n=e.state,a=e.handlers,o=e.subscribers,s=e.innerData,i=r.l,u=r.m,c=r.s,l=r.i,p=r.p,f=r.h,h=r.a,d=r.c,v=r.t,b=r.u,g=r.k,y=r.v,m=le({val:y,state:n,handlers:a,subscribers:o,innerData:s,handler:de});t.addEventListener(i,function(e){!!f!=!!e.shiftKey||!!h!=!!e.altKey||!!d!=!!e.ctrlKey||!!v!=!!e.metaKey||g&&-1===g.indexOf(e.which)||(c&&e.stopPropagation(),l&&e.stopImmediatePropagation(),p&&e.preventDefault(),n.$methods[u]&&n.$methods[u]({e:e,value:m(),state:n}))},!!b)},be=Node.prototype,ge={before:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];var n=document.createDocumentFragment();t.reverse();for(var a=0,o=t;a<o.length;a+=1){var s=o[a];be.appendChild.call(n,s)}be.insertBefore.call(e.parentNode,n,e)},after:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];for(var n=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var s=o[a];be.appendChild.call(n,s)}e.nextSibling?be.insertBefore.call(e.parentNode,n,e.nextSibling):be.appendChild.call(e.parentNode,n)},append:function(e){for(var t=[],r=arguments.length-1;0<r--;)t[r]=arguments[r+1];if(-1!==[1,9,11].indexOf(e.nodeType)){for(var n=document.createDocumentFragment(),a=0,o=t;a<o.length;a+=1){var s=o[a];be.appendChild.call(n,s)}be.appendChild.call(e,n)}},remove:function(e){be.removeChild.call(e.parentNode,e)}},ye={empty:function(){W();for(var e=0,t=S.copy(this);e<t.length;e+=1){t[e].$destroy()}Y(),S.empty(this)},pop:function(){if(0!==this.length){var e=S.pop(this);return e.$umount(),e}},push:function(e){for(var t=e.state,r=e.key,n=e.anchor,a=[],o=arguments.length-1;0<o--;)a[o]=arguments[o+1];var s=[];W();for(var i=0,u=a;i<u.length;i+=1){var c=u[i];S.push(s,c.$mount({parent:t,key:r}))}return 0===this.length?ge.after.apply(ge,[n].concat(s)):ge.after.apply(ge,[this[this.length-1].$ctx.nodeInfo.placeholder].concat(s)),Y(),S.push.apply(S,[this].concat(a))},remove:function(e){if(-1!==this.indexOf(e))return e.$umount(),e},reverse:function(e){var t=e.state,r=e.key,n=e.anchor;if(0===this.length)return this;var a=S.copy(this),o=[];W();for(var s=a.length-1;0<=s;s--)a[s].$umount(),S.push(o,a[s].$mount({parent:t,key:r}));return S.push.apply(S,[this].concat(S.reverse(a))),ge.after.apply(ge,[n].concat(o)),Y(),this},shift:function(){if(0!==this.length){var e=S.shift(this);return e.$umount(),e}},sort:function(e,t){var r=e.state,n=e.key,a=e.anchor;if(0===this.length)return this;var o=S.copy(S.sort(this,t)),s=[];W();for(var i=0,u=o;i<u.length;i+=1){var c=u[i];c.$umount(),S.push(s,c.$mount({parent:r,key:n}))}return S.push.apply(S,[this].concat(o)),ge.after.apply(ge,[a].concat(s)),Y(),this},splice:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(0===this.length)return this;var r=S.splice.apply(S,[S.copy(this)].concat(e));W();for(var n=0,a=r;n<a.length;n+=1){a[n].$umount()}return Y(),r},unshift:function(e){for(var t,r=e.state,n=e.key,a=e.anchor,o=[],s=arguments.length-1;0<s--;)o[s]=arguments[s+1];if(0===this.length)return(t=this).push.apply(t,o).length;var i=[];W();for(var u=0,c=o;u<c.length;u+=1){var l=c[u];S.push(i,l.$mount({parent:r,key:n}))}return ge.after.apply(ge,[a].concat(i)),Y(),S.unshift.apply(S,[this].concat(o))}},me={},Ne=function(e){var i=e.state,u=e.key,c=e.children,l=e.anchor;Object.defineProperty(i,u,{get:function(){return c[u]},set:function(e){var t,r,n,a,o,s;r=(t={state:i,children:c,key:u,anchor:l,value:e}).state,n=t.children,a=t.key,o=t.anchor,s=t.value,n[a]!==s&&(s&&s!==me&&(s.$ctx.nodeInfo.parent,s.$ctx.nodeInfo.element.contains(r.$ctx.nodeInfo.element))||(W(),n[a]&&(s===me?s=null:n[a].$umount()),(n[a]=s)&&s.$mount({target:o,parent:r,option:"before",key:a}),Y()))},enumerable:!0,configurable:!0})},xe=function(e){var t,r,n=e.state,a=e.key,o=e.children,s=e.anchor;o[a]=(t=[],r={state:n,key:a,anchor:s},Object.defineProperties(t,{empty:{value:ye.empty},pop:{value:ye.pop},push:{value:ye.push.bind(t,r)},remove:{value:ye.remove},reverse:{value:ye.reverse.bind(t,r)},shift:{value:ye.shift},sort:{value:ye.sort.bind(t,r)},splice:{value:ye.splice},unshift:{value:ye.unshift.bind(t,r)}}),t),Object.defineProperty(n,a,{get:function(){return o[a]},set:function(e){o[a]&&S.equals(o[a],e)||function(e){var t=e.state,r=e.children,n=e.key,a=e.anchor,o=e.value;o=o?S.copy(o):[];var s=document.createDocumentFragment();if(W(),r[n]){for(var i=0,u=o;i<u.length;i+=1){var c=u[i];if(c.$ctx.nodeInfo.element.contains(t.$ctx.nodeInfo.element))return;c.$umount(),ge.append(s,c.$mount({parent:t,key:n}))}for(var l=0,p=S.copy(r[n]);l<p.length;l+=1)p[l].$umount()}else for(var f=0,h=o;f<h.length;f+=1){var d=h[f];ge.append(s,d.$mount({parent:t,key:n}))}r[n].length=0,S.push.apply(S,[r[n]].concat(o)),ge.after(a,s),Y()}({state:n,children:o,key:a,anchor:s,value:e})},enumerable:!0,configurable:!0})},we=function(e){var t,r,n,a,o,s,i,u,c,l,p,f,h,d=e.node,v=e.nodeType,b=e.element,g=e.state,y=e.innerData,m=e.refs,N=e.children,x=e.handlers,w=e.subscribers,k=e.svg,E=e.create;switch(v){case"string":ge.append(b,document.createTextNode(d));break;case"array":"object"===O(d[0])?ge.append(b,E({node:d,state:g,innerData:y,refs:m,children:N,handlers:x,subscribers:w,svg:k,create:E})):(r=(t={node:d,state:g,handlers:x,subscribers:w,innerData:y,element:b}).node,n=t.state,a=t.handlers,o=t.subscribers,s=t.innerData,i=t.element,u=document.createTextNode(""),c=oe({bind:r,state:n,handlers:a,subscribers:o,innerData:s}),l=c.dataNode,p=c.handlerNode,f=c._key,h=function(){u.textContent=l[f]},p.push(h),q([h]),ge.append(i,u));break;case"object":var $=document.createTextNode("");if(0===d.t)Ne({state:g,key:d.n,children:N,anchor:$});else{if(1!==d.t)throw new TypeError("Not a standard ef.js AST: Unknown mounting point type '"+d.t+"'");xe({state:g,key:d.n,children:N,anchor:$})}ge.append(b,$);break;default:throw new TypeError("Not a standard ef.js AST: Unknown node type '"+v+"'")}},ke=function(e){var t=e.node,r=e.state,n=e.innerData,a=e.refs,o=e.children,s=e.handlers,i=e.subscribers,u=e.svg,c=e.create,l=t[0],p=t.slice(1);u||"svg"!==l.t.toLowerCase()||(u=!0);var f=function(e){var t=e.info,r=e.state,n=e.innerData,a=e.refs,o=e.handlers,s=e.subscribers,i=e.svg,u=t.t,c=t.a,l=t.p,p=t.e,f=t.r,h=ce({tag:u,ref:f,refs:a,svg:i});for(var d in c)fe({element:h,attr:c[d],key:d,state:r,handlers:o,subscribers:s,innerData:n});for(var v in l)he({element:h,prop:l[v],key:v,state:r,handlers:o,subscribers:s,innerData:n});for(var b in p)ve({element:h,event:p[b],state:r,handlers:o,subscribers:s,innerData:n});return h}({info:l,state:r,innerData:n,refs:a,handlers:s,subscribers:i,svg:u});u&&"foreignobject"===l.t.toLowerCase()&&(u=!1);for(var h=0,d=p;h<d.length;h+=1){var v=d[h];we({node:v,nodeType:O(v),element:f,state:r,innerData:n,refs:a,children:o,handlers:s,subscribers:i,svg:u,create:c})}return f},Ee={BEFORE:"before",AFTER:"after",APPEND:"append",REPLACE:"replace"},$e=function(){function e(e){var t={},r={},n={},a={},o={placeholder:document.createTextNode(""),replace:[],parent:null,key:null},s=document.createDocumentFragment(),i=function(){if(0<o.replace.length){for(var e=0,t=o.replace;e<t.length;e+=1){var r=t[e];ge.remove(r)}S.empty(o.replace)}ge.before(o.placeholder,o.element)},u={mount:i,refs:t,innerData:r,methods:{},handlers:n,subscribers:a,nodeInfo:o,safeZone:s};Object.defineProperty(this,"$ctx",{get:function(){return u}}),W(),te(["$data"],this,!1),o.element=ke({node:e,state:this,innerData:r,refs:t,children:{},handlers:n,subscribers:a,svg:!1,create:ke}),ge.append(s,o.placeholder),V(i),Y()}var t={$methods:{configurable:!0},$refs:{configurable:!0}};return t.$methods.get=function(){return this.$ctx.methods},t.$methods.set=function(e){var t=this.$ctx.methods;ee(t,e)},t.$refs.get=function(){return this.$ctx.refs},e.prototype.$mount=function(e){var t=e.target,r=e.option,n=e.parent,a=e.key,o=this.$ctx,s=o.nodeInfo,i=o.mount;if("string"==typeof t&&(t=document.querySelector(t)),W(),s.parent&&this.$umount(),n||(n=t),a||(a="__DIRECTMOUNT__"),s.parent=n,s.key=a,V(i),!t)return Y(),s.placeholder;switch(r){case Ee.BEFORE:ge.before(t,s.placeholder);break;case Ee.AFTER:ge.after(t,s.placeholder);break;case Ee.REPLACE:ge.before(t,s.placeholder),s.replace.push(t);break;case Ee.APPEND:default:ge.append(t,s.placeholder)}return Y()},e.prototype.$umount=function(){var e=this.$ctx,t=e.nodeInfo,r=e.safeZone,n=e.mount,a=t.parent,o=t.key;return t.parent=null,t.key=null,W(),a&&"__DIRECTMOUNT__"!==o&&a[o]&&(Array.isArray(a[o])?S.remove(a[o],this):a[o]=me),ge.append(r,t.placeholder),V(n),Y()},e.prototype.$subscribe=function(e,t){var r=this.$ctx,n=r.handlers,a=r.subscribers,o=r.innerData,s=e.split("."),i=oe({bind:[s],state:this,handlers:n,subscribers:a,innerData:o}),u=i.dataNode,c=i.subscriberNode,l=i._key;W();try{t({state:this,value:u[l]}),c.push(t)}catch(e){j.error("Error caught when registering subscriber:\n",e)}Y()},e.prototype.$unsubscribe=function(e,t){var r,n,a=this.$ctx.subscribers;r=t,n=function(e,t){for(var r=e.split("."),n=r.pop(),a=0,o=r;a<o.length;a+=1){var s=o[a];t[s]||(t[s]={}),t=t[s]}return t[n]}(e,a),S.remove(n,r)},e.prototype.$update=function(e){W();var t=ee({},e);t.$data&&(ee(this.$data,t.$data),delete t.$data),t.$methods&&(ee(this.$methods,t.$methods),delete t.$methods),ee(this,t),Y()},e.prototype.$destroy=function(){var e=this.$ctx.nodeInfo;for(var t in W(),this.$umount(),this)this[t]=null,delete this[t];return V(function(){ge.remove(e.element),ge.remove(e.placeholder)}),Y()},Object.defineProperties(e.prototype,t),e}(),De=T,_e=function(e){var t,r,n=O(e);if("string"===n)(t=De)||(t=T),e=t(e);else if("array"!==n)throw new TypeError("Cannot create new component without proper template or AST!");return r=e,function(t){function e(e){W(),t.call(this,r),e&&this.$update(e),Y()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e}($e)};e.bundle=function(e){W();try{return Y(e(W,Y))}catch(e){return j.error("Error caught when executing bundle:\n",e),Y()}},e.create=_e,e.exec=Y,e.inform=W,e.isPaused=function(){return 0<C},e.mountOptions=Ee,e.onNextRender=function(e){return P.push(e)},e.parseEft=T,e.setParser=function(e){De=e},e.t=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return _e(R.apply(void 0,e))},e.version="0.8.5",Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ef.min.js.map
