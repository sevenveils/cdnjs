jexcel=function(){this.constructor=function(e){var s={id:null,url:null,data:[[]],columns:[],colHeaders:[],colWidths:[],colAlignments:[],colHeaderClasses:[],defaultColWidth:50,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],contextMenu:null,columnSorting:!0,columnResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeleteColumn:!0,wordWrap:!1,csv:null,csvFileName:"jexcel",csvHeaders:!1,csvDelimiter:",",selectionCopy:!0,tableOverflow:!1,tableHeight:"300px",history:[],historyIndex:-1,about:"jExcel Spreadsheet\\nVersion 2.0.1\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel"};for(var t in s)e.hasOwnProperty(t)?this[t]=e[t]:this[t]=s[t];window.__jexcel__||(window.__jexcel__={current:null,ignoreEvents:!1,ignoreHistory:!1,factory:function(e,s){this.k=e,this.v=s}}),window.__jexcel__.factory.prototype.toString=function(){if(!window.__jexcel__.current)return this.v};var o=this;this.csv?$.csv?$.ajax({url:o.csv,success:function(e){var s=$.csv.toArrays(e);1==o.csvHeaders&&(o.colHeaders=s.shift()),o.data=s,o.prepareTable()}}):console.error("Jexcel error: jquery-csv library not loaded"):this.url?$.ajax({url:o.url,dataType:"json",success:function(e){o.data=e.data?e.data:e,o.prepareTable()}}):o.prepareTable()}(),this.prepareTable=function(){var e=this,s=[],t=this.colHeaders.length;this.data[0].length>t&&(t=this.data[0].length),this.minDimensions[0]>t&&(t=this.minDimensions[0]);for(var o=0;o<t;o++)this.colHeaders[o]||(this.colHeaders[o]=""),this.columns[o]?this.columns[o]||(this.columns[o].type="text"):this.columns[o]={type:"text"},this.columns[o].source||(this.columns[o].source=[]),this.columns[o].options||(this.columns[o].options=[]),this.columns[o].editor||(this.columns[o].editor=null),this.columns[o].allowEmpty||(this.columns[o].allowEmpty=!1),this.colWidths[o]||(this.colWidths[o]=this.defaultColWidth||"50"),this.colAlignments[o]||(this.colAlignments[o]="center"),this.colHeaderClasses[o]||(this.colHeaderClasses[o]=""),"autocomplete"==this.columns[o].type||"dropdown"==this.columns[o].type?this.columns[o].url&&s.push($.ajax({url:e.columns[o].url,index:o,dataType:"json",success:function(e){this.columns[this.index].source=e},error:function(e){console.error("It was not possible to load the url: "+this.url)}})):"calendar"==this.columns[o].type&&(this.columns[o].options.format||(this.columns[o].options.format="DD/MM/YYYY"));0<s.length?$.when.apply(this,s).done(function(){e.createTable()}):e.createTable()},this.createTable=function(){console.log(this)}};