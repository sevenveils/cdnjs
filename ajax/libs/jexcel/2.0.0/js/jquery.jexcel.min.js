!function($){var methods={init:function(e){var l=$(this).prop("id");(e=$.extend({columns:[],colHeaders:[],colWidths:[],colAlignments:[],colHeaderClasses:[],defaultColWidth:50,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],contextMenu:null,columnSorting:!0,columnResize:!0,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeleteColumn:!0,allowComments:!0,wordWrap:!1,csvFileName:"jexcel",selectionCopy:!0,tableOverflow:!1,tableHeight:200,toolbar:null,about:"jExcel Spreadsheet\\nVersion 2.0.0\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel"},e)).div=this,null!=e.manualColumnResize&&(e.columnResize=e.manualColumnResize),null!=e.manualRowMove&&(e.rowDrag=e.manualRowMove),$.fn.jexcel.defaults||($.fn.jexcel.ignoreEvents=!1,$.fn.jexcel.ignoreHistory=!1,$.fn.jexcel.defaults=[],$.fn.jexcel.factory=function(e,l){this.k=e,this.v=l},$.fn.jexcel.factory.prototype.toString=function(){return $.fn.jexcel.current?$.fn.jexcel.defaults[$.fn.jexcel.current].values[this.k]:this.v},$.fn.jexcel.hash=null,$.fn.jexcel.style=null),$.fn.jexcel.defaults[l]=e,$.fn.jexcel.defaults[l].data||($.fn.jexcel.defaults[l].data=[]),$.fn.jexcel.defaults[l].data.length||($.fn.jexcel.defaults[l].data=[[]]),$.fn.jexcel.defaults[l].history=[],$.fn.jexcel.defaults[l].historyIndex=-1,$.fn.jexcel.defaults[l].csv?$.csv?($.fn.jexcel.defaults[l].delimiter=$.fn.jexcel.defaults[l].delimiter||",",$.ajax({id:l,url:$.fn.jexcel.defaults[l].csv,success:function(e){var l=$.csv.toArrays(e);1==$.fn.jexcel.defaults[this.id].csvHeaders&&($.fn.jexcel.defaults[this.id].colHeaders=l.shift()),$.fn.jexcel.defaults[this.id].data=l,$.fn.jexcel("prepareTable",this.id)}})):console.error("Jexcel error: jquery-csv library not loaded"):e.url?$.ajax({id:l,url:$.fn.jexcel.defaults[l].url,dataType:"json",success:function(e){$.fn.jexcel.defaults[this.id].data=e.data?e.data:e,$.fn.jexcel("prepareTable",this.id)}}):$.fn.jexcel("prepareTable",l)},prepareTable:function(e){var l=[],t=$.fn.jexcel.defaults[e].colHeaders.length;$.fn.jexcel.defaults[e].data[0].length>t&&(t=$.fn.jexcel.defaults[e].data[0].length),$.fn.jexcel.defaults[e].minDimensions[0]>t&&(t=$.fn.jexcel.defaults[e].minDimensions[0]);for(var n=0;n<t;n++)$.fn.jexcel.defaults[e].colHeaders[n]||($.fn.jexcel.defaults[e].colHeaders[n]=""),$.fn.jexcel.defaults[e].columns[n]?$.fn.jexcel.defaults[e].columns[n]||($.fn.jexcel.defaults[e].columns[n].type="text"):$.fn.jexcel.defaults[e].columns[n]={type:"text"},$.fn.jexcel.defaults[e].columns[n].source||($.fn.jexcel.defaults[e].columns[n].source=[]),$.fn.jexcel.defaults[e].columns[n].options||($.fn.jexcel.defaults[e].columns[n].options=[]),$.fn.jexcel.defaults[e].columns[n].editor||($.fn.jexcel.defaults[e].columns[n].editor=null),$.fn.jexcel.defaults[e].columns[n].allowEmpty||($.fn.jexcel.defaults[e].columns[n].allowEmpty=!1),$.fn.jexcel.defaults[e].colWidths[n]||($.fn.jexcel.defaults[e].colWidths[n]=$.fn.jexcel.defaults[e].defaultColWidth||"50"),$.fn.jexcel.defaults[e].colAlignments[n]||($.fn.jexcel.defaults[e].colAlignments[n]="center"),$.fn.jexcel.defaults[e].colHeaderClasses[n]||($.fn.jexcel.defaults[e].colHeaderClasses[n]=""),"autocomplete"==$.fn.jexcel.defaults[e].columns[n].type||"dropdown"==$.fn.jexcel.defaults[e].columns[n].type?$.fn.jexcel.defaults[e].columns[n].url&&l.push($.ajax({id:e,url:$.fn.jexcel.defaults[e].columns[n].url,index:n,dataType:"json",success:function(e){$.fn.jexcel.defaults[this.id].columns[this.index].source=e},error:function(e){console.error("It was not possible to load the url: "+this.url)}})):"calendar"==$.fn.jexcel.defaults[e].columns[n].type&&($.fn.jexcel.defaults[e].columns[n].options.format||($.fn.jexcel.defaults[e].columns[n].options.format="DD/MM/YYYY"));l.length>0?$.when.apply(this,l).done(function(){$($.fn.jexcel.defaults[e].div).jexcel("createTable")}):$($.fn.jexcel.defaults[e].div).jexcel("createTable")},createTable:function(){var e=$(this).prop("id"),l=$.fn.jexcel.defaults[e];if($(this).prop("class","jexcel"),l.toolbar&&l.toolbar.length){var t=document.createElement("div");$(t).css("display","nonex"),$(t).prop("class","jexcel-toolbar"),$.each(l.toolbar,function(e,l){if("i"==l.type){if("function"==typeof l.v)var n="getFontColor()";else n="$('#' + $.fn.jexcel.current).jexcel('setStyle', $.fn.jexcel('getSelectedCells'), '"+l.k+"', '"+l.v+"')";toolbar='<i class="jexcel-toolbar-item material-icons" onclick="'+n+'">'+l.content+"</i>",$(t).append(toolbar)}else if("select"==l.type){var c="";"string"==typeof l.v[0]&&$.each(l.v,function(e,l){c+='<option value="'+l+'">'+l+"</option>"}),toolbar="<select class=\"jexcel-toolbar-item\" onchange=\"$('#' + $.fn.jexcel.current).jexcel('setStyle', $.fn.jexcel('getSelectedCells'), '"+l.k+"', this.value)\">"+c+"</select>",$(t).append(toolbar)}else"spectrum"==l.type&&(toolbar=document.createElement("input"),$(t).append(toolbar),$(toolbar).spectrum({showButtons:!1,move:function(e){$("#"+$.fn.jexcel.current).jexcel("setStyle",$.fn.jexcel("getSelectedCells"),l.k,e.toHexString())}}))})}var n=document.createElement("div");$(n).prop("class","jexcel-header");var c=document.createElement("div");$(c).prop("class","jexcel-content");var s=document.createElement("table");$(s).prop("cellpadding","0"),$(s).prop("cellspacing","0"),$(s).prop("unselectable","yes"),$(s).prop("onselectstart","return false");var o=document.createElement("thead"),r=document.createElement("tbody");$(o).prop("class","jexcel_label");var a="",i="",f="";if(l.nestedHeaders&&l.nestedHeaders.length>0){var d=function(e){a="<td></td>";for(var l=0,t=0;t<e.length;t++){e[t].colspan||(e[t].colspan=1),e[t].align||(e[t].align="center"),e[t].title||(e[t].title="");for(var n="",c=0;c<e[t].colspan;c++)n&&(n+=" "),n+="h"+l,l++;a+='<td class="'+n+'" colspan="'+e[t].colspan+'" align="'+e[t].align+'">'+e[t].title+"</td>"}return'<tr class="jexcel_nested">'+a+"</tr>"};l.nestedHeaders[0]&&l.nestedHeaders[0][0]?$.each(l.nestedHeaders,function(e,l){i+=d(l)}):i+=d(l.nestedHeaders)}a="<td></td>";for(var u=0;u<l.colHeaders.length;u++){var p=l.colWidths[u],x=l.colAlignments[u]||"center",j="";l.colHeaderClasses[u]&&(j+=l.colHeaderClasses[u]);var h="hidden"==l.columns[u].type?' style="display:none"':"",m=l.colHeaders[u],g=m||$.fn.jexcel("getColumnName",u);f+='<col width="'+p+'">',a+='<td id="col-'+u+'" align="'+x+'" title="'+m+'" class="'+j+'"'+h+">"+g+"</td>",'<td><input placeholder="Filter:"></td>'}$(o).append('<tr class="jexcel_headers_nested">'+i+"</tr>"),$(o).append('<tr class="jexcel_headers">'+a+"</tr>"),$(s).append('<colgroup><col width="30">'+f+"</colgroup>"),$(s).append(o),$(n).append(s);var v=document.createElement("table");if($(v).prop("cellpadding","0"),$(v).prop("cellspacing","0"),$(v).prop("unselectable","yes"),$(v).prop("onselectstart","return false"),$(v).append('<colgroup><col width="30">'+f+"</colgroup>"),$(v).append(r),$(c).html(v),1==$.fn.jexcel.defaults[e].tableOverflow&&($.fn.jexcel.defaults[e].tableWidth&&($(c).css("overflow-x","scroll"),$(c).css("max-width",$.fn.jexcel.defaults[e].tableWidth)),$.fn.jexcel.defaults[e].tableHeight?($(c).css("overflow-y","scroll"),$(c).css("max-height",$.fn.jexcel.defaults[e].tableHeight),$.fn.jexcel.defaults[e].tableWidth&&($(n).css("overflow-x","hidden"),$(n).css("max-width",parseInt($.fn.jexcel.defaults[e].tableWidth)-17))):$.fn.jexcel.defaults[e].tableWidth&&($(n).css("overflow-x","hidden"),$(n).css("max-width",$.fn.jexcel.defaults[e].tableWidth))),$(this).html(t),$(this).append(n),$(this).append(c),!$(".jexcel_corner").length){var C=document.createElement("div");$(C).prop("class","jexcel_corner jexcel"),$(C).prop("id","jexcel_corner"),0==l.selectionCopy&&$(C).css("display","none");var y=document.createElement("textarea");$(y).prop("class","jexcel_textarea"),$(y).prop("id","jexcel_textarea");var w=document.createElement("div");$(w).css("display","none"),$(w).prop("class","jexcel_contextmenu"),$(w).prop("id","jexcel_contextmenu");var b=document.createElement("div");$(b).css("display","none"),$(b).prop("id","jexcel_about"),$(b).prop("class","jexcel_about"),$(b).html('<a href="https://github.com/paulhodel/jexcel">jExcel Spreadsheet</a>'),$("body").append(C),$("body").append(y),$("body").append(w),$("body").append(b),$(C).prop("unselectable","on"),$(C).prop("onselectstart","return false"),$.fn.jexcel.dragStartControls=function(e){$(e.target).prop("id")},$.fn.jexcel.selectedCorner=!1,$.fn.jexcel.selectedHeader=null,$.fn.jexcel.resizeColumn=null,$.fn.jexcel.contextMenuControls=function(e){if($($.fn.jexcel.selectedCell).hasClass("edition"))e.preventDefault();else if("block"==$("#jexcel_contextmenu").css("display")&&$("#jexcel_contextmenu").css("display","none"),$.fn.jexcel.current&&!!$(e.target).parents(".jexcel").length){if($(e.target).parent().is(".jexcel_headers"))var l=$(e.target).prop("id");else l=$(e.target).parent().prop("id");l&&(l=l.split("-"),contextMenuContent="","function"==typeof $.fn.jexcel.defaults[$.fn.jexcel.current].contextMenu?contextMenuContent=$.fn.jexcel.defaults[$.fn.jexcel.current].contextMenu(l[0],l[1]):contextMenuContent=$.fn.jexcel("contextMenu",l[0],l[1]),contextMenuContent&&($("#jexcel_contextmenu").html(contextMenuContent),$("#jexcel_contextmenu").css({display:"block",top:e.pageY+"px",left:e.pageX+"px"}),e.preventDefault()))}},$(document).on("contextmenu",$.fn.jexcel.contextMenuControls),$.fn.jexcel.mouseWheelControls=function(e){$(".jexcel_contextmenu").css("display","none")},$(document).on("mousewheel",$.fn.jexcel.mouseWheelControls),$.fn.jexcel.mouseDownControls=function(e){if(3!=e.which)if("jexcel_corner"==e.target.id)1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&($.fn.jexcel.selectedCorner=!0);else{var l=$(e.target).parents(".jexcel");if($(l).length>0){var t=$(l).prop("id");if($.fn.jexcel.current&&$.fn.jexcel.current!=t&&$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$.fn.jexcel.current=t,$(e.target).parent().is(".jexcel_headers")){if(a=$(e.target).prop("id")){if(a=a.split("-"),$.fn.jexcel.selectedHeader&&(e.shiftKey||e.ctrlKey))var n=$($.fn.jexcel.selectedHeader).prop("id").split("-");else{n=$(e.target).prop("id").split("-");$.fn.jexcel.selectedHeader=$(e.target),$.fn.jexcel.selectedRow=null}if($(e.target).outerWidth()-e.offsetX<8)1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnResize&&($.fn.jexcel.resizeColumn={mousePosition:e.pageX,column:a[1],width:parseInt($(e.target).css("width"))},$("#"+$.fn.jexcel.current+" .c"+a[1]).addClass("resizing"),$("#"+$.fn.jexcel.current+" .h"+a[1]).addClass("resizing"),$("#"+$.fn.jexcel.current+" #col-"+a[1]).addClass("resizing"),$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$(".jexcel_corner").css("left","-200px"));else{var c=$("#"+$.fn.jexcel.current).find("#"+a[1]+"-0"),s=$("#"+$.fn.jexcel.current).find("#"+n[1]+"-"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1));$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,s,1),$.fn.jexcel.selectedCell=$(c)}}}else $.fn.jexcel.selectedHeader=!1;if($(e.target).parent().is(".jexcel_nested")){var o=$(e.target).prop("class").split(" "),r="";if($.each(o,function(e,l){"h"==l.substr(0,1)&&(r&&(r+=", "),r+=".c"+l.substr(1))}),r){o=$("#"+$.fn.jexcel.current).find(r),c=$(o).first(),s=$(o).last();$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,s,1),$.fn.jexcel.selectedCell=$(c)}}if($(e.target).parent().parent().parent().parent().hasClass("jexcel-content"))if($(e.target).is(".jexcel_label"))if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].rowDrag&&$(e.target).outerWidth()-e.offsetX<8)$("#"+$.fn.jexcel.current).jexcel("resetSelection"),$.fn.jexcel.dragRowFrom=$(e.target).parent().prop("id"),$.fn.jexcel.dragRowOver=$(e.target).parent().prop("id"),$(e.target).parent().find("td").css("background-color","rgba(0,0,0,0.1)");else{var a=$(e.target).parent().prop("id").split("-");if($.fn.jexcel.selectedRow&&(e.shiftKey||e.ctrlKey))n=$($.fn.jexcel.selectedRow).prop("id").split("-");else{n=$(e.target).parent().prop("id").split("-");$.fn.jexcel.selectedRow=$(e.target).parent(),$.fn.jexcel.selectedHeader=null}c=$("#"+$.fn.jexcel.current).find("#0-"+a[1]),s=$("#"+$.fn.jexcel.current).find("#"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1)+"-"+n[1]);$("#"+$.fn.jexcel.current).jexcel("updateSelection",c,s),$.fn.jexcel.selectedCell=$(s)}else $($.fn.jexcel.selectedCell).hasClass("edition")?$(e.target)!=$.fn.jexcel.selectedCell&&($.fn.jexcel.selectedCell=$(e.target),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(e.target))):($.fn.jexcel.selectedCell&&e.shiftKey||($.fn.jexcel.selectedCell=$(e.target)),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(e.target))),$.fn.jexcel.selectedRow=null}else $(e.target).parents(".jexcel, .jexcel_contextmenu").length||e.target!=$("html").get(0)&&$("#"+$.fn.jexcel.current).jexcel("resetSelection")}},$(document).on("mousedown",$.fn.jexcel.mouseDownControls),$.fn.jexcel.touchControls=null,$(document).on("touchstart",function(e){$.fn.jexcel.touchControl=setTimeout(function(){$("#"+$.fn.jexcel.current).jexcel("openEditor",$.fn.jexcel.selectedCell)},1e3)}),$(document).on("touchend touchcancel",function(){$.fn.jexcel.touchControl&&clearTimeout($.fn.jexcel.touchControl)}),$.fn.jexcel.mouseUpControls=function(e){if("jexcel_arrow"==e.target.id)$.fn.jexcel.current||($.fn.jexcel.current=$(e.target).parents(".jexcel").parent().prop("id")),$.fn.jexcel.selectedCell=$(e.target).parent().parent(),$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$.fn.jexcel.selectedCell),$("#"+$.fn.jexcel.current).jexcel("openEditor",$.fn.jexcel.selectedCell);else{if(3!=e.which&&$("#jexcel_contextmenu").css("display","none"),$.fn.jexcel.selectedCorner=!1,$.fn.jexcel.resizeColumn){$("#"+$.fn.jexcel.current+" .h"+$.fn.jexcel.resizeColumn.column).removeClass("resizing"),$("#"+$.fn.jexcel.current+" .c"+$.fn.jexcel.resizeColumn.column).removeClass("resizing"),$("#"+$.fn.jexcel.current+" #col-"+$.fn.jexcel.resizeColumn.column).removeClass("resizing");var l=$("#"+$.fn.jexcel.current+" .jexcel-header col").eq(parseInt($.fn.jexcel.resizeColumn.column)+1).prop("width");$("#"+$.fn.jexcel.current).jexcel("setWidth",$.fn.jexcel.resizeColumn.column,l),"function"==typeof $.fn.jexcel.defaults[$.fn.jexcel.current].onresize&&$.fn.jexcel.defaults[$.fn.jexcel.current].onresize($(this),$.fn.jexcel.resizeColumn.column,l,$.fn.jexcel.resizeColumn.width),$.fn.jexcel.resizeColumn=null}var t=$("#"+$.fn.jexcel.current).find("tbody td.selection");if($(t).length>0){var n=$(t[0]).prop("id").split("-"),c=$(t[t.length-1]).prop("id").split("-");$("#"+$.fn.jexcel.current).jexcel("copyData",n,c),$(t).removeClass("selection selection-left selection-right selection-top selection-bottom")}}if($.fn.jexcel.dragRowFrom){if($.fn.jexcel.dragRowFrom!=$.fn.jexcel.dragRowOver){var s=$.fn.jexcel.dragRowFrom.split("-"),o=$.fn.jexcel.dragRowOver.split("-");$("#"+$.fn.jexcel.current).jexcel("moveRow",s[1],o[1])}$("#"+$.fn.jexcel.dragRowFrom).css("cursor",""),$("#"+$.fn.jexcel.dragRowOver).css("cursor",""),$("#"+$.fn.jexcel.current+" #"+$.fn.jexcel.dragRowOver).parent().find("td").css("background-color","")}$.fn.jexcel.dragRowFrom=null,$.fn.jexcel.dragRowOver=null},$(document).on("mouseup",$.fn.jexcel.mouseUpControls),$.fn.jexcel.doubleClickControls=function(e){if($.fn.jexcel.current){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable){if("jexcel_corner"==e.target.id){var l=$("#"+$.fn.jexcel.current).find("tbody td.highlight");if("object"==typeof l){var t=$(l[0]).prop("id").split("-"),n=$(l[l.length-1]).prop("id").split("-");t[1]=parseInt(n[1])+1,n[1]=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length),$("#"+$.fn.jexcel.current).jexcel("copyData",t,n)}}$(e.target).is(".highlight")&&$("#"+$.fn.jexcel.current).jexcel("openEditor",$(e.target))}if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnSorting)if($(e.target).parent().parent().is("thead"))(t=$(e.target).prop("id"))&&(t=$(e.target).prop("id").split("-"),$("#"+$.fn.jexcel.current).jexcel("orderBy",t[1]))}},$(document).on("dblclick",$.fn.jexcel.doubleClickControls),$.fn.jexcel.mouseMoveControls=function(e){if($.fn.jexcel.current){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnResize)if($.fn.jexcel.resizeColumn){var l=e.pageX-$.fn.jexcel.resizeColumn.mousePosition;if($.fn.jexcel.resizeColumn.width+l>0){var t=$.fn.jexcel.resizeColumn.width+l;$("#"+$.fn.jexcel.current).find(".jexcel-header col").eq(parseInt($.fn.jexcel.resizeColumn.column)+1).prop("width",t)}}else $(e.target).parent().is(".jexcel_headers")&&($(e.target).outerWidth()-e.offsetX<8&&""!=$(e.target).prop("id")?$(e.target).css("cursor","col-resize"):"col-resize"==$(e.target).css("cursor")&&$(e.target).css("cursor",""));1==$.fn.jexcel.defaults[$.fn.jexcel.current].rowDrag&&$(e.target).parent().parent().is("tbody")&&$(e.target).is(".jexcel_label")&&($(e.target).outerWidth()-e.offsetX<8?$(e.target).css("cursor","all-scroll"):"all-scroll"==$(e.target).css("cursor")&&$(e.target).css("cursor",""))}$.fn.jexcel.dragRowFrom?$("body").css("cursor","all-scroll"):"all-scroll"==$("body").css("cursor")&&$("body").css("cursor","")},$(document).on("mousemove",$.fn.jexcel.mouseMoveControls),$.fn.jexcel.mouseOverControls=function(l){if(!$.fn.jexcel.resizeColumn){var t=$(l.target).closest(".jexcel");if($.fn.jexcel.current==$(t).prop("id")){if($(l.target).parent().is(".jexcel_headers")&&$.fn.jexcel.selectedHeader&&l.buttons){var n=$($.fn.jexcel.selectedHeader).prop("id"),c=$(l.target).prop("id");if(n&&c){n=n.split("-"),c=c.split("-");var s=$("#"+$.fn.jexcel.current).find("#"+n[1]+"-0"),o=$("#"+$.fn.jexcel.current).find("#"+c[1]+"-"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1));$("#"+$.fn.jexcel.current).jexcel("updateSelection",s,o)}}if($(l.target).parent().parent().is("tbody"))if($(l.target).is(".jexcel_label"))if($.fn.jexcel.selectedRow){if(l.buttons){n=$($.fn.jexcel.selectedRow).prop("id"),c=$(l.target).parent().prop("id");if(n&&c){n=n.split("-"),c=c.split("-");s=$("#"+$.fn.jexcel.current).find("#0-"+n[1]),o=$("#"+$.fn.jexcel.current).find("#"+parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1)+"-"+c[1]);$("#"+$.fn.jexcel.current).jexcel("updateSelection",s,o)}}}else $.fn.jexcel.dragRowFrom&&($("#"+$.fn.jexcel.current+" #"+$.fn.jexcel.dragRowOver).parent().find("td").css("background-color",""),$(l.target).parent().find("td").css("background-color","rgba(0,0,0,0.1)"),$.fn.jexcel.dragRowOver=$(l.target).parent().prop("id"));else $.fn.jexcel.selectedCell&&($($.fn.jexcel.selectedCell).hasClass("edition")||(1==$.fn.jexcel.selectedCorner?$("#"+$.fn.jexcel.current).jexcel("updateCornerSelection",$(l.target)):l.buttons&&$("#"+$.fn.jexcel.current).jexcel("updateSelection",$.fn.jexcel.selectedCell,$(l.target)))),1!=$.fn.jexcel.ignoreEvents&&$.fn.jexcel.defaults[e].onmouseover&&"function"==typeof $.fn.jexcel.defaults[e].onmouseover&&$.fn.jexcel.defaults[e].onmouseover($("#"+$.fn.jexcel.current),$(l.target))}}},$(document).on("mouseover",$.fn.jexcel.mouseOverControls),$.fn.jexcel.pasteControls=function(e){$.fn.jexcel.selectedCell&&($($.fn.jexcel.selectedCell).hasClass("edition")||e.originalEvent&&(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&$("#"+$.fn.jexcel.current).jexcel("paste",$.fn.jexcel.selectedCell,e.originalEvent.clipboardData.getData("text")),e.preventDefault()))},$(document).on("paste",$.fn.jexcel.pasteControls),$.fn.jexcel.keyDownControls=function(e){if($.fn.jexcel.current){var l=null;if($.fn.jexcel.selectedCell){if(columnId=$($.fn.jexcel.selectedCell).prop("id").split("-"),37==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(e.ctrlKey?l=$($.fn.jexcel.selectedCell).parent().find("td").not(".jexcel_label").first():$.fn.jexcel("col")>0&&(l=$($.fn.jexcel.selectedCell).prev()),e.preventDefault());else if(39==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().find("td").last():$($.fn.jexcel.selectedCell).next(),e.preventDefault());else if(38==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").first().find("#"+columnId[0]+"-0"):$($.fn.jexcel.selectedCell).parent().prev().find("#"+columnId[0]+"-"+(columnId[1]-1)),e.preventDefault());else if(40==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").last().find("#"+columnId[0]+"-"+($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1)):$($.fn.jexcel.selectedCell).parent().next().find("#"+columnId[0]+"-"+(parseInt(columnId[1])+1)),e.preventDefault());else if(36==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.shiftKey&&e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").first().find("td").not(".jexcel_label").first():$($.fn.jexcel.selectedCell).parent().find("td").not(".jexcel_label").first(),e.preventDefault());else if(35==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")||(l=e.shiftKey&&e.ctrlKey?$($.fn.jexcel.selectedCell).parent().parent().find("tr").last().find("td").last():$($.fn.jexcel.selectedCell).parent().find("td").last(),e.preventDefault());else if(27==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")&&$("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!1);else if(13==e.which){if($($.fn.jexcel.selectedCell).hasClass("edition"))if("calendar"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type)$("#"+$.fn.jexcel.current).find("editor").jcalendar("close",1);else if("dropdown"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type||"autocomplete"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type);else if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].wordWrap&&e.altKey){var t=$($.fn.jexcel.selectedCell).find(".editor"),n=$(t).val(),c=$(t).prop("selectionStart");n=n.slice(0,c)+"\n"+n.slice(c),$(t).val(n),$(t).focus(),$(t).prop("selectionStart",c+1),$(t).prop("selectionEnd",c+1)}else $("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!0);$($.fn.jexcel.selectedCell).hasClass("edition")||(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertRow&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowManualInsertRow&&columnId[1]==$.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1&&$("#"+$.fn.jexcel.current).jexcel("insertRow"),l=$($.fn.jexcel.selectedCell).parent().next().find("#"+columnId[0]+"-"+(parseInt(columnId[1])+1)),e.preventDefault())}else if(9==e.which)$($.fn.jexcel.selectedCell).hasClass("edition")&&("calendar"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type?$("#"+$.fn.jexcel.current).find("editor").jcalendar("close",1):$("#"+$.fn.jexcel.current).jexcel("closeEditor",$($.fn.jexcel.selectedCell),!0)),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertColumn&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowManualInsertColumn&&columnId[0]==$.fn.jexcel.defaults[$.fn.jexcel.current].data[0].length-1&&$("#"+$.fn.jexcel.current).jexcel("insertColumn"),$($.fn.jexcel.selectedCell).hasClass("edition")||(e.shiftKey?$.fn.jexcel("col")>0&&(l=$($.fn.jexcel.selectedCell).prev()):l=$($.fn.jexcel.selectedCell).next()),e.preventDefault();else if(46==e.which){if(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if($.fn.jexcel.selectedRow)confirm("Are you sure to delete the selected rows?")&&($("#"+$.fn.jexcel.current).jexcel("deleteRow"),$("#"+$.fn.jexcel.current).jexcel("resetSelection"));else if($.fn.jexcel.selectedHeader){if(confirm("Are you sure to delete the selected columns?")){var s=$("#"+$.fn.jexcel.current).find("thead.jexcel_label").find(".selected");$("#"+$.fn.jexcel.current).jexcel("deleteColumn",parseInt($(s[0]).prop("id").split("-")[1]),parseInt(s.length))}}else $("#"+$.fn.jexcel.current).jexcel("setValue",$("#"+$.fn.jexcel.current).find(".highlight"),"")}else if(!e.metaKey||e.shiftKey||e.ctrlKey){if(e.ctrlKey){if(!e.shiftKey&&e.ctrlKey&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if(65==e.which){var o=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].columns.length-1),r=parseInt($.fn.jexcel.defaults[$.fn.jexcel.current].data.length-1),a=$("#"+$.fn.jexcel.current).find("#0-0"),i=$("#"+$.fn.jexcel.current).find("#"+o+"-"+r);$("#"+$.fn.jexcel.current).jexcel("updateSelection",a,i),e.preventDefault()}else 83==e.which?($("#"+$.fn.jexcel.current).jexcel("download"),e.preventDefault()):89==e.which?($($.fn.jexcel.selectedCell).hasClass("edition")||$("#"+$.fn.jexcel.current).jexcel("redo"),e.preventDefault()):90==e.which?($($.fn.jexcel.selectedCell).hasClass("edition")||$("#"+$.fn.jexcel.current).jexcel("undo"),e.preventDefault()):67==e.which?($("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault()):88==e.which?(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable?$("#"+$.fn.jexcel.current).jexcel("cut"):$("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault()):86==e.which&&window.clipboardData&&(1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&$("#"+$.fn.jexcel.current).jexcel("paste",$.fn.jexcel.selectedCell,window.clipboardData.getData("Text")),e.preventDefault())}else if($.fn.jexcel.selectedCell&&1==$.fn.jexcel.defaults[$.fn.jexcel.current].editable&&"readonly"!=$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type&&!$($.fn.jexcel.selectedCell).hasClass("edition"))if(32==e.keyCode)if("checkbox"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type||"radio"==$.fn.jexcel.defaults[$.fn.jexcel.current].columns[columnId[0]].type){var f=$("#"+$.fn.jexcel.current).jexcel("getValue",$.fn.jexcel.selectedCell);$("#"+$.fn.jexcel.current).jexcel("setValue",$.fn.jexcel.selectedCell,1!=f),e.preventDefault()}else $("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!0);else 110==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=65&&e.keyCode<=90||e.keyCode>=96&&e.keyCode<=105||e.keyCode>=186&&e.keyCode<=190?$("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!0):113==e.keyCode&&($("#"+$.fn.jexcel.current).jexcel("openEditor",$($.fn.jexcel.selectedCell),!1),e.preventDefault())}else $($.fn.jexcel.selectedCell).hasClass("edition")||67==e.which&&($("#"+$.fn.jexcel.current).jexcel("copy",!0),e.preventDefault());if(l&&$(l).length>0){if(e.shiftKey&&9!=e.which){$.fn.jexcel.referenceCell||($.fn.jexcel.referenceCell=$.fn.jexcel.selectedCell);a=$.fn.jexcel.referenceCell}else{$.fn.jexcel.referenceCell=null;a=l}var d=l;$.fn.jexcel.selectedCell=d,$("#"+$.fn.jexcel.current).jexcel("updateSelection",a,d)}}}},$(document).on("keydown",$.fn.jexcel.keyDownControls)}$(this).children(".jexcel-content").on("scroll",function(){$(this).jexcel("updateCornerPosition"),$(n).scrollLeft($(this).scrollLeft())}),$(this).jexcel("setData",$.fn.jexcel.defaults[e].data);var I=!!$.fn.jexcel.ignoreEvents,H=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$.fn.jexcel.defaults[e].style&&$(this).jexcel("setStyle",$.fn.jexcel.defaults[e].style),$.fn.jexcel.defaults[e].meta&&$(this).jexcel("setMeta",$.fn.jexcel.defaults[e].meta),$.fn.jexcel.ignoreEvents=I,$.fn.jexcel.ignoreHistory=H},setData:function(e,l){var t=$(this).prop("id");e&&("string"==typeof e&&(e=JSON.parse(e)),$.fn.jexcel.defaults[t].data=e),$.fn.jexcel.defaults[t].history=[],$.fn.jexcel.defaults[t].historyIndex=-1;var n=$.fn.jexcel.defaults[t].colHeaders.length,c=$.fn.jexcel.defaults[t].data.length,s=$.fn.jexcel.defaults[t].minDimensions[0],o=$.fn.jexcel.defaults[t].minDimensions[1],r=s>n?s:n,a=o>c?o:c;for(j=0;j<a;j++)for(i=0;i<r;i++)null==$.fn.jexcel.defaults[t].data[j]&&($.fn.jexcel.defaults[t].data[j]=[]),null==$.fn.jexcel.defaults[t].data[j][i]&&($.fn.jexcel.defaults[t].data[j][i]="");$.fn.jexcel.defaults[t].formula=[],$.fn.jexcel.defaults[t].values=[];var f=$(this).find("tbody");$(f).html("");var d=[];for(j=0;j<$.fn.jexcel.defaults[t].data.length;j++){for(tr=document.createElement("tr"),$(tr).prop("id","row-"+parseInt(j)),$(tr).append('<td class="jexcel_label">'+parseInt(j+1)+"</td>"),i=0;i<$.fn.jexcel.defaults[t].colHeaders.length;i++)td=$(this).jexcel("createCell",i,j),$(tr).append(td),d.push({col:i,row:j,cell:$(td),newValue:$.fn.jexcel.defaults[t].data[j][i],oldValue:""});$(f).append(tr)}$(this).jexcel("loadCells",d,!0),$(this).jexcel("updateAllCellsWithFormulas"),e&&1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[t].onload&&$.fn.jexcel.defaults[t].onload($(this))},updateSettings:function(e){var l=$(this),t=$(this).prop("id");if(e?$.fn.jexcel.defaults[t].updateSettingsOptions=e:$.fn.jexcel.defaults[t].updateSettingsOptions&&(e=$.fn.jexcel.defaults[t].updateSettingsOptions),e){var n=$(this).find("tbody td").not(".jexcel_label");"function"==typeof e.cells?$.each(n,function(l,t){var n=$(t).prop("id").split("-");e.cells($(t),n[0],n[1])}):"function"==typeof e.table&&$.each(n,function(n,c){var s=$(c).prop("id").split("-");e.table($(l),$(c),s[0],s[1],$.fn.jexcel.defaults[t].data[s[1]][s[0]],$.fn.jexcel("getColumnNameFromId",[s[0],s[1]]))})}},openEditor:function(e,l,t){var n=$(this).prop("id"),c=$(this),s=$.fn.jexcel.defaults[n],o=$(e).prop("id").split("-");if(1==$(e).hasClass("readonly"));else if($.fn.jexcel.edition=$(e).html(),$.fn.jexcel.editionValue=$(this).jexcel("getValue",$(e)),s.columns[o[0]].editor)$(e).addClass("edition"),s.columns[o[0]].editor.openEditor(e);else if("checkbox"==s.columns[o[0]].type||"radio"==s.columns[o[0]].type||"hidden"==s.columns[o[0]].type){var r=1!=$(this).jexcel("getValue",$(e));$(this).jexcel("setValue",$(e),r)}else if("dropdown"==s.columns[o[0]].type||"autocomplete"==s.columns[o[0]].type){$(e).addClass("edition");r=$(e).find("input").val();if("function"==typeof s.columns[o[0]].filter)var a=s.columns[o[0]].filter($(this),$(e),o[0],o[1],s.columns[o[0]].source);else a=s.columns[o[0]].source;if($.fn.jdropdown){var f=document.createElement("div");$(f).jdropdown({data:a,multiple:!!s.columns[o[0]].multiple,autocomplete:!(!s.columns[o[0]].autocomplete&&"autocomplete"!=s.columns[o[0]].type),opened:!0,value:s.columns[o[0]].multiple?r.split(";"):r,onclose:function(){$(c).jexcel("closeEditor",$(e),!0)}}),$(f).css("width",$(e).width()),$(f).css("height",$(e).height())}else if("autocomplete"==s.columns[o[0]].type)console.error("This is deprected. You should include jdropdown to render the autocomplete properly");else{f=document.createElement("select");for(i=0;i<a.length;i++){"object"==typeof a[i]?(k=a[i].id,v=a[i].name):(k=a[i],v=a[i]);var d=document.createElement("option");$(d).val(k),$(d).html(v),$(f).append(d)}$(f).css("width",$(e).width()),$(f).css("height",$(e).height()),$(f).blur(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)}),$(f).change(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)}),$(f).focus(),r&&$(f).val(r)}$(e).html(f)}else if("calendar"==s.columns[o[0]].type){$(e).addClass("edition");r=$(e).find("input").val(),f=document.createElement("input");$(f).prop("class","editor"),$(f).css("width",$(e).width()),$(f).css("height",$(e).height()),$(f).val($(e).text()),$(e).html(f),$(f).focus(),s.columns[o[0]].options.onclose=function(){$(c).jexcel("closeEditor",$(e),!0)},$(f).jcalendar(s.columns[o[0]].options),$(f).jcalendar("open",r)}else{var u=$(e).width(),p=$(e).innerHeight();if($(e).addClass("edition"),1==s.wordWrap||1==s.columns[o[0]].wordWrap)var x=$(e).find("textarea");else x=$(e).find("input");if($(x).length)var j=$(x).val();else j=$(e).html();if(1==s.wordWrap||1==s.columns[o[0]].wordWrap)f=document.createElement("textarea");else f=document.createElement("input");$(f).prop("class","editor"),$(f).css("width",u),$(f).css("min-height",p),$(e).html(f),s.columns[o[0]].mask&&($.fn.masked?$(f).mask(s.columns[o[0]].mask,s.columns[o[0]].options):console.error("Jexcel: it was not possible to load the mask plugin.")),$(f).focus(),l||$(f).val(j),$(f).blur(function(){$(c).jexcel("closeEditor",$(this).parent(),!0)})}},closeEditor:function(e,l){$(e).removeClass("edition");var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");if(1==l){if(n.columns[c[0]].editor)s=n.columns[c[0]].editor.closeEditor(e,l);else if("checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type||"hidden"==n.columns[c[0]].type);else if("dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type)if($.fn.jdropdown)var s=$(e).find(".jdropdown").jdropdown("getValue");else if("autocomplete"==n.columns[c[0]].type)console.error("This is deprected. You should include jdropdown to render the autocomplete properly");else s=$(e).find("select").val();else if("calendar"==n.columns[c[0]].type)s=$(e).find(".jcalendar_value").val();else if("numeric"==n.columns[c[0]].type){"="!=(s=$(e).find(".editor").val()).substr(0,1)&&(s=""==s&&n.columns[c[0]].allowEmpty?"":Number(s)||0)}else s=$(e).find(".editor").val();var o=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.defaults[t].data[c[1]][c[0]]==s&&($.fn.jexcel.ignoreHistory=!0),$.fn.jexcel.defaults[t].data[c[1]][c[0]]=s,$(this).jexcel("updateCells",[{col:c[0],row:c[1],cell:$(e),newValue:s,oldValue:$.fn.jexcel.editionValue}]),$.fn.jexcel.ignoreHistory=o}else n.columns[c[0]].editor?n.columns[c[0]].editor.closeEditor(e,l):"calendar"==n.columns[c[0]].type||("dropdown"!=n.columns[c[0]].type&&"autocomplete"!=n.columns[c[0]].type||$(e).find(".jdropdown").jdropdown("close"),$(e).html($.fn.jexcel.edition),$.fn.jexcel.edition=null)},getCell:function(e){return e=$(this).jexcel("getIdFromColumnName",e),e=$(this).find("[id="+e+"]")},getValue:function(e){var l=null;if("object"!=typeof e&&(e=$(this).jexcel("getCell",e)),$(e).length){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");n.columns[c[0]].editor?l=n.columns[c[0]].editor.getValue(e):"checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type?l=1==$(e).find("input").is(":checked")?"1":"0":"dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type||"calendar"==n.columns[c[0]].type?l=$(e).find("input").val():"currency"==n.columns[c[0]].type?l=$(e).html().replace(/\D/g,""):(l=$(e).find("input"),l=$(l).length?$(l).val():$(e).html())}return l},setValue:function(e,l,t){if("object"!=typeof e){$(this).jexcel("getIdFromColumnName",e);e=$(this).jexcel("getCell",e)}if($(e).length){var n=$(this).prop("id"),c=($(this),[]);return $.each(e,function(e,t){var s=$(t).prop("id").split("-");c.push({col:s[0],row:s[1],cell:$(t),newValue:l,oldValue:$.fn.jexcel.defaults[n].data[s[1]][s[0]]})}),t=!!t,$(this).jexcel("updateCells",c,t),!0}return!1},getText:function(e){var l=null;if("object"!=typeof e&&(e=$(this).jexcel("getCell",e)),$(e).length){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=$(e).prop("id").split("-");l=n.columns[c[0]].editor?n.columns[c[0]].editor.getText(e):"checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type?1==$(e).find("input").is(":checked")?"1":"0":$(e).text()}return l},loadCells:function(e,l){var t=!!$.fn.jexcel.ignoreEvents,n=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$(this).jexcel("updateCells",e,l),$.fn.jexcel.ignoreEvents=t,$.fn.jexcel.ignoreHistory=n},updateCells:function(e,l){var t=$(this).prop("id"),n=$(this),c=$.fn.jexcel.defaults[t];$.each(e,function(e,t){t.cell=$(n).find("#"+t.col+"-"+t.row),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.onbeforechange&&c.onbeforechange(n,$(t.cell),t.oldValue,t.newValue),l=!!l,$(n).jexcel("updateCell",t,l),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.onchange&&c.onchange(n,$(t.cell),t.newValue,t.oldValue)}),$(this).jexcel("afterChange"),$(this).jexcel("setHistory",e)},updateCell:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t],c=[e.col,e.row];if(value=""+e.newValue,1==$(e.cell).hasClass("readonly")&&0==l);else{if(n.columns[c[0]].editor)n.columns[c[0]].editor.setValue($(e.cell),value);else if("checkbox"==n.columns[c[0]].type||"radio"==n.columns[c[0]].type)1==value||1==value||"true"==value?$(e.cell).find("input").prop("checked",!0):$(e.cell).find("input").prop("checked",!1);else if("dropdown"==n.columns[c[0]].type||"autocomplete"==n.columns[c[0]].type){if(key="",val="",value){var s=[],o=n.columns[c[0]].source;for(num=0;num<o.length;num++)"object"==typeof o[num]?s[o[num].id]=o[num].name:s[o[num]]=o[num];for(var r=value.split(";"),a=0;a<r.length;a++)s[r[a]]&&(key&&(key+=";"),key+=r[a],val&&(val+="; "),val+=s[r[a]])}val||(val="&nbsp"),$(e.cell).html('<input type="hidden" value="'+key+'">'+val+'<span class="jexcel_arrow"><span id="jexcel_arrow"></span></span>')}else"calendar"==n.columns[c[0]].type?(val="","undefined"!=value?(date=$.fn.jcalendar("fromFormatted",value,n.columns[c[0]].options.format),date&&(value=date),val=$.fn.jcalendar("label",value,n.columns[c[0]].options.format)):val="",val||(value=""),$(e.cell).html('<input type="hidden" value="'+value+'">'+val)):(val=value||"","="==value.substr(0,1)?($(this).jexcel("updateFormulas",e.col+"-"+e.row,value),$(e.cell).html('<input type="hidden" value="'+value+'">'+val)):"numeric"==n.columns[c[0]].type?$(e.cell).html('<input type="hidden" value="'+value+'">'+val):$(e.cell).html(val));$.fn.jexcel.defaults[t].data[c[1]][c[0]]=value;var i=$.fn.jexcel("getColumnName",e.col)+(parseInt(e.row)+1);value==Number(value)?$.fn.jexcel.defaults[t].values[i]=Number(value):$.fn.jexcel.defaults[t].values[i]=value,window[i]=new $.fn.jexcel.factory(i,$.fn.jexcel.defaults[t].values[i]),1!=$.fn.jexcel.ignoreEvents&&("="==value.substr(0,1)&&$(this).jexcel("executeFormula",e.col+"-"+e.row),Object.keys($.fn.jexcel.defaults[t].formula).length&&$(this).jexcel("formula",e.col+"-"+e.row))}},updateSelection:function(e,l,t){var n=$(this),c=$(this).prop("id"),s=$(this).find("tbody tr"),o=$(this).find("tbody td"),r=$(this).find(".jexcel_headers td"),a=$(this).find(".highlight").length>0,i=!1;if($(o).removeClass("highlight"),$(o).removeClass("highlight-left"),$(o).removeClass("highlight-right"),$(o).removeClass("highlight-top"),$(o).removeClass("highlight-bottom"),$(r).removeClass("selected"),$(s).removeClass("selected"),e&&l){if(or=$(e).prop("id").split("-"),de=$(l).prop("id").split("-"),parseInt(or[0])<parseInt(de[0]))var f=parseInt(or[0]),d=parseInt(de[0]);else f=parseInt(de[0]),d=parseInt(or[0]);if(parseInt(or[1])<parseInt(de[1]))var u=parseInt(or[1]),p=parseInt(de[1]);else u=parseInt(de[1]),p=parseInt(or[1]);for(var x=null,j=null,h=u,m=p,g=f;g<=d;g++){for(var v=u;v<=p;v++)$(this).find("#"+g+"-"+v).addClass("highlight"),$(this).find("#col-"+g).addClass("selected"),$(this).find("#row-"+v).addClass("selected");"hidden"!=$.fn.jexcel.defaults[c].columns[g].type&&(null==x&&(x=g),j=g)}for(g=x;g<=j;g++)$(this).find("#"+g+"-"+h).addClass("highlight-top"),$(this).find("#"+g+"-"+m).addClass("highlight-bottom");for(v=h;v<=m;v++)$(this).find("#"+x+"-"+v).addClass("highlight-left"),$(this).find("#"+j+"-"+v).addClass("highlight-right");i=!0}1!=$.fn.jexcel.ignoreEvents&&($.fn.jexcel.defaults[c].onblur&&"function"==typeof $.fn.jexcel.defaults[c].onblur&&1==a&&0==i&&$.fn.jexcel.defaults[c].onblur($(this)),$.fn.jexcel.defaults[c].onfocus&&"function"==typeof $.fn.jexcel.defaults[c].onfocus&&0==a&&1==i&&$.fn.jexcel.defaults[c].onfocus($(this)),1==i&&$.fn.jexcel.defaults[c].onselection&&"function"==typeof $.fn.jexcel.defaults[c].onselection&&$.fn.jexcel.defaults[c].onselection($(this),e,l,t)),$.fn.jexcel.selection=e&&l?[e,l]:null,setTimeout(function(){$(n).jexcel("updateCornerPosition")},0)},resetSelection:function(){$.fn.jexcel.current&&$("#"+$.fn.jexcel.current).jexcel("updateSelection"),$(".jexcel_corner").css("left","-200px"),$.fn.jexcel.selectedRow=null,$.fn.jexcel.selectedCell=null,$.fn.jexcel.selectedHeader=null},getSelection:function(){if($.fn.jexcel.current)return $.fn.jexcel.selection},getCellCursor:function(){if($.fn.jexcel.current)return $.fn.jexcel.selectedCell},getSelectedCells:function(){if($.fn.jexcel.current)return $("#"+$.fn.jexcel.current).find("tbody td.highlight")},updateCornerSelection:function(e){$(this);var l=$(this).find("tbody td");$(l).removeClass("selection"),$(l).removeClass("selection-left"),$(l).removeClass("selection-right"),$(l).removeClass("selection-top"),$(l).removeClass("selection-bottom");var t=$(this).find("tbody td.highlight"),n=$(t[0]).prop("id").split("-"),c=$(t[t.length-1]).prop("id").split("-"),s=$(e).prop("id").split("-");if(s[1]>c[1]||s[1]<n[1]){var o=parseInt(n[0]),r=parseInt(c[0]);if(parseInt(s[1])>parseInt(c[1]))var a=parseInt(c[1])+1,f=parseInt(s[1]);else a=parseInt(s[1]),f=parseInt(n[1])-1}else if(s[0]>c[0]||s[0]<n[0]){a=parseInt(n[1]),f=parseInt(c[1]);if(parseInt(s[0])>parseInt(c[0]))o=parseInt(c[0])+1,r=parseInt(s[0]);else o=parseInt(s[0]),r=parseInt(n[0])-1}for(j=a;j<=f;j++)for(i=o;i<=r;i++)$(this).find("#"+i+"-"+j).addClass("selection"),$(this).find("#"+i+"-"+a).addClass("selection-top"),$(this).find("#"+i+"-"+f).addClass("selection-bottom"),$(this).find("#"+o+"-"+j).addClass("selection-left"),$(this).find("#"+r+"-"+j).addClass("selection-right")},updateCornerPosition:function(){var e=$(this).find(".highlight");if($(e).length){var l=$(e).last(),t=parseInt($(l).offset().top)+$(l).parent().innerHeight()-2,n=parseInt($(l).offset().left)+$(l).innerWidth()-2;$(".jexcel_corner").css("top",t),$(".jexcel_corner").css("left",n);var c=$(this).offset().top;t<=c+$(this).height()&&t>=c||($(".jexcel_corner").css("top",-200),$(".jexcel_corner").css("left",-200));var s=$(this).offset().left;n<=s+$(this).width()-5&&n>=s||($(".jexcel_corner").css("top",-200),$(".jexcel_corner").css("left",-200))}},getData:function(e){var l=[],t=0,n=0,c=$(this).prop("id"),s=$.fn.jexcel.defaults[c].data[0].length,o=$.fn.jexcel.defaults[c].data.length;for(j=0;j<o;j++){for(t=0,i=0;i<s;i++)cell=$(this).find("#"+i+"-"+j),e&&!$(cell).hasClass("highlight")||(l[n]||(l[n]=[]),l[n][t]=$(this).jexcel("getValue",$(cell)),t++);t>0&&n++}return l},getRowData:function(e){var l=$(this),t=[];if(parseInt(e)){if(-1==e){var n=$(this).prop("id");e=$.fn.jexcel.defaults[n].data.length-1}}else e=0;var c=$(this).find(".jexcel-content .r"+e);return $.each(c,function(e,n){t.push($(l).jexcel("getValue",$(n)))}),t},getColumnData:function(e){var l=$(this),t=[];if(parseInt(e)){if(-1==e){var n=$(this).prop("id");e=$.fn.jexcel.defaults[n].columns.length-1}}else e=0;var c=$(this).find(".jexcel-content .c"+e);return $.each(c,function(e,n){t.push($(l).jexcel("getValue",$(n)))}),t},copy:function(e,l,t){var n=$(this).prop("id");l||(l="\t");var c="",s="",o="",r="",a=[],f=!1,d=!1,u=$.fn.jexcel.defaults[n].data[0].length,p=$.fn.jexcel.defaults[n].data.length;for(j=0;j<p;j++){for(s="",f=!1,i=0;i<u;i++)cell=$(this).find("#"+i+"-"+j),e&&!$(cell).hasClass("highlight")||(f&&(s+=l),(o=$(this).jexcel("getValue",$(cell))).match&&(o.match(/,/g)||o.match(/\n/)||o.match(/\"/))&&(o='"'+(o=o.replace(new RegExp('"',"g"),'""'))+'"'),s+=o,f=!0,r=$(cell).attr("style"),a.push(r||""));s&&(d&&(c+="\n"),c+=s,d=!0)}return t||(txt=$(".jexcel_textarea"),$(txt).val(c),$(txt).select(),document.execCommand("copy")),$.fn.jexcel.hash=$(this).jexcel("hash",c),$.fn.jexcel.style=a,c},cut:function(){var e=$(this).find(".highlight");if($(e).length>0){var l=[];$.each(e,function(e,t){var n=$(t).prop("id").split("-");l.push({col:n[0],row:n[1],cell:$(t),newValue:"",oldValue:$.fn.jexcel.defaults[$.fn.jexcel.current].data[n[1]][n[0]]})}),$(this).jexcel("copy",!0),$(this).jexcel("updateCells",l)}},paste:function(e,l){var t=$(this).prop("id");"function"==typeof $.fn.jexcel.defaults[t].onbeforepaste&&(l=$.fn.jexcel.defaults[t].onbeforepaste(l));var n=$(this).jexcel("hash",l)==$.fn.jexcel.hash?$.fn.jexcel.style:null;l=$(this).jexcel("parseCSV",l,"\t");var c=$(e).prop("id");if(c){c=c.split("-");var s=parseInt(c[0]),o=parseInt(c[1]);o+l.length>$.fn.jexcel.defaults[t].data.length&&$(this).jexcel("insertRow",o+l.length-$.fn.jexcel.defaults[t].data.length),l[0]&&(row=l[0],s+row.length>$.fn.jexcel.defaults[t].data[o].length&&$(this).jexcel("insertColumn",s+row.length-$.fn.jexcel.defaults[t].data[o].length));var r=[],a=0;for(j=0;j<l.length;j++)for(row=l[j],i=0;i<row.length;i++)e=$(this).find("#"+(parseInt(i)+parseInt(s))+"-"+(parseInt(j)+parseInt(o))),$(e).length>0&&r.push({col:parseInt(i)+parseInt(s),row:parseInt(j)+parseInt(o),cell:$(e),newValue:row[i],oldValue:$.fn.jexcel.defaults[t].data[parseInt(j)+parseInt(o)][parseInt(i)+parseInt(s)]}),n&&$(e).attr("style",n[a]),a++;$(this).jexcel("updateSelection",r[0].cell,r[r.length-1].cell),r.length>0&&($(this).jexcel("updateCells",r),"function"==typeof $.fn.jexcel.defaults[t].onpaste&&(l=$.fn.jexcel.defaults[t].onpaste(r)))}},parseCSV:function(e,l){e=e.replace(/\r?\n$|\r$|\n$/g,""),l=l||",";for(var t=new RegExp("(\\"+l+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+l+"\\r\\n]*))","gi"),n=[[]],c=!1;c=t.exec(e);){var s,o=c[1];o.length&&o!==l&&n.push([]),s=c[2]?c[2].replace(new RegExp('""',"g"),'"'):c[3],n[n.length-1].push(s)}return n},insertColumn:function(e,l,t){var n=$(this).prop("id"),c=$.fn.jexcel.defaults[n];if(1==c.allowInsertColumn){var s=[],o=[];e>0?numOfColumns=e:(numOfColumns=1,e&&(o=e));var r=c.colHeaders.length,a=0;if(null==t||t>=parseInt(r)){t=parseInt(r);a=1}l||(l=[]),l.columns||(l.columns=[]),l.colWidths||(l.colWidths=[]),l.colHeaders||(l.colHeaders=[]),l.colAlignments||(l.colAlignments=[]),l.colHeaderClasses||(l.colHeaderClasses=[]);for(var i=0;i<numOfColumns;i++)l.columns[i]||(l.columns[i]={type:"text"}),l.colWidths[i]||(l.colWidths[i]=50),l.colHeaders[i]||(l.colHeaders[i]=""),l.colAlignments[i]||(l.colAlignments[i]="center"),l.colHeaderClasses[i]||(l.colHeaderClasses[i]="");var f=c.columns.splice(t),d=c.colWidths.splice(t),u=c.colHeaders.splice(t),p=c.colAlignments.splice(t),x=c.colHeaderClasses.splice(t);i=0;for(var j=t;j<numOfColumns+t;j++)c.columns[j]=l.columns[i],c.colWidths[j]=l.colWidths[i],c.colHeaders[j]=l.colHeaders[i],c.colAlignments[j]=l.colAlignments[i],c.colHeaderClasses[j]=l.colHeaderClasses[i],c.columns[j].source||($.fn.jexcel.defaults[n].columns[j].source=[]),c.columns[j].options||($.fn.jexcel.defaults[n].columns[j].options=[]),i++;if(Array.prototype.push.apply(c.columns,f),Array.prototype.push.apply(c.colWidths,d),Array.prototype.push.apply(c.colHeaders,u),Array.prototype.push.apply(c.colAlignments,p),Array.prototype.push.apply(c.colHeaderClasses,x),1==a){var h=$(this).find(".jexcel-header #col-"+(t-1)),m=$(this).find(".jexcel-header > table > colgroup > col").eq(t),g=$(this).find(".jexcel-content > table > colgroup > col").eq(t);for(j=numOfColumns+t-1;j>=t;j--){$(m).after('<col width="'+c.colWidths[j]+'">'),$(g).after('<col width="'+c.colWidths[j]+'">');var v=(I=c.colHeaders[j])||$.fn.jexcel("getColumnName",j),C="hidden"==c.columns[j].type?' style="display:none"':"";td='<td align="'+c.colAlignments[j]+'" title="'+I+'" class="'+c.colHeaderClasses[j]+'"'+C+">"+v+"</td>",$(h).after(td)}for(var y=0;y<c.data.length;y++){var w=$.fn.jexcel.defaults[n].data[y].splice(t),b=$(this).find("tbody").find("#row-"+y).find(".c"+(t-1));for(j=numOfColumns+t-1;j>=t;j--)td=$(this).jexcel("createCell",j,y),$(b).after(td),$.fn.jexcel.defaults[n].data[y][j]=o[y]?o[y]:"",s.push({col:j,row:y,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[y][j],oldValue:""});Array.prototype.push.apply($.fn.jexcel.defaults[n].data[y],w)}}else{for(h=$(this).find(".jexcel-header #col-"+t),m=$(this).find(".jexcel-header > table > colgroup > col").eq(t+1),g=$(this).find(".jexcel-content > table > colgroup > col").eq(t+1),j=t;j<numOfColumns+t;j++){$(m).before('<col width="'+c.colWidths[j]+'">'),$(g).before('<col width="'+c.colWidths[j]+'">');var I;v=(I=c.colHeaders[j])||$.fn.jexcel("getColumnName",j),C="hidden"==c.columns[j].type?' style="display:none"':"";td='<td align="'+c.colAlignments[j]+'" title="'+I+'" class="'+c.colHeaderClasses[j]+'"'+C+">"+v+"</td>",$(h).before(td)}for(y=0;y<c.data.length;y++){for(w=$.fn.jexcel.defaults[n].data[y].splice(t),b=$(this).find("tbody").find("#row-"+y).find(".c"+t),j=t;j<numOfColumns+t;j++)td=$(this).jexcel("createCell",j,y),$(b).before(td),$.fn.jexcel.defaults[n].data[y][j]=o[y]?o[y]:"",s.push({col:j,row:y,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[y][j],oldValue:""});Array.prototype.push.apply($.fn.jexcel.defaults[n].data[y],w)}}$(this).jexcel("updateTableReferences",t,0),$(this).jexcel("updateSelection",s[0].cell,s[s.length-1].cell),$(this).jexcel("loadCells",s,!0),$(this).jexcel("setHistory",s,{type:"insertColumn",mixed:e,properties:l,columnNumber:t}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.oninsertcolumn&&c.oninsertcolumn($(this))}},insertRow:function(e,l){var t=$(this),n=$(this).prop("id"),c=$.fn.jexcel.defaults[n];if(1==c.allowInsertRow){var s=[],o=[];if(e>0)var r=e;else{r=1;e&&(o=e)}var a=c.data.length,i=0;if(null==l||l>=parseInt(a)){l=parseInt(a);i=1}var f=$.fn.jexcel.defaults[n].data.splice(l);if(1==i)var d=$(this).find("tbody").find("#row-"+(l-1));else d=$(this).find("tbody").find("#row-"+l);var u=function(){var e=document.createElement("tr");$(e).append('<td class="jexcel_label"></td>'),$.fn.jexcel.defaults[n].data[p]=[];for(var l=0;l<$.fn.jexcel.defaults[n].colHeaders.length;l++)$.fn.jexcel.defaults[n].data[p][l]=o[l]?o[l]:"",td=$(t).jexcel("createCell",l,p),$(e).append(td),s.push({col:l,row:p,cell:$(td),newValue:$.fn.jexcel.defaults[n].data[p][l],oldValue:""});return e};if(1==i)for(var p=r+l-1;p>=l;p--)$(d).after(u());else for(p=l;p<r+l;p++)$(d).before(u());Array.prototype.push.apply($.fn.jexcel.defaults[n].data,f),$(this).jexcel("updateTableReferences"),$(this).jexcel("updateSelection",s[0].cell,s[s.length-1].cell),$(this).jexcel("loadCells",s,!0),$(this).jexcel("setHistory",s,{type:"insertRow",mixed:e,rowNumber:l}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof c.oninsertrow&&c.oninsertrow($(this))}},deleteColumn:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];if(1==n.allowDeleteColumn){var c=[];if(null==e){var s=$(this).jexcel("getSelectedColumns");s[0]?(e=parseInt(s[0]),l=parseInt(s.length)):(e=$.fn.jexcel.defaults[t].data[0].length-1,l=1)}if(-1==e&&(e=$.fn.jexcel.defaults[t].data[0].length-1),l!=parseInt(l)&&(l=1),l>n.data[0].length-e&&(l=n.data[0].length-e),n.data[0].length>1){if(parseInt(e)>-1){for(var o=n.columns.splice(e,l),r=n.colHeaders.splice(e,l),a=n.colWidths.splice(e,l),i=n.colAlignments.splice(e,l),f=n.colHeaderClasses.splice(e,l),d=0;d<$.fn.jexcel.defaults[t].data.length;d++){data=n.data[d].splice(e,l);for(var u=0;u<l;u++)c[u]||(c[u]=[]),c[u].push(data[u])}var p=!1;for(u=e;u<e+l;u++){var x=$(this).find("thead #col-"+u);$(x).hasClass("selected")&&(p=!0),$(x).remove(),$(this).find("tbody .c"+u).remove()}if($(this).jexcel("updateTableReferences",e,0),p){var j=$(this).find("#0-0"),h=$(this).find("#0-0");$(this).jexcel("updateSelection",j,h)}}$(this).jexcel("setHistory",null,{type:"deleteColumn",columnNumber:e,numOfColumns:l,columnData:c,columnProperties:{columns:o,colHeaders:r,colWidths:a,colAlignments:i,colHeaderClasses:f}}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof n.ondeletecolumn&&n.ondeletecolumn($(this),e,l,c)}else console.error("It is not possible to delete the last column")}},deleteRow:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];if(1==n.allowDeleteRow){var c=[];if(null==e){var s=$(this).jexcel("getSelectedRows");s[0]?(e=parseInt(s[0]),l=parseInt(s.length)):(e=$.fn.jexcel.defaults[t].data.length-1,l=1),e=parseInt(s[0]),l=parseInt(s.length)}if(-1==e&&(e=$.fn.jexcel.defaults[t].data.length-1),l!=parseInt(l)&&(l=1),l>n.data.length-e&&(l=n.data.length-l),n.data.length>1){if(parseInt(e)>-1){for(var o=!1,r=e;r<e+l;r++){c[r]=$.fn.jexcel.defaults[t].data[r];var a=$(this).find("#row-"+r);$(a).hasClass("selected")&&(o=!0),$(a).remove()}if($.fn.jexcel.defaults[t].data.splice(parseInt(e),l),$(this).jexcel("updateTableReferences",0,e),o){var i=$(this).find("#0-0"),f=$(this).find("#0-0");$(this).jexcel("updateSelection",i,f)}$(this).jexcel("setHistory",null,{type:"deleteRow",rowNumber:e,numOfRows:l,rowData:c}),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof n.ondeleterow&&n.ondeleterow($(this),e,l,c)}}else console.error("It is not possible to delete the last row")}},setWidth:function(e,l){var t=$(this).prop("id");if(l>0){"object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]);var n=$(this).find(".jexcel-header col");$(n[parseInt(e)+1]).prop("width",l);n=$(this).find(".jexcel-content col");var c=$(n[parseInt(e)+1]).prop("width");$(n[parseInt(e)+1]).prop("width",l),$.fn.jexcel.defaults[t].colWidths[e]=l,$(this).jexcel("setHistory",null,{type:"setWidth",column:e,fr:c,to:l})}},getWidth:function(e){var l=[];if(e){"object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]);var t=$(this).find(".jexcel-header #col-"+e);t.length&&(l=$(t).prop("width"))}else{e=$(this).find(".jexcel-header .jexcel_headers td");$.each(e,function(e,t){e>0&&l.push($(t).prop("width"))})}return l},getHeader:function(e){var l=$(this).find(".jexcel_headers #col-"+e);if(l.length)return $(l).html()},getHeaders:function(e){var l=$(this).find(".jexcel_headers > td"),t=[];return $.each(l,function(e,l){e>0&&t.push($(l).text())}),1==e&&(t=t.join(",")),t},setHeader:function(e,l){var t=$(this).find("thead #col-"+e);if(t.length){l||(l=prompt("Column name",$(t).text()));var n=$(t).html();n=n.replace($(t).text(),l),$(t).html(n)}},setSource:function(e,l){"object"==typeof e&&(e=(e=$(e).prop("id").split("-"))[0]);var t=$(this).prop("id");$.fn.jexcel.defaults[t].columns[e].source=l},afterChange:function(e){var l=$(this).prop("id");e||$(this).jexcel("spareCheck"),$(this).jexcel("updateCornerPosition"),$(this).jexcel("updateSettings"),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[l].onafterchange&&$.fn.jexcel.defaults[l].onafterchange($(this))},copyData:function(e,l){var t=$(this).jexcel("getData",!0),n=parseInt(e[0]),c=parseInt(l[0]),s=parseInt(e[1]),o=parseInt(l[1]),r=[],a=0,f=0;for(j=s;j<=o;j++){for(null==t[f]&&(f=0),a=0,i=n;i<=c;i++)null==t[f]?a=0:null==t[f][a]&&(a=0),cell=$(this).find("#"+i+"-"+j),$(cell).length&&!$(cell).hasClass("readonly")&&r.push({col:i,row:j,cell:$(cell),newValue:t[f][a],oldValue:$.fn.jexcel.defaults[$.fn.jexcel.current].data[j][i]}),a++;f++}r.length>0&&$(this).jexcel("updateCells",r)},orderBy:function(e,l){if(e>=0){var t=$(this).find("#col-"+e).parent();if("0"!=l&&"1"!=l){var n=$(t).find(".arrow-down");l=$(n).length>0?1:0}$(t).find(".arrow-down").remove(),$(t).find(".arrow-up").remove(),$(t).find("td").css("text-decoration","none"),1==l?$(t).find("#col-"+e).append('<span class="arrow-up"></span>').css("text-decoration","underline"):$(t).find("#col-"+e).append('<span class="arrow-down"></span>').css("text-decoration","underline"),$(".jexcel_corner").css("top","-200px"),$(".jexcel_corner").css("left","-200px");var c=$(this).prop("id"),s=$.fn.jexcel.defaults[c];return Array.prototype.sortBy=function(e,l){return this.slice(0).sort(function(t,n){if(Number(t[e])==t[e]&&Number(n[e])==n[e])var c=Number(t[e]),s=Number(n[e]);else c=t[e].toLowerCase(),s=n[e].toLowerCase();return l?c>s?-1:c<s?1:0:c>s?1:c<s?-1:0})},s.data=s.data.sortBy(e,l),$(this).jexcel("setData",null,!0),1!=$.fn.jexcel.ignoreEvents&&"function"==typeof $.fn.jexcel.defaults[c].onsort&&$.fn.jexcel.defaults[c].onsort($(this),e,l),!0}},updateFormulas:function(e,l){if("object"==typeof excelFormulaUtilities){var t=$(this).prop("id"),n=excelFormulaUtilities.formula2JavaScript(l).match(/([A-Z]+[0-9]+)*/g);$.each(n,function(l,n){n&&(elementId=$.fn.jexcel("getIdFromColumnName",n),$.fn.jexcel.defaults[t].formula[elementId]||($.fn.jexcel.defaults[t].formula[elementId]=[]),elementId==e?console.error("Self reference error: "+n):$.fn.jexcel.defaults[t].formula[elementId].push(e))})}},formula:function(e){if("object"==typeof excelFormulaUtilities){var l=$(this).prop("id"),t=$(this);$.fn.jexcel.defaults[l].formula[e]&&$.each($.fn.jexcel.defaults[l].formula[e],function(n,c){var s=c.split("-");"="!=$.fn.jexcel.defaults[l].data[s[1]][s[0]].substr(0,1)?($(t).find("#"+c).removeClass("error"),$.fn.jexcel.defaults[l].formula[e].splice(n,1)):$(t).jexcel("executeFormula",c),$(t).jexcel("formula",c)})}else console.error("excelFormulaUtilities lib not included")},executeFormula:function(cellId){var id=$(this).prop("id"),cell=$(this).find("#"+cellId),cellId=cellId.split("-"),formula=$.fn.jexcel.defaults[id].data[cellId[1]][cellId[0]];try{var value=eval(excelFormulaUtilities.formula2JavaScript(formula))}catch(e){var value=null}if(null===value||null==value||""+value=="NaN")value='<input type="hidden" value="'+formula+'">#ERROR',$(cell).addClass("error"),$(cell).html(value);else{var letter=$.fn.jexcel("getColumnName",cellId[0])+(parseInt(cellId[1])+1);value==Number(value)?$.fn.jexcel.defaults[id].values[letter]=Number(value):$.fn.jexcel.defaults[id].values[letter]=value,window[letter]=new $.fn.jexcel.factory(letter,$.fn.jexcel.defaults[id].values[letter]),value='<input type="hidden" value="'+formula+'">'+value,$(cell).removeClass("error"),$(cell).html(value)}},updateAllCellsWithFormulas:function(){if("object"==typeof excelFormulaUtilities){var e=$(this).prop("id"),l=Object.keys($.fn.jexcel.defaults[e].formula);if(l.length>0)for(var t=0;t<l.length;t++)$(this).jexcel("formula",l[t])}},helper:function(e){var l=[];if("object"==typeof e&&"createEmptyData"==e.action){var t=e.cols||10,n=e.rows||100;for(j=0;j<n;j++)for(l[j]=[],i=0;i<t;i++)l[j][i]=""}return l},download:function(){var e=$(this).prop("id"),l=$.fn.jexcel.defaults[e],t="";1==l.csvHeaders&&(t=l.colHeaders.join()+"\n"),t+=$(this).jexcel("copy",!1,",",!0);var n=document.createElement("a"),c=new Blob([t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(c);n.href=s,n.setAttribute("download",l.csvFileName+".csv"),n.click()},setHistory:function(e,l){if(1!=$.fn.jexcel.ignoreHistory){$(this);var t=$(this).prop("id"),n=++$.fn.jexcel.defaults[t].historyIndex,c=$.fn.jexcel.defaults[t].history=$.fn.jexcel.defaults[t].history.slice(0,n+1);c[n]=l?{action:l}:{firstSelected:e[0].cell,lastSelected:e[e.length-1].cell,cellChanges:e}}},undo:function(){var e=$(this).prop("id"),l=!!$.fn.jexcel.ignoreEvents,t=!!$.fn.jexcel.ignoreHistory;$.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0;var n=[];if($.fn.jexcel.defaults[e].historyIndex>=0){var c=$.fn.jexcel.defaults[e].history[$.fn.jexcel.defaults[e].historyIndex--];if(c.action)if("insertRow"==c.action.type){var s=c.action.rowNumber,o=c.action.mixed>0?c.action.mixed:1;$(this).jexcel("deleteRow",s,o)}else if("deleteRow"==c.action.type){s=c.action.rowNumber,o=c.action.numOfRows;for(var r=s;r<s+o;r++)$(this).jexcel("insertRow",c.action.rowData[r],r)}else if("insertColumn"==c.action.type){var a=c.action.columnNumber,i=c.action.mixed>0?c.action.mixed:1;$(this).jexcel("deleteColumn",a,i)}else if("deleteColumn"==c.action.type){a=c.action.columnNumber,i=c.action.numOfColumns;for(var f=c.action.columnProperties,d=0,u=a;u<a+i;u++)$(this).jexcel("insertColumn",c.action.columnData[d],{columns:[f.columns[d]],colHeaders:[f.colHeaders[d]],colWidths:[f.colWidths[d]],colAlignments:[f.colAlignments[d]],colHeaderClasses:[f.colHeaderClasses[d]]},u),d++}else"moveRow"==c.action.type?$(this).jexcel("moveRow",c.action.to,c.action.fr):"setStyle"==c.action.type?$(this).jexcel("setStyle",c.action.fr):"setWidth"==c.action.type&&$(this).jexcel("setWidth",c.action.column,c.action.fr);else{for(var p=0;p<c.cellChanges.length;p++)n.push({col:c.cellChanges[p].col,row:c.cellChanges[p].row,cell:c.cellChanges[p].cell,newValue:c.cellChanges[p].oldValue,oldValue:c.cellChanges[p].newValue});$.fn.jexcel.selectedCell=c.firstSelected,$(this).jexcel("updateSelection",c.firstSelected,c.lastSelected),$(this).jexcel("loadCells",n)}}$.fn.jexcel.ignoreEvents=l,$.fn.jexcel.ignoreHistory=t,$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},redo:function(){var e=$(this).prop("id"),l=!!$.fn.jexcel.ignoreEvents,t=!!$.fn.jexcel.ignoreHistory;if($.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$.fn.jexcel.defaults[e].historyIndex<$.fn.jexcel.defaults[e].history.length-1){var n=$.fn.jexcel.defaults[e].history[++$.fn.jexcel.defaults[e].historyIndex];n.action?"insertRow"==n.action.type?$(this).jexcel("insertRow",n.action.mixed,n.action.rowNumber):"deleteRow"==n.action.type?$(this).jexcel("deleteRow",n.action.rowNumber,n.action.numOfRows):"insertColumn"==n.action.type?$(this).jexcel("insertColumn",n.action.mixed,n.action.properties,n.action.columnNumber):"deleteColumn"==n.action.type?$(this).jexcel("deleteColumn",n.action.columnNumber,n.action.numOfColumns):"moveRow"==n.action.type?$(this).jexcel("moveRow",n.action.fr,n.action.to):"setStyle"==n.action.type?$(this).jexcel("setStyle",n.action.to):"setWidth"==n.action.type&&$(this).jexcel("setWidth",n.action.column,n.action.to):($.fn.jexcel.selectedCell=n.firstSelected,$(this).jexcel("updateSelection",n.firstSelected,n.lastSelected),$(this).jexcel("loadCells",n.cellChanges))}$.fn.jexcel.ignoreEvents=l,$.fn.jexcel.ignoreHistory=t,$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},createCell:function(e,l){var t=$(this).prop("id"),n=$.fn.jexcel.defaults[t];return align=n.colAlignments[e],width=n.colWidths[e],td=document.createElement("td"),$(td).prop("width",width),$(td).prop("align",align),$(td).prop("id",e+"-"+l),$(td).addClass("c"+e),$(td).addClass("r"+l),"hidden"==n.columns[e].type?$(td).css("display","none"):"checkbox"==n.columns[e].type?1==n.columns[e].readOnly?$(td).html('<input type="checkbox" disabled="disabled">'):$(td).html('<input type="checkbox">'):"radio"==n.columns[e].type&&(1==n.columns[e].readOnly?$(td).html('<input type="radio" name="c'+e+'" disabled="disabled">'):$(td).html('<input type="radio" name="c'+e+'">')),1==n.columns[e].readOnly&&$(td).addClass("readonly","readonly"),1!=n.wordWrap&&1!=n.columns[e].wordWrap||$(td).css("white-space","pre-wrap"),n.columns[e].cssClass&&$(td).addClass(n.columns[e].cssClass),$(td)},spareCheck:function(){var e=$(this).prop("id"),l=!1,t=!!$.fn.jexcel.ignoreEvents,n=!!$.fn.jexcel.ignoreHistory;if($.fn.jexcel.ignoreEvents=!0,$.fn.jexcel.ignoreHistory=!0,$.fn.jexcel.defaults[e].minSpareCols>0){lastCol=$.fn.jexcel.defaults[e].data[0]?$.fn.jexcel.defaults[e].data[0].length:0,lastRow=$.fn.jexcel.defaults[e].data.length,checkPoint=lastCol-$.fn.jexcel.defaults[e].minSpareCols,checkPoint<0&&(checkPoint=0),l=!1;for(var c=0;c<lastRow;c++)for(var s=checkPoint;s<lastCol;s++)$.fn.jexcel.defaults[e].data[c][s]&&(l=!0);l&&$(this).jexcel("insertColumn",$.fn.jexcel.defaults[e].minSpareCols)}if($.fn.jexcel.defaults[e].minSpareRows>0){lastCol=$.fn.jexcel.defaults[e].data[0]?$.fn.jexcel.defaults[e].data[0].length:0,lastRow=$.fn.jexcel.defaults[e].data.length,checkPoint=lastRow-$.fn.jexcel.defaults[e].minSpareRows,checkPoint<0&&(checkPoint=0),l=!1;for(c=checkPoint;c<lastRow;c++)for(s=0;s<lastCol;s++)$.fn.jexcel.defaults[e].data[c][s]&&(l=!0);l&&$(this).jexcel("insertRow",$.fn.jexcel.defaults[e].minSpareCols)}$.fn.jexcel.ignoreEvents=t,$.fn.jexcel.ignoreHistory=n},getSelectedRows:function(){var e=[],l=$(this).find("tbody > tr.selected");return $.each(l,function(l,t){e.push($(t).prop("id").replace("row-",""))}),e},getSelectedColumns:function(){var e=[],l=$(this).find(".jexcel_headers > td.selected");return $.each(l,function(l,t){e.push($(t).prop("id").replace("col-",""))}),e},getHeaderNumber:function(e){var l=!1;if(e){var t=$(this).find(".jexcel_headers > td."+e);$(t).length&&(l=parseInt($(t).prop("id").replace("col-","")))}return l},updateTableReferences:function(e,l){var t=$(this),n=$(this).prop("id");if(e||(e=0),l||(l=0),e>-1){var c=$(this).find(".jexcel_headers td");$.each(c,function(l,t){if(l>0&&l>=e&&($(t).prop("id","col-"+(l-1)),!$(t).prop("title"))){var n=$.fn.jexcel("getColumnName",l-1);$(t).html(n)}})}var s=$(this).find(".jexcel-content tbody > tr");$.each(s,function(t,c){if(t>=l){$(c).prop("id","row-"+t);var s=$(c).find("td");$.each(s,function(l,c){if(0==l)$(c).html(parseInt(t)+1);else if(l>=e){var s=$(c).prop("id").split("-");$(c).prop("id",l-1+"-"+t),$(c).removeClass("r"+s[1]),$(c).addClass("r"+t),$(c).removeClass("c"+s[0]),$(c).addClass("c"+(l-1));var o=""+$.fn.jexcel.defaults[n].data[t][l-1];"="==o.substr(0,1)&&(s[0]!=l-1&&(o=$.fn.jexcel("shiftFormulaByColumn",o,l-1-s[0]),$.fn.jexcel.defaults[n].data[t][l-1]=o,$(c).find("input").val(o)),s[1]!=t&&(o=$.fn.jexcel("shiftFormulaByRow",o,t-s[1]),$.fn.jexcel.defaults[n].data[t][l-1]=o,$(c).find("input").val(o)));var r=$.fn.jexcel("getColumnNameFromId",[l-1,t]);o==Number(o)?$.fn.jexcel.defaults[n].values[r]=Number(o):$.fn.jexcel.defaults[n].values[r]=o,window[r]=new $.fn.jexcel.factory(r,$.fn.jexcel.defaults[n].values[r])}})}}),$.fn.jexcel.defaults[n].formula=[];for(var o=0;o<$.fn.jexcel.defaults[n].data.length;o++)for(var r=0;r<$.fn.jexcel.defaults[n].data[o].length;r++){var a=""+$.fn.jexcel.defaults[n].data[o][r];"="==a.substr(0,1)&&$(t).jexcel("updateFormulas",r+"-"+o,a)}$(this).jexcel("updateAllCellsWithFormulas"),$(this).jexcel("afterChange")},moveRow:function(e,l){var t=$(this).prop("id");$.fn.jexcel.defaults[t].data.splice(l,0,$.fn.jexcel.defaults[t].data.splice(e,1)[0]);var n=$(this).find("#row-"+e).clone();$(this).find("#row-"+e).remove(),e>l?$(this).find("#row-"+l).before(n):$(this).find("#row-"+l).after(n),$(this).jexcel("updateTableReferences",0,0),"function"==typeof $.fn.jexcel.defaults[t].onmoverow&&$.fn.jexcel.defaults[t].onmoverow($(this),e,l),$(this).jexcel("setHistory",null,{type:"moveRow",fr:e,to:l})},moveColumn:function(){},getColumnName:function(e){var l="";return e>701?(l+=String.fromCharCode(64+parseInt(e/676)),l+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(l+=String.fromCharCode(64+parseInt(e/26))),l+=String.fromCharCode(65+e%26)},getIdFromColumnName:function(e,l){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,c=0;c<t[0].length;c++)n+=parseInt(t[0].charCodeAt(c)-64)*Math.pow(26,t[0].length-1-c);--n<0&&(n=0);var s=parseInt(/[0-9]+$/.exec(e));s>0&&s--,e=1==l?[n,s]:n+"-"+s}return e},getColumnNameFromId:function(e){return Array.isArray(e)||(e=e.split("-")),$.fn.jexcel("getColumnName",e[0])+(parseInt(e[1])+1)},shiftFormulaByColumn:function(e,l){l||(l=1);for(var t=excelFormulaUtilities.formula2JavaScript(e).match(/([A-Z]+[0-9]+)*/g).filter(function(e){return""!=e}).sort(function(e,t){return e=$.fn.jexcel("getIdFromColumnName",e,!0),t=$.fn.jexcel("getIdFromColumnName",t,!0),l>0?t[0]-e[0]:e[0]-t[0]}),n=0;n<t.length;n++)if(t[n]){var c=$.fn.jexcel("getIdFromColumnName",t[n],!0),s=c[0]+l;s<0&&(s=0);var o=$.fn.jexcel("getColumnName",s);e=e.replace(new RegExp(t[n],"g"),o+(c[1]+1))}return e},shiftFormulaByRow:function(e,l){l||(l=1);for(var t=excelFormulaUtilities.formula2JavaScript(e).match(/([A-Z]+[0-9]+)*/g).filter(function(e){return""!=e}).sort(function(e,t){return e=$.fn.jexcel("getIdFromColumnName",e,!0),t=$.fn.jexcel("getIdFromColumnName",t,!0),l>0?t[1]-e[1]:e[1]-t[1]}),n=0;n<t.length;n++)if(t[n]){var c=$.fn.jexcel("getIdFromColumnName",t[n],!0),s=""+$.fn.jexcel("getColumnName",c[0]),o=c[1]+1+l;o<1&&(o=1),e=e.replace(new RegExp(t[n],"g"),s+o)}return e},row:function(e){e||(e=$.fn.jexcel.selectedCell);var l=!1;return $(e).length&&(l=(l=$(e).prop("id").split("-"))[1]),l},col:function(e){e||(e=$.fn.jexcel.selectedCell);var l=!1;return $(e).length&&(l=(l=$(e).prop("id").split("-"))[0]),l},getEventsFlag:function(e){return!!$.fn.jexcel.ignoreEvents},setEventsFlag:function(e){$.fn.jexcel.ignoreEvents=!!e},getHistoryFlag:function(e){return!!$.fn.jexcel.ignoreHistory},setHistoryFlag:function(e){$.fn.jexcel.ignoreHistory=!!e},showFilter:function(){$(this).find(".jexcel-filter").css("display","")},hideFilter:function(){$(this).find(".jexcel-filter").css("display","none")},getComments:function(e){if("string"==typeof e)e=$(this).jexcel("getCell",e);return $(e).prop("title")},setComments:function(e,l){if("string"==typeof e)e=$(this).jexcel("getCell",e);$(e).prop("title",l),l?$(e).addClass("jexcel_comments"):$(e).removeClass("jexcel_comments")},getConfig:function(e,l){var t=$(this).prop("id");return $.fn.jexcel.defaults[t][e]},setConfig:function(e,l){var t=$(this).prop("id");$.fn.jexcel.defaults[t][e]=l},getRowCount:function(){var e=$(this).prop("id");return $.fn.jexcel.defaults[e].data.length},getMeta:function(e,l){if(e)return e=$(this).jexcel("getCell",e),l?$(e).data(l):$(e).data();var t={},n=$(this).prop("id"),c=$.fn.jexcel.defaults[n].data[0].length,s=$.fn.jexcel.defaults[n].data.length;for(j=0;j<s;j++)for(i=0;i<c;i++){e=$(this).find(".jexcel-content #"+i+"-"+j);var o=l?$(e).data(l):$(e).data();if(Object.keys(o).length)t[$.fn.jexcel("getColumnName",i)+(parseInt(j)+1)]=o}return t},setMeta:function(e,l,t){var n=$(this);if(l&&t){var c=$(this).jexcel("getCell",e);$(c).data(l,t)}else $.each(e,function(e,l){var t=Object.keys(l)[0];(t=$(n).jexcel("getCell",t))&&$(t).data(l[Object.keys(l)[0]])})},getStyle:function(e,l){if(e)return e=$(this).jexcel("getCell",e),l?$(e).css(l):$(e).attr("style");var t={},n=$(this).prop("id"),c=$.fn.jexcel.defaults[n].data[0].length,s=$.fn.jexcel.defaults[n].data.length;for(j=0;j<s;j++)for(i=0;i<c;i++){e=$(this).find("#"+i+"-"+j);var o=l?$(e).css(l):$(e).attr("style");if(o)t[$.fn.jexcel("getColumnName",i)+(parseInt(j)+1)]=o}return t},setStyle:function(e,l,t){var n=$(this),c=[],s=[];if(l&&t){if("string"==typeof e)e=$(this).jexcel("getCell",e);$.each(e,function(e,n){var o=$(n).prop("id"),r=[],a=$(n).attr("style");r[o]=""+(a||""),c.push(r),$(n).css(l)==t?$(n).css(l,""):$(n).css(l,t);r=[],a=$(n).attr("style");r[o]=""+(a||""),s.push(r)})}else $.each(e,function(e,l){var t=$(n).jexcel("getCell",Object.keys(l)[0]);if(t){var o=$(t).prop("id"),r=[],a=$(t).attr("style");r[o]=""+(a||""),c.push(r),$(t).attr("style",l[Object.keys(l)[0]]);r=[],a=$(t).attr("style");r[o]=""+(a||""),s.push(r)}});$(this).jexcel("setHistory",null,{type:"setStyle",fr:c,to:s})},contextMenu:function(e,l){var t="";return"col"==e?(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertColumn&&(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('insertColumn', 1, null, "+l+')">Insert a new column<span></span></a>'),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteColumn&&(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('deleteColumn')\">Delete this column<span></span></a>"),t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setHeader', "+l+')">Rename this column</a>',t+="<hr>",1==$.fn.jexcel.defaults[$.fn.jexcel.current].columnSorting&&(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('orderBy', "+l+', 0)">Order ascending <span></span></a>',t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('orderBy', "+l+', 1)">Order descending <span></span></a>'),t+="<hr><a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('copy', true)\">Copy...<span>Ctrl + C</span></a>",t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('download')\">Save as...<span>Ctrl + S</span></a>",$.fn.jexcel.defaults[$.fn.jexcel.current].about&&(t+="<a onclick=\"alert('"+$.fn.jexcel.defaults[$.fn.jexcel.current].about+"')\">About<span></span></a>")):(1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowInsertRow&&(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('insertRow', 1, "+l+')">Insert a new row<span></span></a>'),1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowDeleteRow&&(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('deleteRow')\">Delete this row<span></span></a>"),t+="<hr>",1==$.fn.jexcel.defaults[$.fn.jexcel.current].allowComments&&($($.fn.jexcel.selectedCell).prop("title")?(t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, prompt('Comments', $($.fn.jexcel.selectedCell).prop('title')));\">Edit comments<span></span></a>",t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, '');\">Reset comments<span></span></a><hr>"):t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('setComments', $.fn.jexcel.selectedCell, prompt('Comments', ''));\">Add comments<span></span></a><hr>"),t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('copy', true)\">Copy...<span>Ctrl + C</span></a>",t+="<a onclick=\"jQuery('#"+$.fn.jexcel.current+"').jexcel('download')\">Save as...<span>Ctrl + S</span></a>",$.fn.jexcel.defaults[$.fn.jexcel.current].about&&(t+="<a onclick=\"alert('"+$.fn.jexcel.defaults[$.fn.jexcel.current].about+"')\">About<span></span></a>")),t},hash:function(e){for(var l="",t=0;t<e.length;t++)e.charCodeAt(t)>30&&e.charCodeAt(t)<=127&&(l+=e.charAt(t));return hash=l.split("").reduce((e,l)=>(e<<5)-e+l.charCodeAt(0),0)},destroy:function(){var e=$(this).prop("id");$.fn.jexcel.defaults[e]&&(delete $.fn.jexcel.defaults[e],$(this).html(""),$(".jexcel_corner").remove(),$(".jexcel_textarea").remove(),$(".jexcel_contextmenu").remove(),$(".jexcel_about").remove(),$.fn.jexcel.current==e&&($.fn.jexcel.current=null)),Object.keys($.fn.jexcel.defaults).length||($(document).off("dragstart",$.fn.jexcel.dragStartControls),$(document).off("contextmenu",$.fn.jexcel.contextMenuControls),$(document).off("mousewheel",$.fn.jexcel.mouseWheelControls),$(document).off("mousedown touchstart",$.fn.jexcel.mouseDownControls),$(document).off("mouseup",$.fn.jexcel.mouseUpControls),$(document).off("dblclick touchend",$.fn.jexcel.doubleClickControls),$(document).off("mousemove",$.fn.jexcel.mouseMoveControls),$(document).off("mouseover",$.fn.jexcel.mouseOverControls),$(document).off("paste",$.fn.jexcel.pasteControls),$(document).off("keydown",$.fn.jexcel.keyDownControls),$.fn.jexcel.defaults=null,$.fn.jexcel.current=null,$.fn.jexcel.factory=null,$.fn.jexcel.hash=null,$.fn.jexcel.style=null,$.fn.jexcel.selectedCorner=null,$.fn.jexcel.selectedHeader=null,$.fn.jexcel.resizeColumn=null,$.fn.jexcel.dragStartControls=null,$.fn.jexcel.contextMenuControls=null,$.fn.jexcel.mouseWheelControls=null,$.fn.jexcel.mouseDownControls=null,$.fn.jexcel.mouseUpControls=null,$.fn.jexcel.doubleClickControls=null,$.fn.jexcel.mouseMoveControls=null,$.fn.jexcel.mouseOverControls=null,$.fn.jexcel.pasteControls=null,$.fn.jexcel.keyDownControls=null,$.fn.jexcel.touchControls=null)}};$.fn.jexcel=function(e){return methods[e]?methods[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.tooltip"):methods.init.apply(this,arguments)}}(jQuery);