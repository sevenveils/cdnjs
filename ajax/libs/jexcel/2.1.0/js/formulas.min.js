if("undefined"!=typeof module&&"undefined"!=typeof require){var _=require("underscore"),numeral=require("numeral"),numeric=require("numeric"),jStat=require("jStat").jStat,moment=require("moment");_.str=require("underscore.string")}!function(scope){var _s=_.str,MEMOIZED_FACT=[],SQRT2PI=2.5066282746310002,WEEK_STARTS=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]];scope.ARGSCONCAT=function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t},scope.ARGSTOARRAY=function(e){return Array.prototype.slice.call(e,0)},scope.CLEANFLOAT=function(e){var t=Math.pow(10,14);return Math.round(e*t)/t},scope.COUNTIN=function(e,t){for(var n=0,r=0;r<e.length;r++)e[r]===t&&n++;return n},scope.GETJSON=function(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.send(null),200==t.status)return JSON.parse(t.responseText)},scope.DATE=function(e,t,n){return new Date(e,t-1,n)},scope.DATEVALUE=function(e){return new Date(e)},scope.DAY=function(e){return moment(new Date(e)).date()},scope.DAYS=function(e,t){return moment(new Date(e)).diff(moment(new Date(t)),"days")},scope.DAYS360=function(e,t,n){var r=moment(new Date(e)),o=moment(new Date(t)),a=31,s=31,u=r.date(),i=o.date();return n?(u=31===u?30:u,i=31===i?30:i):(1===r.month()&&(a=r.daysInMonth()),1===o.month()&&(s=o.daysInMonth()),30!==(u=u===a?30:u)&&u!==a||(i=i===s?30:i)),360*(o.year()-r.year())+30*(o.month()-r.month())+(i-u)},scope.EDATE=function(e,t){return moment(new Date(e)).add("months",t).toDate()},scope.EOMONTH=function(e,t){var n=moment(new Date(e)).add("months",t);return new Date(n.year(),n.month(),n.daysInMonth())},scope.HOUR=function(e){return e<=1?Math.floor(24*e):moment(new Date(e)).hours()},scope.MINUTE=function(e){return e<=1?Math.floor(1440*e)-60*Math.floor(24*e):moment(new Date(e)).minutes()},scope.ISOWEEKNUM=function(e){return moment(new Date(e)).format("w")},scope.MONTH=function(e){return moment(new Date(e)).month()+1},scope.NETWORKDAYS=function(e,t,n){return scope.NETWORKDAYSINTL(e,t,1,n)},scope.NETWORKDAYSINTL=function(e,t,n,r){var o=WEEKEND_TYPES[void 0===n?1:n],a=moment(new Date(e)),s=moment(new Date(t)).diff(a,"days")+1,u=s,i="",c=a,p=[];if(void 0!==r)for(var f=0;f<r.length;f++)p[f]=moment(new Date(r[f])).format("MM-DD-YYYY");for(var l=1;l<s;)i=c.format("d"),0<=o.indexOf(parseInt(i,10))?u--:0<=p.indexOf(c.format("MM-DD-YYYY"))&&u--,c=c.add("days",1),l++;return u},scope.NOW=function(){return new Date},scope.SECOND=function(e){return moment(new Date(e)).seconds()},scope.TIME=function(e,t,n){return(3600*e+60*t+n)/86400},scope.TIMEVALUE=function(e){var t=moment(new Date(e));return(3600*t.hours()+60*t.minutes()+t.seconds())/86400},scope.TODAY=function(){return new Date},scope.WEEKDAY=function(e,t){var n=moment(new Date(e)).format("d");return WEEK_TYPES[void 0===t?1:t][n]},scope.WEEKNUM=function(e,t){var n=moment(new Date(e)),r=moment(new Date(n.year(),0,1)),o=void 0===t?1:t,a=WEEK_STARTS[o],s=r.format("d"),u=s<a?a-s+1:s-a;return 21===o?scope.ISOWEEKNUM(e):Math.floor(n.diff(r.subtract("days",u),"days")/7)+1},scope.WORKDAY=function(e,t,n){return scope.WORKDAYINTL(e,t,1,n)},scope.WORKDAYINTL=function(e,t,n,r){var o=WEEKEND_TYPES[void 0===n?1:n],a=moment(new Date(e)),s="",u=[];if(void 0!==r)for(var i=0;i<r.length;i++)u[i]=moment(new Date(r[i])).format("MM-DD-YYYY");for(var c=0;c<t;)s=(a=a.add("days",1)).format("d"),o.indexOf(parseInt(s,10))<0&&u.indexOf(a.format("MM-DD-YYYY"))<0&&c++;return a.toDate()},scope.YEAR=function(e){return moment(new Date(e)).year()},scope.YEARFRAC=function(e,t,n){n=void 0===n?0:n;var r=moment(new Date(e)),o=moment(new Date(t));if(!r.isValid()||!o.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(n))return"#NUM!";if(r===o)return 0;0<r.diff(o)&&(o=moment(new Date(e)),r=moment(new Date(t)));var a=r.year(),s=r.month(),u=r.date(),i=o.year(),c=o.month(),p=o.date();switch(n){case 0:return 31===u&&31===p?p=u=30:31===u?u=30:30===u&&31===p?p=30:1===s&&1===c&&r.daysInMonth()===u&&o.daysInMonth()===p?p=u=30:1===s&&r.daysInMonth()===u&&(u=30),(p+30*c+360*i-(u+30*s+360*a))/360;case 1:var f=365;if(a===i||a+1===i&&(c<s||s===c&&p<=u))return a===i&&moment([a]).isLeapYear()?f=366:(function(e,t){var n=moment(new Date(e.year(),2,1));if(moment([e.year()]).isLeapYear()&&e.diff(n)<0&&0<=t.diff(n))return!0;var r=moment(new Date(t.year(),2,1));return!!(moment([t.year()]).isLeapYear()&&0<=t.diff(r)&&e.diff(r)<0)}(r,o)||1===c&&29===p)&&(f=366),o.diff(r,"days")/f;var l=i-a+1,M=moment(new Date(i+1,0,1)).diff(moment(new Date(a,0,1)),"days")/l;return o.diff(r,"days")/M;case 2:return o.diff(r,"days")/360;case 3:return o.diff(r,"days")/365;case 4:return 31===u&&(u=30),31===p&&(p=30),(p+30*c+360*i-(u+30*s+360*a))/360}},scope.BESSELI=function(){},scope.BESSELJ=function(){},scope.BESSELK=function(){},scope.BESSELY=function(){},scope.BIN2DEC=function(e){if(!/^[01]{1,10}$/.test(e))return"#NUM!";var t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},scope.BIN2HEX=function(e,t){if(!/^[01]{1,10}$/.test(e))return"#NUM!";var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var r=parseInt(e,2).toString(16);return void 0===t?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=r.length?_s.repeat("0",t-r.length)+r:"#NUM!"},scope.BIN2OCT=function(e,t){if(!/^[01]{1,10}$/.test(e))return"#NUM!";var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var r=parseInt(e,2).toString(8);return void 0===t?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=r.length?_s.repeat("0",t-r.length)+r:"#NUM!"},scope.BITAND=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<0||t<0?"#NUM!":Math.floor(e)!==e||Math.floor(t)!==t?"#NUM!":0xffffffffffff<e||0xffffffffffff<t?"#NUM!":e&t},scope.BITLSHIFT=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<0?"#NUM!":Math.floor(e)!==e?"#NUM!":0xffffffffffff<e?"#NUM!":53<Math.abs(t)?"#NUM!":0<=t?e<<t:e>>-t},scope.BITOR=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<0||t<0?"#NUM!":Math.floor(e)!==e||Math.floor(t)!==t?"#NUM!":0xffffffffffff<e||0xffffffffffff<t?"#NUM!":e|t},scope.BITRSHIFT=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<0?"#NUM!":Math.floor(e)!==e?"#NUM!":0xffffffffffff<e?"#NUM!":53<Math.abs(t)?"#NUM!":0<=t?e>>t:e<<-t},scope.BITXOR=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<0||t<0?"#NUM!":Math.floor(e)!==e||Math.floor(t)!==t?"#NUM!":0xffffffffffff<e||0xffffffffffff<t?"#NUM!":e^t},scope.COMPLEX=function(e,t,n){if(isNaN(e)||isNaN(t))return"#VALUE!";if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return"#VALUE!";if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();var r=0<t?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)},scope.CONVERT=function(e,t,n){if(isNaN(e))return"#VALUE!";for(var r,o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},s={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,i=null,c=t,p=n,f=1,l=1,M=0;M<o.length;M++)r=null===o[M][2]?[]:o[M][2],(o[M][1]===c||0<=r.indexOf(c))&&(u=o[M]),(o[M][1]===p||0<=r.indexOf(p))&&(i=o[M]);if(null===u){var N=a[t.substring(0,2)],h=s[t.substring(0,1)];"da"===t.substring(0,2)&&(h=["dekao",10,"da"]),N?(f=N[2],c=t.substring(2)):h&&(f=h[1],c=t.substring(h[2].length));for(var E=0;E<o.length;E++)r=null===o[E][2]?[]:o[E][2],(o[E][1]===c||0<=r.indexOf(c))&&(u=o[E])}if(null===i){var A=a[n.substring(0,2)],I=s[n.substring(0,1)];"da"===n.substring(0,2)&&(I=["dekao",10,"da"]),A?(l=A[2],p=n.substring(2)):I&&(l=I[1],p=n.substring(I[2].length));for(var g=0;g<o.length;g++)r=null===o[g][2]?[]:o[g][2],(o[g][1]===p||0<=r.indexOf(p))&&(i=o[g])}return null===u||null===i?"#N/A":u[3]!==i[3]?"#N/A":e*u[6]*f/(i[6]*l)},scope.DEC2BIN=function(e,t){if(isNaN(e))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||511<e)return"#NUM!";if(e<0)return"1"+_s.repeat("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!"},scope.DEC2HEX=function(e,t){if(isNaN(e))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||549755813887<e)return"#NUM!";if(e<0)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!"},scope.DEC2OCT=function(e,t){if(isNaN(e))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||536870911<e)return"#NUM!";if(e<0)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=n.length?_s.repeat("0",t-n.length)+n:"#NUM!"},scope.DELTA=function(e,t){return t=void 0===t?0:t,isNaN(e)||isNaN(t)?"#VALUE!":e===t?1:0},scope.ERF=function(e,t){return t=void 0===t?0:t,isNaN(e)||isNaN(t)?"#VALUE!":jStat.erf(e)},scope.ERFC=function(e){return isNaN(e)?"#VALUE!":jStat.erfc(e)},scope.ERFCPRECISE=function(){},scope.ERFPRECISE=function(){},scope.GESTEP=function(e,t){return t=void 0===t?0:t,isNaN(e)||isNaN(t)?"#VALUE!":t<=e?1:0},scope.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return"#NUM!";var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||511<r)return"#NUM!";if(n)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var o=r.toString(2);return void 0===t?o:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=o.length?_s.repeat("0",t-o.length)+o:"#NUM!"},scope.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return"#NUM!";var t=parseInt(e,16);return 549755813888<=t?t-1099511627776:t},scope.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return"#NUM!";var n=parseInt(e,16);if(536870911<n&&n<0xffe0000000)return"#NUM!";if(0xffe0000000<=n)return(n-0xffc0000000).toString(8);var r=n.toString(8);return void 0===t?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=r.length?_s.repeat("0",t-r.length)+r:"#NUM!"},scope.IMABS=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":Math.sqrt(Math.pow(t,2)+Math.pow(n,2))},scope.IMAGINARY=function(e){if(0===e||"0"===e)return 0;if(0<=["i","j"].indexOf(e))return 1;var t=(e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return 0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?"#NUM!":Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?"#NUM!":-Number(e.substring(n+1,e.length-1)):"#NUM!":o?isNaN(e.substring(0,e.length-1))?"#NUM!":e.substring(0,e.length-1):isNaN(e)?"#NUM!":0},scope.IMARGUMENT=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":0===t&&0===n?"#DIV/0!":0===t&&0<n?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&0<t?0:0===n&&t<0?-Math.PI:0<t?Math.atan(n/t):t<0&&0<=n?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI},scope.IMCONJUGATE=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":0!==n?scope.COMPLEX(t,-n,r):e},scope.IMCOS=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)},scope.IMCOSH=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)},scope.IMCOT=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV(scope.IMCOS(e),scope.IMSIN(e))},scope.IMCSC=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV("1",scope.IMSIN(e))},scope.IMCSCH=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV("1",scope.IMSINH(e))},scope.IMDIV=function(e,t){var n=scope.IMREAL(e),r=scope.IMAGINARY(e),o=scope.IMREAL(t),a=scope.IMAGINARY(t),s=e.substring(e.length-1),u=e.substring(e.length-1),i="i";if("j"===s?i="j":"j"===u&&(i="j"),"#NUM!"===n||"#NUM!"===r||"#NUM!"===o||"#NUM!"===a)return"#NUM!";if(0===o&&0===a)return"#NUM!";var c=o*o+a*a;return scope.COMPLEX((n*o+r*a)/c,(r*o-n*a)/c,i)},scope.IMEXP=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);if(r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n)return"#NUM!";var o=Math.exp(t);return scope.COMPLEX(o*Math.cos(n),o*Math.sin(n),r)},scope.IMLN=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),r)},scope.IMLOG10=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),r)},scope.IMLOG2=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),r)},scope.IMPOWER=function(e,t){if(isNaN(t))return"#VALUE!";var n=scope.IMREAL(e),r=scope.IMAGINARY(e),o=e.substring(e.length-1);if(o="i"===o||"j"===o?o:"i","#NUM!"===n||"#NUM!"===r)return"#NUM!";var a=Math.pow(scope.IMABS(e),t),s=scope.IMARGUMENT(e);return scope.COMPLEX(a*Math.cos(t*s),a*Math.sin(t*s),o)},scope.IMPRODUCT=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=scope.IMREAL(e),r=scope.IMAGINARY(e),o=scope.IMREAL(arguments[t]),a=scope.IMAGINARY(arguments[t]);if("#NUM!"===n||"#NUM!"===r||"#NUM!"===o||"#NUM!"===a)return"#NUM!";e=scope.COMPLEX(n*o-r*a,n*a+r*o)}return e},scope.IMREAL=function(e){if(0===e||"0"===e)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e))return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),o="i"===r||"j"===r;return 0<=t||0<=n?o?0<=t?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?"#NUM!":Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?"#NUM!":Number(e.substring(0,n)):"#NUM!":o?isNaN(e.substring(0,e.length-1))?"#NUM!":0:isNaN(e)?"#NUM!":e},scope.IMSEC=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV("1",scope.IMCOS(e))},scope.IMSECH=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV("1",scope.IMCOSH(e))},scope.IMSIN=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,r)},scope.IMSINH=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n?"#NUM!":scope.COMPLEX(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,r)},scope.IMSQRT=function(e){var t=scope.IMREAL(e),n=scope.IMAGINARY(e),r=e.substring(e.length-1);if(r="i"===r||"j"===r?r:"i","#NUM!"===t||"#NUM!"===n)return"#NUM!";var o=Math.sqrt(scope.IMABS(e)),a=scope.IMARGUMENT(e);return scope.COMPLEX(o*Math.cos(a/2),o*Math.sin(a/2),r)},scope.IMSUB=function(e,t){var n=scope.IMREAL(e),r=scope.IMAGINARY(e),o=scope.IMREAL(t),a=scope.IMAGINARY(t),s=e.substring(e.length-1),u=e.substring(e.length-1),i="i";return"j"===s?i="j":"j"===u&&(i="j"),"#NUM!"===n||"#NUM!"===r||"#NUM!"===o||"#NUM!"===a?"#NUM!":scope.COMPLEX(n-o,r-a,i)},scope.IMSUM=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=scope.IMREAL(e),r=scope.IMAGINARY(e),o=scope.IMREAL(arguments[t]),a=scope.IMAGINARY(arguments[t]);if("#NUM!"===n||"#NUM!"===r||"#NUM!"===o||"#NUM!"===a)return"#NUM!";e=scope.COMPLEX(n+o,r+a)}return e},scope.IMTAN=function(e){if(!0===e||!1===e)return"#VALUE!";var t=scope.IMREAL(e),n=scope.IMAGINARY(e);return"#NUM!"===t||"#NUM!"===n?"#NUM!":scope.IMDIV(scope.IMSIN(e),scope.IMCOS(e))},scope.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return"#NUM!";var n=10===e.length&&"7"===e.substring(0,1),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||511<r)return"#NUM!";if(n)return"1"+_s.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var o=r.toString(2);return void 0===t?o:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=o.length?_s.repeat("0",t-o.length)+o:"#NUM!"},scope.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return"#NUM!";var t=parseInt(e,8);return 536870912<=t?t-1073741824:t},scope.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return"#NUM!";var n=parseInt(e,8);if(536870912<=n)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return void 0===t?r:isNaN(t)?"#VALUE!":t<0?"#NUM!":(t=Math.floor(t))>=r.length?_s.repeat("0",t-r.length)+r:"#NUM!"},scope.ACCRINT=function(e,t,n,r,o,a,s,u){if(!moment(e).isValid()||!moment(t).isValid()||!moment(n).isValid())return"#VALUE!";if(r<=0||o<=0)return"#NUM!";if(-1===[1,2,4].indexOf(a))return"#NUM!";if(-1===[0,1,2,3,4].indexOf(s))return"#NUM!";if(0<=moment(e).diff(moment(n)))return"#NUM!";o=void 0===o?0:1e3,s=void 0===s?0:s,u=void 0===u||u;var i=0,c=moment(new Date(e));moment(new Date(t)),moment(new Date(n)),moment([c.year()]).isLeapYear();switch(s){case 0:case 1:case 2:case 3:case 4:i=scope.YEARFRAC(e,n,s)}return o*r*i},scope.ACCRINTM=function(){},scope.AMORDEGRC=function(){},scope.AMORLINC=function(){},scope.COUPDAYBS=function(){},scope.COUPDAYS=function(){},scope.COUPDAYSNC=function(){},scope.COUPNCD=function(){},scope.COUPNUM=function(){},scope.COUPPCD=function(){},scope.CUMIPMT=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||end<start)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=scope.PMT(rate,periods,value,0,type),interest=0;1===start&&0===type&&(interest=-value,start++);for(var i=start;i<=end;i++)interest+=1===type?scope.FV(rate,i-2,payment,value,1)-payment:scope.FV(rate,i-1,payment,value,0);return interest*=rate,interest},scope.CUMPRINC=function(rate,periods,value,start,end,type){if(rate=eval(rate),periods=eval(periods),rate<=0||periods<=0||value<=0)return"#NUM!";if(start<1||end<1||end<start)return"#NUM!";if(0!==type&&1!==type)return"#NUM!";var payment=scope.PMT(rate,periods,value,0,type),principal=0;1===start&&(principal=0===type?payment+value*rate:payment,start++);for(var i=start;i<=end;i++)principal+=0<type?payment-(scope.FV(rate,i-2,payment,value,1)-payment)*rate:payment-scope.FV(rate,i-1,payment,value,0)*rate;return principal},scope.DB=function(e,t,n,r,o){if(o=void 0===o?12:o,isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(o))return"#VALUE!";if(e<0||t<0||n<0||r<0)return"#NUM!";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o))return"#NUM!";if(n<r)return"#NUM!";if(e<=t)return 0;for(var a=(1-Math.pow(t/e,1/n)).toFixed(3),s=e*a*o/12,u=s,i=0,c=r===n?n-1:r,p=2;p<=c;p++)u+=i=(e-u)*a;return 1===r?s:r===n?(e-u)*a:i},scope.DDB=function(e,t,n,r,o){if(o=void 0===o?2:o,isNaN(e)||isNaN(t)||isNaN(n)||isNaN(r)||isNaN(o))return"#VALUE!";if(e<0||t<0||n<0||r<0||o<=0)return"#NUM!";if(n<r)return"#NUM!";if(e<=t)return 0;for(var a=0,s=0,u=1;u<=r;u++)a+=s=Math.min(o/n*(e-a),e-t-a);return s},scope.DISC=function(){},scope.DOLLARDE=function(e,t){if(isNaN(e)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(0<=t&&t<1)return"#DIV/0!";t=parseInt(t,10);var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r},scope.DOLLARFR=function(e,t){if(isNaN(e)||isNaN(t))return"#VALUE!";if(t<0)return"#NUM!";if(0<=t&&t<1)return"#DIV/0!";t=parseInt(t,10);var n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},scope.DURATION=function(){},scope.EFFECT=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<=0||t<1?"#NUM!":(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},scope.FV=function(rate,periods,payment,value,type){var result;if(type=void 0===type?0:type,rate=eval(rate),0===rate)result=value+payment*periods;else{var term=Math.pow(1+rate,periods);result=1===type?value*term+payment*(1+rate)*(term-1)/rate:value*term+payment*(term-1)/rate}return-result},scope.FVSCHEDULE=function(e,t){for(var n=e,r=0;r<t.length;r++){if(isNaN(t[r]))return"#VALUE!";n*=1+t[r]}return n},scope.INTRATE=function(){},scope.IPMT=function(rate,period,periods,present,future,type){type=void 0===type?0:type,rate=eval(rate),periods=eval(periods);var payment=scope.PMT(rate,periods,present,future,type),interest;return interest=1===period?1===type?0:-present:1===type?scope.FV(rate,period-2,payment,present,1)-payment:scope.FV(rate,period-1,payment,present,0),interest*rate},scope.IRR=function(e,t){function n(e,t,n){for(var r=n+1,o=e[0],a=1;a<e.length;a++)o+=e[a]/Math.pow(r,(t[a]-t[0])/365);return o}function r(e,t,n){for(var r=n+1,o=0,a=1;a<e.length;a++){var s=(t[a]-t[0])/365;o-=s*e[a]/Math.pow(r,1+s)}return o}for(var o=[],a=!1,s=!1,u=0;u<e.length;u++)o[u]=0===u?0:o[u-1]+365,0<e[u]&&(a=!0),e[u]<0&&(s=!0);if(!a||!s)return"#NUM!";for(var i,c,p,f=t=void 0===t?.1:t,l=0,M=!0;i=f-(p=n(e,o,f))/r(e,o,f),c=Math.abs(i-f),f=i,(M=1e-10<c&&1e-10<Math.abs(p))&&++l<50;);return M?"#NUM!":f},scope.ISPMT=function(rate,period,periods,value){return rate=eval(rate),periods=eval(periods),value*rate*(period/periods-1)},scope.MDURATION=function(){},scope.MIRR=function(e,t,n){for(var r=e.length,o=[],a=[],s=0;s<r;s++)e[s]<0?o.push(e[s]):a.push(e[s]);var u=-scope.NPV(n,a)*Math.pow(1+n,r-1),i=scope.NPV(t,o)*(1+t);return Math.pow(u/i,1/(r-1))-1},scope.NOMINAL=function(e,t){return isNaN(e)||isNaN(t)?"#VALUE!":e<=0||t<1?"#NUM!":(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},scope.NPER=function(rate,payment,present,future,type){type=void 0===type?0:type,future=void 0===future?0:future,rate=eval(rate);var num=payment*(1+rate*type)-future*rate,den=present*rate+payment*(1+rate*type);return Math.log(num/den)/Math.log(1+rate)},scope.NPV=function(){var e=[];for(i=0;i<arguments.length;i++)e=e.concat(arguments[i]);for(var t=e[0],n=0,r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n},scope.ODDFPRICE=function(){},scope.ODDFYIELD=function(){},scope.ODDLPRICE=function(){},scope.ODDLYIELD=function(){},scope.PDURATION=function(e,t,n){return isNaN(e)||isNaN(t)||isNaN(n)?"#VALUE!":e<=0?"#NUM!":(Math.log(n)-Math.log(t))/Math.log(1+e)},scope.PMT=function(rate,periods,present,future,type){var result;if(type=void 0===type?0:type,rate=eval(rate),periods=eval(periods),0===rate)result=(present+future)/periods;else{var term=Math.pow(1+rate,periods);result=1===type?(future*rate/(term-1)+present*rate/(1-1/term))/(1+rate):future*rate/(term-1)+present*rate/(1-1/term)}return-result},scope.PPMT=function(e,t,n,r,o,a){return scope.PMT(e,n,r,o,a)-scope.IPMT(e,t,n,r,o,a)},scope.PRICE=function(){},scope.PRICEDISC=function(){},scope.PRICEMAT=function(){},scope.PV=function(rate,periods,payment,future,type){return type=void 0===type?0:type,rate=eval(rate),periods=eval(periods),0===rate?-payment*periods-future:((1-Math.pow(1+rate,periods))/rate*payment*(1+rate*type)-future)/Math.pow(1+rate,periods)},scope.RATE=function(periods,payment,present,future,type,guess){guess=void 0===guess?.01:guess,future=void 0===future?0:future,type=void 0===type?0:type,periods=eval(periods);var epsMax=1e-10,iterMax=50,y,y0,y1,x0,x1=0,f=0,i=0,rate=guess;for(y=Math.abs(rate)<epsMax?present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),present*f+payment*(1/rate+type)*(f-1)+future),y0=present+payment*periods+future,y1=present*f+payment*(1/rate+type)*(f-1)+future,i=x0=0,x1=rate;Math.abs(y0-y1)>epsMax&&i<iterMax;)rate=(y1*x0-y0*x1)/(y1-y0),x0=x1,x1=rate,y=Math.abs(rate)<epsMax?present*(1+periods*rate)+payment*(1+rate*type)*periods+future:(f=Math.exp(periods*Math.log(1+rate)),present*f+payment*(1/rate+type)*(f-1)+future),y0=y1,y1=y,++i;return rate},scope.RECEIVED=function(){},scope.RRI=function(){},scope.SLN=function(){},scope.SYD=function(){},scope.TBILLEQ=function(){},scope.TBILLPRICE=function(){},scope.TBILLYIELD=function(){},scope.VDB=function(){},scope.XIRR=function(){},scope.XNPV=function(){},scope.YIELD=function(){},scope.YIELDDISC=function(){},scope.YIELDMAT=function(){},scope.ISNUMBER=function(e){return!(isNaN(parseFloat(e))||!isFinite(e))},scope.AND=function(){result=!0;for(var e=0;e<arguments.length;e++)arguments[e]||(result=!1);return result},scope.FALSE=function(){return!1},scope.IF=function(e,t,n){return e?void 0===t||t:void 0===n||n},scope.IFERROR=function(e,t){return 0<=["#DIV/0!","#N/A","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!"].indexOf(e)?t:e},scope.IFNA=function(e,t){return"#N/A"===e?t:e},scope.NOT=function(e){return!e},scope.OR=function(){result=!1;for(var e=0;e<arguments.length;e++)arguments[e]&&(result=!0);return result},scope.TRUE=function(){return!0},scope.XOR=function(){for(var e=result=0;e<arguments.length;e++)arguments[e]&&result++;return!!(1&Math.floor(Math.abs(result)))},scope.ABS=function(e){return Math.abs(e)},scope.ACOS=function(e){return Math.acos(e)},scope.ACOSH=function(e){return Math.log(e+Math.sqrt(e*e-1))},scope.ACOT=function(e){return Math.atan(1/e)},scope.ACOTH=function(e){return.5*Math.log((e+1)/(e-1))},scope.AGGREGATE=function(e,t){for(var n=[],r=2;r<arguments.length;r++)switch(e){case 1:n[r-2]=scope.AVERAGE(arguments[r]);break;case 2:n[r-2]=scope.COUNT(arguments[r]);break;case 3:n[r-2]=scope.COUNTA(arguments[r]);break;case 4:n[r-2]=scope.MAX(arguments[r]);break;case 5:n[r-2]=scope.MIN(arguments[r]);break;case 6:n[r-2]=scope.PRODUCT(arguments[r]);break;case 7:n[r-2]=scope.STDEVS(arguments[r]);break;case 8:n[r-2]=scope.STDEVP(arguments[r]);break;case 9:n[r-2]=scope.SUM(arguments[r]);break;case 10:n[r-2]=scope.VARS(arguments[r]);break;case 11:n[r-2]=scope.VARP(arguments[r]);break;case 12:n[r-2]=scope.MEDIAN(arguments[r]);break;case 13:n[r-2]=scope.MODESNGL(arguments[r]);break;case 14:n[r-2]=scope.LARGE(arguments[r]);break;case 15:n[r-2]=scope.SMALL(arguments[r]);break;case 16:n[r-2]=scope.PERCENTILEINC(arguments[r]);break;case 17:n[r-2]=scope.QUARTILEINC(arguments[r]);break;case 18:n[r-2]=scope.PERCENTILEEXC(arguments[r]);break;case 19:n[r-2]=scope.QUARTILEEXC(arguments[r])}return n},scope.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))throw new Error("Incorrect roman number");var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},scope.ASIN=function(e){return Math.asin(e)},scope.ASINH=function(e){return Math.log(e+Math.sqrt(e*e+1))},scope.ATAN=function(e){return Math.atan(e)},scope.ATAN2=function(e,t){return Math.atan2(e,t)},scope.ATANH=function(e){return Math.log((1+e)/(1-e))/2},scope.BASE=function(e,t,n){n=void 0===n?0:n;var r=e.toString(t);return Array(Math.max(n+1-r.length,0)).join("0")+r},scope.CEILING=function(e,t,n){if(0===t)return 0;t=void 0===t?1:Math.abs(t),n=void 0===n?0:n;var r=-Math.floor(Math.log(t)/Math.log(10));return 0<=e?scope.ROUND(Math.ceil(e/t)*t,r):0===n?-scope.ROUND(Math.floor(Math.abs(e)/t)*t,r):-scope.ROUND(Math.ceil(Math.abs(e)/t)*t,r)},scope.CEILINGMATH=scope.CEILING,scope.CEILINGPRECISE=scope.CEILING,scope.COMBIN=function(e,t){return scope.FACT(e)/(scope.FACT(t)*scope.FACT(e-t))},scope.COMBINA=function(e,t){return 0===e&&0===t?1:scope.COMBIN(e+t-1,e-1)},scope.COS=function(e){return Math.cos(e)},scope.COSH=function(e){return(Math.exp(e)+Math.exp(-e))/2},scope.COT=function(e){return 1/Math.tan(e)},scope.COTH=function(e){var t=Math.exp(2*e);return(t+1)/(t-1)},scope.CSC=function(e){return 1/Math.sin(e)},scope.CSCH=function(e){return 2/(Math.exp(e)-Math.exp(-e))},scope.DECIMAL=function(e,t){return parseInt(e,t)},scope.DEGREES=function(e){return 180*e/Math.PI},scope.EVEN=function(e){return scope.CEILING(e,-2,-1)},scope.EXP=function(e){return Math.exp(e)},scope.FACT=function(e){var t=Math.floor(e);return 0===t||1===t?1:(0<MEMOIZED_FACT[t]||(MEMOIZED_FACT[t]=scope.FACT(t-1)*t),MEMOIZED_FACT[t])},scope.FACTDOUBLE=function(e){var t=Math.floor(e);return t<=0?1:t*scope.FACTDOUBLE(t-2)},scope.FLOOR=function(e,t,n){if(0===t)return 0;t=void 0===t?1:Math.abs(t),n=void 0===n?0:n;var r=-Math.floor(Math.log(t)/Math.log(10));return 0<=e?scope.ROUND(Math.floor(e/t)*t,r):0===n?-scope.ROUND(Math.ceil(Math.abs(e)/t)*t,r):-scope.ROUND(Math.floor(Math.abs(e)/t)*t,r)},scope.FLOORMATH=scope.FLOOR,scope.FLOORPRECISE=scope.FLOOR,scope.GCD=function(){for(var e=arguments.length-1,t=arguments[e];e;)arguments[--e];return t},scope.INT=function(e){return Math.floor(e)},scope.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},scope.ISOCEILING=scope.CEILING,scope.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},scope.LCM=function(){for(var e,t,n,r,o=scope.ARGSTOARRAY(arguments),a=1;void 0!==(n=o.pop());)for(;1<n;){if(n%2){for(e=3,t=Math.floor(Math.sqrt(n));e<=t&&n%e;e+=2);r=e<=t?e:n}else r=2;for(n/=r,a*=r,e=o.length;e;o[--e]%r==0&&1==(o[e]/=r)&&o.splice(e,1));}return a},scope.LN=function(e){return Math.log(e)},scope.LOG=function(e,t){return t=void 0===t?10:t,Math.log(e)/Math.log(t)},scope.LOG10=function(e){return Math.log(e)/Math.log(10)},scope.MDETERM=numeric.det,scope.MINVERSE=numeric.inv,scope.MMULT=numeric.dot,scope.MOD=function(e,t){var n=Math.abs(e%t);return 0<t?n:-n},scope.MROUND=function(e,t){if(e*t<0)throw new Error("Number and multiple must have the same sign.");return Math.round(e/t)*t},scope.MULTINOMIAL=function(){for(var e=0,t=1,n=0;n<arguments.length;n++)e+=arguments[n],t*=scope.FACT(arguments[n]);return scope.FACT(e)/t},scope.MUNIT=numeric.identity,scope.ODD=function(e){var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,0<e?t:-t},scope.PI=function(){return Math.PI},scope.POWER=function(e,t){return Math.pow(e,t)},scope.PRODUCT=function(){for(var e=1,t=0;t<arguments.length;t++)e*=arguments[t];return e},scope.QUOTIENT=function(e,t){return(e/t).toFixed(0)},scope.RADIANS=function(e){return e*Math.PI/180},scope.RAND=function(){return Math.random()},scope.RANDBETWEEN=function(e,t){return e+Math.ceil((t-e+1)*Math.random())-1},scope.ROUND=function(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)},scope.ROUNDDOWN=function(e,t){return(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},scope.ROUNDUP=function(e,t){return(0<e?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},scope.SERIESSUM=function(e,t,n,r){for(var o=r[0]*Math.pow(e,t),a=1;a<r.length;a++)o+=r[a]*Math.pow(e,t+a*n);return o},scope.SEC=function(e){return 1/Math.cos(e)},scope.SECH=function(e){return 2/(Math.exp(e)+Math.exp(-e))},scope.SIGN=function(e){return e<0?-1:0===e?0:1},scope.SIN=function(e){return Math.sin(e)},scope.SINH=function(e){return(Math.exp(e)-Math.exp(-e))/2},scope.SQRT=function(e){return Math.sqrt(e)},scope.SQRTPI=function(e){return Math.sqrt(e*Math.PI)},scope.SUBTOTAL=function(e){for(var t=[],n=1;n<arguments.length;n++)switch(e){case 1:t[n-1]=scope.AVERAGE(arguments[n]);break;case 2:t[n-1]=scope.COUNT(arguments[n]);break;case 3:t[n-1]=scope.COUNTA(arguments[n]);break;case 4:t[n-1]=scope.MAX(arguments[n]);break;case 5:t[n-1]=scope.MIN(arguments[n]);break;case 6:t[n-1]=scope.PRODUCT(arguments[n]);break;case 7:t[n-1]=scope.STDEV(arguments[n]);break;case 8:t[n-1]=scope.STDEVP(arguments[n]);break;case 9:t[n-1]=scope.SUM(arguments[n]);break;case 10:t[n-1]=scope.VAR(arguments[n]);break;case 11:t[n-1]=scope.VARP(arguments[n])}return t},scope.SUM=function(){for(var e=scope.ARGSTOARRAY(arguments),t=0,n=0;n<e.length;n++)if(e[n]instanceof Array)for(var r=0;r<e[n].length;r++)t+=scope.ISNUMBER(e[n][r])?e[n][r]:0;else t+=scope.ISNUMBER(e[n])?e[n]:0;return t},scope.SUMIF=function(range,criteria){for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},scope.SUMIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?range[i]:0}return result},scope.SUMPRODUCT=function(){for(var e=arguments.length+1,t=0,n=0;n<arguments[0].length;n++)for(var r=0;r<arguments[0][n].length;r++){for(var o=1,a=1;a<e;a++)o*=arguments[a-1][n][r];t+=o}return t},scope.SUMSQ=function(){for(var e=scope.ARGSTOARRAY(arguments),t=0,n=0;n<e.length;n++)t+=scope.ISNUMBER(e[n])?e[n]*e[n]:0;return t},scope.SUMX2MY2=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n},scope.SUMX2PY2=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n},scope.SUMXMY2=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},scope.TAN=function(e){return Math.tan(e)},scope.TANH=function(e){var t=Math.exp(2*e);return(t-1)/(t+1)},scope.TRUNC=function(e,t){return t=void 0===t?0:t,(0<e?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},scope.AVEDEV=function(){var e=scope.ARGSCONCAT(arguments);return jStat.sum(jStat(e).subtract(jStat.mean(e)).abs()[0])/e.length},scope.AVERAGE=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0,o=0;o<t;o++)!0!==e[o]&&!1!==e[o]&&(r+=e[o],n++);return r/n},scope.AVERAGEA=function(){return jStat.mean(scope.ARGSCONCAT(arguments))},scope.AVERAGEIF=function(range,criteria,average_range){average_range=void 0===average_range?range:average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},scope.AVERAGEIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],count=0,result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);fit&&(result+=range[i],count++)}return result/count},scope.BETADIST=function(e,t,n,r,o,a){return e=(e-(o=void 0===o?0:o))/((a=void 0===a?1:a)-o),r?jStat.beta.cdf(e,t,n):jStat.beta.pdf(e,t,n)},scope.BETAINV=function(e,t,n,r,o){return r=void 0===r?0:r,o=void 0===o?1:o,jStat.beta.inv(e,t,n)*(o-r)+r},scope.BINOMDIST=function(e,t,n,r){return r?jStat.binomial.cdf(e,t,n):jStat.binomial.pdf(e,t,n)},scope.BINOMDISTRANGE=function(e,t,n,r){r=void 0===r?n:r;for(var o=0,a=n;a<=r;a++)o+=scope.COMBIN(e,a)*Math.pow(t,a)*Math.pow(1-t,e-a);return o},scope.BINOMINV=function(e,t,n){for(var r=0;r<=e;){if(jStat.binomial.cdf(r,e,t)>=n)return r;r++}},scope.CHISQDIST=function(e,t,n){return n?jStat.chisquare.cdf(e,t):jStat.chisquare.pdf(e,t)},scope.CHISQDISTRT=function(e,t){},scope.CHISQINV=function(e,t){return jStat.chisquare.inv(e,t)},scope.CHISQINVRT=function(){},scope.CHISQTEST=function(){},scope.CONFIDENCENORM=function(e,t,n){return jStat.normalci(1,e,t,n)[1]-1},scope.CONFIDENCET=function(e,t,n){return jStat.tci(1,e,t,n)[1]-1},CORREL=jStat.corrcoeff,scope.COUNT=function(){return scope.ARGSCONCAT(arguments).length},scope.COUNTA=function(){var e=scope.ARGSCONCAT(arguments);return e.length-scope.COUNTBLANK(e)},scope.COUNTBLANK=function(){for(var e=scope.ARGSCONCAT(arguments),t=0,n=0;n<e.length;n++)null!==e[n]&&""!==e[n]||t++;return t},scope.COUNTIF=function(e,t){for(var n=0,r=0;r<e.length;r++)e[r].match(new RegExp(t))&&n++;return n},scope.COUNTIFS=function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},scope.COUNTUNIQUE=function(){return _.uniq(scope.ARGSCONCAT(arguments)).length},scope.COVARIANCEP=function(e,t){for(var n=jStat.mean(e),r=jStat.mean(t),o=0,a=e.length,s=0;s<a;s++)o+=(e[s]-n)*(t[s]-r);return o/a},scope.COVARIANCES=jStat.covariance,scope.DEVSQ=function(){for(var e=scope.ARGSCONCAT(arguments),t=jStat.mean(e),n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},scope.EXPONDIST=function(e,t,n){return n?jStat.exponential.cdf(e,t):jStat.exponential.pdf(e,t)},scope.FDIST=function(e,t,n,r){return r?jStat.centralF.cdf(e,t,n):jStat.centralF.pdf(e,t,n)},scope.FDISTRT=function(){},scope.FINV=function(e,t,n){return jStat.centralF.inv(e,t,n)},scope.FINVRT=function(){},scope.FTEST=function(){},scope.FISHER=function(e){return Math.log((1+e)/(1-e))/2},scope.FISHERINV=function(e){var t=Math.exp(2*e);return(t-1)/(t+1)},scope.FORECAST=function(e,t,n){for(var r=jStat.mean(n),o=jStat.mean(t),a=n.length,s=0,u=0,i=0;i<a;i++)s+=(n[i]-r)*(t[i]-o),u+=Math.pow(n[i]-r,2);var c=s/u;return o-c*r+c*e},scope.FREQUENCY=function(e,t){for(var n=e.length,r=t.length,o=[],a=0;a<=r;a++)for(var s=o[a]=0;s<n;s++)0===a?e[s]<=t[0]&&(o[0]+=1):a<r?e[s]>t[a-1]&&e[s]<=t[a]&&(o[a]+=1):a===r&&e[s]>t[r-1]&&(o[r]+=1);return o},scope.GAMMA=jStat.gammafn,scope.GAMMADIST=function(e,t,n,r){},scope.GAMMAINV=function(e,t,n){},scope.GAMMALN=jStat.gammaln,scope.GAMMALNPRECISE=function(){},scope.GAUSS=function(e){return jStat.normal.cdf(e,0,1)-.5},scope.GEOMEAN=function(){return jStat.geomean(scope.ARGSCONCAT(arguments))},scope.GROWTH=function(e,t,n,r){var o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);void 0===r&&(r=!0);var a,s=e.length,u=0,i=0,c=0,p=0;for(o=0;o<s;o++){var f=t[o],l=Math.log(e[o]);u+=f,i+=l,c+=f*l,p+=f*f}u/=s,i/=s,c/=s,p/=s,a=r?(beta=(c-u*i)/(p-u*u),i-beta*u):(beta=c/p,0);var M=[];for(o=0;o<n.length;o++)M.push(Math.exp(a+beta*n[o]));return M},scope.HARMEAN=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0;r<t;r++)n+=1/e[r];return t/n},scope.HYPGEOMDIST=function(e,t,n,r,o){function s(e,t,n,r){return scope.COMBIN(n,e)*scope.COMBIN(r-n,t-e)/scope.COMBIN(r,t)}return o?function(e,t,n,r){for(var o=0,a=0;a<=e;a++)o+=s(a,t,n,r);return o}(e,t,n,r):s(e,t,n,r)},scope.INTERCEPT=function(e,t){return scope.FORECAST(0,e,t)},scope.KURT=function(){for(var e=scope.ARGSCONCAT(arguments),t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(r/=Math.pow(jStat.stdev(e,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},scope.LARGE=function(e,t){return e.sort(function(e,t){return t-e})[t-1]},scope.LINEST=function(e,t){for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,a=0,s=0,u=0;u<o;u++)a+=(t[u]-n)*(e[u]-r),s+=Math.pow(t[u]-n,2);var i=a/s;return b=r-i*n,[i,b]},scope.LOGEST=function(){},scope.LOGNORMDIST=function(e,t,n,r){return r?jStat.lognormal.cdf(e,t,n):jStat.lognormal.pdf(e,t,n)},scope.LOGNORMINV=function(e,t,n){return jStat.lognormal.inv(e,t,n)},scope.MAX=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0<t?e[0]:0,r=0;r<t;r++)n=e[r]>n&&!0!==e[r]&&!1!==e[r]?e[r]:n;return n},scope.MAXA=function(){var e=scope.ARGSCONCAT(arguments);return 0<e.length?Math.max.apply(Math,e):0},scope.MEDIAN=function(){return jStat.median(scope.ARGSCONCAT(arguments))},scope.MIN=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0<t?e[0]:0,r=0;r<t;r++)n=e[r]<n&&!0!==e[r]&&!1!==e[r]?e[r]:n;return n},scope.MINA=function(){var e=scope.ARGSCONCAT(arguments);return 0<e.length?Math.min.apply(Math,e):0},scope.MODEMULT=function(){for(var e,t=scope.ARGSCONCAT(arguments),n=t.length,r={},o=[],a=0,s=0;s<n;s++)r[e=t[s]]=r[e]?r[e]+1:1,r[e]>a&&(a=r[e],o=[]),r[e]===a&&(o[o.length]=e);return o},scope.MODESNGL=function(){return scope.MODEMULT(scope.ARGSCONCAT(arguments)).sort(function(e,t){return e-t})[0]},scope.NEGBINOMDIST=function(e,t,n,r){return r?jStat.negbin.cdf(e,t,n):jStat.negbin.pdf(e,t,n)},scope.NORMDIST=function(e,t,n,r){return isNaN(e)||isNaN(t)||isNaN(n)?"#VALUE!":n<=0?"#NUM!":r?jStat.normal.cdf(e,t,n):jStat.normal.pdf(e,t,n)},scope.NORMINV=function(e,t,n){return jStat.normal.inv(e,t,n)},scope.NORMSDIST=function(e,t){return t?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)},scope.NORMSINV=function(e){return jStat.normal.inv(e,0,1)},scope.PEARSON=function(e,t){for(var n=jStat.mean(e),r=jStat.mean(t),o=e.length,a=0,s=0,u=0,i=0;i<o;i++)a+=(e[i]-n)*(t[i]-r),s+=Math.pow(e[i]-n,2),u+=Math.pow(t[i]-r,2);return a/Math.sqrt(s*u)},scope.PERCENTILEEXC=function(e,t){var n=(e=e.sort(function(e,t){return e-t})).length;if(t<1/(n+1)||1-1/(n+1)<t)return"#NUM!";var r=t*(n+1)-1,o=Math.floor(r);return scope.CLEANFLOAT(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},scope.PERCENTILEINC=function(e,t){var n=t*((e=e.sort(function(e,t){return e-t})).length-1),r=Math.floor(n);return scope.CLEANFLOAT(n===r?e[n]:e[r]+(n-r)*(e[r+1]-e[r]))},scope.PERCENTRANKEXC=function(e,t,n){e=e.sort(function(e,t){return e-t});var r=_.uniq(e),o=e.length,a=r.length;n=void 0===n?3:n;for(var s=Math.pow(10,n),u=0,i=!1,c=0;!i&&c<a;)t===r[c]?(u=(e.indexOf(r[c])+1)/(o+1),i=!0):t>=r[c]&&(t<r[c+1]||c===a-1)&&(u=(e.indexOf(r[c])+1+(t-r[c])/(r[c+1]-r[c]))/(o+1),i=!0),c++;return Math.floor(u*s)/s},scope.PERCENTRANKINC=function(e,t,n){e=e.sort(function(e,t){return e-t});var r=_.uniq(e),o=e.length,a=r.length;n=void 0===n?3:n;for(var s=Math.pow(10,n),u=0,i=!1,c=0;!i&&c<a;)t===r[c]?(u=e.indexOf(r[c])/(o-1),i=!0):t>=r[c]&&(t<r[c+1]||c===a-1)&&(u=(e.indexOf(r[c])+(t-r[c])/(r[c+1]-r[c]))/(o-1),i=!0),c++;return Math.floor(u*s)/s},scope.PERMUT=function(e,t){return scope.FACT(e)/FACT(e-t)},scope.PERMUTATIONA=function(e,t){return Math.pow(e,t)},scope.PHI=function(e){return Math.exp(-.5*e*e)/SQRT2PI},scope.POISSONDIST=function(e,t,n){return n?jStat.poisson.cdf(e,t):jStat.poisson.pdf(e,t)},scope.PROB=function(e,t,n,r){if(void 0===n)return 0;if(n===(r=void 0===r?n:r))return 0<=e.indexOf(n)?t[e.indexOf(n)]:0;var o=e.sort(function(e,t){return e-t}),a=o.length,s=0;for(i=0;i<a;i++)o[i]>=n&&o[i]<=r&&(s+=t[e.indexOf(o[i])]);return s},scope.QUARTILEEXC=function(e,t){switch(t){case 1:return scope.PERCENTILEEXC(e,.25);case 2:return scope.PERCENTILEEXC(e,.5);case 3:return scope.PERCENTILEEXC(e,.75);default:return"#NUM!"}},scope.QUARTILEINC=function(e,t){switch(t){case 1:return scope.PERCENTILEINC(e,.25);case 2:return scope.PERCENTILEINC(e,.5);case 3:return scope.PERCENTILEINC(e,.75);default:return"#NUM!"}},scope.RANKAVG=function(e,t,n){var r=(n=void 0!==n&&n)?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(r);var o=scope.COUNTIN(t,e);return 1<o?(2*t.indexOf(e)+o+1)/2:t.indexOf(e)+1},scope.RANKEQ=function(e,t,n){var r=(n=void 0!==n&&n)?function(e,t){return e-t}:function(e,t){return t-e};return(t=t.sort(r)).indexOf(e)+1},scope.RSQ=function(e,t){return Math.pow(PEARSON(e,t),2)},scope.SKEW=function(){for(var e=scope.ARGSCONCAT(arguments),t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(jStat.stdev(e,!0),3))},scope.SKEWP=function(){for(var e=scope.ARGSCONCAT(arguments),t=jStat.mean(e),n=e.length,r=0,o=0,a=0;a<n;a++)o+=Math.pow(e[a]-t,3),r+=Math.pow(e[a]-t,2);return r/=n,(o/=n)/Math.pow(r,1.5)},scope.SLOPE=function(e,t){for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,a=0,s=0,u=0;u<o;u++)a+=(t[u]-n)*(e[u]-r),s+=Math.pow(t[u]-n,2);return a/s},scope.SMALL=function(e,t){return e.sort(function(e,t){return e-t})[t-1]},scope.STANDARDIZE=function(e,t,n){return(e-t)/n},scope.STDEVA=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=jStat.mean(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return Math.sqrt(n/(t-1))},scope.STDEVP=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0,o=scope.AVERAGE(e),a=0;a<t;a++)!0!==e[a]&&!1!==e[a]&&(n+=Math.pow(e[a]-o,2),r++);return Math.sqrt(n/r)},scope.STDEVPA=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=jStat.mean(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return Math.sqrt(n/t)},scope.STDEVS=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0,o=scope.AVERAGE(e),a=0;a<t;a++)!0!==e[a]&&!1!==e[a]&&(n+=Math.pow(e[a]-o,2),r++);return Math.sqrt(n/(r-1))},scope.STEYX=function(e,t){for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,a=0,s=0,u=0,i=0;i<o;i++)a+=Math.pow(e[i]-r,2),s+=(t[i]-n)*(e[i]-r),u+=Math.pow(t[i]-n,2);return Math.sqrt((a-s*s/u)/(o-2))},scope.TDIST=function(e,t,n){return n?jStat.studentt.cdf(e,t):jStat.studentt.pdf(e,t)},scope.TDIST2T=function(){},scope.TDISTRT=function(){},scope.TINV=function(e,t){return jStat.studentt.inv(e,t)},scope.TINV2T=function(){},scope.TTEST=function(){},scope.TREND=function(){},scope.TRIMMEAN=function(e,t){e.length;var n=scope.FLOOR(e.length*t,2)/2;return jStat.mean(_.initial(_.rest(e.sort(function(e,t){return e-t}),n),n))},scope.VARA=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=jStat.mean(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)},scope.VARP=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0,o=scope.AVERAGE(e),a=0;a<t;a++)!0!==e[a]&&!1!==e[a]&&(n+=Math.pow(e[a]-o,2),r++);return n/r},scope.VARPA=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=jStat.mean(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/t},scope.VARS=function(){for(var e=scope.ARGSCONCAT(arguments),t=e.length,n=0,r=0,o=scope.AVERAGE(e),a=0;a<t;a++)!0!==e[a]&&!1!==e[a]&&(n+=Math.pow(e[a]-o,2),r++);return n/(r-1)},scope.WEIBULLDIST=function(e,t,n,r){return r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},scope.ZTEST=function(e,t,n){var r=e.length,o=void 0===n?scope.STDEVS(e):n;return 1-scope.NORMSDIST((scope.AVERAGE(e)-t)/(o/Math.sqrt(r)),TRUE)},scope.CHAR=function(e){return String.fromCharCode(e)},scope.CLEAN=function(e){return e.replace(/[\0-\x1F]/g,"")},scope.CODE=function(e){return e.charCodeAt(0)},scope.CONCATENATE=function(){for(var e="",t=0;t<arguments.length;t++)e+=arguments[t];return e},scope.DOLLAR=function(e,t){var n="";return(t=void 0===t?2:t)<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),n="($0,0)"):0<t&&(n="($0,0."+Array(t+1).join("0")+")"),numeral(e).format(n)},scope.EXACT=function(e,t){return e===t},scope.FIND=function(e,t,n){return n=void 0===n?0:n,t.indexOf(e,n-1)+1},scope.FIXED=function(e,t,n){var r=(n=void 0!==n&&n)?"0":"0,0";return(t=void 0===t?2:t)<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):0<t&&(r+="."+Array(t+1).join("0")),numeral(e).format(r)},scope.JOIN=function(e,t){return t.join(e)},scope.LEFT=function(e,t){return t=void 0===t?1:t,e.substring(0,t)},scope.LEN=function(e){return e.length},scope.LOWER=function(e){return e.toLowerCase()},scope.MID=function(e,t,n){return e.substring(t-1,n)},scope.NUMBERVALUE=function(e,t,n){return t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,""))},scope.PROPER=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},scope.REGEXEXTRACT=function(e,t){var n=e.match(new RegExp(t));return n?n[0]:null},scope.REGEXMATCH=function(e,t){return!!e.match(new RegExp(t))},scope.REGEXREPLACE=function(e,t,n){return e.replace(new RegExp(t),n)},scope.REPLACE=function(e,t,n,r){return e.substr(0,t-1)+r+e.substr(t-1+n)},scope.REPT=function(e,t){return Array(t+1).join(e)},scope.RIGHT=function(e,t){return t=void 0===t?1:t,e.substring(e.length-t)},scope.ROMAN=function(e){for(var t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",o=3;o--;)r=(n[+t.pop()+10*o]||"")+r;return Array(+t.join("")+1).join("M")+r},scope.SEARCH=function(e,t,n){return n=void 0===n?0:n,t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1},scope.SPLIT=function(e,t){return _s.words(e,t)},scope.SUBSTITUTE=function(e,t,n,r){if(void 0===r)return e.replace(new RegExp(t,"g"),n);for(var o=0,a=0;0<e.indexOf(t,o);)if(o=e.indexOf(t,o+1),++a===r)return e.substring(0,o)+n+e.substring(o+t.length)},scope.T=function(e){return"string"==typeof e?e:null},scope.TEXT=function(e,t){return 0<=t.indexOf("0")?numeral(e).format(t):moment(new Date(e)).format(t)},scope.TRIM=function(e){return _s.clean(e)},scope.UNICHAR=scope.CHAR,scope.UNICODE=scope.CODE,scope.UPPER=function(e){return e.toUpperCase()},scope.VALUE=function(e){return numeral().unformat(e)}}(this);