/*!
 * chillout v1.0.1 - Reduce JavaScript CPU usage by asynchronous iteration
 * Copyright (c) 2016 polygon planet <polygon.planet.aqua@gmail.com>
 * @license MIT
 */
!function(a,b,c){"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=c():exports[a]=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("chillout",this,function(){"use strict";function a(a){return null!=a&&"function"==typeof a.then}var b={};"function"==typeof setImmediate?b.nextTick=function(a){setImmediate(a)}:"object"==typeof process&&"function"==typeof process.nextTick?b.nextTick=function(a){process.nextTick(a)}:"function"==typeof MessageChannel?b.nextTick=function(){var a=[],b=new MessageChannel;return b.port1.onmessage=function(){a.shift()()},function(c){a.push(c),b.port2.postMessage("")}}():b.nextTick=function(a){setTimeout(a,0)};var c={each:function(a,b,c){var d,e=0;if(Array.isArray(a))return d=a.length,{next:function(){return e>=d?!1:b.call(c,a[e],e++,a)}};var f=Object.keys(a);return d=f.length,{next:function(){if(e>=d)return!1;var g=f[e++];return b.call(c,a[g],g,a)}}},repeat:function(a,b,c){var d,e,f;return"object"==typeof a?(d=a.start||0,e=a.step||1,f=a.end):(d=0,e=1,f=a),{next:function(){var a=b.call(c,d);return d+=e,d>=f?!1:a}}},forever:function(a,b){return{next:function(){return a.call(b)}}}},d=function(c){return new Promise(function(d,e){function f(a){a.then(function(a){a===!1?d():g()},function(a){e(a)})}function g(){for(var i,j,k,l,m,n,o,p=Date.now();;){try{if(i=c.next(),i===!1)return void d();if(a(i))return void f(i)}catch(q){return void e(q)}if(n=Date.now(),o=n-p,h+=o,h>1e3)break;if(!(10>o||(j=Math.min(10,Math.floor(o/10)),k=n%(10-j))))break}m=Math.sqrt(o)*Math.min(1e3,o)/80,l=Math.min(1e3,Math.floor(m)),h=0,l>10?setTimeout(g,l):b.nextTick(g)}var h=0;b.nextTick(g)})};return b.each=function(a,b,e){return d(c.each(a,b,e))},b.repeat=function(a,b,e){return d(c.repeat(a,b,e))},b.forever=function(a,b){return d(c.forever(a,b))},b});