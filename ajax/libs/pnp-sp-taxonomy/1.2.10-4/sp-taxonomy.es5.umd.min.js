/**
 * @license
 * v1.2.10-4
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/sp-clientsvc"),require("@pnp/common"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/sp-clientsvc","@pnp/common","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-taxonomy"]={}),e.pnp["sp-clientsvc"],e.pnp.common,e.pnp.sp)}(this,function(e,a,u,t){"use strict";var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var r,i,s,d=function(n){function e(e,t){void 0===e&&(e=""),void 0===t&&(t=null);var r=n.call(this,e,t)||this;return r._objectPaths.add(a.property("Labels")),r}return o(e,n),e.prototype.getByValue=function(e){var t=a.MethodParams.build().string(e);return this.getChild(p,"GetByValue",t)},e.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Value))return t.getByValue(e.Value);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},e}(a.ClientSvcQueryable),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.get=function(){return this.sendGet(t)},t.prototype.setAsDefaultForLanguage=function(){return this.invokeNonQuery("SetAsDefaultForLanguage")},t.prototype.delete=function(){return this.invokeNonQuery("DeleteObject")},t}(a.ClientSvcQueryable),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in Terms.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(c,"GetById",t)},t.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(c,"GetByName",t)},t}(a.ClientSvcQueryable),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.addTerm=function(e,t,r,n){var o=this;void 0===r&&(r=!0),void 0===n&&(n=u.getGUID());var i=a.MethodParams.build().string(e).number(t).string(u.sanitizeGuid(n));return this._useCaching=!1,this.invokeMethod("CreateTerm",i,a.setProperty("IsAvailableForTagging","Boolean",""+r)).then(function(e){return u.extend(o.termSet.getTermById(e.Id),e)})},Object.defineProperty(t.prototype,"terms",{get:function(){return this.getChildProperty(l,"Terms")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labels",{get:function(){return new d(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getChildProperty(t,"Parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pinSourceTermSet",{get:function(){return this.getChildProperty(y,"PinSourceTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reusedTerms",{get:function(){return this.getChildProperty(l,"ReusedTerms")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceTerm",{get:function(){return this.getChildProperty(t,"SourceTerm")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSet",{get:function(){return this.getChildProperty(y,"TermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(h,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.createLabel=function(t,e,r){var n=this;void 0===r&&(r=!1);var o=a.MethodParams.build().string(t).number(e).boolean(r);return this._useCaching=!1,this.invokeMethod("CreateLabel",o).then(function(e){return u.extend(n.labels.getByValue(t),e)})},t.prototype.deprecate=function(e){var t=a.MethodParams.build().boolean(e);return this.invokeNonQuery("Deprecate",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.getDescription=function(e){var t=a.MethodParams.build().number(e);return this.invokeMethodAction("GetDescription",t)},t.prototype.setDescription=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.invokeNonQuery("SetDescription",r)},t.prototype.setLocalCustomProperty=function(e,t){var r=a.MethodParams.build().string(e).string(t);return this.invokeNonQuery("SetLocalCustomProperty",r)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(y,"GetById",t)},t.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(y,"GetByName",t)},t}(a.ClientSvcQueryable),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"group",{get:function(){return this.getChildProperty(g,"Group")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"terms",{get:function(){return this.getChild(l,"GetAllTerms",null)},enumerable:!0,configurable:!0}),t.prototype.addStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("DeleteStakeholder",t)},t.prototype.deleteStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddStakeholder",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(c,"GetTerm",t)},t.prototype.addTerm=function(e,t,r,n){var o=this;void 0===r&&(r=!0),void 0===n&&(n=u.getGUID());var i=a.MethodParams.build().string(e).number(t).string(u.sanitizeGuid(n));return this._useCaching=!1,this.invokeMethod("CreateTerm",i,a.setProperty("IsAvailableForTagging","Boolean",""+r)).then(function(e){return u.extend(o.getTermById(e.Id),e)})},t.prototype.copy=function(){return this.invokeMethod("Copy",null)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in TermGroups.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(g,"GetById",t)},t.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(g,"GetByName",t)},t}(a.ClientSvcQueryable),g=function(n){function t(e,t){void 0===e&&(e="");var r=n.call(this,e,t)||this;return r.store=e instanceof b?e:null,r}return o(t,n),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(h,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.addContributor=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddContributor",t)},t.prototype.addGroupManager=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddGroupManager",t)},t.prototype.createTermSet=function(e,t,r){var n=this;void 0===r&&(r=u.getGUID());var o=a.MethodParams.build().string(e).string(u.sanitizeGuid(r)).number(t);return this._useCaching=!1,this.invokeMethod("CreateTermSet",o).then(function(e){return u.extend(n.store.getTermSetById(e.Id),e)})},t.prototype.get=function(){return this.sendGet(t)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),f=function(r){function e(e){void 0===e&&(e="");var t=r.call(this,e)||this;return t._objectPaths.add(a.property("TermStores",a.objectPath())),t}return o(e,r),e.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in TermStores.get(). You must include at least one of these in your select fields.")})},e.prototype.getByName=function(e){return this.getChild(b,"GetByName",a.MethodParams.build().string(e))},e.prototype.getById=function(e){return this.getChild(b,"GetById",a.MethodParams.build().string(u.sanitizeGuid(e)))},e}(a.ClientSvcQueryable),b=function(r){function t(e,t){return void 0===e&&(e=""),void 0===t&&(t=null),r.call(this,e,t)||this}return o(t,r),Object.defineProperty(t.prototype,"hashTagsTermSet",{get:function(){return this.getChildProperty(y,"HashTagsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keywordsTermSet",{get:function(){return this.getChildProperty(y,"KeywordsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orphanedTermsTermSet",{get:function(){return this.getChildProperty(y,"OrphanedTermsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"systemGroup",{get:function(){return this.getChildProperty(g,"SystemGroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this.getChildProperty(m,"Groups")},enumerable:!0,configurable:!0}),t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermSetsByName=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.getChild(h,"GetTermSetsByName",r)},t.prototype.getTermSetById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(y,"GetTermSet",t)},t.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(c,"GetTerm",t)},t.prototype.getTermsById=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=a.MethodParams.build().strArray(e.map(function(e){return u.sanitizeGuid(e)}));return this.getChild(l,"GetTermsById",r)},t.prototype.getTermInTermSet=function(e,t){var r=a.MethodParams.build().string(u.sanitizeGuid(e)).string(u.sanitizeGuid(t));return this.getChild(c,"GetTermInTermSet",r)},t.prototype.getTermGroupById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(g,"GetGroup",t)},t.prototype.getTerms=function(e){var t=this._objectPaths.copy(),r=t.lastIndex,n=a.objConstructor.apply(void 0,["{61a1d689-2744-4ea3-a88b-c95bee9803aa}",a.objectPath()].concat(a.objectProperties(e))),o=t.add(n),i=a.MethodParams.build().objectPath(o),u=t.add(a.method("GetTerms",i,a.objectPath()));return t.addChildRelationship(r,u),new l(this,t)},t.prototype.getSiteCollectionGroup=function(e){void 0===e&&(e=!1);var t=this._objectPaths.copy(),r=t.lastIndex,n=t.siteIndex,o=a.MethodParams.build().objectPath(n).boolean(e),i=t.add(a.method("GetSiteCollectionGroup",o,a.objectPath()));return t.addChildRelationship(r,i),new g(this,t)},t.prototype.addLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("AddLanguage",t)},t.prototype.addGroup=function(e,t){var r=this;void 0===t&&(t=u.getGUID());var n=a.MethodParams.build().string(e).string(u.sanitizeGuid(t));return this._useCaching=!1,this.invokeMethod("CreateGroup",n).then(function(e){return u.extend(r.getTermGroupById(e.Id),e)})},t.prototype.commitAll=function(){return this.invokeNonQuery("CommitAll")},t.prototype.deleteLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("DeleteLanguage",t)},t.prototype.rollbackAll=function(){return this.invokeNonQuery("RollbackAll")},t.prototype.updateCache=function(){return this.invokeNonQuery("UpdateCache")},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t.prototype.updateUsedTermsOnSite=function(){var e=this._objectPaths.copy(),t=e.lastIndex,r=e.siteIndex,n=a.MethodParams.build().objectPath(r),o=e.add(a.method("UpdateUsedTermsOnSite",n));return e.addChildRelationship(t,o),this.send(e)},t.prototype.getChanges=function(e){var t=this._objectPaths.copy(),r=t.lastIndex,n=t.add(a.objConstructor.apply(void 0,["{1f849fb0-4fcb-4a54-9b01-9152b9e482d3}",a.objectPath()].concat(a.objectProperties(e)))),o=a.MethodParams.build().objectPath(n),i=t.add(a.method("GetChanges",o,a.objectPath(),a.opQuery([],this.getSelects())));return t.addChildRelationship(r,i),this.send(t)},t}(a.ClientSvcQueryable),v=function(r){function e(e){void 0===e&&(e="");var t=r.call(this,e)||this;return t._objectPaths.add(a.staticMethod("GetTaxonomySession","{981cbc68-9edc-4f8d-872f-71146fcbb84f}",a.objectPath())),t}return o(e,r),Object.defineProperty(e.prototype,"termStores",{get:function(){return new f(this)},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){t.sp.setup(e)},e.prototype.createBatch=function(){return new a.ObjectPathBatch(this.toUrl())},e.prototype.getDefaultKeywordTermStore=function(){return this.getChild(b,"GetDefaultKeywordsTermStore",null)},e.prototype.getDefaultSiteCollectionTermStore=function(){return this.getChild(b,"GetDefaultSiteCollectionTermStore",null)},e}(a.ClientSvcQueryable);(r=e.StringMatchOption||(e.StringMatchOption={}))[r.StartsWith=0]="StartsWith",r[r.ExactMatch=1]="ExactMatch",(i=e.ChangedItemType||(e.ChangedItemType={}))[i.Unknown=0]="Unknown",i[i.Term=1]="Term",i[i.TermSet=2]="TermSet",i[i.Group=3]="Group",i[i.TermStore=4]="TermStore",i[i.Site=5]="Site",(s=e.ChangedOperationType||(e.ChangedOperationType={}))[s.Unknown=0]="Unknown",s[s.Add=1]="Add",s[s.Edit=2]="Edit",s[s.DeleteObject=3]="DeleteObject",s[s.Move=4]="Move",s[s.Copy=5]="Copy",s[s.PathChange=6]="PathChange",s[s.Merge=7]="Merge",s[s.ImportObject=8]="ImportObject",s[s.Restore=9]="Restore";var P=new v;e.taxonomy=P,e.Labels=d,e.Label=p,e.Session=v,e.TermGroups=m,e.TermGroup=g,e.Terms=l,e.Term=c,e.TermSets=h,e.TermSet=y,e.TermStores=f,e.TermStore=b,e.setItemMetaDataField=function(e,t,r){if(!u.objectDefinedNotNull(r))return Promise.resolve(null);var n={};return n[t]={Label:r.Name,TermGuid:u.sanitizeGuid(r.Id),WssId:"-1",__metadata:{type:"SP.Taxonomy.TaxonomyFieldValue"}},e.update(n)},e.setItemMetaDataMultiField=function(r,e){for(var n=[],t=2;t<arguments.length;t++)n[t-2]=arguments[t];return n.length<1?Promise.resolve(null):r.list.fields.getByTitle(e+"_0").select("InternalName").get().then(function(e){var t={};return t[e.InternalName]=n.map(function(e){return"-1;#"+e.Name+"|"+u.sanitizeGuid(e.Id)+";#"}).join(""),r.update(t)})},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sp-taxonomy.es5.umd.min.js.map
