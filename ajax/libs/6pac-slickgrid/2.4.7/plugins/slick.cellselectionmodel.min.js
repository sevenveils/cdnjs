!function(w){w.extend(!0,window,{Slick:{CellSelectionModel:function(l){var u,n,o,t=[],c=this;n=void 0===l||void 0===l.cellRangeSelector?new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}):l.cellRangeSelector;var i={selectActiveCell:!0};function f(e){for(var l=[],n=0;n<e.length;n++){var o=e[n];u.canCellBeSelected(o.fromRow,o.fromCell)&&u.canCellBeSelected(o.toRow,o.toCell)&&l.push(o)}return l}function h(e){if(t&&0!==t.length||e&&0!==e.length){var l=!function(e,l){var n=e.length!==l.length;if(!n)for(var o=0;o<e.length;o++)if(e[o].fromCell!==l[o].fromCell||e[o].fromRow!==l[o].fromRow||e[o].toCell!==l[o].toCell||e[o].toRow!==l[o].toRow){n=!0;break}return!n}(t,e);t=f(e),l&&c.onSelectedRangesChanged.notify(t)}}function C(){return t}function r(e,l){if(u.getEditorLock().isActive())return e.stopPropagation(),!1}function a(e,l){u.setActiveCell(l.range.fromRow,l.range.fromCell,!1,!1,!0),h([l.range])}function s(e,l){o.selectActiveCell&&null!=l.row&&null!=l.cell?h([new Slick.Range(l.row,l.cell)]):o.selectActiveCell||h([])}function g(e){var l,n,o=u.getActiveCell(),t=e.ctrlKey||e.metaKey;if(o&&e.shiftKey&&!t&&!e.altKey&&(37==e.which||39==e.which||38==e.which||40==e.which)){(l=C().slice()).length||l.push(new Slick.Range(o.row,o.cell)),(n=l.pop()).contains(o.row,o.cell)||(n=new Slick.Range(o.row,o.cell));var c=n.toRow-n.fromRow,i=n.toCell-n.fromCell,r=o.row==n.fromRow?1:-1,a=o.cell==n.fromCell?1:-1;37==e.which?i-=a:39==e.which?i+=a:38==e.which?c-=r:40==e.which&&(c+=r);var s=new Slick.Range(o.row,o.cell,o.row+r*c,o.cell+a*i);if(f([s]).length){l.push(s);var g=0<r?s.toRow:s.fromRow,w=0<a?s.toCell:s.fromCell;u.scrollRowIntoView(g),u.scrollCellIntoView(g,w)}else l.push(n);h(l),e.preventDefault(),e.stopPropagation()}}w.extend(this,{getSelectedRanges:C,setSelectedRanges:h,init:function(e){o=w.extend(!0,{},i,l),(u=e).getCanvasNode(),u.onActiveCellChanged.subscribe(s),u.onKeyDown.subscribe(g),e.registerPlugin(n),n.onCellRangeSelected.subscribe(a),n.onBeforeCellRangeSelected.subscribe(r)},destroy:function(){u.onActiveCellChanged.unsubscribe(s),u.onKeyDown.unsubscribe(g),n.onCellRangeSelected.unsubscribe(a),n.onBeforeCellRangeSelected.unsubscribe(r),u.unregisterPlugin(n)},pluginName:"CellSelectionModel",onSelectedRangesChanged:new Slick.Event})}}})}(jQuery);