!function(z){z.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(e){var u,w,c,n=null,o=this,t=null,d=[],i=new Slick.EventHandler,l=5,a=0,r={columnId:"_detail_selector",cssClass:"detailView-toggle",expandedClass:null,collapsedClass:null,keyPrefix:"_",loadOnce:!1,collapseAllOnSort:!0,saveDetailViewOnScroll:!0,singleRowExpand:!1,useSimpleViewportCalc:!1,alwaysRenderColumn:!0,toolTip:"",width:30,maxRows:null},p=r.keyPrefix,s=0,g=[],f=z.extend(!0,{},r,e);"function"==typeof f.expandableOverride&&S(f.expandableOverride);function m(e,i){if(e)for(var t=0;t<e.length;t++)if(e[t]===i)return t;return-1}function R(e,i){var t=u.getDataItem(i.row);if(O(i.row,t,u)&&(f.useRowClick||u.getColumns()[i.cell].id===f.columnId&&z(e.target).hasClass(f.cssClass))){if(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();var n=_dataView.getItem(i.row);o.onBeforeRowDetailToggle.notify({grid:u,item:n},e,o),function(e,i){if(!O(e,i,u))return;_dataView.beginUpdate(),t=i,t&&(t[p+"collapsed"]?D(t):y(t)),_dataView.endUpdate();var t}(i.row,n),o.onAfterRowDetailToggle.notify({grid:u,item:n,expandedRows:d},e,o),e.stopPropagation(),e.stopImmediatePropagation()}}function v(e,i){f.useSimpleViewportCalc?function(){if(u){var n=u.getRenderedRange();d.forEach(function(e){var i=_dataView.getRowById(e.id),t=function(e,i){if(Math.abs(i.bottom-s-e)>2*a)return!0;return!1}(i,n);!t&&0<=m(g,e.id)?h(e,e.id):t&&V(e,e.id)})}}():function(){if(u){var o=u.getRenderedRange();if(0<d.length){var a="DOWN";if(t){if(t.top===o.top&&t.bottom===o.bottom)return;(t.top>o.top||0===t.top&&0===o.top&&t.bottom>o.bottom)&&(a="UP")}}d.forEach(function(e){var i=_dataView.getRowById(e.id),t=e[p+"sizePadding"],n=0<=m(g,e.id);"UP"===a?(f.saveDetailViewOnScroll&&i>=o.bottom-s&&C(e),n&&i-l<o.top&&i>=o.top?h(e,e.id):!n&&i+t>o.bottom&&V(e,e.id)):"DOWN"===a&&(f.saveDetailViewOnScroll&&i<=o.top+s&&C(e),n&&i+t+l>o.bottom&&i<i+t?h(e,e.id):!n&&i<o.top&&V(e,e.id))}),t=o}}()}function V(e,i){var t=e.rowIndex||_dataView.getRowById(e.id);o.onRowOutOfViewportRange.notify({grid:u,item:e,rowId:i,rowIndex:t,expandedRows:d,rowIdsOutOfViewport:b(i,!0)},null,o)}function h(e,i){var t=e.rowIndex||_dataView.getRowById(e.id);setTimeout(function(){z(".cellDetailView_"+e.id).length&&o.onRowBackToViewportRange.notify({grid:u,item:e,rowId:i,rowIndex:t,expandedRows:d,rowIdsOutOfViewport:b(i,!1)},null,o)},100)}function b(e,i){var t=m(g,e);return i&&t<0?g.push(e):!i&&0<=t&&g.splice(t,1),g}function x(){_dataView.beginUpdate();for(var e=d.length-1;0<=e;e--)y(d[e],!0);_dataView.endUpdate()}function y(i,e){e||_dataView.beginUpdate(),f.loadOnce&&C(i),i[p+"collapsed"]=!0;for(var t=1;t<=i[p+"sizePadding"];t++)_dataView.deleteItem(i.id+"."+t);i[p+"sizePadding"]=0,_dataView.updateItem(i.id,i),d=d.filter(function(e){return e.id!==i.id}),e||_dataView.endUpdate()}function D(e){if(f&&f.singleRowExpand&&x(),e[p+"collapsed"]=!1,d.push(e),e[p+"detailContent"]||(e[p+"detailViewLoaded"]=!1),e[p+"detailViewLoaded"]&&!0===f.loadOnce)return o.onAsyncResponse.notify({item:e,itemDetail:e,detailView:e[p+"detailContent"]},void 0,this),I(e),void _dataView.updateItem(e.id,e);e[p+"detailContent"]=f.preTemplate(e),I(e),_dataView.updateItem(e.id,e),f.process(e)}function C(e){var i=z("."+c+" .innerDetailView_"+e.id);if(i){var t=z("."+c+" .innerDetailView_"+e.id).html();void 0!==t&&(e[p+"detailContent"]=t)}}var _=function(e,i){var t={};for(var n in u.getData())t[n]=null;return t.id=e.id+"."+i,t[p+"collapsed"]=!0,t[p+"isPadding"]=!0,t[p+"parent"]=e,t[p+"offset"]=i,t};function I(e){var i=f.panelRows;e[p+"sizePadding"]=Math.ceil(2*i*13/w.rowHeight),e[p+"height"]=e[p+"sizePadding"]*w.rowHeight;for(var t=_dataView.getIdxById(e.id),n=1;n<=e[p+"sizePadding"];n++)_dataView.insertItem(t+n,_(e,n))}function P(e,i,t,n,o,a){if(!O(e,o,a))return null;if(null==o[p+"collapsed"]&&(o[p+"collapsed"]=!0,o[p+"sizePadding"]=0,o[p+"height"]=0,o[p+"isPadding"]=!1,o[p+"parent"]=void 0,o[p+"offset"]=0),1==o[p+"isPadding"])return null;if(o[p+"collapsed"]){var d=f.cssClass+" expand ";return f.collapsedClass&&(d+=f.collapsedClass),'<div class="'+d+'"></div>'}var l=[],r=w.rowHeight,s=o[p+"sizePadding"]*w.rowHeight;null!==f.maxRows&&o[p+"sizePadding"]>f.maxRows&&(s=f.maxRows*r,o[p+"sizePadding"]=f.maxRows);var u=f.cssClass+" collapse ";return f.expandedClass&&(u+=f.expandedClass),l.push('<div class="'+u+'"></div></div>'),l.push('<div class="dynamic-cell-detail cellDetailView_',o.id,'" '),l.push('style="height:',s,"px;"),l.push("top:",r,'px">'),l.push('<div class="detail-container detailViewContainer_',o.id,'">'),l.push('<div class="innerDetailView_',o.id,'">',o[p+"detailContent"],"</div></div>"),l.join("")}function O(e,i,t){return"function"!=typeof n||n(e,i,t)}function S(e){n=e}z.extend(this,{init:function(e){if(!e)throw new Error('RowDetailView Plugin requires the Grid instance to be passed as argument to the "init()" method');c=(u=e).getUID(),w=e.getOptions()||{},_dataView=u.getData(),p=f&&f.keyPrefix||"_",s=u.getOptions().minRowBuffer,u.getOptions().minRowBuffer=f.panelRows+3,i.subscribe(u.onClick,R).subscribe(u.onScroll,v),f.collapseAllOnSort&&(i.subscribe(u.onSort,x),d=[],g=[]);i.subscribe(u.getData().onRowCountChanged,function(){u.updateRowCount(),u.render()}),i.subscribe(u.getData().onRowsChanged,function(e,i){u.invalidateRows(i.rows),u.render()}),o.onAsyncResponse.subscribe(function(e,i){if(!i||!i.item&&!i.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.item" property.';var t=i.item||i.itemDetail;i.detailView?t[p+"detailContent"]=i.detailView:t[p+"detailContent"]=f.postTemplate(t),t[p+"detailViewLoaded"]=!0,_dataView.updateItem(t.id,t),o.onAsyncEndUpdate.notify({grid:u,item:t,itemDetail:t},e,o)}),f.useSimpleViewportCalc&&i.subscribe(u.onRendered,function(e,i){i&&i.endRow&&(a=i.endRow-i.startRow)})},destroy:function(){i.unsubscribeAll(),o.onAsyncResponse.unsubscribe(),o.onAsyncEndUpdate.unsubscribe(),o.onAfterRowDetailToggle.unsubscribe(),o.onBeforeRowDetailToggle.unsubscribe(),o.onRowOutOfViewportRange.unsubscribe(),o.onRowBackToViewportRange.unsubscribe()},pluginName:"RowDetailView",collapseAll:x,collapseDetailView:y,expandDetailView:D,expandableOverride:S,getColumnDefinition:function(){return{id:f.columnId,name:"",toolTip:f.toolTip,field:"sel",width:f.width,resizable:!1,sortable:!1,alwaysRenderColumn:f.alwaysRenderColumn,cssClass:f.cssClass,formatter:P}},getExpandedRows:function(){return d},getFilterItem:function(e){e[p+"isPadding"]&&e[p+"parent"]&&(e=e[p+"parent"]);return e},getOptions:function(){return f},resizeDetailView:function(e){if(!e)return;var i=document.querySelector("."+c+" .detailViewContainer_"+e.id),t=document.querySelector("."+c+" .cellDetailView_"+e.id),n=document.querySelector("."+c+" .innerDetailView_"+e.id);if(!i||!t||!n)return;for(var o=1;o<=e[p+"sizePadding"];o++)_dataView.deleteItem(e.id+"."+o);var a=w.rowHeight;i.style.minHeight=null;var d=i.scrollHeight,l=Math.ceil(d/a);e[p+"sizePadding"]=Math.ceil(2*l*13/a),e[p+"height"]=d;var r=e[p+"sizePadding"]*a;null!==f.maxRows&&e[p+"sizePadding"]>f.maxRows&&(r=f.maxRows*a,e[p+"sizePadding"]=f.maxRows);u.getOptions().minRowBuffer<e[p+"sizePadding"]&&(u.getOptions().minRowBuffer=e[p+"sizePadding"]+3);i.setAttribute("style","min-height: "+e[p+"height"]+"px"),t&&t.setAttribute("style","height: "+r+"px; top:"+a+"px");for(var s=_dataView.getIdxById(e.id),o=1;o<=e[p+"sizePadding"];o++)_dataView.insertItem(s+o,_(e,o));C(e)},saveDetailView:C,setOptions:function(e){(f=z.extend(!0,{},f,e))&&f.singleRowExpand&&x()},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,onRowOutOfViewportRange:new Slick.Event,onRowBackToViewportRange:new Slick.Event})}}}})}(jQuery);