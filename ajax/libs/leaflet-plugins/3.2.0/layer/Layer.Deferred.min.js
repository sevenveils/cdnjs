L.DeferredLayer=L.LayerGroup.extend({options:{js:[],init:null},_script_cache:{},initialize:function(t){L.Util.setOptions(this,t),L.LayerGroup.prototype.initialize.apply(this),this._loaded=!1},onAdd:function(t){if(L.LayerGroup.prototype.onAdd.apply(this,[t]),!this._loaded){this._loadScripts(this.options.js.reverse(),L.Util.bind(function(){this._loaded=!0;var t=this.options.init();t&&this.addLayer(t)},this))}},_loadScripts:function(t,i,e){if(!t||0===t.length)return i(e);var a,o=this,n=t.pop();if(void 0===(a=this._script_cache[n])){a={url:n,wait:[]};var r=document.createElement("script");r.src=n,r.type="text/javascript",r.onload=function(){a.e.readyState="completed";var t=0;for(t=0;t<a.wait.length;t++)a.wait[t]()},a.e=r,document.getElementsByTagName("head")[0].appendChild(r)}function s(){o._loadScripts(t,i,e)}a.wait.push(s),"completed"===a.e.readyState&&s(),this._script_cache[n]=a}});