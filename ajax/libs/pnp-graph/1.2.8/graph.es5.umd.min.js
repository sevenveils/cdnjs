/**
 * @license
 * v1.2.8
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@pnp/common"),require("@pnp/odata"),require("@pnp/logging")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/odata","@pnp/logging"],e):e((t.pnp=t.pnp||{},t.pnp.graph={}),t.pnp.common,t.pnp.odata,t.pnp.logging)}(this,function(u,c,r,a){"use strict";var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(u=(i<3?o(u):3<i?o(e,n,u):o(e,n))||u);return 3<i&&u&&Object.defineProperty(e,n,u),u}var l=new(function(){function t(){}return Object.defineProperty(t.prototype,"headers",{get:function(){var t=c.RuntimeConfig.get("graph");return null!=t&&void 0!==t.headers?t.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClientFactory",{get:function(){var t=c.RuntimeConfig.get("graph");if(null!=t&&void 0!==t.fetchClientFactory)return t.fetchClientFactory;if(void 0!==c.RuntimeConfig.spfxContext)return function(){return c.AdalClient.fromSPFxContext(c.RuntimeConfig.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),t}()),f=function(){function t(){this._impl=l.fetchClientFactory()}return t.prototype.fetch=function(t,e){void 0===e&&(e={});var n=new Headers;c.mergeHeaders(n,l.headers),c.mergeHeaders(n,e.headers),n.has("Content-Type")||n.append("Content-Type","application/json");var r=c.extend(e,{headers:n});return this.fetchRaw(t,r)},t.prototype.fetchRaw=function(t,e){var r=this;void 0===e&&(e={});var n=new Headers;c.mergeHeaders(n,e.headers),e=c.extend(e,{headers:n});var o=function(n){r._impl.fetch(t,e).then(function(t){return n.resolve(t)}).catch(function(t){429!==t.status&&503!==t.status&&n.reject(t);var e=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(t),setTimeout(c.getCtxCallback(r,o,n),e)})};return new Promise(function(t,e){var n={attempts:0,delay:100,reject:e,resolve:t,retryCount:7};o.call(r,n)})},t.prototype.get=function(t,e){void 0===e&&(e={});var n=c.extend(e,{method:"GET"});return this.fetch(t,n)},t.prototype.post=function(t,e){void 0===e&&(e={});var n=c.extend(e,{method:"POST"});return this.fetch(t,n)},t.prototype.patch=function(t,e){void 0===e&&(e={});var n=c.extend(e,{method:"PATCH"});return this.fetch(t,n)},t.prototype.delete=function(t,e){void 0===e&&(e={});var n=c.extend(e,{method:"DELETE"});return this.fetch(t,n)},t}(),e=function(){function i(){}return i.ensure=function(t,e){var n=[i.Beta,i.V1],r=new RegExp(e,"i"),o=n.filter(function(t){return!r.test(t)}).map(function(t){return t.replace(".","\\.")});return r=new RegExp("/?("+o.join("|")+")/","ig"),t.replace(r,"/"+e+"/")},i.Beta="beta",i.V1="v1.0",i}(),t=function(o){function t(t,e){var n=o.call(this)||this;if("string"==typeof t){var r=t;n._parentUrl=r,n._url=c.combine(r,e)}else n.extend(t,e);return n}return i(t,o),t.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this.query.set("$select",t.join(",")),this},t.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0<t.length&&this.query.set("$expand",t.join(",")),this},t.prototype.as=function(t){var e=new t(this._url,null);return c.extend(e,this,!0)},t.prototype.toUrlAndQuery=function(){var t=this.toUrl();if(c.isUrlAbsolute(t)||(t=c.combine("https://graph.microsoft.com",t)),0<this.query.size){var e=-1<t.indexOf("?")?"&":"?";t+=""+e+Array.from(this.query).map(function(t){return t[0]+"="+t[1]}).join("&")}return t},t.prototype.getParent=function(t,e,n){return void 0===e&&(e=this.parentUrl),new t(e,n)},t.prototype.clone=function(t,e,n){return void 0===n&&(n=!0),o.prototype._clone.call(this,new t(this,e),{includeBatch:n})},t.prototype.setEndpoint=function(t){return this._url=e.ensure(this._url,t),this},t.prototype.toRequestContext=function(t,e,n,r){void 0===e&&(e={});var o=this.hasBatch?this._batchDependency:function(){};return Promise.resolve({batch:this.batch,batchDependency:o,cachingOptions:this._cachingOptions,clientFactory:function(){return new f},isBatched:this.hasBatch,isCached:/^get$/i.test(t)&&this._useCaching,options:e,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:c.getGUID(),verb:t})},t}(r.ODataQueryable),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.filter=function(t){return this.query.set("$filter",t),this},e.prototype.orderBy=function(t,e){void 0===e&&(e=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(t+" "+(e?"asc":"desc")),this.query.set(n,r.join(",")),this},e.prototype.top=function(t){return this.query.set("$top",t.toString()),this},e.prototype.skip=function(t){return this.query.set("$skip",t.toString()),this},e.prototype.skipToken=function(t){return this.query.set("$skiptoken",t),this},Object.defineProperty(e.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),e}(t),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.search=function(t){return this.query.set("$search",t),this},e}(n),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(t);function y(r){return function(t){return function(n){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.call(this,t[0],1<t.length&&void 0!==t[1]?t[1]:r)||this}return i(t,n),t}(t)}}var d,b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return i(e,t),(n=e).prototype.add=function(t){return this.clone(n,"$ref").postCore({body:c.jsS({"@odata.id":t})})},e.prototype.getById=function(t){return new g(this,t)},e=n=s([y("members")],e)}(n),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(h),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("owners")],e)}(b),v=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}i(e,t),e=s([y("calendars")],e)}(n),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return new j(this)},enumerable:!0,configurable:!0}),e}(h)),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new w(this,t)},e.prototype.add=function(t){var e=this;return this.postCore({body:c.jsS(t)}).then(function(t){return{data:t,event:e.getById(t.id)}})},e=s([y("events")],e)}(n),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(h),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new O(this,t)},e.prototype.addFile=function(t,e){return this.postCore({body:c.jsS({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:e,name:t})})},e=s([y("attachments")],e)}(n),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(h),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.add=function(t){return this.postCore({body:c.jsS(t)})},e.prototype.getById=function(t){return new B(this,t)},e=s([y("conversations")],e)}(n),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new x(this,t)},e.prototype.add=function(t){return this.postCore({body:c.jsS(t)})},e=s([y("threads")],e)}(n),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new T(this,t)},e.prototype.add=function(t){return this.postCore({body:c.jsS(t)})},e=s([y("posts")],e)}(n),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"threads",{get:function(){return new S(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(h),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"posts",{get:function(){return new I(this)},enumerable:!0,configurable:!0}),e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:c.jsS({post:t})})},e.prototype.delete=function(){return this.deleteCore()},e}(h),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"attachments",{get:function(){return new C(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.forward=function(t){return this.clone(e,"forward").postCore({body:c.jsS(t)})},e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:c.jsS({post:t})})},e}(h),k=function(n){function r(t,e){return n.call(this,t,e)||this}return i(r,n),r.prototype.add=function(t){return this.clone(r,"$ref").postCore({body:c.jsS({"@odata.id":t})})},r.prototype.remove=function(t){var e=this.clone(r,"$ref");return e.query.set("$id",t),e.deleteCore()},r}(n),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"plans",{get:function(){return new G(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tasks",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buckets",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),e=s([y("planner")],e)}(h),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new R(this,t)},e.prototype.add=function(t,e){var n=this,r={owner:t,title:e};return this.postCore({body:c.jsS(r)}).then(function(t){return{data:t,plan:n.getById(t.id)}})},e=s([y("plans")],e)}(n),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"tasks",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buckets",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"details",{get:function(){return new A(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e}(h),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new M(this,t)},e.prototype.add=function(t,e,n,r){var o=this,i=c.extend({planId:t,title:e},n);return r&&(i=c.extend(i,{bucketId:r})),this.postCore({body:c.jsS(i)}).then(function(t){return{data:t,task:o.getById(t.id)}})},e=s([y("tasks")],e)}(n),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},Object.defineProperty(e.prototype,"details",{get:function(){return new A(this)},enumerable:!0,configurable:!0}),e}(h),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.add=function(t,e,n){var r=this,o={name:t,orderHint:n||"",planId:e};return this.postCore({body:c.jsS(o)}).then(function(t){return{bucket:r.getById(t.id),data:t}})},e.prototype.getById=function(t){return new _(this,t)},e=s([y("buckets")],e)}(n),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},Object.defineProperty(e.prototype,"tasks",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),e}(h),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("details")],e)}(n),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return i(e,t),(n=e).prototype.getBlob=function(){return this.clone(n,"$value",!1).get(new r.BlobParser)},e.prototype.getBuffer=function(){return this.clone(n,"$value",!1).get(new r.BufferParser)},e.prototype.setContent=function(t){return this.clone(n,"$value",!1).patchCore({body:t})},e=n=s([y("photo")],e)}(h),U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.create=function(t,e,n,r){void 0===e&&(e=""),void 0===r&&(r={});var o={description:e&&0<e.length?e:"","owners@odata.bind":["https://graph.microsoft.com/v1.0/users/"+n]};return Tt.groups.add(t,t,u.GroupType.Office365,o).then(function(e){return e.group.createTeam(r).then(function(t){return{data:t,group:e.group,team:new $(e.group)}})})},e.prototype.getById=function(t){return new $(this,t)},e=s([y("teams")],e)}(n),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var u;return i(e,t),u=e,Object.defineProperty(e.prototype,"channels",{get:function(){return new N(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"installedApps",{get:function(){return new H(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){var e=this;return this.clone(u,"").patchCore({body:c.jsS(t)}).then(function(t){return{data:t,team:e}})},e.prototype.archive=function(t){var e,n=this;return null!=t&&(e=c.extend(e,{shouldSetSpoSiteReadOnlyForMembers:t})),this.clone(u,"archive").postCore({body:c.jsS(e)}).then(function(t){return{data:t,team:n}})},e.prototype.unarchive=function(){var e=this;return this.clone(u,"unarchive").postCore({}).then(function(t){return{data:t,team:e}})},e.prototype.cloneTeam=function(t,e,n,r){var o=this;void 0===e&&(e="");var i={description:e||"",displayName:t,mailNickname:t,partsToClone:n,visibility:r};return this.clone(u,"clone").postCore({body:c.jsS(i)}).then(function(t){return{data:t,team:o}})},e.prototype.get=function(t,e){return void 0===t&&(t=new r.ODataDefaultParser),void 0===e&&(e={}),this.clone(u,"").getCore(t,e)},e=u=s([y("team")],e)}(h),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.create=function(t,e){var n=this;void 0===e&&(e="");var r={description:e&&0<e.length?e:"",displayName:t};return this.postCore({body:c.jsS(r)}).then(function(t){return{channel:n.getById(t.id),data:t}})},e.prototype.getById=function(t){return new L(this,t)},e=s([y("channels")],e)}(n),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"tabs",{get:function(){return new Q(this)},enumerable:!0,configurable:!0}),e}(h),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.add=function(t){var e={"teamsApp@odata.bind":t};return this.postCore({body:c.jsS(e)}).then(function(t){return{data:t}})},e.prototype.remove=function(){return this.deleteCore()},e=s([y("installedApps")],e)}(n),Q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.add=function(t,e,n){var r=this,o=c.extend({name:t,"teamsApp@odata.bind":e},n);return this.postCore({body:c.jsS(o)}).then(function(t){return{data:t,tab:r.getById(t.id)}})},e.prototype.getById=function(t){return new V(this,t)},e=s([y("tabs")],e)}(n),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return i(e,t),(n=e).prototype.update=function(t){var e=this;return this.clone(n,"").patchCore({body:c.jsS(t)}).then(function(t){return{data:t,tab:e}})},e.prototype.remove=function(){return this.deleteCore()},e=n=s([y("tab")],e)}(h);(d=u.GroupType||(u.GroupType={}))[d.Office365=0]="Office365",d[d.Dynamic=1]="Dynamic",d[d.Security=2]="Security";var W,z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new J(this,t)},e.prototype.add=function(t,e,n,r){var o=this;void 0===r&&(r={});var i=c.extend({displayName:t,mailEnabled:n===u.GroupType.Office365,mailNickname:e,securityEnabled:n!==u.GroupType.Office365},r);return n!==u.GroupType.Security&&(i=c.extend(i,{groupTypes:n===u.GroupType.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:c.jsS(i)}).then(function(t){return{data:t,group:o.getById(t.id)}})},e=s([y("groups")],e)}(n),J=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return i(r,t),Object.defineProperty(r.prototype,"calendar",{get:function(){return new v(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"events",{get:function(){return new j(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"owners",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"plans",{get:function(){return new G(this,"planner/plans")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"members",{get:function(){return new b(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"conversations",{get:function(){return new P(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"acceptedSenders",{get:function(){return new k(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rejectedSenders",{get:function(){return new k(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"photo",{get:function(){return new E(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"team",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),r.prototype.addFavorite=function(){return this.clone(r,"addFavorite").postCore()},r.prototype.createTeam=function(t){return this.clone(r,"team").putCore({body:c.jsS(t)})},r.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(r,"getMemberObjects").postCore({body:c.jsS({securityEnabledOnly:t})})},r.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(r,"getMemberGroups").postCore({body:c.jsS({securityEnabledOnly:t})})},r.prototype.checkMemberGroups=function(t){return this.clone(r,"checkMemberGroups").postCore({body:c.jsS({groupIds:t})})},r.prototype.delete=function(){return this.deleteCore()},r.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},r.prototype.removeFavorite=function(){return this.clone(r,"removeFavorite").postCore()},r.prototype.resetUnseenCount=function(){return this.clone(r,"resetUnseenCount").postCore()},r.prototype.subscribeByMail=function(){return this.clone(r,"subscribeByMail").postCore()},r.prototype.unsubscribeByMail=function(){return this.clone(r,"unsubscribeByMail").postCore()},r.prototype.getCalendarView=function(t,e){var n=this.clone(r,"calendarView");return n.query.set("startDateTime",t.toISOString()),n.query.set("endDateTime",e.toISOString()),n.get()},r}(h),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new X(this,t)},e.prototype.add=function(t,e,n,r,o){var i=this;void 0===o&&(o={});var u=c.extend({businessPhones:r,emailAddresses:n,givenName:t,surName:e},o);return this.postCore({body:c.jsS(u)}).then(function(t){return{contact:i.getById(t.id),data:t}})},e=s([y("contacts")],e)}(n),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e}(h),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new Z(this,t)},e.prototype.add=function(t,e){var n=this,r={displayName:t,parentFolderId:e};return this.postCore({body:c.jsS(r)}).then(function(t){return{contactFolder:n.getById(t.id),data:t}})},e=s([y("contactFolders")],e)}(n),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"contacts",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childFolders",{get:function(){return new Y(this,"childFolders")},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e}(h),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"notebooks",{get:function(){return new et(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sections",{get:function(){return new rt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pages",{get:function(){return new it(this)},enumerable:!0,configurable:!0}),e=s([y("onenote")],e)}(h),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new nt(this,t)},e.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:c.jsS(n)}).then(function(t){return{data:t,notebook:e.getById(t.id)}})},e=s([y("notebooks")],e)}(n),nt=function(n){function t(t,e){return n.call(this,t,e)||this}return i(t,n),Object.defineProperty(t.prototype,"sections",{get:function(){return new rt(this)},enumerable:!0,configurable:!0}),t}(h),rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new ot(this,t)},e.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:c.jsS(n)}).then(function(t){return{data:t,section:e.getById(t.id)}})},e=s([y("sections")],e)}(n),ot=function(n){function t(t,e){return n.call(this,t,e)||this}return i(t,n),t}(h),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("pages")],e)}(n),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new st(this,t)},e=s([y("drives")],e)}(n),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return new pt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return new ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return new ft(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recent",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedWithMe",{get:function(){return new yt(this)},enumerable:!0,configurable:!0}),e=s([y("drive")],e)}(h),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),e.prototype.search=function(t){return new dt(this,"search(q='"+t+"')")},e=s([y("root")],e)}(h),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new at(this,t)},e=s([y("items")],e)}(n),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnails",{get:function(){return new bt(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e.prototype.move=function(t,e){var n=c.extend({},t);return e&&(n=c.extend({},e)),this.patchCore({body:c.jsS(n)})},e}(h),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.add=function(t,e){var n=this,r=c.extend({name:t},e);return this.postCore({body:c.jsS(r)}).then(function(t){return{data:t,driveItem:new at(n,t.id)}})},e=s([y("children")],e)}(n),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("list")],e)}(n),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("recent")],e)}(h),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("sharedWithMe")],e)}(h),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("search")],e)}(h),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e=s([y("thumbnails")],e)}(h),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new mt(this,t)},e.prototype.add=function(t){return this.postCore({body:c.jsS(t)})},e=s([y("messages")],e)}(n),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(h),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new jt(this,t)},e.prototype.add=function(t){return this.postCore({body:c.jsS(t)})},e=s([y("mailFolders")],e)}(n),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(h),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e=s([y("mailboxSettings")],e)}(h);(W=u.DirectoryObjectType||(u.DirectoryObjectType={}))[W.directoryObject=0]="directoryObject",W[W.user=1]="user",W[W.group=2]="group",W[W.device=3]="device";var Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return i(e,t),(n=e).prototype.getById=function(t){return new Ot(this,t)},e.prototype.getByIds=function(t,e){return void 0===e&&(e=u.DirectoryObjectType.directoryObject),this.clone(n,"getByIds").postCore({body:c.jsS({ids:t,type:e})})},e=n=s([y("directoryObjects")],e)}(n),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberObjects").postCore({body:c.jsS({securityEnabledOnly:t})})},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:c.jsS({securityEnabledOnly:t})})},e.prototype.checkMemberGroups=function(t){return this.clone(e,"checkMemberGroups").postCore({body:c.jsS({groupIds:t})})},e}(h),Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getById=function(t){return new St(this,t)},e=s([y("users")],e)}(n),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e.prototype,"onenote",{get:function(){return new tt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contacts",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"joinedTeams",{get:function(){return new U(this,"joinedTeams")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberOf",{get:function(){return new Ct(this,"memberOf")},enumerable:!0,configurable:!0}),e.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberObjects").postCore({body:c.jsS({securityEnabledOnly:t})})},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:c.jsS({securityEnabledOnly:t})})},e.prototype.checkMemberGroups=function(t){return this.clone(e,"checkMemberGroups").postCore({body:c.jsS({groupIds:t})})},Object.defineProperty(e.prototype,"contactFolders",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drive",{get:function(){return new st(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drives",{get:function(){return new ut(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tasks",{get:function(){return new D(this,"planner/tasks")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messages",{get:function(){return new gt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailboxSettings",{get:function(){return new wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailFolders",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:c.jsS(t)})},e.prototype.delete=function(){return this.deleteCore()},e.prototype.sendMail=function(t){return this.clone(e,"sendMail").postCore({body:c.jsS(t)})},e}(h),It=function(r){function p(t,e){void 0===t&&(t="https://graph.microsoft.com/v1.0/$batch"),void 0===e&&(e=20);var n=r.call(this)||this;return n.batchUrl=t,n.maxRequests=e,n}return i(p,r),p.makeUrlRelative=function(t){if(!c.isUrlAbsolute(t))return t;var e=t.indexOf(".com/v1.0/");return e<0?-1<(e=t.indexOf(".com/beta/"))?t.substr(e+10):t:t.substr(e+9)},p.formatRequests=function(t){var o=this;return t.map(function(t,e){var n={id:""+ ++e,method:t.method,url:o.makeUrlRelative(t.url)},r={};return void 0!==l.headers&&null!==l.headers&&(r=c.extend(r,l.headers)),void 0!==t.options&&(void 0!==t.options.headers&&null!==t.options.headers&&(r=c.extend(r,t.options.headers)),void 0!==t.options.body&&null!==t.options.body&&(n=c.extend(n,{body:t.options.body}))),n=c.extend(n,{headers:r})})},p.parseResponse=function(i,u){return new Promise(function(t){for(var e=new Array(i.length).fill(null),n=0;n<u.responses.length;++n){var r=u.responses[n],o=parseInt(r.id,10)-1;204===r.status?e[o]=new Response:e[o]=new Response(JSON.stringify(r.body),r)}t({nextLink:u.nextLink,responses:e})})},p.prototype.executeImpl=function(){var i=this;if(a.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return a.Logger.write("Resolving empty batch.",1),Promise.resolve();for(var n=new f,r=this.requests.slice(),u=Promise.resolve(),t=function(){var o=r.splice(0,s.maxRequests),t={requests:p.formatRequests(o)},e={body:c.jsS(t),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};a.Logger.write("["+s.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),n.fetch(s.batchUrl,e).then(function(t){return t.json()}).then(function(t){return p.parseResponse(o,t)}).then(function(t){a.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.responses.reduce(function(t,e,n){var r=o[n];return a.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+r.method+" "+r.url+".",0),t.then(function(t){return r.parser.parse(e).then(r.resolve).catch(r.reject)})},u)})},s=this;0<r.length;)t();return u},p}(r.ODataBatch),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.create=function(t,e,n){void 0===n&&(n={});var r=c.extend({inviteRedirectUrl:e,invitedUserEmailAddress:t},n);return this.postCore({body:c.jsS(r)}).then(function(t){return{data:t}})},e=s([y("invitations")],e)}(n),xt=function(n){function t(t,e){return n.call(this,t,e)||this}return i(t,n),Object.defineProperty(t.prototype,"directoryObjects",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teams",{get:function(){return new U(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return new St(this,"me")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"planner",{get:function(){return new q(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"users",{get:function(){return new Pt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invitations",{get:function(){return new Bt(this)},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new It},t.prototype.setup=function(t){var e;e=t,c.RuntimeConfig.extend(e)},t}(t),Tt=new xt("v1.0");u.graph=Tt,u.GraphRest=xt,u.Group=J,u.Groups=z,u.GraphBatch=It,u.GraphQueryable=t,u.GraphQueryableCollection=n,u.GraphQueryableInstance=h,u.GraphQueryableSearchableCollection=p,u.Teams=U,u.Team=$,u.Channels=N,u.Channel=L,u.Apps=H,u.Tabs=Q,u.Tab=V,u.GraphEndpoints=e,u.OneNote=tt,u.Notebooks=et,u.Notebook=nt,u.Sections=rt,u.Section=ot,u.Pages=it,u.Contacts=K,u.Contact=X,u.ContactFolders=Y,u.ContactFolder=Z,u.Drives=ut,u.Drive=st,u.Root=pt,u.DriveItems=ct,u.DriveItem=at,u.Children=lt,u.DriveList=ft,u.Recent=ht,u.SharedWithMe=yt,u.DriveSearch=dt,u.Thumbnails=bt,u.Planner=q,u.Plans=G,u.Plan=R,u.Tasks=D,u.Task=M,u.Buckets=F,u.Bucket=_,u.Details=A,u.DirectoryObjects=Ct,u.DirectoryObject=Ot,u.Invitations=Bt,Object.defineProperty(u,"__esModule",{value:!0})});
//# sourceMappingURL=graph.es5.umd.min.js.map
