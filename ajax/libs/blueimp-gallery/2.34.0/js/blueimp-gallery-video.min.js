!function(e){"use strict";"function"==typeof define&&define.amd?define(["./blueimp-helper","./blueimp-gallery"],e):e(window.blueimp.helper||window.jQuery,window.blueimp.Gallery)}(function(f,e){"use strict";f.extend(e.prototype.options,{videoContentClass:"video-content",videoLoadingClass:"video-loading",videoPlayingClass:"video-playing",videoPosterProperty:"poster",videoSourcesProperty:"sources"});var t=e.prototype.handleSlide;return f.extend(e.prototype,{handleSlide:function(e){t.call(this,e),this.playingVideo&&this.playingVideo.pause()},videoFactory:function(e,t,o){var i,s,n,r,a,l=this,p=this.options,d=this.elementPrototype.cloneNode(!1),y=f(d),c=[{type:"error",target:d}],u=o||document.createElement("video"),g=this.getItemProperty(e,p.urlProperty),h=this.getItemProperty(e,p.typeProperty),m=this.getItemProperty(e,p.titleProperty),C=this.getItemProperty(e,this.options.altTextProperty)||m,P=this.getItemProperty(e,p.videoPosterProperty),v=this.getItemProperty(e,p.videoSourcesProperty);if(y.addClass(p.videoContentClass),m&&(d.title=m),u.canPlayType)if(g&&h&&u.canPlayType(h))u.src=g;else if(v)for(;v.length;)if(s=v.shift(),g=this.getItemProperty(s,p.urlProperty),h=this.getItemProperty(s,p.typeProperty),g&&h&&u.canPlayType(h)){u.src=g;break}return P&&(u.poster=P,i=this.imagePrototype.cloneNode(!1),f(i).addClass(p.toggleClass),i.src=P,i.draggable=!1,i.alt=C,d.appendChild(i)),(n=document.createElement("a")).setAttribute("target","_blank"),o||n.setAttribute("download",m),n.href=g,u.src&&(u.controls=!0,(o||f(u)).on("error",function(){l.setTimeout(t,c)}).on("pause",function(){u.seeking||(r=!1,y.removeClass(l.options.videoLoadingClass).removeClass(l.options.videoPlayingClass),a&&l.container.addClass(l.options.controlsClass),delete l.playingVideo,l.interval&&l.play())}).on("playing",function(){r=!1,y.removeClass(l.options.videoLoadingClass).addClass(l.options.videoPlayingClass),l.container.hasClass(l.options.controlsClass)?(a=!0,l.container.removeClass(l.options.controlsClass)):a=!1}).on("play",function(){window.clearTimeout(l.timeout),r=!0,y.addClass(l.options.videoLoadingClass),l.playingVideo=u}),f(n).on("click",function(e){l.preventDefault(e),r?u.pause():u.play()}),d.appendChild(o&&o.element||u)),d.appendChild(n),this.setTimeout(t,[{type:"load",target:d}]),d}}),e});