/**
 * @license
 * v1.2.8
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";var r=n(1),o=n(5),i=n(2),u=n(7);function s(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.hostname}var a=function(e){function t(t,n,r){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=n,o.redirectUri=r,o._displayCallback=null,o._loginPromise=null,o}return r.c(t,e),t.fromSPFxContext=function(e){return new c(e)},t.prototype.fetch=function(t,n){var r=this;if(!Object(i.l)(t))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(s(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){var n=this;return new Promise(function(r,o){n.ensureAuthContext().then(function(e){return n.login()}).then(function(n){t._authContext.acquireToken(e,function(e,t){if(e)return o(Error(e));r(t)})}).catch(o)})},t.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(n){null===t._authContext&&(t._authContext=u.inject({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),n()})},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(n,r){if(t._authContext.getCachedUser())return n();e._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return r(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var u=window.setInterval(function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(u);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(u),t._authContext.handleWindowCallback(i.location.hash),i.close(),n())}catch(e){r(e)}},30)},e.ensureAuthContext().then(function(n){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null})}),this._loginPromise)},t._authContext=null,t}(o.a),c=function(e){function t(t){var n=e.call(this,null)||this;return n.context=t,n}return r.c(t,e),t.prototype.fetch=function(t,n){var r=this;return this.getToken(s(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){return this.context.aadTokenProviderFactory.getTokenProvider().then(function(t){return t.getToken(e)})},t}(o.a),l=Object(i.k)(Object.entries)?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})};function p(e){return void 0!==e&&null!==e?new Map(l(e)):new Map}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)t[r].forEach(function(t,n){e.set(n,t)});return e}var h=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"],f=function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(h[0],"session"),this._v.set(h[1],60),this._v.set(h[2],!1),this._v.set(h[3],!1),this._v.set(h[4],750),this._v.set(h[5],null)}return e.prototype.extend=function(e){this._v=d(this._v,p(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(h[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(h[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(h[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(h[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(h[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(h[5])},enumerable:!0,configurable:!0}),e}(),y=new f,g=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),y.enableCacheExpiration&&this.cacheExpirationHandler()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!Object(i.n)(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(o){var i=r.get(e);null==i?t().then(function(t){r.put(e,t,n),o(t)}):o(i)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=y.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=Object(i.b)(new Date,"second",n)}return Object(i.m)({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.deleteExpired().then(function(t){setTimeout(Object(i.e)(e,e.cacheExpirationHandler),y.cacheExpirationIntervalMilliseconds)}).catch(function(e){console.error(e)})},e}(),b=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),m=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=this.getStore("local")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=this.getStore("session")),this._session},enumerable:!0,configurable:!0}),e.prototype.getStore=function(e){return new g("local"===e?"undefined"==typeof localStorage?new b:localStorage:"undefined"==typeof sessionStorage?new b:sessionStorage)},e}();n.d(t,"a",function(){return a}),n.d(t,"h",function(){return c}),n.d(t,"z",function(){return p}),n.d(t,"w",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return y}),n.d(t,"v",function(){return o.c}),n.d(t,"x",function(){return o.d}),n.d(t,"c",function(){return o.b}),n.d(t,"b",function(){return o.a}),n.d(t,"e",function(){return g}),n.d(t,"d",function(){return m}),n.d(t,"m",function(){return i.e}),n.d(t,"j",function(){return i.b}),n.d(t,"i",function(){return i.a}),n.d(t,"p",function(){return i.h}),n.d(t,"n",function(){return i.f}),n.d(t,"s",function(){return i.k}),n.d(t,"y",function(){return i.n}),n.d(t,"r",function(){return i.j}),n.d(t,"k",function(){return i.c}),n.d(t,"t",function(){return i.l}),n.d(t,"B",function(){return i.p}),n.d(t,"l",function(){return i.d}),n.d(t,"A",function(){return i.o}),n.d(t,"u",function(){return i.m}),n.d(t,"q",function(){return i.i}),n.d(t,"o",function(){return i.g})},function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return s});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u}function u(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{a(r.next(e))}catch(e){i(e)}}function s(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,s)}a((r=r.apply(e,t||[])).next())})}function s(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}},function(e,t,n){"use strict";function r(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function o(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!h(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function u(e){for(var t=new Array(e),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t[r]=n.charAt(Math.floor(Math.random()*n.length));return t.join("")}function s(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function a(e){return"function"==typeof e}function c(e){return void 0!==e&&null!==e}function l(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function p(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!c(t))return e;var o=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return o(e,t)&&r(t)}).reduce(function(e,n){return e[n]=t[n],e},e)}function d(e){return/^https?:\/\/|^\/\//i.test(e)}function h(e){return void 0===e||null===e||e.length<1}function f(e,t){e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");var n=new RegExp(t+"\\s*?=\\s*?(\"|')([^\\1]*?)\\1","i").exec(e);return null!==n&&n.length>0?n[2]:null}function y(e){if(h(e))return e;var t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function g(e){return JSON.stringify(e)}function b(e,t){return Object.hasOwnProperty.call(e,t)}function m(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}n.d(t,"e",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"k",function(){return a}),n.d(t,"n",function(){return c}),n.d(t,"j",function(){return l}),n.d(t,"c",function(){return p}),n.d(t,"l",function(){return d}),n.d(t,"p",function(){return h}),n.d(t,"d",function(){return f}),n.d(t,"o",function(){return y}),n.d(t,"m",function(){return g}),n.d(t,"i",function(){return b}),n.d(t,"g",function(){return m})},function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var r=n(0);function o(e){r.f.extend(e)}var i=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=r.f.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=r.f.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==r.f.spfxContext&&null!==r.f.spfxContext?r.f.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=r.f.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new r.c}},enumerable:!0,configurable:!0}),e}())},function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return i});var r=n(0),o=n(3);function i(t){return new Promise(function(n){if(Object(r.t)(t))return n(t);if(null!==o.a.baseUrl)return n(Object(r.i)(o.a.baseUrl,t));if(void 0!==e._spPageContextInfo){if(Object(r.q)(e._spPageContextInfo,"webAbsoluteUrl"))return n(Object(r.i)(e._spPageContextInfo.webAbsoluteUrl,t));if(Object(r.q)(e._spPageContextInfo,"webServerRelativeUrl"))return n(Object(r.i)(e._spPageContextInfo.webServerRelativeUrl,t))}if(void 0!==e.location){var i=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(e){var o=i.indexOf(e);if(o>0)return n(Object(r.i)(i.substr(0,o),t))})}return n(t)})}}).call(this,n(6))},function(e,t,n){"use strict";(function(e){n.d(t,"c",function(){return i}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return a});var r=n(1),o=n(2);function i(e,t){void 0!==t&&null!==t&&new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}function u(e,t){if(Object(o.n)(t)){var n=Object(o.c)(e.headers||{},t.headers);(e=Object(o.c)(e,t)).headers=n}}var s=function(){function t(){}return t.prototype.fetch=function(t,n){return e.fetch(t,n)},t}(),a=function(e){function t(t){var n=e.call(this)||this;return n._token=t,n}return r.c(t,e),Object.defineProperty(t.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return i(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},t}(s)}).call(this,n(6))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){
/*! adal-angular v1.0.17 2018-02-27 */
var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},r.prototype._openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=u/2-n/2+o,c=s/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+c+", left="+a);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,n,r,o){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},r.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var i=this.config.redirectUri.split("#")[0];else i=this.config.redirectUri;var u=this,s=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return u.isAngular&&u._broadcast("adal:popUpClosed",n+u.CONSTANTS.RESOURCE_DELIMETER+e),u._handlePopupError(o,t,e,n,n),void window.clearInterval(s)}try{var a=r.location;if(-1!=encodeURI(a.href).indexOf(encodeURI(i)))return u.isAngular?u._broadcast("adal:popUpHashChanged",a.hash):u.handleWindowCallback(a.hash),window.clearInterval(s),u._loginInProgress=!1,u._acquireTokenInProgress=!1,u.info("Closing popup window"),u._openedWindows=[],void r.close()}catch(e){}},1)}else{var a="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,t,"Error opening popup",a,a)}},r.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,o,i,u){r._activeRenewals[t]=null;for(var s=0;s<r._callBacksMappedToRenewStates[e].length;++s)try{r._callBacksMappedToRenewStates[e][s](n,o,i,u)}catch(i){r.warn(i)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},r.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),n=n||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var o=null===t||void 0===t?null:this.config.clientId,i=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt"));i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},r.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,r),this._loginPopup(i,e,r)},r.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},r.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},r.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r;if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var n;this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,o,i=t.getRequestInfo(e),u=null;o=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],u=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],u=t.CONSTANTS.ID_TOKEN);var s=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],a=i.parameters[t.CONSTANTS.ERROR];try{o&&o(s,r,a,u)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,u,s,a,c,l,p="",d=0;d<n;d+=4){if(r=t.indexOf(e.charAt(d)),o=t.indexOf(e.charAt(d+1)),i=t.indexOf(e.charAt(d+2)),u=t.indexOf(e.charAt(d+3)),d+2===n-1){a=(s=r<<18|o<<12|i<<6)>>16&255,c=s>>8&255,p+=String.fromCharCode(a,c);break}if(d+1===n-1){a=(s=r<<18|o<<12)>>16&255,p+=String.fromCharCode(a);break}a=(s=r<<18|o<<12|i<<6|u)>>16&255,c=s>>8&255,l=255&s,p+=String.fromCharCode(a,c,l)}return p},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(o))}return r.join("&")},r.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",u=0;u<36;u++)"-"!==n[u]&&"4"!==n[u]&&(o=16*Math.random()|0),"x"===n[u]?i+=r[o]:"y"===n[u]?(o&=3,i+=r[o|=8]):i+=n[u];return i},r.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},r.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var o=(new Date).toUTCString(),i="";i=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(i+="\nstack:\n"+n.stack),Logging.log(i)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.17"},e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},function(e,t,n){"use strict";n.r(t);var r,o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=1),e.instance.log({level:n,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}(),i=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(r||(r={}));var u=function(){function e(){}return e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(" Data: Error in stringify of supplied data "+e)}return t.join("")},e}(),s=function(){function e(e){this.method=e}return e.prototype.log=function(e){this.method(e)},e}(),a=n(0),c=function(){function e(e){void 0===e&&(e=new Map),this._settings=e}return e.prototype.add=function(e,t){this._settings.set(e,t)},e.prototype.addJSON=function(e,t){this._settings.set(e,Object(a.u)(t))},e.prototype.apply=function(e){var t=this;return new Promise(function(n,r){try{t._settings=Object(a.w)(t._settings,Object(a.z)(e)),n()}catch(e){r(e)}})},e.prototype.load=function(e){var t=this;return new Promise(function(n,r){e.getConfiguration().then(function(e){t._settings=Object(a.w)(t._settings,Object(a.z)(e)),n()}).catch(r)})},e.prototype.get=function(e){return this._settings.get(e)||null},e.prototype.getJSON=function(e){var t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)},e}(),l=function(){function e(e,t,n){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=n||this.selectPnPCache()}return e.prototype.getWrappedProvider=function(){return this.wrappedProvider},e.prototype.getConfiguration=function(){var e=this;return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,function(){return e.wrappedProvider.getConfiguration().then(function(t){return e.store.put(e.cacheKey,t),t})}):this.wrappedProvider.getConfiguration()},e.prototype.selectPnPCache=function(){var e=new a.d;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")},e}(),p=function(){function e(e,t,n,r){void 0===t&&(t="config"),void 0===n&&(n="Title"),void 0===r&&(r="Value"),this.web=e,this.listTitle=t,this.keyFieldName=n,this.valueFieldName=r}return e.prototype.getConfiguration=function(){var e=this;return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName).get().then(function(t){return t.reduce(function(t,n){return t[n[e.keyFieldName]]=n[e.valueFieldName],t},{})})},e.prototype.asCaching=function(e){return void 0===e&&(e="pnp_configcache_splist_"+this.web.toUrl()+"+"+this.listTitle),new l(this,e)},e}(),d=n(1),h=function(){function e(e){this.key=e,this.expiration=Object(a.j)(new Date,"second",a.f.defaultCachingTimeoutSeconds),this.storeName=a.f.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new a.d,e}(),f=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}(),y=function(e){function t(t,n,r,o){void 0===r&&(r=n.status),void 0===o&&(o=n.statusText);var i=e.call(this,t)||this;return i.response=n,i.status=r,i.statusText=o,i.isHttpRequestError=!0,i}return d.c(t,e),t.init=function(e){return e.clone().text().then(function(n){return new t("Error making HttpClient request in queryable ["+e.status+"] "+e.statusText+" ::> "+n,e.clone())})},t}(Error),g=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&t.parseImpl(e,n,r)})},e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||y.init(e).then(t),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return Object(a.q)(e,"d")?t=Object(a.q)(e.d,"results")?e.d.results:e.d:Object(a.q)(e,"value")&&(t=e.value),t},e}(),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(g),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(g),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(g),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(g),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.parseImpl=function(e,t){Object(a.s)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(g),T=function(e){function t(t){var n=e.call(this)||this;return n.parser=t,n}return d.c(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)},t}(g);function w(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function C(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function P(e){e.pipeline.length<1&&o.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2);var t=C(e).then(function(e){return function(e){return o.log({data:0===o.activeLogLevel?e.result:{},level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(e.result)}(e)}).catch(function(e){throw o.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function _(e){return void 0===e&&(e=!1),function(t,n,r){var i=r.value;r.value=function(){for(var r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];return!e&&r.length>0&&Object(a.q)(r[0],"hasResult")&&r[0].hasResult?(o.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(r[0])):(o.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),i.apply(t,r).then(function(e){return C(e)}))}}}var I=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){o.log({data:1===o.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if(e.isCached){o.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new h(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=Object(a.k)(n,e.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return o.log({data:1===o.activeLogLevel?{}:r,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),Object(a.s)(e.batchDependency)&&e.batchDependency(),Object(a.q)(e.parser,"hydrate")&&(r=e.parser.hydrate(r)),w(e,r).then(function(e){return t(e)})}o.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),e.parser=new f(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var r=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);Object(a.s)(e.batchDependency)&&e.batchDependency(),o.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",1),t(w(e,r))}else{o.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var i=e.clientFactory(),u=Object(a.k)(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,u).then(function(t){return e.parser.parse(t)}).then(function(t){return w(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?o.log({data:1===o.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):o.log({data:1===o.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},d.b([_(!0)],e,"logStart",null),d.b([_()],e,"caching",null),d.b([_()],e,"send",null),d.b([_(!0)],e,"logEnd",null),e}();function E(){return[I.logStart,I.caching,I.send,I.logEnd].slice(0)}var j=function(){function e(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null,this._cloneParentWasCaching=!1,this._cloneParentCacheOptions=null,this._requestPipeline=null}return e.prototype.toUrl=function(){return this._url},e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return Object(a.x)(this._options,e),this},e.prototype.configureFrom=function(e){return Object(a.x)(this._options,e._options),this},e.prototype.usingCaching=function(e){return a.f.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.withPipeline=function(e){return this._requestPipeline=e.slice(0),this},e.prototype.getCore=function(e,t){return void 0===e&&(e=new O),void 0===t&&(t={}),this._cloneParentWasCaching&&this.usingCaching(this._cloneParentCacheOptions),this.reqImpl("GET",t,e)},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.reqImpl("POST",e,t)},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.reqImpl("PATCH",e,t)},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.reqImpl("DELETE",e,t)},e.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.reqImpl("PUT",e,t)},e.prototype.reqImpl=function(e,t,n){var r=this;return void 0===t&&(t={}),this.getRequestPipeline(e,t,n).then(function(o){return r.toRequestContext(e,t,n,o)}).then(function(e){return P(e)})},e.prototype.append=function(e){this._url=Object(a.i)(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this._parentUrl=e._url,this._url=Object(a.i)(this._parentUrl,t||""),this.configureFrom(e)},e.prototype._clone=function(e,t){return e.configureFrom(this),this._useCaching&&(e._cloneParentWasCaching=!0,e._cloneParentCacheOptions=this._cachingOptions),e},e.prototype.getRequestPipeline=function(e,t,n){var r=this;return void 0===t&&(t={}),new Promise(function(e){Object(a.y)(r._requestPipeline)&&Object(a.r)(r._requestPipeline)?e(r._requestPipeline):e(E())})},e}(),R=function(e){function t(){var t=e.call(this)||this;return t._batch=null,t._batchDependency=null,t}return d.c(t,e),t.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return Object(a.y)(e)&&(this._batch=e,this._batchDependency=e.addDependency()),this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(e,t){return void 0===e&&(e=new b),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(t,n){return void 0===t&&(t=new b),void 0===n&&(n={}),e.prototype.getCore.call(this,t,n)},t.prototype.postCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new b),e.prototype.postCore.call(this,t,n)},t.prototype.patchCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new b),e.prototype.patchCore.call(this,t,n)},t.prototype.deleteCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new b),e.prototype.deleteCore.call(this,t,n)},t.prototype.putCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new b),e.prototype.putCore.call(this,t,n)},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return Object(a.y)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype._clone=function(t,n){return t=e.prototype._clone.call(this,t,n),n.includeBatch&&(t=t.inBatch(this._batch)),t},t}(j),N=function(){function e(e){void 0===e&&(e=Object(a.n)()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r,o){var i={id:o,method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},u=new Promise(function(e,t){i.resolve=e,i.reject=t});return this._reqs.push(i),u},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise(function(t){e=t})),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},e}();var A=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=a.f.get("graph");return void 0!==e&&null!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=a.f.get("graph");if(void 0!==e&&null!==e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==a.f.spfxContext)return function(){return a.a.fromSPFxContext(a.f.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),e}()),k=function(){function e(){this._impl=A.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;Object(a.v)(n,A.headers),Object(a.v)(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json");var r=Object(a.k)(t,{headers:n});return this.fetchRaw(e,r)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;Object(a.v)(r,t.headers),t=Object(a.k)(t,{headers:r});var o=function(r){n._impl.fetch(e,t).then(function(e){return r.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&r.reject(e);var t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(Object(a.m)(n,o,r),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"DELETE"});return this.fetch(e,n)},e}(),x=function(){function e(){}return e.ensure=function(t,n){var r=[e.Beta,e.V1],o=new RegExp(n,"i"),i=r.filter(function(e){return!o.test(e)}).map(function(e){return e.replace(".","\\.")});return o=new RegExp("/?("+i.join("|")+")/","ig"),t.replace(o,"/"+n+"/")},e.Beta="beta",e.V1="v1.0",e}(),U=function(e){function t(t,n){var r=e.call(this)||this;if("string"==typeof t){var o=t;r._parentUrl=o,r._url=Object(a.i)(o,n)}else r.extend(t,n);return r}return d.c(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.as=function(e){var t=new e(this._url,null);return Object(a.k)(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this.toUrl();(Object(a.t)(e)||(e=Object(a.i)("https://graph.microsoft.com",e)),this.query.size>0)&&(e+=""+(e.indexOf("?")>-1?"&":"?")+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&"));return e},t.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},t.prototype.clone=function(t,n,r){return void 0===r&&(r=!0),e.prototype._clone.call(this,new t(this,n),{includeBatch:r})},t.prototype.setEndpoint=function(e){return this._url=x.ensure(this._url,e),this},t.prototype.toRequestContext=function(e,t,n,r){void 0===t&&(t={});var o=this.hasBatch?this._batchDependency:function(){};return Promise.resolve({batch:this.batch,batchDependency:o,cachingOptions:this._cachingOptions,clientFactory:function(){return new k},isBatched:this.hasBatch,isCached:/^get$/i.test(e)&&this._useCaching,options:t,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:Object(a.n)(),verb:e})},t}(R),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),t}(U),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.search=function(e){return this.query.set("$search",e),this},t}(D),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(U);function q(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return d.c(n,t),n}(t)}}var B,M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.add=function(e){return this.clone(n,"$ref").postCore({body:Object(a.u)({"@odata.id":e})})},t.prototype.getById=function(e){return new G(this,e)},t=n=d.b([q("members")],t)}(D),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(F),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("owners")],t)}(M),H=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}d.c(t,e),t=d.b([q("calendars")],t)}(D),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),t}(F)),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new V(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:Object(a.u)(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t=d.b([q("events")],t)}(D),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(F),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new z(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:Object(a.u)({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t=d.b([q("attachments")],t)}(D),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(F),J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.add=function(e){return this.postCore({body:Object(a.u)(e)})},t.prototype.getById=function(e){return new Y(this,e)},t=d.b([q("conversations")],t)}(D),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Z(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(a.u)(e)})},t=d.b([q("threads")],t)}(D),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new ee(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(a.u)(e)})},t=d.b([q("posts")],t)}(D),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(F),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:Object(a.u)({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(F),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new Q(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:Object(a.u)(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:Object(a.u)({post:e})})},t}(F),te=function(e){function t(t,n){return e.call(this,t,n)||this}return d.c(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:Object(a.u)({"@odata.id":e})})},t.prototype.remove=function(e){var n=this.clone(t,"$ref");return n.query.set("$id",e),n.deleteCore()},t}(D),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"plans",{get:function(){return new re(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tasks",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buckets",{get:function(){return new se(this)},enumerable:!0,configurable:!0}),t=d.b([q("planner")],t)}(F),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new oe(this,e)},t.prototype.add=function(e,t){var n=this,r={owner:e,title:t};return this.postCore({body:Object(a.u)(r)}).then(function(e){return{data:e,plan:n.getById(e.id)}})},t=d.b([q("plans")],t)}(D),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"tasks",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buckets",{get:function(){return new se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"details",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t}(F),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new ue(this,e)},t.prototype.add=function(e,t,n,r){var o=this,i=Object(a.k)({planId:e,title:t},n);return r&&(i=Object(a.k)(i,{bucketId:r})),this.postCore({body:Object(a.u)(i)}).then(function(e){return{data:e,task:o.getById(e.id)}})},t=d.b([q("tasks")],t)}(D),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},Object.defineProperty(t.prototype,"details",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),t}(F),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.add=function(e,t,n){var r=this,o={name:e,orderHint:n||"",planId:t};return this.postCore({body:Object(a.u)(o)}).then(function(e){return{bucket:r.getById(e.id),data:e}})},t.prototype.getById=function(e){return new ae(this,e)},t=d.b([q("buckets")],t)}(D),ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},Object.defineProperty(t.prototype,"tasks",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),t}(F),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("details")],t)}(D),le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getBlob=function(){return this.clone(n,"$value",!1).get(new v)},t.prototype.getBuffer=function(){return this.clone(n,"$value",!1).get(new S)},t.prototype.setContent=function(e){return this.clone(n,"$value",!1).patchCore({body:e})},t=n=d.b([q("photo")],t)}(F),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.create=function(e,t,n,r){void 0===t&&(t=""),void 0===r&&(r={});var o={description:t&&t.length>0?t:"","owners@odata.bind":["https://graph.microsoft.com/v1.0/users/"+n]};return et.groups.add(e,e,B.Office365,o).then(function(e){return e.group.createTeam(r).then(function(t){return{data:t,group:e.group,team:new de(e.group)}})})},t.prototype.getById=function(e){return new de(this,e)},t=d.b([q("teams")],t)}(D),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,Object.defineProperty(t.prototype,"channels",{get:function(){return new he(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"installedApps",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){var t=this;return this.clone(n,"").patchCore({body:Object(a.u)(e)}).then(function(e){return{data:e,team:t}})},t.prototype.archive=function(e){var t,r=this;return null!=e&&(t=Object(a.k)(t,{shouldSetSpoSiteReadOnlyForMembers:e})),this.clone(n,"archive").postCore({body:Object(a.u)(t)}).then(function(e){return{data:e,team:r}})},t.prototype.unarchive=function(){var e=this;return this.clone(n,"unarchive").postCore({}).then(function(t){return{data:t,team:e}})},t.prototype.cloneTeam=function(e,t,r,o){var i=this;void 0===t&&(t="");var u={description:t||"",displayName:e,mailNickname:e,partsToClone:r,visibility:o};return this.clone(n,"clone").postCore({body:Object(a.u)(u)}).then(function(e){return{data:e,team:i}})},t.prototype.get=function(e,t){return void 0===e&&(e=new b),void 0===t&&(t={}),this.clone(n,"").getCore(e,t)},t=n=d.b([q("team")],t)}(F),he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.create=function(e,t){var n=this;void 0===t&&(t="");var r={description:t&&t.length>0?t:"",displayName:e};return this.postCore({body:Object(a.u)(r)}).then(function(e){return{channel:n.getById(e.id),data:e}})},t.prototype.getById=function(e){return new fe(this,e)},t=d.b([q("channels")],t)}(D),fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"tabs",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),t}(F),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.add=function(e){var t={"teamsApp@odata.bind":e};return this.postCore({body:Object(a.u)(t)}).then(function(e){return{data:e}})},t.prototype.remove=function(){return this.deleteCore()},t=d.b([q("installedApps")],t)}(D),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.add=function(e,t,n){var r=this,o=Object(a.k)({name:e,"teamsApp@odata.bind":t},n);return this.postCore({body:Object(a.u)(o)}).then(function(e){return{data:e,tab:r.getById(e.id)}})},t.prototype.getById=function(e){return new be(this,e)},t=d.b([q("tabs")],t)}(D),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.update=function(e){var t=this;return this.clone(n,"").patchCore({body:Object(a.u)(e)}).then(function(e){return{data:e,tab:t}})},t.prototype.remove=function(){return this.deleteCore()},t=n=d.b([q("tab")],t)}(F);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(B||(B={}));var me,ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Oe(this,e)},t.prototype.add=function(e,t,n,r){var o=this;void 0===r&&(r={});var i=Object(a.k)({displayName:e,mailEnabled:n===B.Office365,mailNickname:t,securityEnabled:n!==B.Office365},r);return n!==B.Security&&(i=Object(a.k)(i,{groupTypes:n===B.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:Object(a.u)(i)}).then(function(e){return{data:e,group:o.getById(e.id)}})},t=d.b([q("groups")],t)}(D),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"calendar",{get:function(){return new H(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new W(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new re(this,"planner/plans")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new M(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new te(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new te(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"team",{get:function(){return new de(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.createTeam=function(e){return this.clone(t,"team").putCore({body:Object(a.u)(e)})},t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberObjects").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,"checkMemberGroups").postCore({body:Object(a.u)({groupIds:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,n){var r=this.clone(t,"calendarView");return r.query.set("startDateTime",e.toISOString()),r.query.set("endDateTime",n.toISOString()),r.get()},t}(F),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Te(this,e)},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===o&&(o={});var u=Object(a.k)({businessPhones:r,emailAddresses:n,givenName:e,surName:t},o);return this.postCore({body:Object(a.u)(u)}).then(function(e){return{contact:i.getById(e.id),data:e}})},t=d.b([q("contacts")],t)}(D),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t}(F),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Ce(this,e)},t.prototype.add=function(e,t){var n=this,r={displayName:e,parentFolderId:t};return this.postCore({body:Object(a.u)(r)}).then(function(e){return{contactFolder:n.getById(e.id),data:e}})},t=d.b([q("contactFolders")],t)}(D),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"contacts",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childFolders",{get:function(){return new we(this,"childFolders")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t}(F),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"notebooks",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sections",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return new Re(this)},enumerable:!0,configurable:!0}),t=d.b([q("onenote")],t)}(F),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Ie(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:Object(a.u)(n)}).then(function(e){return{data:e,notebook:t.getById(e.id)}})},t=d.b([q("notebooks")],t)}(D),Ie=function(e){function t(t,n){return e.call(this,t,n)||this}return d.c(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),t}(F),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new je(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:Object(a.u)(n)}).then(function(e){return{data:e,section:t.getById(e.id)}})},t=d.b([q("sections")],t)}(D),je=function(e){function t(t,n){return e.call(this,t,n)||this}return d.c(t,e),t}(F),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("pages")],t)}(D),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Ae(this,e)},t=d.b([q("drives")],t)}(D),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"root",{get:function(){return new ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"recent",{get:function(){return new Fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharedWithMe",{get:function(){return new qe(this)},enumerable:!0,configurable:!0}),t=d.b([q("drive")],t)}(F),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),t.prototype.search=function(e){return new Be(this,"search(q='"+e+"')")},t=d.b([q("root")],t)}(F),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Ue(this,e)},t=d.b([q("items")],t)}(D),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"thumbnails",{get:function(){return new Me(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t.prototype.move=function(e,t){var n=Object(a.k)({},e);return t&&(n=Object(a.k)({},t)),this.patchCore({body:Object(a.u)(n)})},t}(F),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.add=function(e,t){var n=this,r=Object(a.k)({name:e},t);return this.postCore({body:Object(a.u)(r)}).then(function(e){return{data:e,driveItem:new Ue(n,e.id)}})},t=d.b([q("children")],t)}(D),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("list")],t)}(D),Fe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("recent")],t)}(F),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("sharedWithMe")],t)}(F),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("search")],t)}(F),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([q("thumbnails")],t)}(F),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new We(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(a.u)(e)})},t=d.b([q("messages")],t)}(D),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(F),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Ke(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(a.u)(e)})},t=d.b([q("mailFolders")],t)}(D),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(F),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t=d.b([q("mailboxSettings")],t)}(F);!function(e){e[e.directoryObject=0]="directoryObject",e[e.user=1]="user",e[e.group=2]="group",e[e.device=3]="device"}(me||(me={}));var Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){return new ze(this,e)},t.prototype.getByIds=function(e,t){return void 0===t&&(t=me.directoryObject),this.clone(n,"getByIds").postCore({body:Object(a.u)({ids:e,type:t})})},t=n=d.b([q("directoryObjects")],t)}(D),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberObjects").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,"checkMemberGroups").postCore({body:Object(a.u)({groupIds:e})})},t}(F),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new Xe(this,e)},t=d.b([q("users")],t)}(D),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"onenote",{get:function(){return new Pe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contacts",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"joinedTeams",{get:function(){return new pe(this,"joinedTeams")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"memberOf",{get:function(){return new Qe(this,"memberOf")},enumerable:!0,configurable:!0}),t.prototype.getMemberObjects=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberObjects").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:Object(a.u)({securityEnabledOnly:e})})},t.prototype.checkMemberGroups=function(e){return this.clone(t,"checkMemberGroups").postCore({body:Object(a.u)({groupIds:e})})},Object.defineProperty(t.prototype,"contactFolders",{get:function(){return new we(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drive",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drives",{get:function(){return new Ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tasks",{get:function(){return new ie(this,"planner/tasks")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"messages",{get:function(){return new Ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mailboxSettings",{get:function(){return new Ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mailFolders",{get:function(){return new He(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:Object(a.u)(e)})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.sendMail=function(e){return this.clone(t,"sendMail").postCore({body:Object(a.u)(e)})},t}(F),$e=function(e){function t(t,n){void 0===t&&(t="https://graph.microsoft.com/v1.0/$batch"),void 0===n&&(n=20);var r=e.call(this)||this;return r.batchUrl=t,r.maxRequests=n,r}return d.c(t,e),t.makeUrlRelative=function(e){if(!Object(a.t)(e))return e;var t=e.indexOf(".com/v1.0/");return t<0?(t=e.indexOf(".com/beta/"))>-1?e.substr(t+10):e:e.substr(t+9)},t.formatRequests=function(e){var t=this;return e.map(function(e,n){var r={id:""+ ++n,method:e.method,url:t.makeUrlRelative(e.url)},o={};return void 0!==A.headers&&null!==A.headers&&(o=Object(a.k)(o,A.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(o=Object(a.k)(o,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(r=Object(a.k)(r,{body:e.options.body}))),r=Object(a.k)(r,{headers:o})})},t.parseResponse=function(e,t){return new Promise(function(n){for(var r=new Array(e.length).fill(null),o=0;o<t.responses.length;++o){var i=t.responses[o],u=parseInt(i.id,10)-1;204===i.status?r[u]=new Response:r[u]=new Response(JSON.stringify(i.body),i)}n({nextLink:t.nextLink,responses:r})})},t.prototype.executeImpl=function(){var e=this;if(o.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return o.write("Resolving empty batch.",1),Promise.resolve();for(var n=new k,r=this.requests.slice(),i=Promise.resolve(),u=function(){var u=r.splice(0,s.maxRequests),c={requests:t.formatRequests(u)},l={body:Object(a.u)(c),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};o.write("["+s.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),n.fetch(s.batchUrl,l).then(function(e){return e.json()}).then(function(e){return t.parseResponse(u,e)}).then(function(t){o.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.responses.reduce(function(t,n,r){var i=u[r];return o.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+i.method+" "+i.url+".",0),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},i)})},s=this;r.length>0;)u();return i},t}(N),Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.create=function(e,t,n){void 0===n&&(n={});var r=Object(a.k)({inviteRedirectUrl:t,invitedUserEmailAddress:e},n);return this.postCore({body:Object(a.u)(r)}).then(function(e){return{data:e}})},t=d.b([q("invitations")],t)}(D),Ze=function(e){function t(t,n){return e.call(this,t,n)||this}return d.c(t,e),Object.defineProperty(t.prototype,"directoryObjects",{get:function(){return new Qe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teams",{get:function(){return new pe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return new Xe(this,"me")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"planner",{get:function(){return new ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"users",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"invitations",{get:function(){return new Ye(this)},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new $e},t.prototype.setup=function(e){!function(e){a.f.extend(e)}(e)},t}(U),et=new Ze("v1.0");!function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}e.prototype.fetch=function(e,t){var n=this;if(void 0===SP||void 0===SP.RequestExecutor)throw Error("SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.");var r,o,i=e.substring(0,e.indexOf("/_api")),u=new SP.RequestExecutor(i),s={};if(t.headers&&t.headers instanceof Headers)for(o=(r=t.headers.entries()).next();!o.done;)s[o.value[0]]=o.value[1],o=r.next();else s=t.headers;return new Promise(function(r,o){var i={error:function(e){o(n.convertToResponse(e))},headers:s,method:t.method,success:function(e){r(n.convertToResponse(e))},url:e};i=t.body?Object(a.k)(i,{body:t.body}):Object(a.k)(i,{binaryStringRequestBody:!0}),u.executeAsync(i)})}}();function tt(e){if(Object(a.B)(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function nt(e){var t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata"];return Object(a.q)(e,n[0])&&"SP.Web"===e[n[0]]?Object(a.q)(e,n[1])?t.push(e[n[1]]):Object(a.q)(e,n[2])&&t.push(e.__metadata.uri):Object(a.q)(e,n[3])&&Object(a.q)(e,n[1])?t.push(tt(e[n[3]]),"_api",e[n[1]]):Object(a.q)(e,n[1])?t.push("_api",e[n[1]]):Object(a.q)(e,n[2])&&t.push(e.__metadata.uri),t.length<1?(o.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):a.i.apply(void 0,t)}var rt=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){var t=new n.factory(nt(e),null);return Object(a.k)(t,e)},n}return d.c(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){var t=new n.factory(nt(e),null);return Object(a.k)(t,e)})},t}(g),ot=function(e){function t(t){var n=e.call(this)||this;return n.factory=t,n.hydrate=function(e){return e.map(function(e){var t=new n.factory(nt(e),null);return Object(a.k)(t,e)})},n}return d.c(t,e),t.prototype.parse=function(t){var n=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new n.factory(nt(e),null);return Object(a.k)(t,e)})})},t}(g);function it(e){return new rt(e)}function ut(e){return new ot(e)}var st=n(3),at=function(){return function(){}}(),ct=new Map,lt=function(){function e(e,t){void 0===t&&(t=ct),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,n=this._digests.get(e);if(void 0!==n&&new Date<n.expiration)return Promise.resolve(n.value);var r=Object(a.i)(e,"/_api/contextinfo");return this._httpClient.fetchRaw(r,{cache:"no-cache",credentials:"same-origin",headers:Object(a.k)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},st.a.headers,!0),method:"POST"}).then(function(e){return(new b).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new at;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.set(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),pt=function(){function e(e){void 0===e&&(e=st.a.fetchClientFactory()),this._impl=e,this._digestCache=new lt(this)}return e.prototype.fetch=function(e,t){var n=this;void 0===t&&(t={});var r=Object(a.k)(t,{cache:"no-cache",credentials:"same-origin"},!0),o=new Headers;return Object(a.v)(o,st.a.headers),Object(a.v)(o,t.headers),o.has("Accept")||o.append("Accept","application/json"),o.has("Content-Type")||o.append("Content-Type","application/json;odata=verbose;charset=utf-8"),o.has("X-ClientService-ClientTag")||o.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.8"),o.has("User-Agent")||o.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/1.2.8"),!(r=Object(a.k)(r,{headers:o})).method||"GET"===r.method.toUpperCase()||o.has("X-RequestDigest")||o.has("Authorization")?this.fetchRaw(e,r):this._digestCache.getDigest(tt(e)).then(function(t){return o.append("X-RequestDigest",t),n.fetchRaw(e,r)})},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;Object(a.v)(r,t.headers),t=Object(a.k)(t,{headers:r});var o=function(r){var i=function(e){var t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error("Retry count exceeded ("+r.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(Object(a.m)(n,o,r),t)};n._impl.fetch(e,t).then(function(e){429===e.status?i(e):r.resolve(e)}).catch(function(e){503===e.status?i(e):r.reject(e)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(a.k)(t,{method:"DELETE"});return this.fetch(e,n)},e}(),dt=n(4);function ht(e){return{__metadata:{type:e}}}var ft=function(e){function t(t,n){var r=e.call(this)||this;if(r._forceCaching=!1,"string"==typeof t)if(Object(a.t)(t)||t.lastIndexOf("/")<0)r._parentUrl=t,r._url=Object(a.i)(t,n);else if(t.lastIndexOf("/")>t.lastIndexOf("(")){var o=t.lastIndexOf("/");r._parentUrl=t.slice(0,o),n=Object(a.i)(t.slice(o),n),r._url=Object(a.i)(r._parentUrl,n)}else{o=t.lastIndexOf("(");r._parentUrl=t.slice(0,o),r._url=Object(a.i)(t,n)}else{r.extend(t,n);var i=t.query.get("@target");void 0!==i&&r.query.set("@target",i)}return r}return d.c(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return Object(a.k)(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,r){return o.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+r,0),e.set(n,"'"+r+"'"),n});e.size>0&&(t+=""+(t.indexOf("?")>-1?"&":"?")+Array.from(e).map(function(e){return e[0]+"="+e[1]}).join("&"));return t},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n).configureFrom(this),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==r&&(o=o.inBatch(r)),o},t.prototype.clone=function(t,n,r){void 0===r&&(r=!0);var o=e.prototype._clone.call(this,new t(this,n),{includeBatch:r}),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),o},t.prototype.toRequestContext=function(e,t,n,r){var o=this;void 0===t&&(t={});var i=this.hasBatch?this._batchDependency:function(){};return Object(dt.a)(this.toUrlAndQuery()).then(function(u){return Object(a.x)(t,o._options),{batch:o.batch,batchDependency:i,cachingOptions:o._cachingOptions,clientFactory:function(){return new pt},isBatched:o.hasBatch,isCached:o._forceCaching||o._useCaching&&/^get$/i.test(e),options:t,parser:n,pipeline:r,requestAbsoluteUrl:u,requestId:Object(a.n)(),verb:e}})},t}(R),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t}(ft),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype._update=function(e,t){var n=this;return function(r){return n.postCore({body:Object(a.u)(Object(a.k)(ht(e),r)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return t(e,r)})}},t.prototype._delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype._deleteWithETag=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(ft);function bt(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return d.c(n,t),n}(t)}}var mt,vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){return new St(this,"getById("+e+")")},t.prototype.getByEmail=function(e){return new St(this,"getByEmail('"+e+"')")},t.prototype.getByLoginName=function(e){var t=new St(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(n,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var t=this.clone(n,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},t.prototype.add=function(e){var t=this;return this.clone(n,null).postCore({body:Object(a.u)(Object(a.k)(ht("SP.User"),{LoginName:e}))}).then(function(){return t.getByLoginName(e)})},t=n=d.b([bt("siteusers")],t)}(yt),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new Wt(this,"groups")},enumerable:!0,configurable:!0}),t}(gt),St=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t.delete=t._delete,t}return d.c(t,e),t}(Ot),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([bt("currentuser")],t)}(Ot);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(mt||(mt={}));var wt,Ct,Pt,_t,It,Et,jt,Rt,Nt,At,kt,xt,Ut,Dt,Lt,Ft,qt,Bt,Mt,Gt,Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Ht(this);return t.concat("("+e+")"),t},t.prototype.add=function(e){var t=this,n=Object(a.u)(Object(a.k)(ht("SP.Group"),e));return this.postCore({body:n}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new Ht(this,"getByName('"+e+"')")},t.prototype.removeById=function(e){return this.clone(n,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(n,"removeByLoginName('"+e+"')").postCore()},t=n=d.b([bt("sitegroups")],t)}(yt),Ht=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.update=n._update("SP.Group",function(e,r){var o=n;return Object(a.q)(r,"Title")&&(o=n.getParent(t,n.parentUrl,"getByName('"+r.Title+"')")),{data:e,group:o}}),n}return d.c(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new vt(this,"users")},enumerable:!0,configurable:!0}),t}(gt),Kt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Vt(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},t.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()},t=n=d.b([bt("roleassignments")],t)}(yt),Vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return d.c(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new Wt(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new Jt(this)},enumerable:!0,configurable:!0}),t}(gt),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new zt(this,"getById("+e+")")},t.prototype.getByName=function(e){return new zt(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new zt(this,"getbytype("+e+")")},t.prototype.add=function(e,t,n,r){var o=this,i=Object(a.u)({BasePermissions:Object(a.k)({__metadata:{type:"SP.BasePermissions"}},r),Description:t,Name:e,Order:n,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:i}).then(function(e){return{data:e,definition:o.getById(e.Id)}})},t=d.b([bt("roledefinitions")],t)}(yt),zt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return d.c(t,e),t.prototype.update=function(e){var t=this,n=["BasePermissions"];void 0!==Object(a.q)(e,n[0])&&(e[n[0]]=Object(a.k)({__metadata:{type:"SP."+n[0]}},e[n[0]]));var r=Object(a.u)(Object(a.k)(ht("SP.RoleDefinition"),e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(n){var r=t;Object(a.q)(e,"Name")&&(r=t.getParent(Qt,t.parentUrl,"").getByName(e.Name));return{data:n,definition:r}})},t}(gt),Jt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([bt("roledefinitionbindings")],t)}(yt);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(wt||(wt={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(Ct||(Ct={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(Pt||(Pt={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(_t||(_t={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(It||(It={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(Et||(Et={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(jt||(jt={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(Rt||(Rt={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(Nt||(Nt={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(At||(At={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(kt||(kt={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(xt||(xt={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(Ut||(Ut={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(Dt||(Dt={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(Lt||(Lt={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(Ft||(Ft={})),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(qt||(qt={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(Bt||(Bt={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(Mt||(Mt={})),function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(Gt||(Gt={}));var Xt,$t,Yt,Zt,en=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new Kt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new gt(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(ft,"getUserEffectivePermissions(@user)");return t.query.set("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return Object(a.q)(e,"GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new gt("_api/web","currentuser").configureFrom(this).select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+n+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===jt.FullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return(t-=1)>=0&&t<32?(n<<=t,0!=(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!=(e.High&n))},t}(gt),tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getShareLink=function(e,n){void 0===n&&(n=null);var r=null!==n?n.toISOString():null;return this.clone(t,"shareLink").postCore({body:Object(a.u)({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}})})},t.prototype.shareWith=function(e,n,r,o,i){var u=this;void 0===r&&(r=!1),void 0===o&&(o=!1),Array.isArray(e)||(e=[e]);var s=Object(a.u)(e.map(function(e){return{Key:e}})),c=n===Ut.Edit?At.Contributor:At.Reader;return new yt("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+c).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+c);var n={includeAnonymousLinkInEmail:r,peoplePickerInput:s,propagateAcl:o,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==i&&(n=Object(a.k)(n,{emailBody:i.body,emailSubject:void 0!==i.subject?i.subject:"",sendEmail:!0})),u.clone(t,"shareObject").postCore({body:Object(a.u)(n)})})},t.prototype.shareObject=function(e,t){var n=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=Object(a.k)(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var r={peoplePickerInput:Object(a.u)(e.loginNames.map(function(e){return{Key:e}})),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(r=Object(a.k)(r,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),n.sendShareObjectRequest(r)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postCore({body:Object(a.u)({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postCore({body:Object(a.u)({recipients:e})})},t.prototype.getSharingInformation=function(e,n){void 0===e&&(e=null);var r=this.clone(t,"getSharingInformation");return r.expand.apply(r,n).postCore({body:Object(a.u)({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postCore({body:Object(a.u)({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:Object(a.u)({linkKind:e})})},t.prototype.unshareLink=function(e,n){return void 0===n&&(n="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:Object(a.u)({linkKind:e,shareId:n})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var n=e===Ut.Edit?At.Contributor:At.Reader;return new yt("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+n).get().then(function(e){if(e.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case At.Contributor:return new gt("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case At.Reader:case At.Guest:return new gt("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(new gt(tt(e),"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(n){return n.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:Object(a.u)(e)})})},t}(ft),nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.shareWith=function(e,t,n){var r=this;void 0===t&&(t=Ut.View);var o=this.addBatchDependency();return new gt(tt(this.toUrl()),"/_api/web/url").get().then(function(i){return o(),r.shareObject(Object(a.i)(i,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,n)})},t.prototype.shareObject=function(e,t,n,r,o,i,u,s){return void 0===i&&(i=!1),void 0===u&&(u=!1),void 0===s&&(s=!0),this.clone(tn,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:u,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:s})},t.prototype.shareObjectRaw=function(e){return this.clone(tn,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(tn,null).unshareObjectWeb(e)},t}(en),rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=xt.OrganizationView),void 0===t&&(t=null),this.clone(tn,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=Ut.View),void 0===n&&(n=!1),this.clone(tn,null).shareWith(e,t,n,!1,r)},t.prototype.checkSharingPermissions=function(e){return this.clone(tn,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e,t){return void 0===e&&(e=null),this.clone(tn,null).getSharingInformation(e,t)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(tn,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(tn,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(tn,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(tn,null).unshareLink(e,t)},t}(en),on=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=xt.OrganizationView),void 0===t&&(t=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},t.prototype.getSharingInformation=function(e,t){void 0===e&&(e=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getSharingInformation(e,t)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(un,"listItemAllFields",!1).select("odata.id").get().then(function(t){var n=new tn(nt(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},t}(gt),un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.shareWith=function(e,t,n,r){void 0===t&&(t=Ut.View),void 0===n&&(n=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,n,!1,r)})},t}(on),sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.shareWith=function(e,t,n,r,o){void 0===t&&(t=Ut.View),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(u){return i(),u.shareWith(e,t,n,r,o)})},t}(on),an=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new cn(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:Object(a.u)({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:Object(a.u)({webPartXml:e})})},t}(ft),cn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){return new ln(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new ln(this,"getByControlId('"+e+"')")},t}(yt),ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new pn(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,n){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+n+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(gt),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([bt("webpart")],t)}(gt),dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getByName=function(e){var t=new hn(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})},t=n=d.b([bt("folders")],t)}(yt),hn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}return d.c(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new yt(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new Wn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new dn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new gt(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new gt(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new ft(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new yt(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return Object(a.k)(new Ln(nt(e)),e)})},t.prototype.moveTo=function(e){var t=this;return this.select("ServerRelativeUrl").get().then(function(n){var r=n.ServerRelativeUrl,o=new pt,i=t.toUrl().split("/_api")[0],u=i.replace("://","___").split("/")[0].replace("___","://"),s=i+"/_api/SP.MoveCopyUtil.MoveFolder()";return o.post(s,{body:Object(a.u)({destUrl:0===e.indexOf("http")?e:""+u+e,srcUrl:""+u+r})}).then(function(e){return e.json()})})},t}(sn),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.addAvailableContentType=function(e){var t=this,r=Object(a.u)({contentTypeId:e});return this.clone(n,"addAvailableContentType").postCore({body:r}).then(function(e){return{contentType:t.getById(e.id),data:e}})},t.prototype.getById=function(e){var t=new yn(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===n&&(n=""),void 0===r&&(r="Custom Content Types"),void 0===o&&(o={});var u=Object(a.u)(Object.assign(ht("SP.ContentType"),{Description:n,Group:r,Id:{StringValue:e},Name:t},o));return this.postCore({body:u}).then(function(e){return{contentType:i.getById(e.id),data:e}})},t=n=d.b([bt("contenttypes")],t)}(yt),yn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return d.c(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new gn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new yt(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new yt(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t}(gt),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){var t=new bn(this);return t.concat("(guid'"+e+"')"),t},t=d.b([bt("fieldlinks")],t)}(yt),bn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(gt),mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getByName=function(e){var t=new vn(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},t.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).recycle()})},Promise.resolve())},t=n=d.b([bt("AttachmentFiles")],t)}(yt),vn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return d.c(t,e),t.prototype.getText=function(){return this.getParsed(new m)},t.prototype.getBlob=function(){return this.getParsed(new v)},t.prototype.getBuffer=function(){return this.getParsed(new S)},t.prototype.getJSON=function(){return this.getParsed(new O)},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getParsed=function(e){return this.clone(t,"$value",!1).get(e)},t}(gt),On=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Sn(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new Sn(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,r){var o=this;void 0===t&&(t=!1),void 0===r&&(r={});var i=Object(a.u)(Object.assign(ht("SP.View"),{PersonalView:t,Title:e},r));return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,view:o.getById(e.Id)}})},t=n=d.b([bt("views")],t)}(yt),Sn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t.delete=t._delete,t}return d.c(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new Tn(this)},enumerable:!0,configurable:!0}),t.prototype.renderAsHtml=function(){return this.clone(ft,"renderashtml").get()},t.prototype.setViewXml=function(e){return this.clone(t,"SetViewXml").postCore({body:Object(a.u)({viewXml:e})})},t}(gt),Tn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getSchemaXml=function(){return this.clone(ft,"schemaxml").get()},t.prototype.add=function(e){return this.clone(n,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,t){return this.clone(n,"moveviewfieldto").postCore({body:Object(a.u)({field:e,index:t})})},t.prototype.removeAll=function(){return this.clone(n,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(n,"removeviewfield('"+e+"')").postCore()},t=n=d.b([bt("viewfields")],t)}(yt),wn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Cn(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new Cn(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new Cn(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.createFieldAsXml=function(e){var t,r=this;t="string"==typeof e?{SchemaXml:e}:e;var o=Object(a.u)({parameters:Object(a.k)(ht("SP.XmlSchemaFieldCreationInformation"),t)});return this.clone(n,"createfieldasxml").postCore({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.add=function(e,t,r){var o=this,i=Object(a.u)(Object.assign(ht(t),{Title:e},r));return this.clone(n,null).postCore({body:i}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addText=function(e,t,n){void 0===t&&(t=255);var r={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",Object(a.k)(r,n))},t.prototype.addCalculated=function(e,t,n,r,o){void 0===r&&(r=Ct.Text);var i={DateFormat:n,FieldTypeKind:17,Formula:t,OutputType:r};return this.add(e,"SP.FieldCalculated",Object(a.k)(i,o))},t.prototype.addDateTime=function(e,t,n,r,o){void 0===t&&(t=Pt.DateOnly),void 0===n&&(n=It.Gregorian),void 0===r&&(r=0);var i={DateTimeCalendarType:n,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:r};return this.add(e,"SP.FieldDateTime",Object(a.k)(i,o))},t.prototype.addNumber=function(e,t,n,r){var o={FieldTypeKind:9};return void 0!==t&&(o=Object(a.k)({MinimumValue:t},o)),void 0!==n&&(o=Object(a.k)({MaximumValue:n},o)),this.add(e,"SP.FieldNumber",Object(a.k)(o,r))},t.prototype.addCurrency=function(e,t,n,r,o){void 0===r&&(r=1033);var i={CurrencyLocaleId:r,FieldTypeKind:10};return void 0!==t&&(i=Object(a.k)({MinimumValue:t},i)),void 0!==n&&(i=Object(a.k)({MaximumValue:n},i)),this.add(e,"SP.FieldCurrency",Object(a.k)(i,o))},t.prototype.addMultilineText=function(e,t,n,r,o,i,u){void 0===t&&(t=6),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=!0);var s={AllowHyperlink:i,AppendOnly:o,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:r,RichText:n};return this.add(e,"SP.FieldMultiLineText",Object(a.k)(s,u))},t.prototype.addUrl=function(e,t,n){void 0===t&&(t=Et.Hyperlink);var r={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",Object(a.k)(r,n))},t.prototype.addUser=function(e,t,n){var r={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",Object(a.k)(r,n))},t.prototype.addLookup=function(e,t,r,o){var i=this,u=Object(a.k)({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},o),s=Object(a.u)({parameters:Object(a.k)(ht("SP.FieldCreationInformation"),u)});return this.clone(n,"addfield").postCore({body:s}).then(function(e){return{data:e,field:i.getById(e.Id)}})},t.prototype.addChoice=function(e,t,n,r,o){void 0===n&&(n=Mt.Dropdown);var i={Choices:{results:t},EditFormat:n,FieldTypeKind:6,FillInChoice:r};return this.add(e,"SP.FieldChoice",Object(a.k)(i,o))},t.prototype.addMultiChoice=function(e,t,n,r){var o={Choices:{results:t},FieldTypeKind:15,FillInChoice:n};return this.add(e,"SP.FieldMultiChoice",Object(a.k)(o,r))},t.prototype.addBoolean=function(e,t){return this.add(e,"SP.Field",Object(a.k)({FieldTypeKind:8},t))},t.prototype.addDependentLookupField=function(e,t,r){var o=this;return this.clone(n,"adddependentlookupfield(displayName='"+e+"', primarylookupfieldid='"+t+"', showfield='"+r+"')").postCore().then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addLocation=function(e,t){return this.add(e,"SP.FieldLocation",Object(a.k)({FieldTypeKind:33},t))},t=n=d.b([bt("fields")],t)}(yt),Cn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return d.c(t,e),t.prototype.update=function(e,t){var n=this;void 0===t&&(t="SP.Field");var r=Object(a.u)(Object(a.k)(ht(t),e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:n}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(gt),Pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){var t=new _n(this);return t.concat("('"+e+"')"),t},t=d.b([bt("forms")],t)}(yt),_n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t}(gt),In=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){var t=new En(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,n){var r=this,o={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return n&&(o.clientState=n),this.postCore({body:Object(a.u)(o),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r.getById(e.id)}})},t=d.b([bt("subscriptions")],t)}(yt),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.update=function(e,t,n){var r=this,o={};return e&&(o.expirationDateTime=e),t&&(o.notificationUrl=t),n&&(o.clientState=n),this.patchCore({body:Object(a.u)(o),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:r}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(gt),jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Rn(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,n=Object(a.u)(Object(a.k)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:n}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(n,"clear").postCore()},t=n=d.b([bt("usercustomactions")],t)}(yt),Rn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}return d.c(t,e),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(gt),Nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new An(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new An(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,n,r,o){var i=this;void 0===t&&(t=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={});var u=Object(a.k)({AllowContentTypes:r,BaseTemplate:n,ContentTypesEnabled:r,Description:t,Title:e,__metadata:{type:"SP.List"}},o);return this.postCore({body:Object(a.u)(u)}).then(function(e){return{data:e,list:i.getByTitle(u.Title)}})},t.prototype.ensure=function(e,t,n,r,o){var i=this;if(void 0===t&&(t=""),void 0===n&&(n=100),void 0===r&&(r=!1),void 0===o&&(o={}),this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");return new Promise(function(u,s){var c=Object(a.k)(o,{Title:e,Description:t,ContentTypesEnabled:r},!0),l=i.getByTitle(c.Title);l.get().then(function(e){l.update(c).then(function(e){u({created:!1,data:e,list:i.getByTitle(c.Title)})}).catch(function(e){return s(e)})}).catch(function(o){i.add(e,t,n,r,c).then(function(e){u({created:!0,data:e.data,list:i.getByTitle(c.Title)})}).catch(function(e){return s(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(n,"ensuresiteassetslibrary").postCore().then(function(e){return new An(nt(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(n,"ensuresitepageslibrary").postCore().then(function(e){return new An(nt(e))})},t=n=d.b([bt("lists")],t)}(yt),An=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new fn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new Dn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new On(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new wn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new Pn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new Sn(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new jn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new ft(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new yt(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new ft(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new ft(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new In(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new hn(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new Sn(this,"getView('"+e+"')")},t.prototype.update=function(e,n){var r=this;void 0===n&&(n="*");var o=Object(a.u)(Object(a.k)({__metadata:{type:"SP.List"}},e));return this.postCore({body:o,headers:{"IF-Match":n,"X-HTTP-Method":"MERGE"}}).then(function(n){var o=r;return Object(a.q)(e,"Title")&&(o=r.getParent(t,r.parentUrl,"getByTitle('"+e.Title+"')")),{data:n,list:o}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:Object(a.u)({query:Object(a.k)({__metadata:{type:"SP.ChangeQuery"}},e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.clone(t,"getitems");return o.expand.apply(o,n).postCore({body:Object(a.u)({query:Object(a.k)({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:Object(a.u)({query:Object(a.k)({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return Object(a.q)(e,"Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var n=this.clone(t,"renderlistdata(@viewXml)");return n.query.set("@viewXml","'"+e+"'"),n.postCore().then(function(e){return JSON.parse(Object(a.q)(e,"RenderListData")?e.RenderListData:e)})},t.prototype.renderListDataAsStream=function(e,n){void 0===n&&(n=null);var r={overrideParameters:Object(a.k)(ht("SP.RenderListDataOverrideParameters"),n),parameters:Object(a.k)(ht("SP.RenderListDataParameters"),e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:Object(a.u)(r)})},t.prototype.renderListFormData=function(e,n,r){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+n+"', mode='"+r+"')").postCore().then(function(e){return JSON.parse(Object(a.q)(e,"RenderListFormData")?e.RenderListFormData:e)})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return Object(a.q)(e,"ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},t.prototype.addValidateUpdateItemUsingPath=function(e,n,r,o){return void 0===r&&(r=!1),this.clone(t,"AddValidateUpdateItemUsingPath()").postCore({body:Object(a.u)({bNewDocumentUpdate:r,checkInComment:o,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:n,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}})}).then(function(e){return void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e})},t}(en),kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.add=function(e){var t=this;"string"==typeof e&&(e={text:e});var r=Object(a.u)(Object(a.k)(ht("Microsoft.SharePoint.Comments.comment"),e));return this.clone(n,null).postCore({body:r}).then(function(e){return Object(a.k)(t.getById(e.id),e)})},t.prototype.getById=function(e){var t=new xn(this);return t.concat("("+e+")"),t},t.prototype.clear=function(){return this.clone(n,"DeleteAll").postCore()},t=n=d.b([bt("comments")],t)}(yt),xn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"replies",{get:function(){return new Un(this)},enumerable:!0,configurable:!0}),t.prototype.like=function(){return this.clone(t,"Like").postCore()},t.prototype.unlike=function(){return this.clone(t,"Unlike").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteComment").postCore()},t}(gt),Un=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.add=function(e){"string"==typeof e&&(e={text:e});var t=Object(a.u)(Object(a.k)(ht("Microsoft.SharePoint.Comments.comment"),e));return this.clone(n,null).postCore({body:t}).then(function(e){return Object(a.k)(new xn(nt(e)),e)})},t=n=d.b([bt("replies")],t)}(yt),Dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Ln(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){return new Ln(this.parentUrl,"getItemByStringId('"+e+"')")},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.get(new Mn(this))},t.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),o.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var r=new n(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)}),new Promise(function(e,t){var n=[],o=function(r){[].push.apply(n,r.results),r.hasNext?r.getNext().then(o).catch(t):e(n)};r.getPaged().then(o).catch(t)})},t.prototype.add=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=null);var o=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var i=Object(a.u)(Object(a.k)(ht(t),e)),u=r.clone(n,"").postCore({body:i}).then(function(e){return{data:e,item:r.getById(e.Id)}});return o(),u})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(An).getListItemEntityTypeFullName()},t=n=d.b([bt("items")],t)}(yt),Ln=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return d.c(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new mn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new yn(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"comments",{get:function(){return new kn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new ft(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new ft(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new gt(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new gt(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new gt(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new hn(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new Hn(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new Fn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this.getParent(An,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,n){var r=this;return void 0===t&&(t="*"),void 0===n&&(n=null),new Promise(function(o,i){var u=r.addBatchDependency();return r.ensureListItemEntityTypeName(n).then(function(n){var i=Object(a.u)(Object(a.k)(ht(n),e));return u(),r.postCore({body:i,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new Gn).then(function(e){o({data:e,item:r})})}).catch(function(e){return i(e)})})},t.prototype.getLikedBy=function(){return this.clone(t,"likedBy").postCore()},t.prototype.like=function(){return this.clone(t,"like").postCore()},t.prototype.unlike=function(){return this.clone(t,"unlike").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var n=this.clone(t,"getWOPIFrameUrl(@action)");return n.query.set("@action",e),n.postCore().then(function(e){return Object(a.q)(e,"GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,n){return void 0===n&&(n=!1),this.clone(t,"validateupdatelistitem").postCore({body:Object(a.u)({formValues:e,bNewDocumentUpdate:n})})},t.prototype.getLikedByInformation=function(){return this.clone(t,"likedByInformation").expand("likedby").getCore()},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},t}(rn),Fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){var t=new qn(this);return t.concat("("+e+")"),t},t=d.b([bt("versions")],t)}(yt),qn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return d.c(t,e),t}(gt),Bn=function(){function e(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){return this.hasNext?new Dn(this.nextUrl,null).configureFrom(this.parent).getPaged():new Promise(function(e){return e(null)})},e}(),Mn=function(e){function t(t){var n=e.call(this)||this;return n._parent=t,n}return d.c(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&e.json().then(function(e){var r=Object(a.q)(e,"d")&&Object(a.q)(e.d,"__next")?e.d.__next:e["odata.nextLink"];n(new Bn(t._parent,r,t.parseODataJSON(e)))})})},t}(g),Gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})},t}(g),Wn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getByName=function(e){var t=new Hn(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,t,r,o,i){var u=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return u.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)})},t.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})},t=n=d.b([bt("files")],t)}(yt),Hn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new gt(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new Kn(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,n){if(void 0===e&&(e=""),void 0===n&&(n=Xt.Major),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"checkin(comment='"+e+"',checkintype="+n+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=$t.Shared),new an(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=Yt.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+n+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new m,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new v,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new S,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new O,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.listItemAllFields;return n.select.apply(n,e).get().then(function(e){return Object(a.k)(new Ln(nt(e)),e)})},t.prototype.setContentChunked=function(e,t,n){var r=this;void 0===n&&(n=10485760),void 0===t&&(t=function(){return null});var o=e.size,i=parseInt((e.size/n).toString(),10)+(e.size%n==0?1:0),u=Object(a.n)();t({uploadId:u,blockNumber:1,chunkSize:n,currentPointer:0,fileSize:o,stage:"starting",totalBlocks:i});for(var s=this.startUpload(u,e.slice(0,n)),c=function(a){s=s.then(function(s){return t({uploadId:u,blockNumber:a,chunkSize:n,currentPointer:s,fileSize:o,stage:"continue",totalBlocks:i}),r.continueUpload(u,s,e.slice(s,s+n))})},l=2;l<i;l++)c(l);return s.then(function(s){return t({uploadId:u,blockNumber:i,chunkSize:n,currentPointer:s,fileSize:o,stage:"finishing",totalBlocks:i}),r.finishUpload(u,s,e.slice(s))})},t.prototype.startUpload=function(e,n){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,n,r){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,n,r){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return{data:e,file:new t(nt(e))}})},t}(un),Kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){var t=new Vn(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()},t=n=d.b([bt("versions")],t)}(yt),Vn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return d.c(t,e),t}(gt);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(Xt||(Xt={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}($t||($t={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(Yt||(Yt={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(Zt||(Zt={}));var Qn,zn=function(e){function t(t,n){return void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps"),e.call(this,tt("string"==typeof t?t:t.toUrl()),n)||this}return d.c(t,e),t.prototype.getAppById=function(e){return new Jn(this,"getById('"+e+"')")},t.prototype.add=function(e,n,r){return void 0===r&&(r=!0),new t(tt(this.toUrl()),"_api/web/tenantappcatalog/add(overwrite="+r+",url='"+e+"')").postCore({body:n}).then(function(e){return{data:e,file:new Hn(nt(e))}})},t}(yt),Jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.deploy=function(e){return void 0===e&&(e=!1),this.clone(t,"Deploy("+e+")").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(gt),Xn=function(e){function t(t){var n=e.call(this)||this;return n.baseUrl=t,n}return d.c(t,e),t.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],u=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),s=e.split("\n"),a="batch",c=0;c<s.length;++c){var l=s[c];switch(a){case"batch":if("--batchresponse_"===l.substr(0,"--batchresponse_".length))a="batchHeaders";else if(""!==l.trim())throw Error("Invalid response, line "+c);break;case"batchHeaders":""===l.trim()&&(a="status");break;case"status":var p=u.exec(l);if(3!==p.length)throw Error("Invalid status, line "+c);r=parseInt(p[1],10),o=p[2],a="statusHeaders";break;case"statusHeaders":""===l.trim()&&(a="body");break;case"body":i.push(204===r?new Response:new Response(l,{status:r,statusText:o})),a="batch"}}"status"!==a&&n(Error("Unexpected end of input")),t(i)})},t.prototype.executeImpl=function(){var e=this;if(o.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return o.write("Resolving empty batch.",1),Promise.resolve();var n=new pt;return Object(dt.a)(this.baseUrl).then(function(r){for(var i=[],u="",s=0;s<e.requests.length;s++){var c=e.requests[s];"GET"===c.method?(u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"\n")):(u.length<1&&(u=Object(a.n)(),i.push("--batch_"+e.batchId+"\n"),i.push('Content-Type: multipart/mixed; boundary="changeset_'+u+'"\n\n')),i.push("--changeset_"+u+"\n")),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n");var l=new Headers,p=Object(a.t)(c.url)?c.url:Object(a.i)(r,c.url);if(o.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+c.method+" "+p+" to batch.",0),"GET"!==c.method){var d=c.method,h=c.options.headers;Object(a.q)(c,"options")&&Object(a.q)(c.options,"headers")&&void 0!==h["X-HTTP-Method"]&&(d=h["X-HTTP-Method"],delete h["X-HTTP-Method"]),i.push(d+" "+p+" HTTP/1.1\n"),l.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else i.push(c.method+" "+p+" HTTP/1.1\n");Object(a.v)(l,st.a.headers),c.options&&Object(a.v)(l,c.options.headers),l.has("Accept")||l.append("Accept","application/json"),l.has("Content-Type")||l.append("Content-Type","application/json;odata=verbose;charset=utf-8"),l.has("X-ClientService-ClientTag")||l.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.8"),l.forEach(function(e,t){i.push(t+": "+e+"\n")}),i.push("\n"),c.options.body&&i.push(c.options.body+"\n\n")}u.length>0&&(i.push("--changeset_"+u+"--\n\n"),u=""),i.push("--batch_"+e.batchId+"--\n");var f={body:i.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return o.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),n.fetch(Object(a.i)(r,"/_api/$batch"),f).then(function(e){return e.text()}).then(t.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return o.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,r){var i=e.requests[r];return o.write("["+i.id+"] ("+(new Date).getTime()+") Resolving request in batch "+e.batchId+".",1),t.then(function(e){return i.parser.parse(n).then(i.resolve).catch(i.reject)})},Promise.resolve())})})},t}(N);function $n(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function Yn(e,t){void 0===t&&(t=0);var n=this.substring(t).search(e);return n>=0?n+t:n}function Zn(e,t,n){var r=[];if(void 0===e||null===e)return r;var o=e.replace(/[\t\r\n]/g,""),i=Yn.call(o,t);if(i<0)return r;for(;i>-1;){for(var u=1,s=i+1,a=-1,c=-1;;){if(a=Yn.call(o,/<div[^>]*>/i,s),c=Yn.call(o,/<\/div>/i,s),a<0&&(a=o.length+1),a<c?(u++,s=a+1):c<a&&(u--,s=c+1),0===u){var l=o.substring(i,c+6).trim();r.push(n(l));break}if(u>1e3||u<0)throw Error("getBoundedDivMarkup exceeded depth parameters.")}i=Yn.call(o,t,c)}return r}function er(e){for(var t=0;t<e.length;t++)e[t].order=t+1,Object(a.q)(e[t],"columns")?er(e[t].columns):Object(a.q)(e[t],"controls")&&er(e[t].controls)}!function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(Qn||(Qn={}));var tr=function(e){function t(t,n,r){void 0===n&&(n=[]),void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.sections=n,o.commentsDisabled=r,o}return d.c(t,e),t.create=function(e,n,r,o){return void 0===o&&(o="Article"),e.rootFolder.files.select("Name").filter("Name eq '"+n+"'").get().then(function(i){if(i.length>0)throw Error("A file with the name '"+n+"' already exists in the library '"+e.toUrl()+"'.");return e.rootFolder.select("ServerRelativePath").get().then(function(i){var u=Object(a.i)("/",i.ServerRelativePath.DecodedUrl,n);return e.rootFolder.files.addTemplateFile(u,Zt.ClientSidePage).then(function(e){return e.file.getItem().then(function(e){return e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:o,PromotedState:0,Title:r}).then(function(e){return new t(e.item.file,e.item.CommentsDisabled)})})})})})},t.fromFile=function(e){var n=new t(e);return n.load().then(function(e){return n})},t.jsonToEscapedString=function(e){return Object(a.u)(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;").replace(/\[/g,"[").replace(/\]/g,"]").replace(/\*/g,"*").replace(/\$/g,"$").replace(/\./g,".")},t.escapedStringToJson=function(e){return Object(a.y)(e)?JSON.parse(function(e){return[[/&quot;/g,'"'],[/&#58;/g,":"],[/&#123;/g,"{"],[/&#125;/g,"}"],[/\\\\/g,"\\"],[/\\\?/g,"?"],[/\\\./g,"."],[/\\\[/g,"["],[/\\\]/g,"]"],[/\\\(/g,"("],[/\\\)/g,")"],[/\\\|/g,"|"],[/\\\+/g,"+"],[/\\\*/g,"*"],[/\\\$/g,"$"]].reduce(function(e,t){return e.replace(t[0],t[1])},e)}(e)):null},t.prototype.addSection=function(){var e=new nr(this,$n(this.sections));return this.sections.push(e),e},t.prototype.toHtml=function(){er(this.sections);var e=[];e.push("<div>");for(var t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")},t.prototype.fromHtml=function(e){var t=this;return this.sections=[],Zn(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,function(e){var n=/controlType&quot;&#58;(\d*?),/i.exec(e),r=null;switch(null==n||n.length<2?0:parseInt(n[1],10)){case 0:(r=new or(null,0)).fromHtml(e),t.mergeColumnToTree(r);break;case 3:(r=new sr("")).fromHtml(e),t.mergePartToTree(r);break;case 4:(r=new ur).fromHtml(e),t.mergePartToTree(r)}}),er(this.sections),this},t.prototype.load=function(){var e=this;return this.getItem("CanvasContent1","CommentsDisabled").then(function(t){e.fromHtml(t.CanvasContent1),e.commentsDisabled=t.CommentsDisabled})},t.prototype.save=function(){return this.updateProperties({CanvasContent1:this.toHtml()})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},t.prototype.like=function(){return this.getItem().then(function(e){return e.like()})},t.prototype.unlike=function(){return this.getItem().then(function(e){return e.unlike()})},t.prototype.getLikedByInformation=function(){return this.getItem().then(function(e){return e.getLikedByInformation()})},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new Ln(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.mergePartToTree=function(e){var t=null,n=null,r=12,o=0,i=0;Object(a.q)(e.controlData,"position")&&(Object(a.q)(e.controlData.position,"zoneIndex")&&(i=e.controlData.position.zoneIndex),Object(a.q)(e.controlData.position,"sectionIndex")&&(o=e.controlData.position.sectionIndex),Object(a.q)(e.controlData.position,"sectionFactor")&&(r=e.controlData.position.sectionFactor));var u=this.sections.filter(function(e){return e.order===i});u.length<1?(t=new nr(this,i),this.sections.push(t)):t=u[0];var s=t.columns.filter(function(e){return e.order===o});s.length<1?(n=new or(t,o,r),t.columns.push(n)):n=s[0],e.column=n,n.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=Object(a.q)(e.controlData,"position")&&Object(a.q)(e.controlData.position,"zoneIndex")?e.controlData.position.zoneIndex:0,n=null,r=this.sections.filter(function(e){return e.order===t});r.length<1?(n=new nr(this,t),this.sections.push(n)):n=r[0],e.section=n,n.columns.push(e)},t.prototype.updateProperties=function(e,t){return void 0===t&&(t="*"),this.getItem().then(function(n){return n.update(e,t)})},t}(Hn),nr=function(){function e(e,t,n){void 0===n&&(n=[]),this.page=e,this.order=t,this.columns=n,this._memId=Object(a.n)()}return Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new or(this,$n(this.columns),e);return this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},e.prototype.toHtml=function(){for(var e=[],t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")},e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter(function(t){return t._memId!==e._memId}),er(this.page.sections)},e}(),rr=function(){function e(e,t,n,r,o,i){void 0===n&&(n=null),void 0===r&&(r=1),void 0===o&&(o=Object(a.n)()),void 0===i&&(i=null),this.controlType=e,this.dataVersion=t,this.column=n,this.order=r,this.id=o,this.controlData=i}return Object.defineProperty(e.prototype,"jsonData",{get:function(){return tr.jsonToEscapedString(this.getControlData())},enumerable:!0,configurable:!0}),e.prototype.fromHtml=function(e){this.controlData=tr.escapedStringToJson(Object(a.l)(e,"data-sp-controldata")),this.dataVersion=Object(a.l)(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id},e}(),or=function(e){function t(t,n,r,o,i){void 0===r&&(r=12),void 0===o&&(o=[]),void 0===i&&(i="1.0");var u=e.call(this,0,i)||this;return u.section=t,u.order=n,u.factor=r,u.controls=o,u}return d.c(t,e),t.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},t.prototype.getControl=function(e){return this.controls[e]},t.prototype.toHtml=function(){var e=[];if(this.controls.length<1)e.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'"></div>');else for(var t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t),this.controlData=tr.escapedStringToJson(Object(a.l)(t,"data-sp-controldata")),Object(a.q)(this.controlData,"position")&&(Object(a.q)(this.controlData.position,"sectionFactor")&&(this.factor=this.controlData.position.sectionFactor),Object(a.q)(this.controlData.position,"sectionIndex")&&(this.order=this.controlData.position.sectionIndex))},t.prototype.getControlData=function(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}},t.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter(function(t){return t.id!==e.id}),er(this.column.controls)},t}(rr),ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter(function(t){return t.id!==e.id}),er(this.column.controls)},t}(rr),ur=function(e){function t(t){void 0===t&&(t="");var n=e.call(this,4,"1.0")||this;return n.text=t,n}return d.c(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this._text=e},enumerable:!0,configurable:!0}),t.prototype.getControlData=function(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}},t.prototype.toHtml=function(e){this.order=e;var t=[];return t.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.dataVersion+'" data-sp-controldata="'+this.jsonData+'">'),t.push('<div data-sp-rte="">'),t.push(""+this.text),t.push("</div>"),t.push("</div>"),t.join("")},t.prototype.fromHtml=function(t){var n=this;e.prototype.fromHtml.call(this,t),this.text="",Zn(t,/<div[^>]*data-sp-rte[^>]*>/i,function(e){var t=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(e);n.text=t.length>1?t[1]:""})},t}(ir),sr=function(e){function t(t,n,r,o,i,u,s){void 0===n&&(n=""),void 0===r&&(r={}),void 0===o&&(o=""),void 0===i&&(i=""),void 0===u&&(u=null),void 0===s&&(s="1.0");var a=e.call(this,3,"1.0")||this;return a.title=t,a.description=n,a.propertieJson=r,a.webPartId=o,a.htmlProperties=i,a.serverProcessedContent=u,a.canvasDataVersion=s,a}return d.c(t,e),t.fromComponentDef=function(e){var n=new t("");return n.import(e),n},t.prototype.import=function(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"").toLowerCase();var t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.dataVersion="1.0",this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)},t.prototype.setProperties=function(e){return this.propertieJson=Object(a.k)(this.propertieJson,e),this},t.prototype.getProperties=function(){return this.propertieJson},t.prototype.toHtml=function(e){this.order=e;var t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,serverProcessedContent:this.serverProcessedContent,title:this.title},n=[];return n.push('<div data-sp-canvascontrol="" data-sp-canvasdataversion="'+this.canvasDataVersion+'" data-sp-controldata="'+this.jsonData+'">'),n.push('<div data-sp-webpart="" data-sp-webpartdataversion="'+this.dataVersion+'" data-sp-webpartdata="'+tr.jsonToEscapedString(t)+'">'),n.push("<div data-sp-componentid>"),n.push(this.webPartId),n.push("</div>"),n.push('<div data-sp-htmlproperties="">'),n.push(this.renderHtmlProperties()),n.push("</div>"),n.push("</div>"),n.push("</div>"),n.join("")},t.prototype.fromHtml=function(t){e.prototype.fromHtml.call(this,t);var n=tr.escapedStringToJson(Object(a.l)(t,"data-sp-webpartdata"));this.title=n.title,this.description=n.description,this.webPartId=n.id,this.canvasDataVersion=Object(a.l)(t,"data-sp-canvasdataversion").replace(/\\\./,"."),this.dataVersion=Object(a.l)(t,"data-sp-webpartdataversion").replace(/\\\./,"."),this.setProperties(n.properties),void 0!==n.serverProcessedContent&&(this.serverProcessedContent=n.serverProcessedContent);var r=Zn(t,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,function(e){return e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,"")});this.htmlProperties=r.length>0?r[0]:""},t.prototype.getControlData=function(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}},t.prototype.renderHtmlProperties=function(){var e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts)for(var t=Object.keys(this.serverProcessedContent.searchablePlainTexts),n=0;n<t.length;n++)e.push('<div data-sp-prop-name="'+t[n]+'" data-sp-searchableplaintext="true">'),e.push(this.serverProcessedContent.searchablePlainTexts[t[n]]),e.push("</div>");if(void 0!==this.serverProcessedContent.imageSources)for(t=Object.keys(this.serverProcessedContent.imageSources),n=0;n<t.length;n++)e.push('<img data-sp-prop-name="'+t[n]+'" src="'+this.serverProcessedContent.imageSources[t[n]]+'" />');if(void 0!==this.serverProcessedContent.links)for(t=Object.keys(this.serverProcessedContent.links),n=0;n<t.length;n++)e.push('<a data-sp-prop-name="'+t[n]+'" href="'+this.serverProcessedContent.links[t[n]]+'"></a>')}return e.join("")},t.prototype.parseJsonProperties=function(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e},t}(ir),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.getById=function(e){var t=new cr(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,n,r){var o=this;void 0===r&&(r=!0);var i=Object(a.u)(Object(a.k)(ht("SP.NavigationNode"),{IsVisible:r,Title:e,Url:n}));return this.clone(t,null).postCore({body:i}).then(function(e){return{data:e,node:o.getById(e.Id)}})},t.prototype.moveAfter=function(e,n){var r=Object(a.u)({nodeId:e,previousNodeId:n});return this.clone(t,"MoveAfter").postCore({body:r})},t}(yt),cr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new ar(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.update=function(e){var t=this,n=Object(a.u)(Object(a.k)({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})},t}(gt),lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new ar(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new ar(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t=d.b([bt("navigation")],t)}(ft),pr=function(e){function t(t){return void 0===t&&(t=null),e.call(this,"_api/navigation",t)||this}return d.c(t,e),t.prototype.getMenuState=function(e,n,r,o){return void 0===e&&(e=null),void 0===n&&(n=10),void 0===r&&(r=null),void 0===o&&(o=null),new t("MenuState").postCore({body:Object(a.u)({customProperties:o,depth:n,mapProviderName:r,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,n){return void 0===n&&(n=null),new t("MenuNodeKey").postCore({body:Object(a.u)({currentUrl:e,mapProviderName:n})})},t}(ft),dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new hr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new hr(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new fr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new yr(this)},enumerable:!0,configurable:!0}),t=d.b([bt("regionalsettings")],t)}(gt),hr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([bt("installedlanguages")],t)}(yt),fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(n,"utctolocaltime('"+t+"')").postCore().then(function(e){return Object(a.q)(e,"UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:Object(a.j)(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(n,"localtimetoutc('"+t+"')").postCore().then(function(e){return Object(a.q)(e,"LocalTimeToUTC")?e.LocalTimeToUTC:e})},t=n=d.b([bt("timezone")],t)}(gt),yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},it(fr))},t=n=d.b([bt("timezones")],t)}(yt),gr=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),br=new Map([]);function mr(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function vr(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(e,t,n){var r=t.toString();if("toSearchQuery"===r)return function(){return e.query};if(gr.has(r))return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=gr.get(r);return e.query[i.length>0?i:mr(r)]=t.length>1?t:t[0],n};var o=br.has(r)?br.get(r):mr(r);return e.query[o]=!0,n}})}var Or,Sr,Tr,wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.execute=function(e){var t=this,n=this.parseQuery(e),r=Object(a.u)({request:Object(a.k)(ht("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},n,{HitHighlightedProperties:this.fixArrProp(n.HitHighlightedProperties),Properties:this.fixArrProp(n.Properties),RefinementFilters:this.fixArrProp(n.RefinementFilters),ReorderingRules:this.fixArrProp(n.ReorderingRules),SelectProperties:this.fixArrProp(n.SelectProperties),SortList:this.fixArrProp(n.SortList)}))});if(this._useCaching){this._forceCaching=!0;var o="PnPjs.SearchWithCaching("+Object(a.o)(r)+")";Object(a.y)(this._cachingOptions)?/\/_api\/search\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=o):this._cachingOptions=new h(o)}return this.postCore({body:r}).then(function(e){return new Cr(e,t.toUrl(),n)})},t.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:(e=Object(a.r)(e)?e:[e],Object(a.q)(e,"results")?e:{results:e})},t.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},t=d.b([bt("_api/search/postquery")],t)}(gt),Cr=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var n=void 0!==t?t:Object(a.q)(this._query,"RowLimit")?this._query.RowLimit:10,r=Object(a.k)(this._query,{RowLimit:n,StartRow:n*(e-1)});return r.StartRow>this.TotalRows?Promise.resolve(null):new wr(this._url,null).execute(r)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=0,r=e.results?e.results:e;n<r.length;n++){var o=r[n],i=o.Cells.results?o.Cells.results:o.Cells;t.push(i.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(Or||(Or={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(Sr||(Sr={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(Tr||(Tr={}));var Pr,_r,Ir,Er,jr=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),Rr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){var t=Object(a.q)(e,"suggest")?function(t){return e.suggest[t].results}:function(t){return e[t]};return{PeopleNames:t("PeopleNames"),PersonalResults:t("PersonalResults"),Queries:t("Queries")}})},t.prototype.mapQueryToQueryString=function(e){var t=this;this.query.set("querytext","'"+e.querytext+"'");var n=function(e){return function(n){return function(r){Object(a.q)(e,n)&&t.query.set(r,e[n].toString())}}}(e);n("count")("inumberofquerysuggestions"),n("personalCount")("inumberofresultsuggestions"),n("preQuery")("fprequerysuggestions"),n("hitHighlighting")("fhithighlighting"),n("capitalize")("fcapitalizefirstletters"),n("culture")("culture"),n("stemming")("enablestemming"),n("includePeople")("showpeoplenamesuggestions"),n("queryRules")("enablequeryrules"),n("prefixMatch")("fprefixmatchallterms")},t=d.b([bt("_api/search/suggest")],t)}(gt),Nr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(n,"add").postCore({body:Object(a.u)({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},t.prototype.getById=function(e){var t=new Ar(this);return t.concat("('"+e+"')"),t},t.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(n,"remove").postCore({body:Object(a.u)({featureId:e,force:t})})},t=n=d.b([bt("features")],t)}(yt),Ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.deactivate=function(e){var n=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new t(this).select("DefinitionId").get().then(function(t){var o=n.getParent(Nr,n.parentUrl,"",n.batch).remove(t.DefinitionId,e);return r(),o})},t}(gt),kr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.FromUrl=function(e){if(null===e)return new n("");var t=e.indexOf("_api/");return new n(t>-1?e.substr(0,t):e)},t.prototype.getRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetRelatedItems"),r.postCore({body:Object(a.u)({SourceItemID:t,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(n,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:Object(a.u)({SourceItemID:t,SourceListName:e})})},t.prototype.addSingleLink=function(e,t,r,o,i,u,s){void 0===s&&(s=!1);var c=this.clone(n,null);return c.concat(".AddSingleLink"),c.postCore({body:Object(a.u)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryAddReverseLink:s})})},t.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkToUrl"),i.postCore({body:Object(a.u)({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var i=this.clone(n,null);return i.concat(".AddSingleLinkFromUrl"),i.postCore({body:Object(a.u)({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,t,r,o,i,u,s){void 0===s&&(s=!1);var c=this.clone(n,null);return c.concat(".DeleteSingleLink"),c.postCore({body:Object(a.u)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:i,TargetListName:o,TargetWebUrl:u,TryDeleteReverseLink:s})})},t=n=d.b([bt("_api/SP.RelatedItemManager")],t)}(ft),xr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.add=function(e,t,r,o,i,u){void 0===r&&(r=""),void 0===o&&(o="STS"),void 0===i&&(i=1033),void 0===u&&(u=!0);var s={Description:r,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:u,WebTemplate:o},c=Object(a.u)({parameters:Object(a.k)({__metadata:{type:"SP.WebCreationInformation"}},s)});return this.clone(n,"add").postCore({body:c}).then(function(e){return{data:e,web:new Dr(nt(e).replace(/_api\/web\/?/i,""))}})},t=n=d.b([bt("webs")],t)}(yt),Ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t=d.b([bt("webinfos")],t)}(yt),Dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.fromUrl=function(e,t){return new n(tt(e),t)},Object.defineProperty(t.prototype,"webs",{get:function(){return new xr(this)},enumerable:!0,configurable:!0}),t.prototype.getParentWeb=function(){var e=this;return this.select("ParentWeb/Id").expand("ParentWeb").get().then(function(t){var n=t.ParentWeb;return n?new Lr(e.parentUrl).openWebById(n.Id):null})},t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(xr,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(yt,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new Ur(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new fn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new Nn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new wn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new Nr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new wn(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new lr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new Wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new An(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new dr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new Tt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new dn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new jn(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new Qt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return kr.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new Xn(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new hn(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new Ht(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new Ht(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new Ht(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultDocumentLibrary",{get:function(){return new An(this,"DefaultDocumentLibrary")},enumerable:!0,configurable:!0}),t.prototype.getFolderByServerRelativeUrl=function(e){return new hn(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new hn(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new Hn(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new Hn(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new An(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,n=Object(a.u)(Object(a.k)({__metadata:{type:"SP.Web"}},e));return this.postCore({body:n,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,t,r,o){var i=Object(a.u)({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(n,"applytheme").postCore({body:i})},t.prototype.applyWebTemplate=function(e){var t=this.clone(n,"applywebtemplate");return t.concat("(@t)"),t.query.set("@t",e),t.postCore()},t.prototype.ensureUser=function(e){var t=Object(a.u)({logonName:e});return this.clone(n,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new St(nt(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new yt(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(n,"getcatalog("+e+")").select("Id").get().then(function(e){return new An(nt(e))})},t.prototype.getChanges=function(e){var t=Object(a.u)({query:Object(a.k)({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(n,"getchanges").postCore({body:t})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new yt(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new St(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=""),this.clone(n,"maptoicon(filename='"+e+"', progid='"+r+"', size="+t+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(n,"getStorageEntity('"+e+"')").get()},t.prototype.setStorageEntity=function(e,t,r,o){return void 0===r&&(r=""),void 0===o&&(o=""),this.clone(n,"setStorageEntity").postCore({body:Object(a.u)({comments:o,description:r,key:e,value:t})})},t.prototype.removeStorageEntity=function(e){return this.clone(n,"removeStorageEntity('"+e+"')").postCore()},t.prototype.getAppCatalog=function(e){return new zn(e||this)},t.prototype.getClientSideWebParts=function(){return this.clone(yt,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t,n){return void 0===t&&(t=e.replace(/\.[^/.]+$/,"")),void 0===n&&(n="Site Pages"),tr.create(this.lists.getByTitle(n),e,t)},t.prototype.addClientSidePageByPath=function(e,t,n){return void 0===n&&(n=e.replace(/\.[^/.]+$/,"")),tr.create(this.getList(t),e,n)},t.prototype.createDefaultAssociatedGroups=function(e,t,r){var o=this.clone(n,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return o.query.set("@u","'"+encodeURIComponent(e||"")+"'"),o.query.set("@v","'"+encodeURIComponent(t||"")+"'"),o.query.set("@s","'"+encodeURIComponent(r||"")+"'"),o.postCore()},t.prototype.hubSiteData=function(e){return void 0===e&&(e=!1),this.clone(n,"hubSiteData("+e+")").get()},t.prototype.syncHubSiteTheme=function(){return this.clone(n,"syncHubSiteTheme").postCore()},t=n=d.b([bt("_api/web")],t)}(nn),Lr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new Dr(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new Nr(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new jn(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new Dr(e.Url)})},t.prototype.getContextInfo=function(){return new n(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(Object(a.q)(e,"GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new ft("","_api/sp.web.getdocumentlibraries(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return Object(a.q)(e,"GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new ft("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return Object(a.q)(e,"GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new Xn(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(n,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Dr.fromUrl(e["odata.id"]||e.__metadata.uri)}})},t.prototype.joinHubSite=function(e){return this.clone(n,"joinHubSite('"+e+"')").postCore()},t.prototype.registerHubSite=function(){return this.clone(n,"registerHubSite").postCore()},t.prototype.unRegisterHubSite=function(){return this.clone(n,"unRegisterHubSite").postCore()},t.prototype.createCommunicationSite=function(e,t,n,r,o,i,u){var s=this;void 0===t&&(t=1033),void 0===n&&(n=!1),void 0===o&&(o=""),void 0===i&&(i=""),void 0===u&&(u="00000000-0000-0000-0000-000000000000");var c={Classification:i,Description:o,Lcid:t,ShareByEmailEnabled:n,SiteDesignId:u,Title:e,Url:r,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:"00000000-0000-0000-0000-000000000000"},l=Object(a.u)({request:Object(a.k)({__metadata:{type:"Microsoft.SharePoint.Portal.SPSiteCreationRequest"}},c)});return this.getRootWeb().then(function(e){return d.a(s,void 0,void 0,function(){var t,n;return d.d(this,function(r){return t=new pt,n=e.parentUrl+"/_api/SPSiteManager/Create",[2,t.post(n,{body:l,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},t.prototype.createModernTeamSite=function(e,t,n,r,o,i,u){var s=this;void 0===n&&(n=!0),void 0===r&&(r=1033),void 0===o&&(o=""),void 0===i&&(i="");var c=Object(a.u)({alias:t,displayName:e,isPublic:n,optionalParams:{Classification:i,CreationOptions:{results:["SPSiteLanguage:"+r]},Description:o,Owners:{results:u||[]}}});return this.getRootWeb().then(function(e){return d.a(s,void 0,void 0,function(){var t,n;return d.d(this,function(r){return t=new pt,n=e.parentUrl+"/_api/GroupSiteManager/CreateGroupEx",[2,t.post(n,{body:c,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},t=n=d.b([bt("_api/site")],t)}(gt),Fr=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.clientPeoplePickerQuery=new Br(t).configureFrom(r),r.profileLoader=new qr(t).configureFrom(r),r}return d.c(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=this.clone(t,"amifollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.amIFollowing=function(e){var n=this.clone(t,"amifollowing(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var n=this.clone(t,"getfollowersfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new yt(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=this.clone(t,"getpeoplefollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getPropertiesFor=function(e){var n=this.clone(t,"getpropertiesfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var r=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.hideSuggestion=function(e){var n=this.clone(t,"hidesuggestion(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.postCore()},t.prototype.isFollowing=function(e,n){var r=this.clone(t,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.query.set("@y","'"+encodeURIComponent(n)+"'"),r.get()},t.prototype.setMyProfilePic=function(e){var n=this;return new Promise(function(r,o){var i=null,u=new FileReader;u.onload=function(e){return i=e.target.result},u.readAsArrayBuffer(e),new t(n,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(i))}).then(function(e){return r()}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,n,r){var o=Object(a.u)({accountName:e,propertyName:n,propertyValue:r});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:o})},t.prototype.setMultiValuedProfileProperty=function(e,n,r){var o=Object(a.u)({accountName:e,propertyName:n,propertyValues:r});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:o})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(gt),qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(n,"createpersonalsiteenqueuebulk",!1).postCore({body:Object(a.u)({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(n,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(n,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(n,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(n,"getuserprofile/shareallsocialdata("+e+")").postCore()},t=n=d.b([bt("_api/sp.userprofiles.profileloader.getprofileloader")],t)}(ft),Br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(n,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerResolveUser:e}).then(JSON.parse)},t.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(n,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerSearchUser:e}).then(JSON.parse)},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return Object(a.u)({queryParams:Object(a.k)(ht("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})},t=n=d.b([bt("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],t)}(ft),Mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,Object.defineProperty(t.prototype,"my",{get:function(){return new Gr(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(n,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(n,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(n,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(n,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(n,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return Object(a.u)({actor:Object.assign(ht("SP.Social.SocialActorInfo"),{Id:null},e)})},t=n=d.b([bt("_api/social.following")],t)}(gt),Gr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var n;return d.c(t,e),n=t,t.prototype.followed=function(e){return this.clone(n,"followed(types="+e+")").get().then(function(e){return Object(a.q)(e,"Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(n,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(n,"followers").get().then(function(e){return Object(a.q)(e,"Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(n,"suggestions").get().then(function(e){return Object(a.q)(e,"Suggestions")?e.Suggestions.results:e})},t=n=d.b([bt("my")],t)}(gt);!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Pr||(Pr={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(_r||(_r={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Ir||(Ir={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(Er||(Er={}));var Wr=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return d.c(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getSiteScripts=function(){return this.clone(t,"GetSiteScripts",!0).execute({})},t.prototype.createSiteScript=function(e,n,r){return d.a(this,void 0,void 0,function(){return d.d(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+encodeURIComponent(e)+"'&@desc='"+encodeURIComponent(n)+"'").execute(r)];case 1:return[2,o.sent()]}})})},t.prototype.getSiteScriptMetadata=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteScriptMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteScript=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteScript").execute({id:e})];case 1:return n.sent(),[2]}})})},t.prototype.updateSiteScript=function(e,n){return d.a(this,void 0,void 0,function(){return d.d(this,function(r){switch(r.label){case 0:return n&&(e.Content=JSON.stringify(n)),[4,this.clone(t,"UpdateSiteScript").execute({updateInfo:e})];case 1:return[2,r.sent()]}})})},t}(ft),Hr=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return d.c(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.prototype.createSiteDesign=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"CreateSiteDesign").execute({info:e})];case 1:return[2,n.sent()]}})})},t.prototype.applySiteDesign=function(e,n){return d.a(this,void 0,void 0,function(){return d.d(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"ApplySiteDesign").execute({siteDesignId:e,webUrl:n})];case 1:return[2,r.sent()]}})})},t.prototype.getSiteDesigns=function(){return d.a(this,void 0,void 0,function(){return d.d(this,function(e){switch(e.label){case 0:return[4,this.clone(t,"GetSiteDesigns").execute({})];case 1:return[2,e.sent()]}})})},t.prototype.getSiteDesignMetadata=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.updateSiteDesign=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"UpdateSiteDesign").execute({updateInfo:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteDesign=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteDesign").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.getSiteDesignRights=function(e){return d.a(this,void 0,void 0,function(){return d.d(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignRights").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.grantSiteDesignRights=function(e,n,r){return void 0===r&&(r=1),d.a(this,void 0,void 0,function(){return d.d(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:n})];case 1:return[2,o.sent()]}})})},t.prototype.revokeSiteDesignRights=function(e,n){return d.a(this,void 0,void 0,function(){return d.d(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"RevokeSiteDesignRights").execute({id:e,principalNames:n})];case 1:return[2,r.sent()]}})})},t}(ft),Kr=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/SP.Utilities.Utility."+r)||this}return d.c(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e.toUrl(),n=t.indexOf("_api/");return n<0?t:t.substr(0,n)},t.prototype.excute=function(e){return this.postCore({body:Object(a.u)(e)})},t.prototype.sendEmail=function(e){var n={properties:Object(a.k)(ht("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(n.properties=Object(a.k)(n.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(n.properties=Object(a.k)(n.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(n.properties=Object(a.k)(n.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(n.properties=Object(a.k)(n.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(n)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({})},t.prototype.resolvePrincipal=function(e,n,r,o,i,u){void 0===u&&(u=!1);var s={addToUserInfoList:i,input:e,inputIsEmailOnly:o,matchUserInfoList:u,scopes:n,sources:r};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(s)},t.prototype.searchPrincipals=function(e,n,r,o,i){var u={groupName:o,input:e,maxCount:i,scopes:n,sources:r};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(u)},t.prototype.createEmailBodyForInvitation=function(e){var n={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(n)},t.prototype.expandGroupsToPrincipals=function(e,n){void 0===n&&(n=30);var r={inputs:e,maxCount:n};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(r)},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:e,file:new Hn(nt(e))}})},t.prototype.containsInvalidFileFolderChars=function(e,n){return void 0===n&&(n=!1),n?t.InvalidFileFolderNameCharsOnPremiseRegex.test(e):t.InvalidFileFolderNameCharsOnlineRegex.test(e)},t.prototype.stripInvalidFileFolderChars=function(e,n,r){return void 0===n&&(n=""),void 0===r&&(r=!1),r?e.replace(t.InvalidFileFolderNameCharsOnPremiseRegex,n):e.replace(t.InvalidFileFolderNameCharsOnlineRegex,n)},t.InvalidFileFolderNameCharsOnlineRegex=/["*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,t.InvalidFileFolderNameCharsOnPremiseRegex=/["#%*:<>?/\\|\x00-\x1f\x7f-\x9f]/g,t}(ft),Vr=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){Object(st.b)(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(Rr).execute(t)},e.prototype.search=function(e){return this.create(wr).execute(e)},e.prototype.searchWithCaching=function(e,t){return this.create(wr).usingCaching(t).execute(e)},Object.defineProperty(e.prototype,"site",{get:function(){return this.create(Lr)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return this.create(Dr)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return this.create(Fr)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return this.create(Mr)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return new pr},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return this.create(Kr,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteScripts",{get:function(){return this.create(Wr,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteDesigns",{get:function(){return this.create(Hr,"")},enumerable:!0,configurable:!0}),e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),Qr=(new Vr,new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return d.c(t,e),t.prototype.crossDomainSite=function(e,t){return this._cdImpl(Lr,e,t,"site")},t.prototype.crossDomainWeb=function(e,t){return this._cdImpl(Dr,e,t,"web")},t.prototype._cdImpl=function(e,t,n,r){if(!Object(a.t)(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!Object(a.t)(n))throw Error("The hostWebUrl parameter must be an absolute url.");var o=new e(Object(a.i)(t,"_api/SP.AppContextSite(@target)"),r);return o.query.set("@target","'"+encodeURIComponent(n)+"'"),o.configure(this._options)},t}(Vr)));var zr={combine:a.i,dateAdd:a.j,extend:a.k,getAttrValueFromString:a.l,getCtxCallback:a.m,getGUID:a.n,getRandomString:a.p,isArray:a.r,isFunc:a.s,isUrlAbsolute:a.t,objectDefinedNotNull:a.y,sanitizeGuid:a.A,stringIsNullOrEmpty:a.B},Jr=Qr,Xr=et,$r=new a.d,Yr=new c,Zr=o,eo=function(e){a.f.extend(e)},to={config:Yr,graph:Xr,log:Zr,setup:eo,sp:Jr,storage:$r,util:zr};n.d(t,"util",function(){return zr}),n.d(t,"sp",function(){return Jr}),n.d(t,"graph",function(){return Xr}),n.d(t,"storage",function(){return $r}),n.d(t,"config",function(){return Yr}),n.d(t,"log",function(){return Zr}),n.d(t,"setup",function(){return eo}),n.d(t,"odataUrlFrom",function(){return nt}),n.d(t,"spODataEntity",function(){return it}),n.d(t,"spODataEntityArray",function(){return ut}),n.d(t,"SharePointQueryable",function(){return ft}),n.d(t,"SharePointQueryableInstance",function(){return gt}),n.d(t,"SharePointQueryableCollection",function(){return yt}),n.d(t,"SharePointQueryableSecurable",function(){return en}),n.d(t,"FileFolderShared",function(){return on}),n.d(t,"SharePointQueryableShareable",function(){return tn}),n.d(t,"SharePointQueryableShareableFile",function(){return un}),n.d(t,"SharePointQueryableShareableFolder",function(){return sn}),n.d(t,"SharePointQueryableShareableItem",function(){return rn}),n.d(t,"SharePointQueryableShareableWeb",function(){return nn}),n.d(t,"AppCatalog",function(){return zn}),n.d(t,"App",function(){return Jn}),n.d(t,"SPBatch",function(){return Xn}),n.d(t,"ContentType",function(){return yn}),n.d(t,"ContentTypes",function(){return fn}),n.d(t,"FieldLink",function(){return bn}),n.d(t,"FieldLinks",function(){return gn}),n.d(t,"Field",function(){return Cn}),n.d(t,"Fields",function(){return wn}),n.d(t,"CheckinType",function(){return Xt}),n.d(t,"WebPartsPersonalizationScope",function(){return $t}),n.d(t,"MoveOperations",function(){return Yt}),n.d(t,"TemplateFileType",function(){return Zt}),n.d(t,"File",function(){return Hn}),n.d(t,"Files",function(){return Wn}),n.d(t,"Folder",function(){return hn}),n.d(t,"Folders",function(){return dn}),n.d(t,"SPHttpClient",function(){return pt}),n.d(t,"Item",function(){return Ln}),n.d(t,"Items",function(){return Dn}),n.d(t,"ItemVersion",function(){return qn}),n.d(t,"ItemVersions",function(){return Fn}),n.d(t,"PagedItemCollection",function(){return Bn}),n.d(t,"NavigationNodes",function(){return ar}),n.d(t,"NavigationNode",function(){return cr}),n.d(t,"NavigationService",function(){return pr}),n.d(t,"List",function(){return An}),n.d(t,"Lists",function(){return Nn}),n.d(t,"RegionalSettings",function(){return dr}),n.d(t,"InstalledLanguages",function(){return hr}),n.d(t,"TimeZone",function(){return fr}),n.d(t,"TimeZones",function(){return yr}),n.d(t,"SPRest",function(){return Vr}),n.d(t,"RoleDefinitionBindings",function(){return Jt}),n.d(t,"Search",function(){return wr}),n.d(t,"SearchQueryBuilder",function(){return vr}),n.d(t,"SearchResults",function(){return Cr}),n.d(t,"SortDirection",function(){return Or}),n.d(t,"ReorderingRuleMatchType",function(){return Sr}),n.d(t,"QueryPropertyValueType",function(){return Tr}),n.d(t,"SearchBuiltInSourceId",function(){return jr}),n.d(t,"SearchSuggest",function(){return Rr}),n.d(t,"Site",function(){return Lr}),n.d(t,"UserProfileQuery",function(){return Fr}),n.d(t,"toAbsoluteUrl",function(){return dt.a}),n.d(t,"extractWebUrl",function(){return tt}),n.d(t,"UtilityMethod",function(){return Kr}),n.d(t,"View",function(){return Sn}),n.d(t,"Views",function(){return On}),n.d(t,"ViewFields",function(){return Tn}),n.d(t,"WebPartDefinitions",function(){return cn}),n.d(t,"WebPartDefinition",function(){return ln}),n.d(t,"WebPart",function(){return pn}),n.d(t,"Web",function(){return Dr}),n.d(t,"SiteScripts",function(){return Wr}),n.d(t,"SiteDesigns",function(){return Hr}),n.d(t,"GraphRest",function(){return Ze}),n.d(t,"GroupType",function(){return B}),n.d(t,"Group",function(){return Oe}),n.d(t,"Groups",function(){return ve}),n.d(t,"GraphBatch",function(){return $e}),n.d(t,"GraphQueryable",function(){return U}),n.d(t,"GraphQueryableCollection",function(){return D}),n.d(t,"GraphQueryableInstance",function(){return F}),n.d(t,"GraphQueryableSearchableCollection",function(){return L}),n.d(t,"Logger",function(){return o}),n.d(t,"LogLevel",function(){return r}),n.d(t,"ConsoleListener",function(){return u}),n.d(t,"FunctionListener",function(){return s}),n.d(t,"PromotedState",function(){return Qn}),n.d(t,"ClientSidePage",function(){return tr}),n.d(t,"CanvasSection",function(){return nr}),n.d(t,"CanvasControl",function(){return rr}),n.d(t,"CanvasColumn",function(){return or}),n.d(t,"ClientSidePart",function(){return ir}),n.d(t,"ClientSideText",function(){return ur}),n.d(t,"ClientSideWebpart",function(){return sr}),n.d(t,"Comments",function(){return kn}),n.d(t,"Comment",function(){return xn}),n.d(t,"Replies",function(){return Un}),n.d(t,"SocialQuery",function(){return Mr}),n.d(t,"MySocialQuery",function(){return Gr}),n.d(t,"SocialActorType",function(){return Pr}),n.d(t,"SocialActorTypes",function(){return _r}),n.d(t,"SocialFollowResult",function(){return Ir}),n.d(t,"SocialStatusCode",function(){return Er}),n.d(t,"ControlMode",function(){return wt}),n.d(t,"FieldTypes",function(){return Ct}),n.d(t,"DateTimeFieldFormatType",function(){return Pt}),n.d(t,"AddFieldOptions",function(){return _t}),n.d(t,"CalendarType",function(){return It}),n.d(t,"UrlFieldFormatType",function(){return Et}),n.d(t,"PermissionKind",function(){return jt}),n.d(t,"PrincipalType",function(){return Rt}),n.d(t,"PrincipalSource",function(){return Nt}),n.d(t,"RoleType",function(){return At}),n.d(t,"PageType",function(){return kt}),n.d(t,"SharingLinkKind",function(){return xt}),n.d(t,"SharingRole",function(){return Ut}),n.d(t,"SharingOperationStatusCode",function(){return Dt}),n.d(t,"SPSharedObjectType",function(){return Lt}),n.d(t,"SharingDomainRestrictionMode",function(){return Ft}),n.d(t,"RenderListDataOptions",function(){return qt}),n.d(t,"FieldUserSelectionMode",function(){return Bt}),n.d(t,"ChoiceFieldFormatType",function(){return Mt}),n.d(t,"UrlZone",function(){return Gt}),n.d(t,"Teams",function(){return pe}),n.d(t,"Team",function(){return de}),n.d(t,"Channels",function(){return he}),n.d(t,"Channel",function(){return fe}),n.d(t,"Apps",function(){return ye}),n.d(t,"Tabs",function(){return ge}),n.d(t,"Tab",function(){return be}),n.d(t,"GraphEndpoints",function(){return x}),n.d(t,"OneNote",function(){return Pe}),n.d(t,"Notebooks",function(){return _e}),n.d(t,"Notebook",function(){return Ie}),n.d(t,"Sections",function(){return Ee}),n.d(t,"Section",function(){return je}),n.d(t,"Pages",function(){return Re}),n.d(t,"Contacts",function(){return Se}),n.d(t,"Contact",function(){return Te}),n.d(t,"ContactFolders",function(){return we}),n.d(t,"ContactFolder",function(){return Ce}),n.d(t,"Drives",function(){return Ne}),n.d(t,"Drive",function(){return Ae}),n.d(t,"Root",function(){return ke}),n.d(t,"DriveItems",function(){return xe}),n.d(t,"DriveItem",function(){return Ue}),n.d(t,"Children",function(){return De}),n.d(t,"DriveList",function(){return Le}),n.d(t,"Recent",function(){return Fe}),n.d(t,"SharedWithMe",function(){return qe}),n.d(t,"DriveSearch",function(){return Be}),n.d(t,"Thumbnails",function(){return Me}),n.d(t,"Planner",function(){return ne}),n.d(t,"Plans",function(){return re}),n.d(t,"Plan",function(){return oe}),n.d(t,"Tasks",function(){return ie}),n.d(t,"Task",function(){return ue}),n.d(t,"Buckets",function(){return se}),n.d(t,"Bucket",function(){return ae}),n.d(t,"Details",function(){return ce}),n.d(t,"DirectoryObjectType",function(){return me}),n.d(t,"DirectoryObjects",function(){return Qe}),n.d(t,"DirectoryObject",function(){return ze}),n.d(t,"Invitations",function(){return Ye}),n.d(t,"AdalClient",function(){return a.a}),n.d(t,"SPFxAdalClient",function(){return a.h}),n.d(t,"objectToMap",function(){return a.z}),n.d(t,"mergeMaps",function(){return a.w}),n.d(t,"RuntimeConfigImpl",function(){return a.g}),n.d(t,"RuntimeConfig",function(){return a.f}),n.d(t,"mergeHeaders",function(){return a.v}),n.d(t,"mergeOptions",function(){return a.x}),n.d(t,"FetchClient",function(){return a.c}),n.d(t,"BearerTokenFetchClient",function(){return a.b}),n.d(t,"PnPClientStorageWrapper",function(){return a.e}),n.d(t,"PnPClientStorage",function(){return a.d}),n.d(t,"getCtxCallback",function(){return a.m}),n.d(t,"dateAdd",function(){return a.j}),n.d(t,"combine",function(){return a.i}),n.d(t,"getRandomString",function(){return a.p}),n.d(t,"getGUID",function(){return a.n}),n.d(t,"isFunc",function(){return a.s}),n.d(t,"objectDefinedNotNull",function(){return a.y}),n.d(t,"isArray",function(){return a.r}),n.d(t,"extend",function(){return a.k}),n.d(t,"isUrlAbsolute",function(){return a.t}),n.d(t,"stringIsNullOrEmpty",function(){return a.B}),n.d(t,"getAttrValueFromString",function(){return a.l}),n.d(t,"sanitizeGuid",function(){return a.A}),n.d(t,"jsS",function(){return a.u}),n.d(t,"hOP",function(){return a.q}),n.d(t,"getHashCode",function(){return a.o}),n.d(t,"Settings",function(){return c}),n.d(t,"CachingConfigurationProvider",function(){return l}),n.d(t,"SPListConfigurationProvider",function(){return p}),n.d(t,"CachingOptions",function(){return h}),n.d(t,"CachingParserWrapper",function(){return f}),n.d(t,"HttpRequestError",function(){return y}),n.d(t,"ODataParserBase",function(){return g}),n.d(t,"ODataDefaultParser",function(){return b}),n.d(t,"TextParser",function(){return m}),n.d(t,"BlobParser",function(){return v}),n.d(t,"JSONParser",function(){return O}),n.d(t,"BufferParser",function(){return S}),n.d(t,"LambdaParser",function(){return T}),n.d(t,"setResult",function(){return w}),n.d(t,"pipe",function(){return P}),n.d(t,"requestPipelineMethod",function(){return _}),n.d(t,"PipelineMethods",function(){return I}),n.d(t,"getDefaultPipeline",function(){return E}),n.d(t,"Queryable",function(){return j}),n.d(t,"ODataQueryable",function(){return R}),n.d(t,"ODataBatch",function(){return N});t.default=to}])});
//# sourceMappingURL=pnpjs.es5.umd.bundle.min.js.map