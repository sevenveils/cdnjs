InteractiveDataDisplay={MinSizeToShow:1,Padding:20,maxTickArrangeIterations:5,tickLength:10,minLabelSpace:60,minTickSpace:5,minLogOrder:4,minNumOrder:8,TooltipDelay:1,TooltipDuration:10,CssPrefix:"",ZIndexNavigationLayer:1e3,ZIndexDOMMarkers:1500,ZIndexTooltipLayer:2e3,MaxInteger:9007199254740991,HeatmapworkerPath:void 0,factory:{}},InteractiveDataDisplay=InteractiveDataDisplay||{},InteractiveDataDisplay.Utils={logE10neg:1/Math.log(10),log10:void 0!==Math.log10?Math.log10:function(a){return Math.log(a)*InteractiveDataDisplay.Utils.logE10neg},applyMask:function(a,b,c){for(var d=a.length,e=new Array(c),f=0,g=0;f<d;f++)0===a[f]&&(e[g++]=b[f]);return e},maskNaN:function(a,b){for(var c=a.length;--c>=0;){var d=b[c];d!=d&&(a[c]=1)}},isArray:function(a){return a instanceof Array||a instanceof Float64Array||a instanceof Float32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array||a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array},isOrderedArray:function(a){if(a.length<=1)return!0;if(isNaN(a[1]))return!1;if(isNaN(a[2]))return!1;for(var b=a[1]-a[0],c=2;c<a.length;c++){if(b*(a[c]-a[c-1])<0)return!1}return!0},cutArray:function(a,b){if(void 0==a)return a;if(a.length>b){for(var c=new Array(b),d=0;d<b;d++)c[d]=a[d];return c}return a},intersect:function(a,b){if(a&&b){var c=Math.max(a.x,b.x),d=Math.min(a.x+a.width,b.x+b.width),e=Math.max(a.y,b.y),f=Math.min(a.y+a.height,b.y+b.height);return d>=c&&f>=e?{x:c,y:e,width:d-c,height:f-e}:void 0}},includes:function(a,b){return!(!a||!b)&&(a.x<=b.x&&a.x+a.width>=b.x+b.width&&a.y<=b.y&&a.y+a.height>=b.y+b.height)},equalRect:function(a,b){return!(!a||!b)&&(a.x==b.x&&a.width==b.width&&a.y==b.y&&a.height==b.height)},calcCSWithPadding:function(a,b,c,d){var e={left:c.left,top:c.top,width:b.width-c.left-c.right,height:b.height-c.top-c.bottom};return new InteractiveDataDisplay.CoordinateTransform(a,e,d)},requestAnimationFrame:function(a,b){setTimeout(a,1e3/60,b)},range:function(a,b){var c=b-a+1;if(c<=0)return[];for(var d=new Array(c),e=0;e<c;e++)d[e]=e;return d},arrangeDiv:function(a,b){a.width(b.width),a.height(b.height)},unionRects:function(a,b){if(void 0===a)return void 0===b?void 0:{x:b.x,y:b.y,width:b.width,height:b.height};if(void 0===b)return void 0===a?void 0:{x:a.x,y:a.y,width:a.width,height:a.height};var c=Math.min(a.x,b.x),d=Math.min(a.y,b.y);return{x:c,y:d,width:Math.max(a.x+a.width,b.x+b.width)-c,height:Math.max(a.y+a.height,b.y+b.height)-d}},readStyle:function(a,b){var c=a.attr("data-idd-style");if(c){for(var d=c.split(";"),e=d.length,f=0;f<e;f++){var g=d[f].split(":",2);if(g&&2===g.length){var h=g[0].trim(),i=g[1].trim();b[h]=i}}return b}},updateStyle:function(a,b,c,d){var b=InteractiveDataDisplay.Utils.readStyle(a,b);b||(b={}),b[c]=d;var e="";$.each(b,function(a,b){e+=a+": "+b+"; "}),a.attr("data-idd-style",e)},getDataSourceFunction:function(a,b){var c=a.attr("data-idd-datasource");return"InteractiveDataDisplay.readTable"==c?InteractiveDataDisplay.readTable:"InteractiveDataDisplay.readCsv"==c?InteractiveDataDisplay.readCsv:"InteractiveDataDisplay.readCsv2d"==c?InteractiveDataDisplay.readCsv2d:"InteractiveDataDisplay.readBase64"==c?InteractiveDataDisplay.readBase64:c?function(){return JSON.parse(c,function(a,b){return null===b?NaN:b})}:b},makeNonEqual:function(a){return a.min==a.max?0==a.min?{min:-1,max:1}:a.min>0?{min:.9*a.min,max:1.1*a.min}:{min:1.1*a.min,max:.9*a.min}:a},getMinMax:function(a){if(a&&0!==a.length){for(var b,c,d,e=a.length,f=0;f<e;f++)if((d=a[f])==d){b=c=d;break}for(f++;f<e;f++)(d=a[f])==d&&(d<b?b=d:d>c&&(c=d));return{min:b,max:c}}},getMin:function(a){if(a&&0!==a.length){for(var b,c,d=a.length,e=0;e<d;e++)if((c=a[e])==c){b=c;break}for(e++;e<d;e++)(c=a[e])==c&&c<b&&(b=c);return b}},getMax:function(a){if(a&&0!==a.length){for(var b,c,d=a.length,e=0;e<d;e++)if((c=a[e])==c){b=c;break}for(e++;e<d;e++)(c=a[e])==c&&c>b&&(b=c);return b}},getMinMaxForPair:function(a,b){if(a&&0!==a.length){if(!b||a.length!==b.length)throw"Arrays should be equal";for(var c,d,e,f,g,h,i=a.length,j=0;j<i;j++)if(g=a[j],h=b[j],!isNaN(g)&&!isNaN(h)){c=d=g,e=f=h;break}for(j++;j<i;j++)g=a[j],h=b[j],isNaN(g)||isNaN(h)||(g<c?c=g:g>d&&(d=g),h<e?e=h:h>f&&(f=h));return{minx:c,maxx:d,miny:e,maxy:f}}},enumPlots:function(a){var b=[],c=function(a,b){b.push(a),a.children&&a.children.forEach(function(a){c(a,b)})};return c(a,b),b.sort(function(a,b){return b.order-a.order}),b},reorder:function(a,b,c){a.order=c?b.order:b.order+1;var d=function(a,b){a.order>=b.order&&a!=b&&a.order<InteractiveDataDisplay.MaxInteger&&(a.order+=1),a.children&&a.children.forEach(function(a){d(a,b)})};d(a.master,a)},getMaxOrder:function(a){var b=a&&a.order!=InteractiveDataDisplay.MaxInteger?a.order:0;return a&&a.children&&a.children.forEach(function(a){var c=InteractiveDataDisplay.Utils.getMaxOrder(a);c!=InteractiveDataDisplay.MaxInteger&&(b=Math.max(b,c))}),b},getBoundingBoxForArrays:function(a,b,c,d){var e=void 0;if(a&&b){var f=InteractiveDataDisplay.Utils.getMinMaxForPair(a,b);if(f){c&&(f.minx=c(f.minx),f.maxx=c(f.maxx)),d&&(f.miny=d(f.miny),f.maxy=d(f.maxy));var g=Math.min(f.minx,f.maxx),h=Math.abs(f.maxx-f.minx);e={x:g,y:Math.min(f.miny,f.maxy),width:h,height:Math.abs(f.maxy-f.miny)}}}return e},getIEVersion:function(){var a=window.navigator.userAgent,b=a.indexOf("MSIE");return b>0?parseInt(a.substring(b+5,a.indexOf(".",b))):navigator.userAgent.match(/Trident\/7\./)?11:0},lastUsedIntId:0,generateNextIntId:function(){return this.lastUsedIntId++},resetLastUsedIntId:function(){return this.lastUsedIntId=0,this.lastUsedIntId},base64toByteArray:function(a){for(var b=atob(a),c=new Array(b.length),d=0;d<b.length;d++)c[d]=b.charCodeAt(d);return new Uint8Array(c)},byteArrayToTypedArray:function(a,b){var c,d=a.buffer;switch(b){case"uint8":return a;case"float32":c=new Float32Array(d);break;case"float64":c=new Float64Array(d);break;case"int16":c=new Int16Array(d);break;case"int32":c=new Int32Array(d);break;default:throw"Unexpected array type: "+b}return c}},InteractiveDataDisplay=InteractiveDataDisplay||{},InteractiveDataDisplay.Binding=InteractiveDataDisplay.Binding||{},function(){var a=[],b=[],c=[],d=[],e=function(a,b,c){for(var d=0,e=a.length;d<e;d++){var f=a[d];if(!(f.plot1!==b&&f.plot1!==c||f.plot2!==b&&f.plot2!==c))return d}return-1},f=function(a,b){var c=[];b=b.slice(0);for(var d=[a];d.length>0;){var e=d.shift();e!=a&&c.indexOf(e)<0&&c.push(e);for(var f=b.length;--f>=0;){var g=b[f],h=null;g.plot1===e?h=g.plot2:g.plot2===e&&(h=g.plot1),h&&(d.push(h),b.splice(f,1))}}return c},g=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++){var g=a[d];c.indexOf(g.plot1)<0&&c.push(g.plot1),c.indexOf(g.plot2)<0&&c.push(g.plot2)}b.splice(0);for(var d=0,e=c.length;d<e;d++){var h=f(c[d],a);b.push({plot:c[d],reachable:h})}};InteractiveDataDisplay.Binding.bindPlots=function(f,h,i){if(void 0==i||"vh"==i){var j=InteractiveDataDisplay.Binding.bindPlots(f,h,"v"),k=InteractiveDataDisplay.Binding.bindPlots(f,h,"h"),l=!1;return{destroy:function(){l||(j.destroy(),k.destroy(),l=!0)}}}if("v"!=i&&"h"!=i)throw"Parameter filter is incorrect";if(!f)throw"plot1 is incorrect";if(!h)throw"plot2 is incorrect";if(f=f.master,h=h.master,f===h)throw"plot1 equals plot2";var m="v"==i?b:a,n=e(m,f,h);if(n>=0)return m[n].binding;var o="v"==i?d:c,l=!1,p={plot1:f,plot2:h,binding:{destroy:function(){if(!l){var a=e(m,f,h);a&&m.splice(a,1),g(m,o),l=!0}}}};return m.push(p),g(m,o),f.requestUpdateLayout(),p.binding},InteractiveDataDisplay.Binding.getBoundPlots=function(a){for(var b={h:[],v:[]},e=0,f=c.length;e<f;e++)if(c[e].plot===a){b.h=c[e].reachable;break}for(var e=0,f=d.length;e<f;e++)if(d[e].plot===a){b.v=d[e].reachable;break}return b}}(),InteractiveDataDisplay.AdaptiveFormatter=function(a,b){var c=function(a){var b=d(a),c=a.map(function(a){var c=a-b;return c*c}),e=d(c);return Math.sqrt(e)},d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)isNaN(a[d])||(b+=a[d],++c);return 0!=c?b/c:NaN},e=function(a){if(a>=0){for(var b=1,c=0;c<a;c++)b*=10;return b}for(var b=1,c=0;c<-a;c++)b*=.1;return b};this.getPrintFormat=function(a,b,c){var d=2,f=Math.max(Math.abs(a),Math.abs(b));if(f===1/0||c===1/0||c===-1/0||isNaN(f)||isNaN(c))return{toString:function(a){return a}};var g,h=Math.LN10,i=f>1e-12?Math.log(f)/h:0;if((g=c>1e-12?Math.floor(Math.log(c)/h)-d:Math.floor(i-d))<0){var j=Math.floor(i);if(g<=-2&&j<=-4){var k=e(-j),l=j;return{toString:function(a){return l>0?(a*k).toFixed(-g+j)+"e+"+l:(a*k).toFixed(-g+j)+"e"+l},exponent:j}}return{toString:function(a){return a.toFixed(-g)}}}if(g>=2&&i>5){var k=e(-g-d),l=g+d;return{toString:function(a){return l>0?(a*k).toFixed(d)+"e+"+l:(a*k).toFixed(d)+"e"+l},exponent:g+d}}return{toString:function(a){var b=a.toFixed();return a!=b&&(b+="."),b}}};var f,g,h;if(void 0!==a&&void 0!==b)g=a,h=b,f=(h-g)/4;else if(void 0!==a&&void 0===b){var i=InteractiveDataDisplay.Utils.getMinMax(a);g=i.min,h=i.max,f=c(a)}return this.getPrintFormat(g,h,f)},InteractiveDataDisplay.register=function(a,b){if(!a)throw"key is undefined";if(!b)throw"factory is undefined";InteractiveDataDisplay.factory[a]=b};var _initializeInteractiveDataDisplay=function(){"use strict";var a=navigator.userAgent.toLowerCase();a.indexOf("firefox")>=0?InteractiveDataDisplay.CssPrefix="-moz":(a.indexOf("chrome")>=0||a.indexOf("safari")>=0)&&(InteractiveDataDisplay.CssPrefix="-webkit"),window.requestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(a){return window.requestAnimationFrame(a)}:window.msRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(a){return window.msRequestAnimationFrame(a)}:window.webkitRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(a){return window.webkitRequestAnimationFrame(a)}:window.mozRequestAnimationFrame?InteractiveDataDisplay.Utils.requestAnimationFrame=function(a){return window.mozRequestAnimationFrame(a)}:window.oRequestAnimationFrame&&(InteractiveDataDisplay.Utils.requestAnimationFrame=function(a){return window.oRequestAnimationFrame(a)});var b=function(a,c){if("undefined"!=typeof Modernizr&&a&&(Modernizr.canvas?Modernizr.borderradius?Modernizr.boxshadow?Modernizr.csstransforms?Modernizr.hsla?Modernizr.rgba||a.replaceWith('<div">Browser does not support rgba colors</div>'):a.replaceWith('<div">Browser does not support hsla colors</div>'):a.replaceWith('<div">Browser does not support 2d css transformations</div>'):a.replaceWith('<div">Browser does not support "box-shadow" style property</div>'):a.replaceWith('<div">Browser does not support "border-radius" style property</div>'):a.replaceWith('<div">Browser does not support HTML5 canvas</div>')),a.hasClass("idd-plot-master")||a.hasClass("idd-plot-dependant"))throw"The div element already is initialized as a plot";var d=void 0,e=a.attr("data-idd-plot");switch(e){case"plot":d=new InteractiveDataDisplay.Plot(a,c),d.order=InteractiveDataDisplay.MaxInteger;break;case"polyline":d=new InteractiveDataDisplay.Polyline(a,c);break;case"dom":d=new InteractiveDataDisplay.DOMPlot(a,c),d.order=InteractiveDataDisplay.MaxInteger;break;case"label":d=new InteractiveDataDisplay.LabelPlot(a,c),d.order=InteractiveDataDisplay.MaxInteger;break;case"figure":d=new InteractiveDataDisplay.Figure(a,c);break;case"chart":d=new InteractiveDataDisplay.Chart(a,c);break;case"grid":d=new InteractiveDataDisplay.GridlinesPlot(a,c);break;case"markers":d=new InteractiveDataDisplay.Markers(a,c);break;case"area":d=new InteractiveDataDisplay.Area(a,c);break;case"bingMaps":d=new InteractiveDataDisplay.BingMapsPlot(a,c)}var f=window.MutationObserver||window.WebKitMutationObserver;if(f){new f(function(a,e){a.forEach(function(a){var e=a.addedNodes,f=a.removedNodes;if(e.length>0)for(var g=0;g<e.length;g++){var h=$(e[g]);if(h.attr("data-idd-plot")){h.removeClass("idd-plot-master").removeClass("idd-plot-dependant");var i=b(h,c);d.addChild(i),d.assignChildOrder(i)}}if(f.length>0)for(var g=0;g<f.length;g++){var j=f[g];if("function"==typeof j.getAttribute){var k=j.getAttribute("data-idd-plot");null!=k&&d.removeChild(j.plot)}}})}).observe(a[0],{subtree:!1,characterData:!1,attributes:!1,childList:!0,attributeOldValue:!1,characterDataOldValue:!1})}else console.warn("MutationObservers are not supported by the browser. DOM changes are not tracked by IDD");if(d)return d;var g=InteractiveDataDisplay.factory[e];if(g)return g(a,c);throw"Unknown plot type"};InteractiveDataDisplay.asPlot=function(a){if(!a)throw"Plot must be attached to div!";var c;if(void 0!==a.tagName&&"div"===a.tagName.toLowerCase())c=$(a);else if("string"==typeof a){if(c=$("#"+a),0===c.length)throw"There is no element with id "+a;a=c[0]}else{if(!(a instanceof jQuery&&a.is("div")))throw"Invalid input parameter! It should be div or id of div or jQuery of single div";c=a,a=a[0]}return void 0!==a.plot?a.plot:b(c)},InteractiveDataDisplay.tryGetMasterPlot=function(a){if(a&&a.hasClass("idd-plot-master")){var b=a.get(0);return"plot"in b?b.plot:null}return null},InteractiveDataDisplay.updateLayouts=function(a){var b=InteractiveDataDisplay.tryGetMasterPlot(a);if(b)b.updateLayout();else for(var c=a.children(),d=0;d<c.length;d++)InteractiveDataDisplay.updateLayouts(c.eq(d))},InteractiveDataDisplay.Event=InteractiveDataDisplay.Event||{},InteractiveDataDisplay.Event.appearanceChanged=jQuery.Event("appearanceChanged"),InteractiveDataDisplay.Event.childrenChanged=jQuery.Event("childrenChanged"),InteractiveDataDisplay.Event.isAutoFitChanged=jQuery.Event("isAutoFitEnabledChanged"),InteractiveDataDisplay.Event.visibleRectChanged=jQuery.Event("visibleRectChanged"),InteractiveDataDisplay.Event.isVisibleChanged=jQuery.Event("visibleChanged"),InteractiveDataDisplay.Event.plotRemoved=jQuery.Event("plotRemoved"),InteractiveDataDisplay.Event.orderChanged=jQuery.Event("orderChanged"),InteractiveDataDisplay.Event.frameRendered=jQuery.Event("frameRendered");var c=0;InteractiveDataDisplay.Plot=function(a,d,e){if(!a||!a.hasClass("idd-plot-master")&&!a.hasClass("idd-plot-dependant")){a&&(a[0].addEventListener("touchstart",function(a){a.preventDefault()},!1),a[0].addEventListener("touchmove",function(a){a.preventDefault()},!1));var f,g,h,i,j,k,l=void 0===d&&void 0!==a,m=d||this,n=a,o=e||n,p=l?new InteractiveDataDisplay.CoordinateTransform:void 0,q=[],r=!0,s=!1,t=!1,u=!0,v=!1,w=!1,x=!1,y=!0,z=!1,A="",B=0,C=InteractiveDataDisplay.Padding,D={},E=!1,F=void 0;if(a){A=a.attr("data-idd-name")||a.attr("id")||"",a.attr("data-idd-X-log")&&(a.removeAttr("data-idd-X-log"),f=InteractiveDataDisplay.logTransform),a.attr("data-idd-Y-log")&&(a.removeAttr("data-idd-Y-log"),g=InteractiveDataDisplay.logTransform);var G={};InteractiveDataDisplay.Utils.readStyle(a,G),G.hasOwnProperty("padding")&&(C=Number(G.padding)),G.hasOwnProperty("suppress-tooltip-coords")&&(F=F||{},F.showCursorCoordinates=Boolean(G["suppress-tooltip-coords"])),G.hasOwnProperty("ignored-by-fit-to-view")&&(t=Boolean(G["ignored-by-fit-to-view"])),F=F||{},G.hasOwnProperty("tooltipDelay")?F.tooltipDelay=1e3*Number(G.tooltipDelay):F.tooltipDelay=1e3*InteractiveDataDisplay.TooltipDelay,a[0].plot=this,a.attr("unselectable","on").addClass("unselectable").on("selectstart",!1)}l&&(this._sharedCanvas=void 0);var H,I=!1;this.requestsRender=!1,this.isInAnimation=!1,this.isAnimationFrameRequested=!1;var J=!1;l&&(this.requestsUpdateLayout=!1);var K=void 0,L=this,M=c++;Object.defineProperty(this,"instanceId",{get:function(){return M},configurable:!1}),Object.defineProperty(this,"isMaster",{get:function(){return l},configurable:!1}),Object.defineProperty(this,"isRendered",{get:function(){return I},configurable:!1}),Object.defineProperty(this,"flatRendering",{get:function(){return l?z:d.flatRendering},set:function(a){if(!l)return void(d.flatRendering=a);z!==a&&(z=a,L.requestUpdateLayout())}}),Object.defineProperty(this,"isIgnoredByFitToView",{get:function(){return t},set:function(a){t=a,u&&this.requestUpdateLayout()}}),Object.defineProperty(this,"master",{get:function(){return m},configurable:!1}),Object.defineProperty(this,"host",{get:function(){return n},configurable:!1}),Object.defineProperty(this,"centralPart",{get:function(){return o},configurable:!1}),Object.defineProperty(this,"name",{get:function(){return A},set:function(a){A!==a&&(A=a,this.fireAppearanceChanged("name"))},configurable:!1}),Object.defineProperty(this,"children",{get:function(){return q.slice(0)},configurable:!1}),Object.defineProperty(this,"screenSize",{get:function(){return l?{width:i,height:j}:m.screenSize},configurable:!1}),Object.defineProperty(this,"xDataTransform",{get:function(){return f},set:function(a){f=a,this.onDataTransformChanged("x")},configurable:!1}),Object.defineProperty(this,"yDataTransform",{get:function(){return g},set:function(a){g=a,this.onDataTransformChanged("y")},configurable:!1}),Object.defineProperty(this,"coordinateTransform",{get:function(){return l?p.clone():m.coordinateTransform},configurable:!1}),Object.defineProperty(this,"doFitOnDataTransformChanged",{get:function(){return l?y:m.doFitOnDataTransformChanged},set:function(a){l?y=a:m.doFitOnDataTransformChanged=a},configurable:!1}),Object.defineProperty(this,"aspectRatio",{get:function(){return l?h:m.aspectRatio},set:function(a){l?(h=a,this.updateLayout()):m.aspectRatio=a},configurable:!1}),Object.defineProperty(this,"isAutoFitEnabled",{get:function(){return l?u:m.isAutoFitEnabled},set:function(a){if(l){if(u===a)return;u=a,u?this.requestUpdateLayout():k=L.visibleRect,this.host.trigger(InteractiveDataDisplay.Event.isAutoFitChanged)}else m.isAutoFitEnabled=a},configurable:!1}),Object.defineProperty(this,"isVisible",{get:function(){return r},set:function(a){r!==a&&(r=a,this.onIsVisibleChanged(),this.fireVisibleChanged(this))},configurable:!1}),Object.defineProperty(this,"isErrorVisible",{get:function(){return s},configurable:!0});var N=function(a){s!==a&&(s=a,this.onIsVisibleChanged(),this.fireVisibleChanged(this))};Object.defineProperty(this,"order",{get:function(){return B},set:function(a){B!==a&&(B=a,this.fireOrderChanged())},configurable:!1}),Object.defineProperty(this,"padding",{get:function(){return l?C:m.padding},set:function(a){l?(C=a,this.updateLayout()):m.padding=a},configurable:!1}),Object.defineProperty(this,"visibleRect",{get:function(){return l?p.getPlotRect({x:0,y:0,width:i,height:j}):m.visibleRect},configurable:!1});var O=void 0;Object.defineProperty(this,"mapControl",{get:function(){return l?O:m.mapControl},configurable:!1}),Object.defineProperty(this,"tooltipSettings",{get:function(){return l?F:m.tooltipSettings},set:function(a){l?F=a:m.tooltipSettings=a},configurable:!1});var P=!0;Object.defineProperty(this,"isToolTipEnabled",{get:function(){return l?P:m.isToolTipEnabled},set:function(a){l?P=a:m.isToolTipEnabled=a},configurable:!1}),Object.defineProperty(this,"titles",{get:function(){return $.extend({},D)},set:function(a){this.setTitles(a,!1)}}),this.selfMapRefresh=function(){if(l){if(void 0!==this.map){if(void 0!==O)throw"Plot composition can have only 1 map!";O=this.map,this.requestUpdateLayout()}if(this.constraint){if(void 0!==K)throw"Plot composition can have only 1 constraint function!";K=this.constraint}}},this.getTitle=function(a){return void 0!==D&&void 0!==D[a]?D[a]:a},this.setTitles=function(a,b){D=a,b||this.fireAppearanceChanged()},this.destroy=function(){this.host.removeClass("idd-plot")},this.remove=function(){void 0!==this.map&&this.master.removeMap(),this.isMaster||this.master.removeChild(this),this.firePlotRemoved(this),this.host.remove()},this.removeMap=function(){l&&(O=void 0,K=void 0,this.navigation.animation=new InteractiveDataDisplay.PanZoomAnimation,this.fitToView())},this.addChild=function(a){if(!a)throw"Child plot is undefined";if(a.master&&a.master!==a&&a.master!==this.master)throw"Given child plot already added to another plot";if(a.master!==this.master&&a.onAddedTo(this.master),q.push(a),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),a.constraint){if(void 0!==K)throw"Plot composition can have only 1 constraint function!";K=a.constraint}if(void 0!==a.map){if(void 0!==O)throw"Plot composition can have only 1 map!";O=a.map}this.fireChildrenChanged({type:"add",plot:a}),this.requestUpdateLayout()},this.assignChildOrder=function(a){void 0===a.host.attr("data-idd-plot-order")?a.order!=InteractiveDataDisplay.MaxInteger&&(a.order=InteractiveDataDisplay.Utils.getMaxOrder(this.master)+1):(a.order=a.host.attr("data-idd-plot-order"),a.host.removeAttr("data-idd-plot-order")),a.order<InteractiveDataDisplay.MaxInteger&&a.host.css("z-index",a.order)},this.onAddedTo=function(b){m=b,l=this===b;for(var c=q.length;--c>=0;)q[c].onAddedTo(b);l?a.addClass("idd-plot-master").removeClass("idd-plot-dependant"):a.removeClass("idd-plot-master").addClass("idd-plot-dependant")},this.removeChild=function(a){if(!a)throw"plot is undefined";for(var b,c=q.length;--c>=0;)if((b=q[c])===a||b.name===a)return q.splice(c,1),b.onAddedTo(b),this.master._sharedCanvas&&(this.master._sharedCanvas.remove(),this.master._sharedCanvas=void 0),void 0!==b.constraint&&(K=void 0),void 0!==b.map&&(O=void 0),this.fireChildrenChanged({type:"remove",plot:b}),this.requestUpdateLayout(),!0;for(c=q.length;--c>=0;)if(b=q[c],b.removeChild(a))return!0;return!1},this.getPlotsSequence=function(){for(var a=[L],b=q.length,c=0;c<b;c++){q[c].getPlotsSequence().forEach(function(b){a.push(b)})}return a},this.getLocalBounds=function(a,b){return H||(H=this.computeLocalBounds(a,b)),H},this.computeLocalBounds=function(a,b){},this.invalidateLocalBounds=function(){var a=H;return H=void 0,a},this.aggregateBounds=function(){for(var a=L.getPlotsSequence(),b=void 0,c=[],d=a.length,e=0;e<d;e++){var f=a[e];if(!f.isIgnoredByFitToView){var g=f.getLocalBounds(1);f.isVisible&&!f.isErrorVisible&&(void 0===g?c.push(f):b=InteractiveDataDisplay.Utils.unionRects(b,g))}}d=c.length;for(var h=b,e=0;e<d;e++){var f=c[e];b=InteractiveDataDisplay.Utils.unionRects(b,f.getLocalBounds(2,h))}if(void 0!==b){var i=100;if(0===b.width){var j=Math.max(.1,Math.abs(b.x));b.x=b.x-j/(2*i),b.width=j/i}if(0===b.height){var k=Math.max(.1,Math.abs(b.y));b.y=b.y-k/(2*i),b.height=k/i}}var m=l&&void 0===b;return m&&(b=void 0!==O?{x:-180,y:-90,width:360,height:180}:{x:0,y:0,width:1,height:1}),{bounds:b,isDefault:m}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.aggregatePadding=function(){for(var a=L.getLocalPadding()||{left:0,right:0,top:0,bottom:0},b=q.length,c=0;c<b;c++){var d=q[c],e=d.aggregatePadding();a={left:Math.max(a.left,e.left),right:Math.max(a.right,e.right),top:Math.max(a.top,e.top),bottom:Math.max(a.bottom,e.bottom)}}return a.left=a.left+this.padding||this.padding,a.right=a.right+this.padding||this.padding,a.top=a.top+this.padding||this.padding,a.bottom=a.bottom+this.padding||this.padding,a};var Q=function(){if(m.flatRendering&&(J=!0,m._sharedCanvas&&(m._sharedCanvas._dirty=!0)),L.requestsUpdateLayout)L.requestsUpdateLayout=!1,L.isAnimationFrameRequested=!1,J=!0,L.updateLayout();else{L.isAnimationFrameRequested=!1;var a=L.screenSize,b=L.coordinateTransform.getPlotRect({x:0,y:0,width:a.width,height:a.height});R(J,m,b,a),L.fireFrameRendered()}J=!1,ga&&ga()},R=function(a,b,c,d){if(b&&b.isVisible){(a||b.requestsRender)&&(b.requestsRender=!1,b.render(c,d));for(var e=b.children,f=e.length,g=0;g<f;g++){var h=e[g];R(a,h,c,d)}}};this.requestNextFrame=function(a){if(a=a||this,!l)return void m.requestNextFrame(a);a.requestsRender=!0,this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,J=!1,InteractiveDataDisplay.Utils.requestAnimationFrame(Q))},this.requestUpdateLayout=function(a){if(!l)return void m.requestUpdateLayout(a);J=!0,E=a&&a.suppressNotifyBoundPlots,this.requestsUpdateLayout||(a&&a.forceOnlyUpdatePlotsOutput||(this.requestsUpdateLayout=!0),this.isAnimationFrameRequested||(this.isAnimationFrameRequested=!0,InteractiveDataDisplay.Utils.requestAnimationFrame(Q)))},this.onIsVisibleChanged=function(){this.updateLayout()},this.onDataTranformChangedCore=function(a){},this.onDataTransformChanged=function(a){H=void 0,this.onDataTranformChangedCore(a),this.isAutoFitEnabled?this.master.requestUpdateLayout():this.doFitOnDataTransformChanged&&this.master.fitToView()},this.render=function(a,b){var c=this.getLocalBounds(),d=!1;if(c){InteractiveDataDisplay.Utils.intersect(c,a)?(N.call(this,!1),this.renderCore(a,b),d=!0):c.width==c.width&&c.height==c.height&&c.x==c.x&&c.y==c.y&&isFinite(c.width)&&isFinite(c.height)&&isFinite(c.y)&&isFinite(c.x)||N.call(this,!0)}else this.renderCore(a,b),d=!0;d!==I&&(I=d,this.onIsRenderedChanged())},this.renderCore=function(a,b){},this.exportToSvg=function(){if(!SVG.supported)throw"SVG is not supported";var a=L.screenSize,b=L.coordinateTransform.getPlotRect({x:0,y:0,width:a.width,height:a.height}),c=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=SVG(c).size(n.width(),n.height());return L.exportContentToSvg(b,a,d),d},this.exportContentToSvg=function(a,b,c){for(var d=InteractiveDataDisplay.Utils.enumPlots(this),e=d.length-1;e>=0;e--)d[e].isVisible&&d[e].renderCoreSvg(a,b,c)},this.exportLegendToSvg=function(a){if(!SVG.supported)throw"SVG is not supported";for(var b,c=L.screenSize,d=(L.coordinateTransform.getPlotRect({x:0,y:0,width:c.width,height:c.height}),document.createElementNS("http://www.w3.org/2000/svg","svg")),e=SVG(d),f=e.group(),g=InteractiveDataDisplay.Utils.enumPlots(this),h={width:170,height:0},i=0,j=0;j<g.length;j++){var k={width:170,height:0};if(void 0!=g[j].getLegend())if(g[j].isVisible){var l=f.group();a&&(k.legendDiv=a.children[i],i++),g[j].buildSvgLegend(k,l),l.translate(5,h.height),f.clipWith(l.rect(k.width,h.height+30)),h.height+=k.height+10,b=e.line(15,h.height,h.width,h.height).stroke({width:.3,color:"gray"}).back(),h.height+=10}else i++}return void 0!=b&&b.remove(),e.size(200,h.height+10),f.clipWith(f.rect(180,h.height+10)),e},this.renderCoreSvg=function(a,b,c){},this.buildSvgLegend=function(a,b){},this.onIsRenderedChanged=function(){},this.fit=function(a,b,c){i=a.width,j=a.height;var d=void 0;if(u||v){var e=m.aggregateBounds(),f=e.bounds;f.x!=f.x&&(f.x=0),f.y!=f.y&&(f.y=0),f.width!=f.width&&(f.width=1),f.height!=f.height&&(f.height=1),k=f;var g=e.isDefault?{left:0,top:0,bottom:0,right:0}:m.aggregatePadding();p=InteractiveDataDisplay.Utils.calcCSWithPadding(k,a,g,m.aspectRatio),d=p.getPlotRect({x:0,y:0,width:a.width,height:a.height}),void 0!==K&&!0===b&&(d=K(d,a,!0),p=new InteractiveDataDisplay.CoordinateTransform(d,{left:0,top:0,width:i,height:j},m.aspectRatio))}else{var h=void 0,l=void 0,n=void 0,e=void 0;!0!==w&&!0!==x||(e=m.aggregateBounds(),n=e.isDefault?{left:0,top:0,bottom:0,right:0}:m.aggregatePadding()),!0===w&&(k.width=e.bounds.width,k.x=e.bounds.x,h=e.isDefault?{left:0,top:0,bottom:0,right:0}:n),!0===x&&(k.height=e.bounds.height,k.y=e.bounds.y,l=e.isDefault?{left:0,top:0,bottom:0,right:0}:n);var g=void 0;void 0===h&&void 0===l||(g={left:void 0!==h?h.left:0,top:void 0!==l?l.top:0,bottom:void 0!==l?l.bottom:0,right:void 0!==h?h.right:0}),p=void 0!==g?InteractiveDataDisplay.Utils.calcCSWithPadding(k,a,g,m.aspectRatio):new InteractiveDataDisplay.CoordinateTransform(k,{left:0,top:0,width:i,height:j},m.aspectRatio),d=p.getPlotRect({x:0,y:0,width:a.width,height:a.height}),void 0!==K&&!0===b&&(d=K(d,a,c),p=new InteractiveDataDisplay.CoordinateTransform(d,{left:0,top:0,width:i,height:j},m.aspectRatio)),k=d}return b&&(k=d),d},this.updateLayout=function(){if(L.requestsUpdateLayout=!1,l){var a=L.visibleRect,b={width:n.width(),height:n.height()};if(b.width<=1||b.height<=1){var c=L.measure({width:1,height:1});return void L.arrange(c)}var d=L.screenSize.width!==b.width||L.screenSize.height!==b.height,c=L.measure(b,d);v=!1,w=!1,x=!1,L.arrange(c);var e=L.visibleRect;if(e.x===a.x&&e.y===a.y&&e.width===a.width&&e.height===a.height||(Q(),L.fireVisibleRectChanged({visibleRect:e})),J=!0,Q(),!E){var f=InteractiveDataDisplay.Binding.getBoundPlots(L),g=f.h.length,h=f.v.length;if(g>0||h>0){var i=L.coordinateTransform.getPlotRect({x:0,y:0,width:c.width,height:c.height});f.v=f.v.slice(0);for(var j=0;j<g;j++){var k=f.h[j],o=f.v.indexOf(k);if(o>=0)f.v[o]=null,k.navigation.setVisibleRect(i,!1,{suppressNotifyBoundPlots:!0});else{var p=k.visibleRect;p.x=i.x,p.width=i.width,k.navigation.setVisibleRect(p,!1,{suppressNotifyBoundPlots:!0})}}for(var j=0;j<h;j++){var k=f.v[j];if(null!=k){var p=k.visibleRect;p.y=i.y,p.height=i.height,k.navigation.setVisibleRect(p,!1,{suppressNotifyBoundPlots:!0})}}}}E=!1}else m.updateLayout()},this.measure=function(a,b){return void 0!==this.mapControl&&this.mapControl.setOptions({width:a.width,height:a.height}),this.fit(a,!0,b),n&&n.children("div").each(function(){var a=$(this);a.css("top",0),a.css("left",0)}),a},this.arrange=function(a){this.isMaster||InteractiveDataDisplay.Utils.arrangeDiv(this.host,a);for(var b=this.children,c=b.length,d=0;d<c;d++){b[d].arrange(a)}};var S=function(a,b){L.isAutoFitEnabled&&(L.isAutoFitEnabled=!1),k=a,void 0!==b&&void 0!==b.syncUpdate&&!0===b.syncUpdate?L.updateLayout():L.requestUpdateLayout(b)};if(a&&a.attr("data-idd-visible-region")){var T=a.attr("data-idd-visible-region"),U=T.split(" ");if(4!=U.length)throw"data-idd-visible-region must contain exactly 4 numbers (xmin,xmax,ymin,ymax) separated by single space";var V=Number(U[0]),W=Number(U[1]),X=Number(U[2]),Y=Number(U[3]);if(V>W)throw"data-idd-visible-region attribute: xmax is less than xmin";if(X>Y)throw"data-idd-visible-region attribute: ymax is less than ymin";var Z=this.xDataTransform&&this.xDataTransform.dataToPlot,_=this.yDataTransform&&this.yDataTransform.dataToPlot,aa=Z?Z(V):V,ba=Z?Z(W):W,ca=_?_(X):X;S({x:aa,width:ba-aa,y:ca,height:(_?_(Y):Y)-ca})}this.fitToView=function(){l?(this.isAutoFitEnabled=!1,this.navigation.stop(),v=!0,this.requestUpdateLayout()):m.fitToView()},this.fitToViewX=function(){l?(this.isAutoFitEnabled=!1,this.navigation.stop(),w=!0,this.requestUpdateLayout()):m.fitToViewX()},this.fitToViewY=function(){l?(this.isAutoFitEnabled=!1,this.navigation.stop(),x=!0,this.requestUpdateLayout()):m.fitToViewY()},this.requestNextFrameOrUpdate=function(){this.isAutoFitEnabled?this.master.requestUpdateLayout():this.master.requestNextFrame(this)},this.getTooltip=function(a,b,c,d){};var da=function(a,b){for(var c=a.children,d=c.length,e=0;e<d;e++){var f=c[e];da(f,b)}b(a)};if(l){var ea,fa,ga;this.enumAll=function(a,b){da(a,b)};var ha=function(a){a&&(a.fadeOutTimer&&(clearTimeout(a.fadeOutTimer),a.fadeOutTimer=void 0),a.remove(),a=void 0)},ia=function(){ea&&(clearTimeout(ea),ea=void 0),ga=void 0,ha(fa)},ja=function(a,b){function c(){ga=void 0,h.fadeOut("fast")}function d(){h.fadeOutTimer&&(clearTimeout(h.fadeOutTimer),h.fadeOutTimer=void 0),h.remove(),h=void 0}ea=void 0,ia();var e=function(){var a,c,d=[],e=b.x,f=b.y;return da(L,function(b){var g=b.xDataTransform?b.xDataTransform.plotToData(e):e,h=b.yDataTransform?b.yDataTransform.plotToData(f):f,i=b.getTooltip(g,h,e,f);if(i){if(g!==a||h!==c){a=g,c=h;var j=new InteractiveDataDisplay.AdaptiveFormatter(m.visibleRect.x,m.visibleRect.x+m.visibleRect.width),k=new InteractiveDataDisplay.AdaptiveFormatter(m.visibleRect.y,m.visibleRect.y+m.visibleRect.height);void 0!==F&&!1===F.showCursorCoordinates||d.push("<div class='idd-tooltip-coordinates'>"+j.toString(a)+", "+k.toString(c)+"</div>")}d.push(i)}}),d},f=e();if(0!==f.length){fa=$("<div></div>").addClass("idd-tooltip").hide().appendTo(L.host).css("position","absolute").css("left",a.x+15).css("top",a.y+15).css("z-index",InteractiveDataDisplay.ZIndexTooltipLayer);var g=function(a){for(var b=a.length,c=0;c<b;c++)$(a[c]).appendTo(fa).addClass("idd-tooltip-item")};g(f),ga=function(){if(fa){fa.empty();var a=e();return g(a),a.length}};var h=fa,i=function(){0===F.tooltipDelay?(h.show(),h.fadeOutTimer=setTimeout(d,1e3*InteractiveDataDisplay.TooltipDuration)):h.fadeOutTimer=setTimeout(c,1e3*InteractiveDataDisplay.TooltipDuration)};0===F.tooltipDelay?i():fa.fadeIn("fast",i)}};o.mousemove(function(a){ka=void 0
;var b=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(n,a),c=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(o,a),d=L.coordinateTransform,e={x:d.screenToPlotX(c.x),y:d.screenToPlotY(c.y)};ea&&(clearTimeout(ea),ea=void 0);var f=fa;L.master.isToolTipEnabled&&(0===F.tooltipDelay?ja(b,e):ea=setTimeout(function(){ja(b,e)},F.tooltipDelay)),ha(f);var g=function(a,b,c){a.onMouseMove&&a.onMouseMove(b,c);for(var d=a.children,e=d.length,f=0;f<e;f++)g(d[f],b,c)};g(L,c,e)});var ka;o.mousedown(function(a){ia(),ka=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(o,a)}),o.mouseup(function(a){ia();var b=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(o,a);if(ka&&ka.x==b.x&&ka.y==b.y){var c=L.coordinateTransform,d={x:c.screenToPlotX(b.x),y:c.screenToPlotY(b.y)},e=function(a,b,c){a.onClick&&a.onClick(b,c);for(var d=a.children,f=d.length,g=0;g<f;g++)e(d[g],b,c)};e(L,b,d)}}),o.mouseleave(function(a){ia()})}else this.enumAll=m.enumAll;this.get=function(a){var b=function(a,c){if(c.name===a||c.host[0].id===a||c.host[0]===a)return c;for(var d=c.children,e=d.length,f=0;f<e;f++){var g=b(a,d[f]);if(g)return g}};return b(a,this.master)};var la=!1;if(this.fireAppearanceChanged=function(a){la||(la=!0,setTimeout(function(){L.host.trigger(InteractiveDataDisplay.Event.appearanceChanged,a),la=!1},20))},this.fireChildrenChanged=function(a){this.host.trigger(InteractiveDataDisplay.Event.childrenChanged,a)},this.fireFrameRendered=function(a){this.host.trigger(InteractiveDataDisplay.Event.frameRendered,a)},this.fireVisibleRectChanged=function(a){ia(),this.master.host.trigger(InteractiveDataDisplay.Event.visibleRectChanged,a)},this.fireVisibleChanged=function(a){this.host.trigger(InteractiveDataDisplay.Event.isVisibleChanged,a)},this.firePlotRemoved=function(a){this.host.trigger(InteractiveDataDisplay.Event.plotRemoved,a),da(a,function(a){a.host.trigger(InteractiveDataDisplay.Event.plotRemoved,a)})},this.fireOrderChanged=function(a){this.host.trigger(InteractiveDataDisplay.Event.orderChanged,a)},this.polyline=function(a,b){var c=this.get(a);if(!c){var d=$("<div></div>").attr("data-idd-name",a).appendTo(this.host);c=new InteractiveDataDisplay.Polyline(d,this.master),this.addChild(c),this.assignChildOrder(c)}return void 0!==b&&c.draw(b),c},this.markers=function(a,b,c){var d=this.get(a);if(!d){var e=$("<div></div>").attr("data-idd-name",a).appendTo(this.host);d=new InteractiveDataDisplay.Markers(e,this.master),this.addChild(d),this.assignChildOrder(d)}return void 0!==b&&d.draw(b,c),d},this.area=function(a,b){var c=this.get(a);if(!c){var d=$("<div></div>").attr("data-idd-name",a).appendTo(this.host);c=new InteractiveDataDisplay.Area(d,this.master),this.addChild(c),this.assignChildOrder(c)}return void 0!==b&&c.draw(b),c},this.heatmap=function(a,b,c){var d=this.get(a);if(!d){var e=$("<div></div>").attr("data-idd-name",a).appendTo(this.host);d=new InteractiveDataDisplay.Heatmap(e,this.master),this.addChild(d),this.assignChildOrder(d)}return void 0!==b&&d.draw(b,c),d},this.labels=function(a,b){var c=this.get(a);if(!c){var d=$("<div></div>").attr("data-idd-name",a).appendTo(this.host);c=new InteractiveDataDisplay.LabelPlot(d,this.master),this.addChild(c),this.assignChildOrder(c)}return void 0!==b&&c.draw(b),c},l)var ma=new InteractiveDataDisplay.Navigation(this,S);Object.defineProperty(this,"navigation",{get:function(){return l?ma:m.navigation},configurable:!1}),n&&n.children("div").each(function(){var a=$(this);if(!a.hasClass("idd-plot-master")&&!a.hasClass("idd-plot-dependant")&&void 0!==a.attr("data-idd-plot")&&"figure"!==a.attr("data-idd-plot")&&"chart"!==a.attr("data-idd-plot")){var c=b(a,m);L.addChild(c),L.assignChildOrder(c)}}),this.getLegend=function(){},setTimeout(function(){if(n&&n.attr("data-idd-legend")){var a=$("#"+n.attr("data-idd-legend")),b=new InteractiveDataDisplay.Legend(L,a,!0);Object.defineProperty(L,"legend",{get:function(){return b},configurable:!1}),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(b){a[0].addEventListener(b,function(a){a.stopPropagation()},!1)})}},0),this.updateOrder=function(a,b){if(a&&InteractiveDataDisplay.Utils.reorder(this,a,b),!z)for(var c=InteractiveDataDisplay.Utils.enumPlots(m),d=0;d<c.length;d++)c[d].order<InteractiveDataDisplay.MaxInteger&&c[d].host.css("z-index",c[d].order)},a&&(l?("figure"!==a.attr("data-idd-plot")&&"chart"!==a.attr("data-idd-plot")&&this.updateLayout(),a.addClass("idd-plot-master")):a.addClass("idd-plot-dependant"))}};var d=[];InteractiveDataDisplay.Legend=function(a,b,c,e,f){var g=[],h=[],i=b[0].style,j=this;j.div=b;var k=!0;Object.defineProperty(this,"isVisible",{get:function(){return k},set:function(a){k=a,i.display=k?"block":"none"},configurable:!1}),Object.defineProperty(this,"Host",{get:function(){return b}});var l=f;void 0===c&&void 0===f?l=!0:!1===c&&void 0===f&&(l=!0),c?b.addClass("idd-legend-compact"):b.addClass("idd-legend"),b.addClass("unselectable"),l&&(b.sortable({axis:"y"}),b.on("sortupdate",function(a,c){j.updateIsLegendInduced=!0;var d,e,f=c.item.data("plot");$("li",b).each(function(a,b){if(f==$(b).data("plot"))return e=$(b).prev().data("plot"),d=$(b).next().data("plot"),!1});for(var h=0;h<g.length;++h)if(g[h].plot==f){if(d){for(var i=0;i<g.length;++i)if(g[i].plot==d){f.updateOrder(g[i].plot);break}}else for(var i=0;i<g.length;++i)if(g[i].plot==e){f.updateOrder(g[i].plot,!0);break}break}j.updateIsLegendInduced=!1}));var m=function(a){a.host.bind("visibleChanged",w),a.host.bind("childrenChanged",t),h.push(a)},n=function(a){a.host.unbind("visibleChanged",w),a.host.unbind("childrenChanged",t);for(var b=0;b<h.length;b++)h[b]===a&&h.splice(b,1)},o=function(){for(var a=0;a<h.length;a++){var b=h[a];b.host.unbind("visibleChanged",w),b.host.unbind("childrenChanged",t)}h=[]},p=function(){b.empty();for(var c=0,d=g.length;c<d;c++)r(g[c]);o(),g=[];for(var e=InteractiveDataDisplay.Utils.enumPlots(a),c=0;c<e.length;c++){var f=e[e.length-c-1];m(f),x(f)}b[0].hasChildNodes()&&k&&(i.display="block")},q=function(a,b){var c=$("<div></div>").addClass("idd-legend-isselected-false").appendTo(a);b.isErrorVisible?(c.attr("class","idd-legend-isselected-error"),c.attr("title","The data can not be displayed.")):(c.attr("title",""),b.isVisible?c.attr("class","idd-legend-isselected-false"):c.attr("class","idd-legend-isselected-true"),c.click(function(a){a.stopPropagation(),b.isErrorVisible||(b.isVisible?(c.attr("class","idd-legend-isselected-true"),b.isVisible=!1):(c.attr("class","idd-legend-isselected-false"),b.isVisible=!0))}))},r=function(a){for(var b=0;b<d.length;b++)if(d[b]==a){d.splice(b,1);break}},s=function(a){for(var b=0,c=h.length;b<c;b++)if(h[b]===a)return!0;return!1},t=function(d,e){if(void 0!==e)if("add"===e.type&&b[0].hasChildNodes()&&e.plot.master==a.master){if(s(e.plot))return;m(e.plot),x(e.plot)}else if("remove"===e.type){for(var f=function(a){var d=g[a];g.splice(a,1),r(d),d.onLegendRemove&&d.onLegendRemove(),d[0].innerHTML="",c?d.removeClass("idd-legend-item-compact"):d.removeClass("idd-legend-item"),b[0].removeChild(d[0]),d.plot.children.forEach(function(a){for(var b=0,c=g.length;b<c;b++)g[b].plot===a&&f(g[b])}),$(d[0]).css("display","none"),0==g.length&&(i.display="none")},h=0,j=g.length;h<j;h++)if(g[h].plot===e.plot){f(h);break}n(e.plot)}else{for(b[0].innerHTML="",i.display="none",j=g.length,h=0;h<j;h++)r(g[h]),g[h].onLegendRemove&&g[h].onLegendRemove(),g[h][0].innerHTML="",c?g[h].removeClass("idd-legend-item-compact"):g[h].removeClass("idd-legend-item");o(),g=[],p()}},u=function(a,b){j.updateIsLegendInduced||p()},v=function(c,d){a==d&&b.remove()},w=function(a,b){for(var c=function(a,b,c){var e=d[a];c?(e[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-error"),e[0].firstElementChild.lastElementChild.setAttribute("title","The data can not be displayed.")):(e[0].firstElementChild.lastElementChild.setAttribute("title",""),b?e[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-false"):e[0].firstElementChild.lastElementChild.setAttribute("class","idd-legend-isselected-true"))},e=0,f=d.length;e<f;e++)d[e].plot===b&&c(e,b.isVisible,b.isErrorVisible)},x=function(a){var f=a.getLegend();if(f){var h=c?$("<div class='idd-legend-item-compact'></div>"):$("<li class='idd-legend-item'></li>");c||h.data("plot",a);var i=c?$("<div class='idd-legend-item-title-compact'></div>"):$("<div class='idd-legend-item-title'></div>");f.legend&&f.legend.thumbnail&&(c?f.legend.thumbnail.addClass("idd-legend-item-title-thumb-compact").appendTo(i):f.legend.thumbnail.addClass("idd-legend-item-title-thumb").appendTo(i)),c?f.name.addClass("idd-legend-item-title-name-compact").appendTo(i):f.name.addClass("idd-legend-item-title-name").appendTo(i),q(i,a),i.appendTo(h),f.legend&&f.legend.content&&(c?f.legend.content.addClass("idd-legend-item-info-compact").appendTo(h):f.legend.content.addClass("idd-legend-item-info").appendTo(h)),e&&$(h).bind("mouseenter",function(){var a=$(this),b=c?a.find(".idd-legend-item-title-name-compact"):a.find(".idd-legend-item-title-name");b[0].offsetWidth<b[0].scrollWidth&&void 0===a.attr("title")&&a.attr("title",b.text())}),h.prependTo(b),h.plot=a,g[g.length]=h,d[d.length]=h,h.plot.updateOrder()}};this.remove=function(){for(var d=0,e=g.length;d<e;d++)r(g[d]),g[d].onLegendRemove&&g[d].onLegendRemove(),g[d][0].innerHTML="",c?g[d].removeClass("idd-legend-item-compact"):g[d].removeClass("idd-legend-item");g=[],o();var f=function(a){a.host.unbind("visibleChanged",w),a.children.forEach(function(a){f(a)})};f(a),b[0].innerHTML="",c?b.removeClass("idd-legend-compact"):b.removeClass("idd-legend"),b.removeClass("unselectable"),a.host.unbind("plotRemoved",v),a.host.unbind("orderChanged",u)},a.host.bind("plotRemoved",v),a.host.bind("orderChanged",u),b[0].legend=j,p(),b.dblclick(function(a){a.stopImmediatePropagation()})},InteractiveDataDisplay.CoordinateTransform=function(a,b,c){var d=0,e=0,f=1,g=1;void 0!==a&&void 0!==b&&(f=b.width/a.width,g=b.height/a.height,void 0!==c&&c>0&&(c*g<f?f=c*g:g=f/c),d=b.left-f*a.x,e=b.height+b.top+g*a.y),this.plotToScreenX=function(a){return a*f+d},this.plotToScreenY=function(a){return e-a*g},this.screenToPlotX=function(a){return(a-d)/f},this.screenToPlotY=function(a){return(e-a)/g},this.plotToScreenWidth=function(a){return a*f},this.plotToScreenHeight=function(a){return a*g},this.screenToPlotWidth=function(a){return a/f},this.screenToPlotHeight=function(a){return a/g},this.getPlotRect=function(a){var b=this.screenToPlotX(a.x),c=this.screenToPlotY(a.height+a.y);return{x:b,y:c,width:this.screenToPlotX(a.x+a.width)-b,height:this.screenToPlotY(a.y)-c}},this.getScale=function(){return{x:f,y:g}},this.getOffset=function(){return{x:d,y:e}},this.clone=function(){var a=new InteractiveDataDisplay.CoordinateTransform;return a.plotToScreenX=this.plotToScreenX,a.plotToScreenY=this.plotToScreenY,a.screenToPlotX=this.screenToPlotX,a.screenToPlotY=this.screenToPlotY,a.plotToScreenWidth=this.plotToScreenWidth,a.plotToScreenHeight=this.plotToScreenHeight,a.screenToPlotWidth=this.screenToPlotWidth,a.screenToPlotHeight=this.screenToPlotHeight,a.getPlotRect=this.getPlotRect,a.getScale=this.getScale,a.getOffset=this.getOffset,a}},InteractiveDataDisplay.CanvasPlot=function(a,b){if(this.base=InteractiveDataDisplay.Plot,this.base(a,b),a){var c,d=function(){b._sharedCanvas&&(b._sharedCanvas.remove(),b._sharedCanvas=void 0)};this.getContext=function(a){var b,d=this.master;if(d.flatRendering?(b=d._sharedCanvas,a=d._sharedCanvas._dirty&&a,d._sharedCanvas._dirty=!1):b=c,void 0!==b){var e=b[0].getContext("2d");if(a){var f=this.screenSize;e.clearRect(0,0,f.width,f.height)}return e}},this.destroy=function(){return InteractiveDataDisplay.CanvasPlot.prototype.destroy.call(this),this.host.children(".idd-plot-canvas").remove(),d(),this},this.arrange=function(a){InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,a);var b,e=this.master;e.flatRendering?(e._sharedCanvas?b=e._sharedCanvas:(c?(b=c,c=void 0):b=$("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas"),e._sharedCanvas=b,e._sharedCanvas._dirty=!1),c&&(c.remove(),c=void 0)):(e._sharedCanvas&&d(),c||(c=$("<canvas></canvas>").prependTo(this.host).addClass("idd-plot-canvas")),b=c);var f=b[0];f.width=a.width,f.height=a.height},this.getTransform=function(){var a=this.coordinateTransform,b=a.plotToScreenX,c=a.plotToScreenY,d=this.xDataTransform&&this.xDataTransform.dataToPlot,e=this.yDataTransform&&this.yDataTransform.dataToPlot;return{dataToScreenX:d?function(a){return b(d(a))}:b,dataToScreenY:e?function(a){return c(e(a))}:c,dataToPlotX:d,dataToPlotY:e,plotToScreenX:b,plotToScreenY:c}},this.getScreenToDataTransform=function(){var a=this.coordinateTransform,b=a.screenToPlotX,c=a.screenToPlotY,d=this.xDataTransform&&this.xDataTransform.plotToData,e=this.yDataTransform&&this.yDataTransform.plotToData;return{screenToDataX:d?function(a){return d(b(a))}:b,screenToDataY:e?function(a){return e(c(a))}:c}}}},InteractiveDataDisplay.CanvasPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.Polyline=function(a,b){var c=this,d=InteractiveDataDisplay.Utils.getDataSourceFunction(a,InteractiveDataDisplay.readCsv),e=d(a);this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b);var f,g,h,i,j,k,l="blue",m="pink",n=1,o="#4169ed",p="butt",q="miter";e&&(n=void 0!==e.thickness?e.thickness:n,o=void 0!==e.stroke?e.stroke:o,p=void 0!==e.lineCap?e.lineCap:p,q=void 0!==e.lineJoin?e.lineJoin:q,l=void 0!==e.fill68?e.fill68:l,m=void 0!==e.fill95?e.fill95:m),this.draw=function(a){var b=a.y.median?a.y.median:a.y;if(!b)throw"Data series y is undefined";var c=b.length;if(a.x||(a.x=InteractiveDataDisplay.Utils.range(0,c-1)),c!=a.x.length)throw"Data series x and y have different lengths";f=b,g=a.x;var d=a.y.upper68;if(d&&d.length!==c)throw"Data series y_u68 and y_median have different lengths";var e=a.y.lower68;if(e&&e.length!==c)throw"Data series y_l68 and y_median have different lengths";var r=a.y.upper95;if(r&&r.length!==c)throw"Data series y_u95 and y_median have different lengths";var s=a.y.lower95;if(s&&s.length!==c)throw"Data series y_l95 and y_median have different lengths";h=d,i=e,j=r,k=s;var t=a.treatAs&&"function"==a.treatAs&&!InteractiveDataDisplay.Utils.isOrderedArray(g);if(InteractiveDataDisplay.Utils.isArray(a.y)){if(f=b,t){var u=Math.min(g.length,b.length);if(f=InteractiveDataDisplay.Utils.cutArray(b,u),g=InteractiveDataDisplay.Utils.cutArray(g,u),t){for(var v=[],w=0;w<u;w++)isNaN(g[w])||v.push({x:g[w],y:f[w]});v.sort(function(a,b){return a.x-b.x}),f=[],g=[];for(var w=0;w<v.length;w++)f.push(v[w].y),g.push(v[w].x)}}}else{var b=a.y,u=Math.min(g.length,b.median.length);if(b.upper68&&b.lower68&&(u=Math.min(u,Math.min(b.upper68.length,b.lower68.length))),b.upper95&&b.lower95&&(u=Math.min(u,Math.min(b.upper95.length,b.lower95.length))),f=InteractiveDataDisplay.Utils.cutArray(b.median,u),h=InteractiveDataDisplay.Utils.cutArray(b.upper68,u),i=InteractiveDataDisplay.Utils.cutArray(b.lower68,u),j=InteractiveDataDisplay.Utils.cutArray(b.upper95,u),k=InteractiveDataDisplay.Utils.cutArray(b.lower95,u),g=InteractiveDataDisplay.Utils.cutArray(g,u),t){for(var v=[],w=0;w<u;w++)isNaN(g[w])||v.push({x:g[w],y:f[w],y_u68:h[w],y_l68:i[w],y_u95:j[w],y_l95:k[w]});v.sort(function(a,b){return a.x-b.x}),f=[],h=[],i=[],j=[],k=[],g=[];for(var w=0;w<v.length;w++)f.push(v[w].y),h.push(v[w].y_u68),i.push(v[w].y_l68),j.push(v[w].y_u95),k.push(v[w].y_l95),g.push(v[w].x)}}n=void 0!==a.thickness?a.thickness:n,"number"!=typeof n&&(n=parseFloat(n)||1),o=void 0!==a.stroke?a.stroke:o,p=void 0!==a.lineCap?a.lineCap:p,q=void 0!==a.lineJoin?a.lineJoin:q,l=void 0!==a.fill68?a.fill68:l,m=void 0!==a.fill95?a.fill95:m,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(a,b){var c=this.xDataTransform&&this.xDataTransform.dataToPlot,d=this.yDataTransform&&this.yDataTransform.dataToPlot,e=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,f,c,d),l=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,h,c,d),m=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,i,c,d),n=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,j,c,d),o=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(g,k,c,d);return InteractiveDataDisplay.Utils.unionRects(e,InteractiveDataDisplay.Utils.unionRects(l,InteractiveDataDisplay.Utils.unionRects(m,InteractiveDataDisplay.Utils.unionRects(n,o))))},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(a,b,c,d){if(void 0!==g&&void 0!=f){if(0!=f.length&&this.isVisible){var e=this.getContext(!1);if(void 0!==e){for(var h=this.getTransform(),i={x:h.dataToScreenX(a),y:h.dataToScreenY(b)},j=e.getImageData(i.x-1,i.y-1,3,3),k=0,l=0;l<j.data.length;l++)0===j.data[l]&&k++;if(k!==j.data.length){var m=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(this.name||"polyline").appendTo(m),m}}}}};var r=function(a,b,d,e,f,g,h){if(void 0!==a&&void 0!=b){var i=b.length;if(0!=i){var j=c.getTransform(),k=j.dataToScreenX,l=j.dataToScreenY,m=g.width,n=g.height,o=0,r=m,s=0,u=n;h.globalAlpha=1,h.strokeStyle=d,h.fillStyle=d,h.lineWidth=e,h.lineCap=p,h.lineJoin=q,h.beginPath();var v,w,x,y,z=0,A=function(){for(;z<i;z++)if(!isNaN(a[z])&&!isNaN(b[z])){v=k(a[z]),x=l(b[z]),B=t(v,x,o,r,s,u);break}0==B&&h.moveTo(v,x)};A();var B,C,D,E,F,G,H,I,J=1;for(z++;z<i;z++)if(isNaN(a[z])||isNaN(b[z])){if(1==J){h.stroke();var K=t(v,x,o,r,s,u);0==K&&(h.beginPath(),h.arc(v,x,e/2,0,2*Math.PI),h.fill())}else h.stroke();h.beginPath(),z++,A(),J=1}else if(H=w=k(a[z]),I=y=l(b[z]),!(Math.abs(v-w)<1&&Math.abs(x-y)<1)){for(D=B,E=C=t(w,y,o,r,s,u);B|C&&!(B&C);)F=w-v,G=y-x,B?(v<o?(x+=G*(o-v)/F,v=o):v>r?(x+=G*(r-v)/F,v=r):x<s?(v+=F*(s-x)/G,x=s):x>u&&(v+=F*(u-x)/G,x=u),B=t(v,x,o,r,s,u)):(w<o?(y+=G*(o-w)/F,w=o):w>r?(y+=G*(r-w)/F,w=r):y<s?(w+=F*(s-y)/G,y=s):y>u&&(w+=F*(u-y)/G,y=u),C=t(w,y,o,r,s,u));B&C||(0!=D&&h.moveTo(v,x),h.lineTo(w,y),J++),v=H,x=I,B=E}if(1==J){h.stroke();var K=t(v,x,o,r,s,u);0==K&&(h.beginPath(),h.arc(v,x,e/2,0,2*Math.PI),h.fill())}else h.stroke()}}};this.renderCore=function(a,b){InteractiveDataDisplay.Polyline.prototype.renderCore.call(this,a,b);var c=this.getContext(!0);InteractiveDataDisplay.Area.render.call(this,g,k,j,m,a,b,c,.5),InteractiveDataDisplay.Area.render.call(this,g,i,h,l,a,b,c,.5),r(g,f,o,n,a,b,c)};var s=function(a,b,d){if(void 0!==g&&void 0!=f){var e=f.length;if(0!=e){var h,i,j,k,l,m=c.getTransform(),p=m.dataToScreenX,q=m.dataToScreenY,r=b.width,s=b.height,u=0,v=r,w=0,x=s,y=0,z=InteractiveDataDisplay.ColorPalette.colorFromString(o),A="rgb("+z.r+","+z.g+","+z.b+")",B=function(){d.polyline(l).style({fill:"none",stroke:A,"stroke-width":n,"stroke-opacity":z.a})},C=function(){for(l=new Array(0);y<e;y++)if(!isNaN(g[y])&&!isNaN(f[y])){h=p(g[y]),j=q(f[y]),D=t(h,j,u,v,w,x);break}0==D&&l.push([h,j])};C();var D,E,F,G,H,I,J,K,L=1;for(y++;y<e;y++)if(isNaN(g[y])||isNaN(f[y])){if(1==L){B();var M=t(h,j,u,v,w,x);0==M&&(context.beginPath(),context.arc(h,j,n/2,0,2*Math.PI),context.fill())}else B();y++,C(),L=1}else if(J=i=p(g[y]),K=k=q(f[y]),!(Math.abs(h-i)<1&&Math.abs(j-k)<1)){for(F=D,G=E=t(i,k,u,v,w,x);D|E&&!(D&E);)H=i-h,I=k-j,D?(h<u?(j+=I*(u-h)/H,h=u):h>v?(j+=I*(v-h)/H,h=v):j<w?(h+=H*(w-j)/I,j=w):j>x&&(h+=H*(x-j)/I,j=x),D=t(h,j,u,v,w,x)):(i<u?(k+=I*(u-i)/H,i=u):i>v?(k+=I*(v-i)/H,i=v):k<w?(i+=H*(w-k)/I,k=w):k>x&&(i+=H*(x-k)/I,k=x),E=t(i,k,u,v,w,x));D&E||(0!=F&&(B(),l=new Array(0),l.push([h,j])),l.push([i,k]),L++),h=J,j=K,D=G}if(1==L){B();var M=t(h,j,u,v,w,x);0==M&&d.circle(n).translate(h,j).fill(A).opacity(z.a)}else B()}}};this.renderCoreSvg=function(a,b,c){InteractiveDataDisplay.Area.renderSvg.call(this,a,b,c,g,k,j,m),InteractiveDataDisplay.Area.renderSvg.call(this,a,b,c,g,i,h,l),s(a,b,c)};var t=function(a,b,c,d,e,f){return(a<c)<<3|(a>d)<<2|(b<e)<<1|b>f};this.onDataTransformChanged=function(a){this.invalidateLocalBounds(),InteractiveDataDisplay.Polyline.prototype.onDataTransformChanged.call(this,a)},Object.defineProperty(this,"thickness",{get:function(){return n},set:function(a){if(a!=n){if(a<=0)throw"Polyline thickness must be positive";n=a,this.fireAppearanceChanged("thickness"),this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return o},set:function(a){a!=o&&(o=a,this.fireAppearanceChanged("stroke"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineCap",{get:function(){return p},set:function(a){a!=p&&(p=a,this.fireAppearanceChanged("lineCap"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"lineJoin",{get:function(){return q},set:function(a){a!=q&&(q=a,this.fireAppearanceChanged("lineJoin"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill68",{get:function(){return l},set:function(a){a!=l&&(l=a,this.fireAppearanceChanged("fill68"),this.requestNextFrameOrUpdate())},configurable:!1}),Object.defineProperty(this,"fill95",{get:function(){return m},set:function(a){a!=m&&(m=a,this.fireAppearanceChanged("fill95"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var a=$("<canvas></canvas>");a[0].width=40,a[0].height=40;var b=a.get(0).getContext("2d"),c=void 0!=j&&void 0!=k,d=void 0!=h&&void 0!=i;c&&(b.globalAlpha=.5,b.strokeStyle=m,b.fillStyle=m,b.beginPath(),b.moveTo(0,0),b.lineTo(0,20),b.lineTo(20,40),b.lineTo(40,40),b.lineTo(40,20),b.lineTo(20,0),b.lineTo(0,0),b.fill(),b.stroke(),b.closePath()),d&&(b.globalAlpha=.5,b.strokeStyle=l,b.fillStyle=l,b.beginPath(),b.moveTo(0,0),b.lineTo(0,10),b.lineTo(30,40),b.lineTo(40,40),b.lineTo(40,30),b.lineTo(10,0),b.lineTo(0,0),b.fill(),b.stroke(),b.closePath()),b.strokeStyle=o,b.lineWidth=n,b.moveTo(0,0),b.lineTo(40,40),b.stroke();var e=this,f=$("<span></span>"),g=function(){f.text(e.name)};g(),this.host.bind("appearanceChanged",function(c,d){d&&"name"!=d||g(),b.clearRect(0,0,a[0].width,a[0].height);var e=void 0!=j&&void 0!=k,f=void 0!=h&&void 0!=i;e&&(b.globalAlpha=.5,b.strokeStyle=m,b.fillStyle=m,b.beginPath(),b.moveTo(0,0),b.lineTo(0,20),b.lineTo(20,40),b.lineTo(40,40),b.lineTo(40,20),b.lineTo(20,0),b.lineTo(0,0),b.fill(),b.stroke(),b.closePath()),f&&(b.globalAlpha=.5,b.strokeStyle=l,b.fillStyle=l,b.beginPath(),b.moveTo(0,0),b.lineTo(0,10),b.lineTo(30,40),b.lineTo(40,40),b.lineTo(40,30),b.lineTo(10,0),b.lineTo(0,0),b.fill(),b.stroke(),b.closePath()),b.strokeStyle=o,b.lineWidth=n,b.moveTo(0,0),b.lineTo(40,40),b.stroke()});var e=this;return{name:f,legend:{thumbnail:a,content:void 0},onLegendRemove:function(){e.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(a,b){var c=this;a.height=30,b.add(b.rect(a.width,a.height).fill("white").opacity(.5));var d=void 0!=j&&void 0!=k,e=void 0!=h&&void 0!=i,f=InteractiveDataDisplay.ColorPalette.colorFromString(o),g="rgb("+f.r+","+f.g+","+f.b+")",p=InteractiveDataDisplay.ColorPalette.colorFromString(m),q="rgb("+p.r+","+p.g+","+p.b+")",r=InteractiveDataDisplay.ColorPalette.colorFromString(l),s="rgb("+r.r+","+r.g+","+r.b+")";d&&b.add(b.polyline([[0,0],[0,9],[9,18],[18,18],[18,9],[9,0],[0,0]]).fill(q).opacity(p.a).translate(5,5)),e&&b.add(b.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(s).opacity(r.a).translate(5,5)),b.add(b.line(0,0,18,18).stroke({width:n,color:g}).translate(5,5));var t=window.getComputedStyle(a.legendDiv.children[0].children[1],null),u=parseFloat(t.getPropertyValue("font-size")),v=t.getPropertyValue("font-family"),w=t?t.getPropertyValue("font-weight"):void 0;b.add(b.text(c.name).font({family:v,size:u,weight:w}).translate(40,0)),b.front()},e&&void 0!==e.y&&this.draw(e)},InteractiveDataDisplay.Polyline.prototype=new InteractiveDataDisplay.CanvasPlot;var e=jQuery.Event("plotClick");InteractiveDataDisplay.DOMPlot=function(a,b){this.base=InteractiveDataDisplay.Plot,this.base(a,b);var c=[],d=this,f=function(a,b,e,f,g,h,i,j){if("div"!==a[0].tagName.toLowerCase())throw"DOMPlot supports only DIV elements";a._x=e,a._y=f,a._width=g&&g>0?g:1,a._height=h&&h>0?h:1,a._originX=i||0,a._originY=j||0,a._scale=b||"element";var k=function(a){var b=d.coordinateTransform.screenToPlotX,c=d.coordinateTransform.screenToPlotY,e=d.xDataTransform&&d.xDataTransform.plotToData,f=d.yDataTransform&&d.yDataTransform.plotToData,g=e?function(a){return e(b(a))}:b,h=f?function(a){return f(c(a))}:c,i=a.position();a._left=i.left+a._originX*a.width(),a._top=i.top+a._originY*a.height(),a._x=g(i.left+a._originX*a.width()),a._y=h(i.top+a._originY*a.height())};a.on("drag",function(b,c){k(a)}),a.on("dragstop",function(b,c){k(a),d.invalidateLocalBounds(),d.requestUpdateLayout()}),a.addClass("idd-dom-marker"),a.css("display","none").css("z-index",InteractiveDataDisplay.ZIndexDOMMarkers),c.push(a)};a.children("div[data-idd-position]").each(function(){var a=$(this),b=a.attr("data-idd-position").split(/\s+/g);if(b.length<2)throw"Position of the DOM marker should define x and y";var c,d,e=parseFloat(b[0]),g=parseFloat(b[1]),h=a.attr("data-idd-size");if(h){var i=h.split(/\s+/g);i.length>=2&&(c=parseFloat(i[0]),d=parseFloat(i[1]))}var j,k,l=a.attr("data-idd-origin");if(l){var m=l.split(/\s+/g);m.length>=2&&(j=parseFloat(m[0]),k=parseFloat(m[1]))}var n=a.attr("data-idd-scale");f(a,n,e,g,c,d,j,k)});var g=function(a){return{left:a._x-a._originX*a._width,top:a._y+a._originY*a._height}};this.computeLocalBounds=function(){var a;if(c){var b=c.length;if(b>0){for(var d=[],e=[],f=0,h=0;f<b;f++,h++){var i=c[f];if("none"!=i._scale){var j=g(i);d[h]=j.left,e[h]=j.top,d[++h]=j.left+i._width,e[h]=j.top-i._height}}var k=InteractiveDataDisplay.Utils.getMinMax(d),l=InteractiveDataDisplay.Utils.getMinMax(e);if(k&&l){var m=this.xDataTransform&&this.xDataTransform.dataToPlot,n=this.yDataTransform&&this.yDataTransform.dataToPlot;m&&(k.min=m(k.min),k.max=m(k.max)),n&&(l.min=n(l.min),l.max=n(l.max)),a={x:k.min,y:l.min,width:k.max-k.min,height:l.max-l.min}}}}return a},this.getLocalPadding=function(){var a=0;return{left:a,right:a,top:a,bottom:a}},this.arrange=function(a){InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,a);var b=a.width,c=a.height;this.host.css("clip","rect(0px,"+b+"px,"+c+"px,0px)")},this.renderCore=function(a,b){InteractiveDataDisplay.DOMPlot.prototype.renderCore.call(this,a,b);var d=c.length;if(d>0)for(var e=0,f=b.height,h=0,i=b.width,j=this.coordinateTransform.plotToScreenX,k=this.coordinateTransform.plotToScreenY,l=this.xDataTransform&&this.xDataTransform.dataToPlot,m=this.yDataTransform&&this.yDataTransform.dataToPlot,n=l?function(a){return j(l(a))}:j,o=m?function(a){return k(m(a))}:k,p=0;p<d;p++){var q,r,s=c[p];if("none"==s._scale){r={x:s.width(),y:s.height()},q={x:n(s._x),y:o(s._y)};var t=q.x-s._originX*r.x,u=q.y-s._originY*r.y;q={x:t,y:u}}else{var v;v=g(s),q={x:n(v.left),y:o(v.top)},r={x:n(v.left+s._width)-q.x,y:o(v.top-s._height)-q.y}}var w,x=(r.y,r.x,e),y=f,z=q.y,A=q.y+r.y,B=Math.max(x,z),C=Math.min(y,A);if((w=B<C)&&(B-q.y,C-q.y,x=h,y=i,z=q.x,A=q.x+r.x,B=Math.max(x,z),C=Math.min(y,A),w=B<C))if(B-q.x,C-q.x,s.css("left",q.x+"px"),s.css("top",q.y+"px"),s.css("display","block"),"content"===s._scale){var D=r.x/s.width(),E=r.y/s.height();s.css(InteractiveDataDisplay.CssPrefix+"-transform-origin","0% 0%"),s.css(InteractiveDataDisplay.CssPrefix+"-transform","scale("+D+","+E+")")}else"element"===s._scale&&(s.css("width",r.x+"px"),s.css("height",r.y+"px"));w||s.css("display","none")}},this.onIsRenderedChanged=function(){if(this.isRendered)for(var a=c.length,b=0;b<a;b++){var d=c[b];d.css("z-index",InteractiveDataDisplay.ZIndexDOMMarkers)}else for(var a=c.length,b=0;b<a;b++){var d=c[b];d.css("display","none")}},this.clear=function(){for(var a=c.length,b=0;b<a;b++){c[b].remove()}c=[],this.invalidateLocalBounds(),this.requestUpdateLayout()},this.add=function(a,b,c,d,e,g,h,i){var j=$(a);return this.host[0].contains(j[0])||j.appendTo(this.host),f(j,b,c,d,e,g,h,i),this.invalidateLocalBounds(),this.requestUpdateLayout(),j.get(0)};var h=function(a){var b=jQuery.grep(c,function(b){return b[0]===a});if(b&&b.length>0)return b[0]};this.remove=function(a){var b=function(a){var b=h(a[0]);b&&c.splice(c.indexOf(b),1),a.remove()};b(a.jquery?a:$(a)),this.invalidateLocalBounds(),this.requestUpdateLayout()},this.set=function(a,b,c,d,e,f,g){var i=h(a);if(!i)throw"Element is not found in the plot";i._x=b,i._y=c,"none"!=i.scale&&(d&&d>0&&(i._width=d),e&&e>0&&(i._height=e)),i._originX=f||i._originX,i._originY=g||i._originY,this.invalidateLocalBounds(),this.requestUpdateLayout()},this.enableClickablePanel=!1,d.master.centralPart.click(function(a){if(d.enableClickablePanel){var b=d.coordinateTransform.screenToPlotX,c=d.coordinateTransform.screenToPlotY,f=d.xDataTransform&&d.xDataTransform.plotToData,g=d.yDataTransform&&d.yDataTransform.plotToData,h=f?function(a){return f(b(a))}:b,i=g?function(a){return g(c(a))}:c,j=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(d.master.centralPart,a),k=h(j.x),l=i(j.y);d.host.trigger(e,{x:k,y:l})}}),Object.defineProperty(this,"domElements",{get:function(){return c.slice(0)},configurable:!1})},InteractiveDataDisplay.DOMPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.GridlinesPlot=function(a,b){this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b);var c,d,e="1px",f="LightGray",g={};InteractiveDataDisplay.Utils.readStyle(this.host,g),g&&(f=void 0!==g.stroke?g.stroke:f,e=void 0!==g.thickness?g.thickness:e),Object.defineProperty(this,"xAxis",{get:function(){return c},set:function(a){a!=c&&(c=a,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"yAxis",{get:function(){return d},set:function(a){a!=d&&(d=a,this.requestUpdateLayout())},configurable:!1}),Object.defineProperty(this,"thickness",{get:function(){return e},set:function(a){if(a!=e){if(a<=0)throw"GridLines thickness must be positive";e=a,this.requestNextFrameOrUpdate()}},configurable:!1}),Object.defineProperty(this,"stroke",{get:function(){return f},set:function(a){a!=f&&(f=a,this.requestNextFrameOrUpdate())},configurable:!1});var h=function(){if(!c){var a=this.host.attr("data-idd-xaxis");if(a){var b=this.master.get(a);b&&(c=b)}}if(!d){var a=this.host.attr("data-idd-yaxis");if(a){var b=this.master.get(a);b&&(d=b)}}};this.renderCore=function(a,b){InteractiveDataDisplay.GridlinesPlot.prototype.renderCore.call(this,a,b),h.call(this);var g=this.getContext(!0);g.strokeStyle=f,g.fillStyle=f,g.lineWidth=1;var i,j=parseInt(e.slice(0,-2)),k=[];c&&(k=c.ticks);for(var l=0,m=k.length;l<m;l++)k[l].invisible||(i=c.getCoordinateFromTick(k[l].position),g.fillRect(i,0,j,b.height));k=[],d&&(k=d.ticks);for(var l=0,m=k.length;l<m;l++)k[l].invisible||(i=b.height-1-d.getCoordinateFromTick(k[l].position),g.fillRect(0,i,b.width,j))},this.renderCoreSvg=function(a,b,g){h.call(this);var i,j=parseInt(e.slice(0,-2)),k={width:j,color:f},l=[];c&&(l=c.ticks);for(var m=0,n=l.length;m<n;m++)if(!l[m].invisible){if((i=c.getCoordinateFromTick(l[m].position))<0||i>b.width)continue;g.polyline([[i,0],[i,b.height-1]]).stroke(k).fill("none")}l=[],d&&(l=d.ticks);for(var m=0,n=l.length;m<n;m++)if(!l[m].invisible){if((i=b.height-1-d.getCoordinateFromTick(l[m].position))<0||i>b.height)continue;g.polyline([[0,i],[b.width-1,i]]).stroke(k).fill("none")}}},InteractiveDataDisplay.GridlinesPlot.prototype=new InteractiveDataDisplay.CanvasPlot}();InteractiveDataDisplay=InteractiveDataDisplay||{},InteractiveDataDisplay.SubplotsTrapPlot=function(a,b){if(this.base=InteractiveDataDisplay.Plot,this.base(a,b),a){this.renderCallback=function(a){},this.suppressRenderCallback=!1,this.renderCore=function(a,b){if(InteractiveDataDisplay.SubplotsTrapPlot.prototype.renderCore.call(this,a,b),!this.suppressRenderCallback){var c=this.xDataTransform&&this.xDataTransform.plotToData?this.xDataTransform.plotToData:function(a){return a},d=this.yDataTransform&&this.yDataTransform.plotToData?this.yDataTransform.plotToData:function(a){return a},e=c(a.x),f=c(a.x+a.width),g=d(a.y),h=d(a.y+a.height),i={x_min:e>f?f:e,x_max:e>f?e:f,y_min:g>h?h:g,y_max:g>h?g:h};this.renderCallback(i)}},this.renderCoreSvg=function(a,b,c){}}},
InteractiveDataDisplay.factory["subplots-trap"]=function(a,b){return new InteractiveDataDisplay.SubplotsTrapPlot(a,b)},InteractiveDataDisplay.SubplotsTrapPlot.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.SubPlots=function(a){if(!a)throw"SubPlots must be applied to <div> element";if(1!==a.children.length&&2!==a.children.length)throw"SubPlots div must contain one or two child elements: optional element div (subplots title) and mandatory element table";var b=$(a).children().last()[0];if(!b)throw"SubPlots div should contain at least one <div> element";if(1!==b.children.length)throw"SubPlots child div must contain exactly one child element which is a <table>";var c=b.children[0];if(!c||"TABLE"!=c.nodeName)throw"SubPlots child div must contain exactly one child element which is a <table>";var d=b,e=c,f=a;if($(f).css("flex-direction","column"),$(d).addClass("idd-subplots-legendholder"),2===a.children.length){var g=$(a).children()[0];$(g).addClass("idd-subplots-title")}var h=0,i=0,j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=void 0,r=void 0,s=void 0,t=$(d).attr("data-idd-horizontal-binding"),u=$(d).attr("data-idd-vertical-binding");t=void 0!==t&&("true"===t||"enabled"===t),u=void 0!==u&&("true"===u||"enabled"===u);var v=this,w=function(){var a=$("tr",e);i=a.length,j=new Array(i/3),k=new Array(i/3),p=new Array(i/3),o=new Array(i/3);var b=function(a,b,c){var d=$("div[data-idd-axis]",c),e=d.length;if(e>0)if(e>1)console.warn("subplots: work with multiple axes in a single slot is not implemented");else{var f=InteractiveDataDisplay.InitializeAxis(d);l.push(f),n.push([a,b]);var g=a%3==1;m.push(g);var h=Math.floor(a/3),i=Math.floor(b/3);f.associatedPlotRow=h,f.associatedPlotCol=i,g?p[h][i]=f:o[h][i]=f}};a.each(function(a){var c=$("td",this);if(0===h)_NCol=c.length;else if(c.length!==_NCol)throw"Different rows have non-equal number of columns";if((a-1)%3==0){var d=Math.floor(a/3);j[d]=new Array(_NCol/3),k[d]=new Array(_NCol/3),p[d]=new Array(_NCol/3),o[d]=new Array(_NCol/3),c.each(function(c){var e=this;if((c-1)%3==0){var f=$("div[data-idd-plot='plot']",e);if(f.length>0){var g=Math.floor(c/3),h=InteractiveDataDisplay.asPlot(f);j[d][g]=h,h.subplotRowIdx=d,h.subplotColIdx=g,k[d][g]=InteractiveDataDisplay.asPlot($("div[data-idd-plot='subplots-trap']",e));var i={};if(InteractiveDataDisplay.Utils.readStyle(f,i),i){if("true"===(void 0!==i.isLegendVisible?i.isLegendVisible:"true")){var l=$("<div style='z-index: 10;'></div>").appendTo(f);new InteractiveDataDisplay.Legend(h,l,!0);l.css("float","right"),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(a){l[0].addEventListener(a,function(a){a.stopPropagation()},!1)})}}}}else b(a,c,e)})}else c.each(function(c){b(a,c,this)})});var c={};c=InteractiveDataDisplay.Utils.readStyle($(d),c);var g=void 0;c&&c["subplots-margin"]?(g=c["subplots-margin"],$(d).find("td div.idd-subplots-margin-left").css("padding-left",g),$(d).find("tr").find("td div.idd-subplots-margin-left:first").css("padding-left",""),$(d).find("td div.idd-subplots-margin-bottom").css("padding-bottom",g),$(d).find("tr").last().find("td div.idd-subplots-margin-bottom").css("padding-bottom","")):g=$(d).find("td div.idd-axis").parent().css("padding-left");var w=d.getAttribute("data-idd-ext-legend");if(w){var x=w.split(" ");if(3!==x.length)throw"data-idd-ext-legend attribute bust contain string in format 'placement plotRowIdx plotColIdx'";var y=x[0];q=parseInt(x[1]),r=parseInt(x[2]);var z=j[q][r],A=$("<div></div>");switch(y.trim().toLowerCase()){case"left":case"top":A.prependTo(d);break;case"right":case"bottom":A.appendTo(d);break;default:throw"Unexpected external legend placement"}switch(y.trim().toLowerCase()){case"left":$(d).css("flex-direction","row"),g&&A.css("margin-right",g);break;case"right":$(d).css("flex-direction","row"),g&&A.css("margin-left",g);break;case"top":$(d).css("flex-direction","column"),g&&A.css("margin-bottom",g);break;case"bottom":$(d).css("flex-direction","column"),g&&A.css("margin-top",g);break;default:throw"Unexpected external legend placement"}s=new InteractiveDataDisplay.Legend(z,A,!1,void 0,!0)}for(var B=0;B<l.length;B++){var C=l[B],D=n[B][0],E=n[B][1],F=Math.floor(D/3),G=Math.floor(E/3),H=j[F][G];C.dataTransform=D%3==1?H.yDataTransform:H.xDataTransform}$("div[data-idd-plot='grid']",e).each(function(a){function b(a,b){for(var c=0;c<a.length;c++)if(a[c]&&a[c][b])return c;return-1}function c(a){for(var b=0;b<a.length;b++)if(a[b])return b;return-1}var d=this,e=d.plot,f=e.master,g=f.subplotRowIdx,h=f.subplotColIdx,i=o[g][h];if(i)e.xAxis=i;else if(t){var j=b(o,h);-1!==j&&(e.xAxis=o[j][h])}var k=p[g][h];if(k)e.yAxis=k;else if(u){var l=c(p[g]);-1!==l&&(e.yAxis=p[g][l])}});for(var B=0;B<j.length;B++)for(var I=j[B],J=0;J<I.length;J++){var H=I[J];if(H){var K=$(H.host).attr("data-idd-navigation-enabled");if(K&&"true"===K){var L=$(H.host);L.dblclick(function(){this.plot.master.fitToView()});var M=H.master.subplotRowIdx,N=H.master.subplotColIdx,O=InteractiveDataDisplay.Gestures.getGesturesStream(L),P=o[M][N];if(P){var Q=P.host,R=InteractiveDataDisplay.Gestures.applyHorizontalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(Q));O=O.merge(R),Q.dblclick(function(){var a=this.axis;j[a.associatedPlotRow][a.associatedPlotCol].fitToViewX()})}var S=p[M][N];if(S){var Q=S.host,T=InteractiveDataDisplay.Gestures.applyVerticalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(Q));O=O.merge(T),Q.dblclick(function(){var a=this.axis;j[a.associatedPlotRow][a.associatedPlotCol].fitToViewY()})}H.navigation.gestureSource=O}}}for(var U=!1,V=function(a){if(!U){U=!0,yRange={min:a.y_min,max:a.y_max},xRange={min:a.x_min,max:a.x_max};var b=this.master,c=b.subplotRowIdx,d=b.subplotColIdx;if(!t){var e=o[c][d];e&&e.update(xRange)}if(!u){var f=p[c][d];f&&f.update(yRange)}for(var g=0;g<l.length;g++){var h=l[g];m[g]&&u?h.update(yRange):!m[g]&&t&&h.update(xRange)}if(t||u)for(var g=0;g<j.length;g++)for(var i=j[g],k=0;k<i.length;k++){var n=i[k];if(n!==this.master){var q=n.visibleRect;t&&(q.x=a.x_min,q.width=a.x_max-a.x_min),u&&(q.y=a.y_min,q.height=a.y_max-a.y_min),n.navigation.setVisibleRect(q,!1,{suppressNotifyBoundPlots:!0,forceOnlyUpdatePlotsOutput:!0,syncUpdate:!0})}}U=!1}},B=0;B<k.length;B++)for(var I=k[B],J=0;J<I.length;J++){var W=I[J];W&&(W.renderCallback=V)}var X=function(a,b){for(var c=0;c<j.length;c++)for(var d=0;d<j[c].length;d++)for(var e=j[c][d].getPlotsSequence(),f=0;f<e.length;f++)b.name.length>0&&e[f].name===b.name&&e[f].isVisible!==b.isVisible&&(e[f].isVisible=b.isVisible)},Y=$(d).attr("data-idd-common-visibility");if(Y&&("true"===Y||"enabled"===Y))for(var B=0;B<j.length;B++)for(var J=0;J<j[B].length;J++)j[B][J]&&j[B][J].host.bind("visibleChanged",X);f.subplots=v};this.renderSVG=function(){for(var a="div[data-idd-plot='plot']",b="div[data-idd-axis]",c="div.idd-subplot-title",d="div.idd-horizontalTitle",e="div.idd-verticalTitle",g="div.idd-legend",h="div.idd-subplots-title",i=$(f).find(a+", "+b+", "+c+", "+d+", "+e+", "+g+", "+h),k=[],l=document.createElementNS("http://www.w3.org/2000/svg","svg"),m=SVG(l).size($(f).width(),$(f).height()),n=m.nested(),o=[],p=[],s=$(f).offset(),t=0;t<i.length;t++){o[t]=$(i[t]).offset().left-s.left,p[t]=$(i[t]).offset().top-s.top+1;var u=$(i[t]);if(u.is(c+", "+d+", "+e+", "+h)){var v=m.text(i[t].innerText);if(k[t]=v.font({family:$(i[t]).css("font-family"),size:$(i[t]).css("font-size"),weight:$(i[t]).css("font-weight")}),u.is(e))switch($(i[t]).css("vertical-align")){case"top":k[t].move(o[t],p[t]);break;case"bottom":k[t].move(o[t],p[t]+$(i[t]).height()-k[t].bbox().w),k[t].rotate(-90,o[t],p[t]+$(i[t]).height()-k[t].bbox().w);break;default:k[t].move(o[t],p[t]+$(i[t]).height()/2+k[t].bbox().w/2),k[t].rotate(-90,o[t],p[t]+$(i[t]).height()/2+k[t].bbox().w/2)}else switch($(i[t]).css("text-align")){case"left":k[t].move(o[t],p[t]);break;case"right":k[t].move(o[t]+$(i[t]).width()-k[t].bbox().w,p[t]);break;default:k[t].move(o[t]+$(i[t]).width()/2-k[t].bbox().w/2,p[t])}}else{if(u.is(a)){var w=$(i[t]).parent().width(),x=$(i[t]).parent().height(),y=m.polyline("0,0 "+w+",0 "+w+","+x+" 0,"+x+" 0,0").fill("none");y.stroke({color:"#808080",width:1}).move(o[t],p[t]),y.attr("shape-rendering","crispEdges"),n.add(y);var z=InteractiveDataDisplay.asPlot(u);k[t]=z.exportToSvg(),o[t]+=parseFloat($(i[t]).css("border-left-width").replace("px","")),p[t]+=parseFloat($(i[t]).css("border-top-width").replace("px",""))}else if(u.is(b))k[t]=u[0].axis.exportToSvg();else{if(!u.is(g))throw"Unexpected element type. SVG export failure";k[t]=j[q][r].exportLegendToSvg(u[0])}k[t].move(o[t],p[t])}n.add(k[t])}return m},w()},InteractiveDataDisplay.asSubPlots=function(a){return a&&void 0!==a.subplots?a.subplots:new InteractiveDataDisplay.SubPlots(a)},InteractiveDataDisplay.readTable=function(a){var b={};InteractiveDataDisplay.Utils.readStyle(a,b);var c=a.children("table:first-child");if(c&&c.length>0){c.toggle();var d=c.children("tbody").children("tr");if(d&&d.length>0){var e=d.first(),f=[];e.children("th").each(function(a){var c=$(this).text();f[a]=c,b[c]=[]});var g=d.toArray();if(g)for(var h=g.length,i=f.length,j=1;j<h;j++)for(var k=$(g[j]).children("td").toArray(),l=0;l<i;l++)b[f[l]][j-1]=parseFloat($(k[l]).text())}}return b},InteractiveDataDisplay.Utils.getAndClearTextContent=function(a){a[0].normalize();var b=a.contents().filter(function(){return 3==this.nodeType&&!(!this.data||""==this.data.trim())})[0];if(b&&b.data){var c=b.wholeText;return void 0!==b.replaceWholeText?b.replaceWholeText(""):b.data="",c}},InteractiveDataDisplay.readCsv=function(a){var b={};InteractiveDataDisplay.Utils.readStyle(a,b);var c=InteractiveDataDisplay.Utils.getAndClearTextContent(a);if(c){c=c.trim();var d=function(a){return a.split(/\s+/g)},e=c.split(/\n/g),f=e.length-1;if(f>0){for(var g=d(e[0]),h=g[0]?0:1,i=h;i<g.length;i++)b[g[i-h]]=[];for(var j=0;j<f;j++){var k=d(e[j+1]);h=k[0]?0:1;for(var i=h;i<k.length;i++){var l=parseFloat(k[i]);isNaN(l)?b[g[i-h]][j]=k[i]:b[g[i-h]][j]=l}}for(var i=0;i<g.length;i++){var m=g[i].split(".");m.length>1&&(b[m[0]]||(b[m[0]]={}),b[m[0]][m[1]]=b[g[i]],delete b[g[i]])}}}return b},InteractiveDataDisplay.readCsv2d=function(a){var b={};InteractiveDataDisplay.Utils.readStyle(a,b);var c=InteractiveDataDisplay.Utils.getAndClearTextContent(a);if(c){c=c.trim();var d=function(a){return a.trim().split(/\s+/g)},e=c.split(/\n/g),f=e.length-1;if(f>0){var g=d(e[0]),h=g.length-1;if(h>0){for(var i=new Array(h),j=new Array(f),k=new Array(h),l=1;l<=h;l++)k[l-1]=new Array(f),i[l-1]=parseFloat(g[l]);for(var m=1;m<=f;m++){var n=d(e[m]);j[m-1]=parseFloat(n[0]);for(var l=1;l<=h;l++)k[l-1][m-1]=parseFloat(n[l])}b.x=i,b.y=j,b.values=k}}}return b},InteractiveDataDisplay.readBase64=function(a){function b(a){var b=a[0].split("."),c=b[0];switch(b[1]){case"1D":if("string"==c){var d=a[1],e=d.split(","),f=e.map(atob);return f}var g=InteractiveDataDisplay.Utils.base64toByteArray(a[1]),f=InteractiveDataDisplay.Utils.byteArrayToTypedArray(g,c);return f;case"2D":var h=parseInt(a[1]),g=InteractiveDataDisplay.Utils.base64toByteArray(a[2]),i=InteractiveDataDisplay.Utils.byteArrayToTypedArray(g,c);if(i.length%h!=0)throw"InnerDimLen is not divisor of decoded flattened array len";for(var j=i.length/h,f=new Array(j),k=0;k<j;k++)f[k]=i.slice(k*h,(k+1)*h);return f;default:throw"Unexpected dimensionality specified ("+a[0]+")"}}var c={};InteractiveDataDisplay.Utils.readStyle(a,c);var d=InteractiveDataDisplay.Utils.getAndClearTextContent(a);if(d){d=d.trim();for(var e=function(a){return a.split(/\s+/g)},f=d.split(/\n/g),g=f.length,h=0;h<g;h++){var i=e(f[h].trim()),j=i[0];i.splice(0,1);var k=b(i);c[j]=k}}return c},InteractiveDataDisplay.InitializeAxis=function(a,b){if(a.hasClass("idd-axis"))throw"The div element already is initialized as an axis";switch(a.attr("data-idd-axis")){case"numeric":return a.axis=new InteractiveDataDisplay.NumericAxis(a),a.axis;case"log":return a.axis=new InteractiveDataDisplay.LogarithmicAxis(a),a.axis;case"labels":if(void 0===b)var c=InteractiveDataDisplay.Utils.getDataSourceFunction(a,InteractiveDataDisplay.readCsv),b=c(a);return a.axis=new InteractiveDataDisplay.LabelledAxis(a,b),a.axis}},InteractiveDataDisplay.TicksRenderer=function(a,b){if("undefined"!=typeof Modernizr&&a&&(Modernizr.canvas||a.replaceWith('<div">Browser does not support HTML5 canvas</div>')),!a||!a.hasClass("idd-axis")){a&&(a[0].axis=this);var c=this,d=a,e="";a&&(e=a.attr("data-idd-placement"));var f="top"==e||"bottom"==e,g={min:0,max:1},h=b,i=[],j=3,k=InteractiveDataDisplay.Utils.generateNextIntId(),l=$("<canvas id='canvas_"+k+"' style='position:relative; float:left'></canvas>"),m=$("<div id='labelsDiv_"+k+"' style='position:relative; float:left'></div>");if(a){"bottom"==e||"right"==e?(a[0].appendChild(l[0]),a[0].appendChild(m[0])):(a[0].appendChild(m[0]),a[0].appendChild(l[0]));var n=InteractiveDataDisplay.tickLength+1;f?l[0].height=n:(l[0].width=n,"right"==e?m.css("left",j):l.css("left",j))}var o,p,q,r,s,t;this.updateSize=function(){var b=q;if(a){var c=a.outerWidth(!1),d=a.outerHeight(!1);f?(o=c,(q=o)!=b&&(l[0].width=q,m.css("width",o))):(p=d,(q=p)!=b&&(l[0].height=q,m.css("height",p)))}r=(q-1)/(g.max-g.min),s=l[0].height};var u=-1,v=InteractiveDataDisplay.tickLength/3,w=d?d.css("color"):"Black",x=l.get(0).getContext("2d");x.strokeStyle=w,x.fillStyle=w,x.lineWidth=1;var y=12,z=!1,A="";d&&(d[0].currentStyle?(y=d[0].currentStyle["font-size"],A=d[0].currentStyle["font-family"]):document.defaultView&&document.defaultView.getComputedStyle?(y=document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"),A=document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-family")):d[0].style&&(y=d[0].style["font-size"],A=d[0].style["font-family"]),x.font=y+A),Object.defineProperty(this,"host",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return e},configurable:!1}),Object.defineProperty(this,"tickSource",{get:function(){return h},set:function(a){h=a,m.empty(),G()},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return g},configurable:!1}),Object.defineProperty(this,"ticks",{get:function(){return i},configurable:!1}),Object.defineProperty(this,"DesiredSize",{get:function(){return{width:o,height:p}},configurable:!1}),Object.defineProperty(this,"axisSize",{get:function(){return q},configurable:!1}),Object.defineProperty(this,"deltaRange",{get:function(){return r},configurable:!1}),Object.defineProperty(this,"FontSize",{get:function(){return _defaultFontSize},set:function(a){z=!0,y=a+"px",x.font=y+A,h.invalidate(),c.update()},configurable:!1}),Object.defineProperty(this,"rotateAngle",{get:function(){return t/Math.PI*180},set:function(a){t=a*Math.PI/180,h.invalidate(),c.update()},configurable:!1}),this.sizeChanged=!0;var B=void 0;Object.defineProperty(this,"dataTransform",{get:function(){return B},set:function(a){B=a,G()},configurable:!1});var C=[],D=function(a){var b=a.length;C=new Array(b);for(var d,e,f,g=0;g<b;g++){var i=a[g];if(i.label){if(d=i.label._size,e=d.width,f=d.height,0==e||0==f){var j=h.getInner(i.position);if("string"==typeof j){var k=x.measureText(j);e=k.width,f=k.height}else{var l=$("<div></div>").append($(j)).css({display:"block",visibility:"hidden",position:"absolute"}).appendTo($("body"));e=l.width(),f=l.height(),l.remove()}}var m=t?e*Math.abs(Math.cos(t))+f*Math.abs(Math.sin(t)):e,n=t?e*Math.abs(Math.sin(t))+f*Math.abs(Math.cos(t)):f;C[g]={position:c.getCoordinateFromTick(i.position),width:m,height:n,hasLabel:!0}}else C[g]={position:c.getCoordinateFromTick(i.position),width:0,height:0,hasLabel:!1}}},E=function(a){var b,c,d=a.length-1;if(H(a),D(a),-1==d)return 1;for(var e=0,g=0;g<d;){for(e=g,g++;g<d+1&&!C[g].hasLabel;)g++;if(g>d)break;if(C[e].hasLabel){if((b=Math.abs(C[g].position-C[e].position))<InteractiveDataDisplay.minTickSpace)return-1;if(f?(c=(C[e].width+C[g].width)/2,0==e&&C[e].position-C[e].width/2<0?c-=C[e].width/2:g==d-1&&C[g].position-C[g].width/2>q&&(c-=C[g].width/2)):(c=(C[e].height+C[g].height)/2,0==e&&C[e].position-C[e].height/2<0?c-=C[e].height/2:g==d-1&&C[g].position-C[g].height/2>q&&(c-=C[g].height/2)),b-c<InteractiveDataDisplay.minLabelSpace)return-1}}var h=1;for(e=g=0;g<d;){for(e=g,g++;g<d+1&&!C[g].hasLabel;)g++;if(g>d)break;if(C[e].hasLabel&&(b=Math.abs(C[g].position-C[e].position),f?(c=(C[e].width+C[g].width)/2,0==e&&C[e].position-C[e].width/2<0?c-=C[e].width/2:g==d-1&&C[g].position-C[g].width/2>q&&(c-=C[g].width/2)):(c=(C[e].height+C[g].height)/2,0==e&&C[e].position-C[e].height/2<0?c-=C[e].height/2:g==d-1&&C[g].position-C[g].height/2>q&&(c-=C[g].height/2)),b-c<InteractiveDataDisplay.minLabelSpace)){h=0;break}}return h};this.getCoordinateFromTick||(this.getCoordinateFromTick=function(a){return a});var F=!1,G=function(){if(c.updateSize(),B){var a=B.plotToData(g.min),b=B.plotToData(g.max);i=h.getTicks({min:Math.min(a,b),max:Math.max(a,b)})}else i=h.getTicks(g);var k,r,s=E(i),y=0;if(-1==s)for(;y++<InteractiveDataDisplay.maxTickArrangeIterations&&(k=h.decreaseTickCount(),r=E(k),i=k,-1==r););if(1==s)for(;y++<InteractiveDataDisplay.maxTickArrangeIterations;){if(k=h.increaseTickCount(),-1==(r=E(k))){i=h.decreaseTickCount(),D(i),H(i);break}if(i=k,0==r)break}if(t&&(i=h.updateTransform(s,t,f)),F=!1,h.getMinTicks&&(-1==r&&y>InteractiveDataDisplay.maxTickArrangeIterations||i.length<2)&&(k=h.getMinTicks(),k.length>0&&(i=k,H(i),D(i))),2==i.length&&(H(i),D(i),2==i.length)){var z,A=C[1].position-C[0].position;z=f?(C[0].width+C[1].width)/2:(C[0].height+C[1].height)/2,A-z<InteractiveDataDisplay.minLabelSpace&&(F=!0)}var G=i.length,I=u;if(u=0,this.sizeChanged=!1,f){for(var J=0;J<G;J++)u=Math.max(u,C[J].height);u!=I&&0!=u&&(m.css("height",u),l[0].height=n,p=u+n,d.css("height",p),this.sizeChanged=!0)}else{for(var J=0;J<G;J++)u=Math.max(u,C[J].width);u!=I&&0!=u&&(m.css("width",u),l[0].width=n,o=u+n+j,d.css("width",o),this.sizeChanged=!0)}x.strokeStyle=w,x.fillStyle=w,f?(x.clearRect(0,0,q,n),"bottom"==e?x.fillRect(0,0,q,1):x.fillRect(0,InteractiveDataDisplay.tickLength,q,1)):(x.clearRect(0,0,n,q),"right"==e?x.fillRect(0,0,1,q):x.fillRect(InteractiveDataDisplay.tickLength,0,1,q));for(var K,J=0;J<G;J++){var L=i[J],M=C[J];K=M.position;var N=void 0,O=void 0;J>0&&(O=C[J-1]),J<G-1&&(N=C[J+1]);var P=O&&N&&!O.hasLabel&&!N.hasClass&&M.hasLabel&&L.invisible;if(f){if(L.invisible||x.fillRect(K,1,1,InteractiveDataDisplay.tickLength),L.label){var Q=void 0,R=M.width,S=L.label._size.width;if(P)if(O.position<0)if(N.position>=R){var T=.5*(0+N.position);Q=T-.5*S}else Q=N.position-.5*(R+S);else if(N.position>q)if(q-O.position>=R){var T=.5*(O.position+q);Q=T-.5*S}else Q=O.position-.5*(S-R);else Q=K-S/2;else Q=K-S/2;L.label.css("left",Q)}}else if(K=q-1-K,i[J].invisible||x.fillRect(1,K,InteractiveDataDisplay.tickLength,1),L.label){var U=M.height,V=L.label._size.height;if(P)if(O.position<0)if(N.position>=U){var T=.5*(0+N.position),W=T+.5*V,X=q-1-W;L.label.css("top",X)}else{var W=N.position-.5*(U-V),X=q-1-W;L.label.css("top",X)}else if(N.position>q)if(q-O.position>=U){var T=.5*(O.position+q),W=T+.5*V,X=q-1-W;L.label.css("top",X)}else{var W=O.position+.5*(U+V),X=q-1-W;L.label.css("top",X)}else L.label.css("top",K-V/2);else L.label.css("top",K-V/2)}}var Y=h.getSmallTicks(i);if(Y.length>0){for(var Z=Math.abs(c.getCoordinateFromTick(Y[1])-c.getCoordinateFromTick(Y[0])),$=1;$<Y.length-1;$++)Z=Math.min(Z,Math.abs(c.getCoordinateFromTick(Y[$+1])-c.getCoordinateFromTick(Y[$])));if(Z>=InteractiveDataDisplay.minTickSpace)for(var J=0,G=Y.length;J<G;J++)K=c.getCoordinateFromTick(Y[J]),"bottom"==e?x.fillRect(K,1,1,v):"top"==e?x.fillRect(K,InteractiveDataDisplay.tickLength-v,1,v):"left"==e?x.fillRect(InteractiveDataDisplay.tickLength-v,q-1-K,v,1):"right"==e&&x.fillRect(1,q-1-K,v,1)}};this.renderToSvg=function(a){var b,d=c.host.height(),g=c.host.width(),j="",k=function(a,b,c){j+="M"+a+" "+b+"h"+c},l=function(a,b,c){j+="M"+a+" "+b+"v"+c};f?(b=p-1,"bottom"==e?(k(0,0,q),InteractiveDataDisplay.tickLength):k(0,b,q)):(b=o-1,"right"==e?(l(0,0,q),InteractiveDataDisplay.tickLength):l(b,0,q)),a.size(g,d);var n,r,s,u=i.length;if(u>0){var x=void 0;for(G=0;G<i.length;G++)if(i[G]&&i[G].label){x=i[G].label[0];break}var A=window.getComputedStyle(x,null);s=A?A.getPropertyValue("font-family"):void 0,r=z?y:A?parseFloat(A.getPropertyValue("font-size")):void 0}for(var B=c.host.offset(),D=m.offset(),E=D.left-B.left,F=D.top-B.top,G=0;G<u;G++)if(n=C[G].position,i[G].label||!(n<0||n>q)){C[G].width;if(f){if(i[G].invisible||("top"==e?l(n,b,-InteractiveDataDisplay.tickLength):l(n,0,InteractiveDataDisplay.tickLength)),i[G].label){var A=i[G].label instanceof jQuery?window.getComputedStyle(i[G].label[0],null):window.getComputedStyle(i[G].label,null),H=parseFloat(A.getPropertyValue("Left")),I=0;i[G].label.normalShift&&(I=i[G].label.normalShift);var J=h.renderToSvg(i[G],a).font({family:s,size:r});J.transform({x:H+E}),J.transform({y:I+F-1},!0),t&&J.transform({rotation:c.rotateAngle},!0)}}else if(n=q-1-n,i[G].invisible||("left"==e?k(b,n,-InteractiveDataDisplay.tickLength):k(0,n,InteractiveDataDisplay.tickLength)),i[G].label){var A=i[G].label instanceof jQuery?window.getComputedStyle(i[G].label[0],null):window.getComputedStyle(i[G].label,null),H=0;i[G].label.normalShift&&(H=i[G].label.normalShift);var I=parseFloat(A.getPropertyValue("Top")),J=h.renderToSvg(i[G],a).font({family:s,size:r});J.transform({x:H+E}),J.transform({y:I+F},!0),t&&J.transform({rotation:c.rotateAngle},!0)}}var K=h.getSmallTicks(i);if(K.length>0){for(var L=Math.abs(c.getCoordinateFromTick(K[1])-c.getCoordinateFromTick(K[0])),M=1;M<K.length-1;M++)L=Math.min(L,Math.abs(c.getCoordinateFromTick(K[M+1])-c.getCoordinateFromTick(K[M])));if(L>=InteractiveDataDisplay.minTickSpace)for(var G=0,u=K.length;G<u;G++)n=c.getCoordinateFromTick(K[G]),"bottom"==e?l(n,0,v):"top"==e?l(n,b,-v):"left"==e?k(b,q-n,-v):"right"==e&&k(.5,q-n,v)}a.path(j).stroke(w).fill("none")},this.exportToSvg=function(){if(!SVG.supported)throw"SVG is not supported";var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),b=SVG(a).size(d.width(),d.height());return c.renderToSvg(b),b};var H=function(a){for(var b,c=0,d=a.length;c<d;c++)if((b=a[c].label)&&!b.hasClass("idd-axis-label")){var e=b[0];m[0].appendChild(e),b.addClass("idd-axis-label"),b._size={width:e.offsetWidth,height:e.offsetHeight},z&&b.css("fontSize",y)}};this.update=function(a){a&&(g=a),G()},this.destroy=function(){d[0].innerHTML="",d.removeClass("idd-axis"),d.removeClass("unselectable")},this.remove=function(){var a=d[0].parentElement;if(a){a.removeChild(d[0]);var b=a.parentElement;b&&("idd-plot-master"==b.className||b.classList&&b.classList.contains("idd-plot-master"))&&b.plot.removeDiv(a)}this.destroy()},a&&(G(),a.addClass("idd-axis"),a.addClass("unselectable"))}},InteractiveDataDisplay.NumericAxis=function(a){this.base=InteractiveDataDisplay.TicksRenderer,a[0].axis=this;var b=!0;this.getCoordinateFromTick=function(a){var b=this.deltaRange;if(isFinite(b)){var c=a,d=this.dataTransform;return d&&(c=d.dataToPlot(a)),(c-this.range.min)*b}return this.axisSize/2};var c=a.attr("data-idd-scientific-notation");void 0!==c?"false"!=c&&"disable"!=c&&"disabled"!=c||(b=!1):b=!1,this.base(a,new InteractiveDataDisplay.NumericTickSource(b))},InteractiveDataDisplay.NumericAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.LogarithmicAxis=function(a){this.base=InteractiveDataDisplay.TicksRenderer,this.getCoordinateFromTick=function(a){var b=this.deltaRange;if(isFinite(b)){return(InteractiveDataDisplay.Utils.log10(a)-this.range.min)*b}return this.axisSize/2},this.base(a,new InteractiveDataDisplay.LogarithmicTickSource)},InteractiveDataDisplay.LogarithmicAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.LabelledAxis=function(a,b){this.base=InteractiveDataDisplay.TicksRenderer;var c=this,d=!0;this.getCoordinateFromTick=function(a){var b=this.deltaRange;if(isFinite(b)){var c=a;return this.dataTransform&&(c=this.dataTransform.dataToPlot(a)),(c-this.range.min)*b}return this.axisSize/2},this.updateLabels=function(a){this.tickSource=new InteractiveDataDisplay.LabelledTickSource(a),this.rotateAngle=a&&a.rotateAngle?a.rotateAngle:0};var e=a.attr("data-idd-force-labels-visibility");return void 0!==e?"false"!=e&&"disable"!=e&&"disabled"!=e||(d=!1):d=!1,void 0===b&&(b={}),b.forceLabelsVisibility=d,this.base(a,new InteractiveDataDisplay.LabelledTickSource(b)),this.rotateAngle=b&&b.rotateAngle?b.rotateAngle:0,this.getToolTip=function(a){for(var b=function(a){return c.dataTransform?c.dataTransform(a):a},d=b(a),e=void 0,f=void 0,g=0;g<c.ticks.length;g++){var h=c.ticks[g];if(!h.text){var i=b(h.position);i>d&&!f&&(f=g),i<d&&(e=g)}}if(f&&!e){if(c.ticks[f-1]&&c.ticks[f-1].text)return c.ticks[f-1].text}else if(e&&!f){if(c.ticks[e+1]&&c.ticks[e+1].text)return c.ticks[e+1].text}else if(e&&f&&f-e==2)return c.ticks[e+1].text},this},InteractiveDataDisplay.LabelledAxis.prototype=new InteractiveDataDisplay.TicksRenderer,InteractiveDataDisplay.TickSource=function(){var a=[],b=[],c=[],d=[],e=0;this.start,this.finish,this.precision=3,this.insertNumericTick=function(a,b,c){var d=2;if(a.empty(),"string"==typeof b&&c){var e=parseFloat(b);isNaN(e)?a.text(b):Math.abs(e)<Math.pow(10,-d)||Math.abs(e)>=Math.pow(10,d+1)?a.append(InteractiveDataDisplay.Utils.getInScientificNotation(e)):a.text(e)}else a.append(b)},this.getDiv=function(f,g){var h=void 0!==g&&g,i=this.getInner(f),j=c.indexOf(i);if(-1!=j){b[j]=!0,d[j].display="block";var k=a[j][0];return a[j]._size={width:k.offsetWidth,height:k.offsetHeight},a[j]}var j=b.indexOf(!1);if(-1!=j){b[j]=!0,d[j].display="block",c[j]=i;var l=a[j];this.insertNumericTick(l,i,h);var k=l[0];return l._size={width:k.offsetWidth,height:k.offsetHeight},a[j]}var l=$("<div></div>");return this.insertNumericTick(l,i,h),b[e]=!0,a[e]=l,c[e]=i,d[e]=l[0].style,l._size=void 0,e++,l},this.getInner=function(a){if(a)return a.toString()},this.invalidate=function(){for(var f=0;f<a.length;f++)a[f].remove();b=[],a=[],c=[],d=[],e=0},this.refreshDivs=function(){for(var a=0;a<e;a++)b[a]?b[a]=!1:d[a].display="none"},this.getTicks=function(a){this.start=a.min,this.finish=a.max},this.decreaseTickCount=function(){},this.increaseTickCount=function(){}},InteractiveDataDisplay.Utils.round=function(a,b){if(b<=0)return-b>15?parseFloat(a.toFixed(15)):parseFloat(a.toFixed(-b));var c=Math.pow(10,b-1);return Math.round(a/c)*c},InteractiveDataDisplay.Utils.getInScientificNotation=function(a,b,c){var d=0,e=Math.abs(a),f=a<0?-1:1,g=void 0===b?3:b,h=void 0!==c&&c;if(e>1){for(var i=e;i>=10&&i%10==0;)d++,i/=10;d<g?d=0:(d=Math.floor(Math.log10(e)),e/=Math.pow(10,Math.floor(Math.log10(e))))}else if(e<=1&&e>0)if((d=Math.floor(Math.log10(e)))>-1*g)d=0;else{d=Math.floor(Math.log10(e)),e/=Math.pow(10,Math.floor(Math.log10(e)));var j=1e6;e=Math.round(e*j)/j}var k="";return 0!=e?k+=f*e:k="0",0!=d&&(k+="&#215;10<sup>"+d+"</sup>"),h?{m:f*e,pow:d}:k},InteractiveDataDisplay.NumericTickSource=function(a){this.base=InteractiveDataDisplay.TickSource,this.base(),this.isScientific=void 0!==a&&a;var b,c,d=this;this.getInner=function(a,b){var d=void 0===b?InteractiveDataDisplay.minNumOrder:b;if(0==a)return a.toString();if(c>=d){return InteractiveDataDisplay.Utils.round(a/Math.pow(10,c),-1)+"e+"+c}return InteractiveDataDisplay.Utils.round(a,c).toString()},this.getMPow=function(a,b){var d=void 0===b?3:b;return 0==a?{m:a,pow:0}:c>=d?{m:InteractiveDataDisplay.Utils.round(a/Math.pow(10,c),-1),pow:c}:{m:InteractiveDataDisplay.Utils.round(a,c),pow:0}},this.getTicks=function(a){return InteractiveDataDisplay.NumericTickSource.prototype.getTicks.call(this,a),b=1,c=Math.floor(InteractiveDataDisplay.Utils.log10(this.finish-this.start)),e()},this.renderToSvg=function(a,b){if(d.isScientific){var c=InteractiveDataDisplay.Utils.getInScientificNotation(a.position,3,!0);return b.text(function(a){a.tspan(c.m).dy(18),0!=c.pow&&(a.tspan("×"),a.tspan("10"),a.tspan(c.pow).style("font-size","0.8em").dy(-10))})}return b.text(d.getInner(a.position))};var e=function(){var a=[];if(d.start>d.finish)return a;if(isFinite(c))for(var e,f=b*Math.pow(10,c),g=Math.floor(d.start/f),h=Math.floor(d.finish/f)-g+2,i=0,j=g*f,k=0;k<h;k++)(e=j+k*f)>=d.start&&e<=d.finish&&(a[i]={position:e,label:d.getDiv(e,d.isScientific)},i++);else a[0]={position:d.start,label:d.getDiv(d.start,d.isScientific),invisible:!0};return d.refreshDivs(),a};this.decreaseTickCount=function(){return 1==b?b=2:2==b?b=5:5==b&&(b=1,c++),e()},this.increaseTickCount=function(){return 1==b?(b=5,c--):2==b?b=1:5==b&&(b=2),e()},this.getSmallTicks=function(a){var b=[],c=0;if(a.length>1){var d=a[0].position,e=Math.abs(a[1].position-d)/10;for(d-=e;d>this.start&&c<10;)b[c]=d,c++,d-=e;for(var f=a.length,g=0;g<f-1;g++){d=a[g].position+e;for(var h=0;h<9;h++)b[c]=d,c++,d+=e}d=a[f-1].position+e;for(var i=0;d<this.finish&&i<10;)b[c]=d,c++,d+=e,i++}return b},this.getMinTicks=function(){var a=[];if(c=Math.floor(InteractiveDataDisplay.Utils.log10(this.finish-this.start)),isFinite(c)){var e=Math.pow(10,c),f=Math.floor(d.start/e)*e;f<d.start&&(f+=e);var g=Math.floor(d.finish/e)*e;if(g>d.finish&&(g-=e),f!=g)a[0]={position:f,label:d.getDiv(InteractiveDataDisplay.Utils.round(f,c))},a[1]={position:g,label:d.getDiv(InteractiveDataDisplay.Utils.round(g,c))};else{c--,b=5,e=b*Math.pow(10,c),f=Math.floor(d.start/e);for(var h,i=Math.floor(d.finish/e)-f+2,j=0,k=f*e,l=0;l<i;l++)(h=k+l*e)>=d.start&&h<=d.finish&&(a[j]={position:h,label:d.getDiv(InteractiveDataDisplay.Utils.round(h,c))},j++)}}else a[0]={position:d.start,label:d.getDiv(d.start),invisible:!0};return this.refreshDivs(),a}},InteractiveDataDisplay.NumericTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.LogarithmicTickSource=function(){this.base=InteractiveDataDisplay.TickSource,this.base();var a,b,c=this,d=1,e=10;this.getInner=function(a){if(Math.abs(a)<InteractiveDataDisplay.minLogOrder)return Math.pow(10,a).toString();var b="10<sup>"+a+"</sup>",c=document.createElement("span");return c.innerHTML=b,c},this.renderToSvg=function(a,b){var c=a.position;return b.text(c.toString())},this.getTicks=function(c){return InteractiveDataDisplay.LogarithmicTickSource.prototype.getTicks.call(this,c),a=Math.pow(10,this.start),b=Math.pow(10,this.finish),f()};var f=function(){var f=[];if(isFinite(Math.pow(10,-c.start))&&isFinite(b))if(a==b)f[0]={position:c.start,label:c.getDiv(c.start),invisible:!0};else for(var g=c.start/d|0,h=(c.finish/d|0)-g+3,i=(g-1)*d,j=Math.pow(10,i),k=0,l=0;l<h;l++)j>=a&&j<=b&&(f[k]={position:j,label:c.getDiv(i)},k++),i+=d,j*=e;return c.refreshDivs(),f};this.decreaseTickCount=function(){return d*=2,e=Math.pow(10,d),f()},this.increaseTickCount=function(){return d>1&&(d/=2,e=Math.pow(10,d)),f()},this.getSmallTicks=function(e){var f=[],g=isFinite(Math.pow(10,-c.start))&&isFinite(b),h=0;if(e.length>0&&1==d&&g){var i=e[0].position,j=i/10;for(i-=j;i>a&&h<10;)f[h]=i,h++,i-=j;for(var k=e.length,l=0;l<k-1;l++){i=e[l].position,j=(e[l+1].position-i)/10,i+=j;for(var m=0;m<9;m++)f[h]=i,h++,i+=j}for(i=e[k-1].position,j=i,i+=j;i<b;)f[h]=i,h++,i+=j}return f},this.getMinTicks=function(){var d=[];return isFinite(Math.pow(10,-c.start))&&isFinite(b)?a==b&&(d[0]={position:c.start,label:c.getDiv(c.start),invisible:!0},this.refreshDivs()):(d[0]={position:1,label:c.getDiv(0)},this.refreshDivs()),d}},InteractiveDataDisplay.LogarithmicTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.LabelledTickSource=function(a){this.base=InteractiveDataDisplay.TickSource,this.base();var b=this,c=[],d=[],e=!1;if(a&&a.forceLabelsVisibility&&(e=a.forceLabelsVisibility),a&&a.labels){for(var f=a.labels.length,g=0;g<f;g++)c[g]=a.labels[g].toString();if(a.ticks)d=a.ticks;else for(var g=0;g<f;g++)d[g]=g}var h,i,j=1,k=d.length-c.length>0;this.getInner=function(a){if("string"==typeof a&&-1!==a.indexOf("\n")){var b=document.createElement("span");return b.title=a,b.innerText=a,$(b).css("white-space","pre"),b}return a.toString()},this.renderToSvg=function(a,b){var c=a.text?a.text:"";return b.text(c)},this.getTicks=function(a){
if(InteractiveDataDisplay.LabelledTickSource.prototype.getTicks.call(this,a),j=1,!k){var b=0,c=d.length-1,e=0|this.start;if(e>d[b])for(;c-b>1;){var f=Math.round((b+c)/2);d[f]<e?b=f:c=f}if(h=b,b=0,c=d.length-1,(e=1|this.finish)<d[c])for(;c-b>1;){var f=Math.round((b+c)/2);d[f]<e?b=f:c=f}if((i=c)>h)for(var g=(d.length-1)/(i-h);j<g;)j*=2}return l()};var l=function(){var a=[];if(k){for(var f=0;d[f]<b.start;)f++;f>0&&f--;for(var g=d.length-1;d[g]>b.finish;)g--;g<d.length-1&&g++;for(var l=g-f+1,m=0,n=d[f],o=0;o<l;o++){boundPos=n,a[m]={position:boundPos},m++,f++;var n=d[f];if(o!=l-1){var p=(boundPos+n)/2,q=b.getDiv(c[f-1]);a[m]={position:p,label:q,invisible:!0,text:c[f-1]},m++}}}else{var r=Math.floor((d.length-1)/j);e&&(r=1),r>d.length-1?r=d.length-1:r<1&&(r=1);for(var s=0,t=0|b.start;d[s]<t;)s+=r;s-r>=0&&d[s]>t&&(s-=r);for(var l=i-h+1,m=0,o=0;o<l;o++){if((t=d[s])>=b.start&&t<=b.finish){var q=b.getDiv(c[s]);a[m]={position:t,label:q,text:c[s]},m++}s+=r}}return b.refreshDivs(),a};this.decreaseTickCount=function(){return k?j++:j/=2,l()},this.increaseTickCount=function(){return k?j--:j*=2,l()},this.updateTransform=function(a,b,c){for(var d=l(),e=0;e<d.length;e++)if(d[e].label){var f=d[e].label,g=b/Math.PI*180,h=f._size.width,i=f._size.height,j=Math.abs(b),k=Math.sin(j),m=Math.cos(j),n="rotate("+g+"deg)";if(c){var o=.5*(h*k+i*m-i),n="translateY("+o+"px)"+n;f.normalShift=o}else{var p=-.5*(h-(h*m+i*k)),n="translateX("+p+"px)"+n;f.normalShift=p}f.css("-webkit-transform",n),f.css("-moz-transform",n),f.css("-ms-transform",n),f.css("-o-transform",n),f.css("transform",n)}return d},this.getSmallTicks=function(a){var b=[];if(!k)for(var c=0,e=0,f=0;f<d.length;f++)a.length>e&&d[f]==a[e].position?e++:(b[c]=d[f],c++);return b},this.getMinTicks=function(){var a=[];if(e)return l();if(!k&&c.length>0){var f=b.getDiv(c[0]);a[0]={position:d[0],label:f,text:c[0]},f=b.getDiv(c[c.length-1]),a[1]={position:d[d.length-1],label:f,text:c[c.length-1]},b.refreshDivs()}return a}},InteractiveDataDisplay.LabelledTickSource.prototype=new InteractiveDataDisplay.TickSource,InteractiveDataDisplay.TicksRenderer.getAxisType=function(a){return void 0===a?"numeric":a.type&&"log10"==a.type?"log":"numeric"},InteractiveDataDisplay=InteractiveDataDisplay||{},InteractiveDataDisplay.ColorPalette=function(a,b,c){var d,e,f,g=this;if(Object.defineProperty(this,"isNormalized",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return e},configurable:!1}),Object.defineProperty(this,"points",{get:function(){return f},configurable:!1}),d=a,e=d?{min:0,max:1}:{min:b.min,max:b.max},e.min>=e.max)throw"range is incorrect (min >= max)";if(void 0==c)throw"points are undefined";if(c.length<2)throw"Palette should have at least two points";f=c.slice(0),this.getRgba=function(a){var b=g.getHsla(a);return InteractiveDataDisplay.ColorPalette.HSLtoRGB(b)},this.getHsla=function(a){var b=f.length;if(a<=f[0].x)return f[0].leftColor;if(a>=f[b-1].x)return f[b-1].rightColor;for(var c=0,d=b-1;d-c>1;){var e=Math.round((c+d)/2);f[e].x<a?c=e:d=e}var g=f[c];g.x==a&&(d=c);var h=f[d],i=(a-g.x)/(h.x-g.x),j=g.rightColor,k=h.leftColor;0==j.h&&0==j.s&&(j.h=k.h),0==k.h&&0==k.s&&(k.h=j.h);var l=j.h,m=k.h;Math.abs(m-l)>3&&(l<m?l+=6:m+=6);var n={h:l+(m-l)*i,s:j.s+(k.s-j.s)*i,l:j.l+(k.l-j.l)*i,a:j.a+(k.a-j.a)*i};return n.h>=6&&(n.h-=6),n},this.absolute=function(a,b){for(var c=f.length,d=(b-a)/(e.max-e.min),g=new Array(c),h=0;h<c;h++){var i=f[h];g[h]={x:d*(i.x-e.min)+a,rightColor:i.rightColor,leftColor:i.leftColor}}return new InteractiveDataDisplay.ColorPalette(!1,{min:a,max:b},g)},this.relative=function(){if(d)return this;for(var a=f.length,b=1/(e.max-e.min),c=new Array(a),g=0;g<a;g++){var h=f[g];c[g]={x:b*(h.x-e.min),rightColor:h.rightColor,leftColor:h.leftColor}}return new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},c)},this.banded=function(a){if(!a)throw"bands is undefined";var b=!1;if("number"==typeof a){if(a<1)throw new"number of bands is less than 1";b=!0;var c=a-1,f=(e.max-e.min)/a;a=new Array(c);for(var g=0;g<c;g++)a[g]=(g+1)*f+e.min}var h=a.length+2,i=a.length+1;if(h<2)throw"number of bands is less than 1";for(var j,k,l=new Array(h),m=this.getHsla(e.min),n=i>1?(e.max-e.min)/(i-1):.5*(e.max-e.min),g=0;g<h-1;g++){if(0==g)j=e.min,k=e.min;else{if(j=g==h-2?e.max:b?e.min+g*n:(a[g-1]+a[g])/2,k>=a[g-1])throw"bands points are incorrect";k=a[g-1]}var o=this.getHsla(j),p={x:k,rightColor:o,leftColor:m};l[g]=p,m=o}if(k>=e.max)throw"bands points are incorrect";return l[h-1]={x:e.max,rightColor:m,leftColor:m},new InteractiveDataDisplay.ColorPalette(d,e,l)},this.gradientString=function(){var a=InteractiveDataDisplay.ColorPalette.getColorNames(),b=function(b){for(var c=function(a){for(var b=a.toString(16);b.length<2;)b="0"+b;return b},d=InteractiveDataDisplay.ColorPalette.HSLtoRGB(b),e=c(d.r),f=c(d.g),g=c(d.b),h="#"+e+f+g,i=Object.keys(a),j=0;j<i.length;j++){var k=i[j];if(a[k]==h){h=k;break}}return h},c="",e=f.length;d||(c=f[0].x+"=");for(var g=1;g<e;g++){var h=f[g-1],i=f[g];h.rightColor===i.leftColor?c+=b(h.rightColor):c+=b(h.rightColor)+","+b(i.leftColor),g<e-1&&(c+="="+i.x+"=")}return d||(c+="="+f[e-1].x),c}},InteractiveDataDisplay.ColorPalette.getColorNames=function(){return{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},InteractiveDataDisplay.ColorPalette.toArray=function(a,b){var c,d,e=new Uint8Array(b<<2),f=a.getRgba;a.isNormalized?(c=1/(b-1),d=0):(d=a.range.min,c=(a.range.max-a.range.min)/(b-1));for(var g,h,i=0,h=0;i<b;i++)g=f(i*c+d),e[h++]=g.r,e[h++]=g.g,e[h++]=g.b,e[h++]=255*g.a;return e},InteractiveDataDisplay.ColorPalette.create=function(){var a=arguments;if(!a||0==a.length)throw"colors is undefined or empty";var b=a.length;1==b&&(b++,a=[a[0],a[0]]);for(var c=new Array(b),d=1/(b-1),e=0;e<b;e++){var f=a[e],g="number"==typeof f.r?InteractiveDataDisplay.ColorPalette.RGBtoHSL(f):f;c[e]={x:e*d,rightColor:g,leftColor:g}}return new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},c)},InteractiveDataDisplay.ColorPalette.parse=function(a){var b,c=!0,d=[];if(void 0==a&&(a=""),""==a)return InteractiveDataDisplay.palettes.grayscale;var e,f=new InteractiveDataDisplay.Lexer(a),g=-1;if(f.readNext()){if(d.push({x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:1,a:1}}),"number"==f.currentLexeme){if(d[d.length-1].x=f.currentNumber,c=!1,f.readNext()&&("separator"!=f.currentLexeme||"equal"!=f.currentSeparator))throw f.position+": separator '=' expected";if(f.readNext()&&"color"!=f.currentLexeme)throw f.position+": color expected"}if("color"!=f.currentLexeme)throw f.position+": wrong lexeme";d[d.length-1].rightColor=f.currentColor,d[d.length-1].leftColor=f.currentColor,d.push({x:d[0].x,rightColor:f.currentColor,leftColor:f.currentColor})}for(e=d[0].x;f.readNext();){if("separator"!=f.currentLexeme)throw f.position+": separator expected";if("equal"==f.currentSeparator){if(f.readNext())if("number"==f.currentLexeme){if(f.currentNumber<e)throw f.position+": number is less than previous";if(e=f.currentNumber,-1==g)d[d.length-1].x=f.currentNumber,g=1;else{if(0!=g)throw f.position+": wrong lexeme";d[d.length-1].x=f.currentNumber,g=2}}else{if("color"!=f.currentLexeme)throw f.position+": wrong lexeme";if(1==g||2==g)d[d.length-1].rightColor=f.currentColor,g=-1;else{if(0!=g&&-1!=g)throw f.position+": wrong lexeme";d[d.length-1].x=d[0].x-1,d[d.length-1].rightColor=f.currentColor,g=-1}}}else if("comma"==f.currentSeparator&&f.readNext())if(1==g||-1==g||2==g)if("number"==f.currentLexeme){if(f.currentNumber<=e)throw f.position+": number is less than previous";if(e=f.currentNumber,!f.readNext()||"separator"!=f.currentLexeme||"equal"!=f.currentSeparator)throw f.position+": wrong lexeme";if(!f.readNext()||"color"!=f.currentLexeme)throw f.position+": color expected";-1!=g?d.push({x:f.currentNumber,rightColor:f.currentColor,leftColor:f.currentColor}):(d[d.length-1].x=f.currentNumber,d[d.length-1].rightColor=f.currentColor,d[d.length-1].leftColor=f.currentColor),g=-1}else{if("color"!=f.currentLexeme)throw f.position+": wrong lexeme";-1==g&&d.pop(),g=0}else if(0==g)if("number"==f.currentLexeme){if(f.currentNumber<=e)throw f.position+": number is less than previous";if(e=f.currentNumber,d[d.length-1].x=d[0].x-1,!f.readNext()||"separator"!=f.currentLexeme||"equal"!=f.currentSeparator)throw f.position+": wrong lexeme";if(!f.readNext()||"color"!=f.currentLexeme)throw f.position+": color expected";d.push({x:f.currentNumber,rightColor:f.currentColor,leftColor:f.currentColor}),g=-1}else{if("color"!=f.currentLexeme)throw f.position+": wrong lexeme";d[d.length-1].x=d[0].x-1,g=0}-1==g?d.push({x:d[0].x,rightColor:f.currentColor,leftColor:f.currentColor}):0==g&&d.push({x:d[0].x,rightColor:f.currentColor,leftColor:f.currentColor})}if("separator"==f.currentLexeme)throw f.position+": wrong lexeme";if("number"==f.currentLexeme&&c||"color"==f.currentLexeme&&!c)throw f.position+": wrong ending";if(c&&(d[d.length-1].x=1,d[d.length-1].x<d[d.length-2].x))throw f.position+": number is less than previous";if(d[d.length-1].rightColor=d[d.length-1].leftColor,d[0].x>=d[d.length-1].x)throw f.position+": wrong range of palette";b={min:d[0].x,max:d[d.length-1].x};for(var h=1,i=0,j=1,k=d.length;j<k;j++)if(d[j].x==d[0].x-1)0==i&&(h=j),i++;else if(0!=i){for(var l=(d[h+i].x-d[h-1].x)/(i+1),m=0;m<i;m++)d[h+m].x=d[h-1].x+l*(m+1);i=0,h=1}return new InteractiveDataDisplay.ColorPalette(c,b,d)},InteractiveDataDisplay.Lexer=function(a){if("string"!=typeof a)throw"wrong definition of palette: must be a string";var b,c,d,e,f=a,g=0;Object.defineProperty(this,"position",{get:function(){return g},configurable:!1}),Object.defineProperty(this,"paletteString",{get:function(){return f},configurable:!1}),Object.defineProperty(this,"currentSeparator",{get:function(){return e},configurable:!1}),Object.defineProperty(this,"currentLexeme",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"currentNumber",{get:function(){return c},configurable:!1}),Object.defineProperty(this,"currentColor",{get:function(){return b},configurable:!1}),this.readNext=function(){if(g>=f.length)return!1;for(;" "===f[g];)g++;if("#"===f[g]||/^[a-z]/.test(f[g].toLowerCase())){d="color";for(var a=g;g<f.length&&" "!=f[g]&&"="!=f[g]&&","!=f[g];)g++;var h=InteractiveDataDisplay.ColorPalette.colorFromString(f.substring(a,g));b=InteractiveDataDisplay.ColorPalette.RGBtoHSL(h)}else if("="===f[g]||","===f[g])d="separator",e="="==f[g]?"equal":"comma",g++;else{d="number";for(var a=g;g<f.length&&" "!=f[g]&&"="!=f[g]&&","!=f[g];)g++;var i=f.substring(a,g),j=i.replace(/[^0-9+-Ee.]/g,"");if(i!=j)throw"wrong number value";c=parseFloat(f.substring(a,g))}return!0}},InteractiveDataDisplay.ColorPalette.colorFromString=function(a){var b=InteractiveDataDisplay.ColorPalette.getColorNames();if("string"!=typeof a)throw"wrong definition of color: must be a string";var c,d,e,f,g=!1;if(b[a.toLowerCase()]){a=b[a.toLowerCase()]}if("#"==a.charAt(0)){if(7==a.length)f=1,c=parseInt(a.substring(1,3),16),d=parseInt(a.substring(3,5),16),e=parseInt(a.substring(5,7),16);else{if(9!=a.length)throw"wrong definition of hex color";c=parseInt(a.substring(1,3),16),d=parseInt(a.substring(3,5),16),e=parseInt(a.substring(5,7),16),f=parseInt(a.substring(7,9),16)/255}g=!0}if(!g){var h=/rgb\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\s*\)/,i=/rgb\(\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%,\s*([0-9]|[1-8][0-9]|9[0-9]|100)%\s*\)/,j=h.exec(a);null!==j&&(f=1,c=parseInt(j[1]),d=parseInt(j[2]),e=parseInt(j[3]),g=!0),g||null!==(j=i.exec(a))&&(f=1,c=Math.round(2.55*parseInt(j[1])),d=Math.round(2.55*parseInt(j[2])),e=Math.round(2.55*parseInt(j[3])),g=!0)}if(!g){var k=/rgba\(\s*(\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*([0|1]\.?\d+)\)/,j=k.exec(a);null!==j&&(c=parseInt(j[1]),d=parseInt(j[2]),e=parseInt(j[3]),f=parseFloat(j[4]),g=!0)}if(!g)throw"Unsupported color definition";if(isNaN(c)||isNaN(d)||isNaN(e)||isNaN(f))throw"wrong definition of hex color";return{r:c,g:d,b:e,a:f}},InteractiveDataDisplay.ColorPalette.RGBtoHSL=function(a){var b,c,d,e;e=a.a;var f=a.r/255,g=a.g/255,h=a.b/255,i=Math.max(f,g);i=Math.max(i,h);var j=Math.min(f,g);return j=Math.min(j,h),d=(i+j)/2,c=i==j?0:d<.5?(i-j)/(i+j):(i-j)/(2-i-j),i==j?b=0:i==f?b=g>=h?(g-h)/(i-j):(g-h)/(i-j)+6:i==g?b=2+(h-f)/(i-j):i==h&&(b=4+(f-g)/(i-j)),{h:b,s:c,l:d,a:e}},InteractiveDataDisplay.ColorPalette.HSLtoRGB=function(a){var b,c,d,e;e=a.a;var f=a.h,g=a.s,h=a.l,i=(1-Math.abs(2*h-1))*g,j=i*(1-Math.abs(f%2-1));f<2?(d=0,f<1?(b=Math.round(255*i),c=Math.round(255*j)):(b=Math.round(255*j),c=Math.round(255*i))):f<4?(b=0,f<3?(c=Math.round(255*i),d=Math.round(255*j)):(c=Math.round(255*j),d=Math.round(255*i))):f<6&&(c=0,f<5?(b=Math.round(255*j),d=Math.round(255*i)):(b=Math.round(255*i),d=Math.round(255*j)));var k=255*(h-i/2),l=b+k;return b=l>255?255:l<0?0:Math.round(l),l=c+k,c=l>255?255:l<0?0:Math.round(l),l=d+k,d=l>255?255:l<0?0:Math.round(l),{r:b,g:c,b:d,a:e}},InteractiveDataDisplay.ColorPaletteViewer=function(a,b,c){function d(a){return k?{min:InteractiveDataDisplay.Utils.log10(a.min),max:InteractiveDataDisplay.Utils.log10(a.max)}:a}function e(){p=$("<div data-idd-placement='bottom' style='width: "+h+"px; color: rgb(0,0,0)'></div>"),g[0].appendChild(p[0]),q=k?new InteractiveDataDisplay.LogarithmicAxis(p):new InteractiveDataDisplay.NumericAxis(p),l&&!l.isNormalized?q.update(d({min:l.range.min,max:l.range.max})):m&&q.update(d({min:m.min,max:m.max}))}function f(){g[0].removeChild(p[0]),p=null,q=null}var g=a,h=g.width(),i=20,j=!0,k=!1,l=b,m=void 0;void 0!==c&&(void 0!==c.height&&(i=c.height),void 0!==c.width&&(h=c.width),void 0!==c.axisVisible&&(j=c.axisVisible),void 0!==c.logAxis&&(k=c.logAxis));var n=$("<canvas height='"+i+"px'width='"+h+"px' style='display: block'></canvas>");g[0].appendChild(n[0]);var o=n.get(0).getContext("2d"),p=null,q=null;j&&e(),Object.defineProperty(this,"axisVisible",{get:function(){return j},set:function(a){a=!!a,j!=a&&(j=a,j?e():f())},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return l},set:function(a){a&&(l=a,!j||l.isNormalized&&m||q.update(d({min:l.range.min,max:l.range.max})),r())},configurable:!1}),Object.defineProperty(this,"dataRange",{get:function(){return m},set:function(a){a&&(m=a,!j||l&&!l.isNormalized||q.update(d({min:m.min,max:m.max})))},configurable:!1});var r=function(){for(var a,b=(l.range.max-l.range.min)/h,c=o.createLinearGradient(0,0,h,0),d=l.range.min,e=0;e<h;e++)a=l.getRgba(d),c.addColorStop(e/h,"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"),d+=b;o.fillStyle=c,o.fillRect(0,0,h,i)};l&&r()},InteractiveDataDisplay.SvgColorPaletteViewer=function(a,b,c,d){function e(){c.children[1].axis.renderToSvg(j),j.translate(0,g+.5)}var f=170,g=20,h=!0,i=b;void 0!==d&&(void 0!==d.height&&(g=d.height),void 0!==d.width&&(f=d.width),void 0!==d.axisVisible&&(h=d.axisVisible));var j=a.group();h&&e();var k=function(){var b,c=(i.range.max-i.range.min)/f,d=a.gradient("linear",function(a){for(var d=i.range.min,e=0;e<f;e++)b=i.getRgba(d),a.at(e/f,"rgba("+b.r+","+b.g+","+b.b+","+b.a+")"),d+=c});a.rect(f,g).fill(d)};i&&k()},InteractiveDataDisplay.SizePalette=function(a,b,c){var d,e,f;if(Object.defineProperty(this,"isNormalized",{get:function(){return d},configurable:!1}),Object.defineProperty(this,"range",{get:function(){return e},configurable:!1}),Object.defineProperty(this,"sizeRange",{get:function(){return f},configurable:!1}),d=a,e=d?{min:0,max:1}:{min:c.min,max:c.max},f={min:b.min,max:b.max},e.min>e.max)throw"valueRange is incorrect (min >= max)";var g=(f.max-f.min)/(e.max-e.min);this.getSize=function(a){return a<=e.min?f.min:a>=e.max?f.max:g*(a-e.min)+f.min}},InteractiveDataDisplay.SizePalette.Create=function(a){if(a instanceof InteractiveDataDisplay.SizePalette)return a;var b=a.sizeRange,c=a.valueRange;return new InteractiveDataDisplay.SizePalette(void 0===c,b,c)},InteractiveDataDisplay.SizePaletteViewer=function(a,b,c){function d(){m=$("<div data-idd-placement='bottom' style='width: "+g+"px; margin-top: -1px; color: rgb(0,0,0)'></div>"),l=new InteractiveDataDisplay.NumericAxis(m),f[0].appendChild(m[0]),j?j.isNormalized||l.update({min:j.range.min,max:j.range.max}):n&&l.update({min:n.min,max:n.max})}function e(){f[0].removeChild(m[0]),m=null,l=null}var f=a,g=f.width(),h=35,i=!0,j=b;void 0!==c&&(void 0!==c.axisVisible&&(i=c.axisVisible),void 0!==c.width&&(g=c.width),void 0!==c.height&&(h=c.height));var k=$("<canvas height='"+h+"px'width='"+g+"px' style='display: block'></canvas>");f[0].appendChild(k[0]);var l=null,m=null;i&&d(),Object.defineProperty(this,"axisVisible",{get:function(){return i},set:function(a){a=!!a,i!=a&&(i=a,i?d():e())},configurable:!1}),Object.defineProperty(this,"palette",{get:function(){return j},set:function(a){a&&(j=a,i&&!j.isNormalized&&l.update({min:j.range.min,max:j.range.max}),p())},configurable:!1});var n=void 0;Object.defineProperty(this,"dataRange",{get:function(){return n},set:function(a){a&&(n=a,!i||j&&!j.isNormalized||l.update({min:n.min,max:n.max}))},configurable:!1});var o=k.get(0).getContext("2d"),p=function(){o.clearRect(0,0,g,h),o.fillStyle="lightgray",o.strokeStyle="black";var a=0,b=h;j&&j.sizeRange&&(a=j.sizeRange.min,b=j.sizeRange.max);var c=h*g/Math.max(b,a);o.beginPath(),o.moveTo(0,h),0!=a&&o.lineTo(0,Math.max(0,h-a)),c<g?(o.lineTo(c,0),a<=b?o.lineTo(g,0):o.lineTo(g,Math.max(0,h-b))):o.lineTo(g,Math.max(0,h-b)),o.lineTo(g,h),o.lineTo(0,h),o.closePath(),o.fill(),o.stroke()};p()},InteractiveDataDisplay.SvgSizePaletteViewer=function(a,b,c,d){function e(){var b=c.children[1],d=a.group();b.axis.renderToSvg(d),d.translate(0,g)}var f=170,g=75,h=!0,i=b;void 0!==d&&(void 0!==d.axisVisible&&(h=d.axisVisible),void 0!==d.width&&(f=d.width),void 0!==d.height&&(g=d.height));h&&e(),function(){var b=0,c=g;i.sizeRange&&(b=i.sizeRange.min,c=i.sizeRange.max);var d=g*f/Math.max(c,b),e=[];0!=b?e.push([0,Math.max(0,g-b)]):e.push([0,g]),d<f?(e.push([d,0]),b<=c?e.push([f,0]):e.push([f,Math.max(0,g-c)])):(e.push([f,Math.max(0,g-c)]),e.push([f,Math.max(0,g-c)])),a.polyline([[0,g],e[0],e[1],e[2],[f,g],[0,g]]).fill("lightgray").stroke("black")}()},InteractiveDataDisplay.UncertaintySizePaletteViewer=function(a,b){var c=a;c.width();void 0!==b&&(void 0!==b.width&&b.width,void 0!==b.height&&b.height);var d=void 0;Object.defineProperty(this,"maxDelta",{get:function(){return d},set:function(a){a&&(d=a,h())}});var e=$("<canvas height='50px'></canvas>");c[0].appendChild(e[0]);var f=e[0].getContext("2d"),g=[{x:25,y:20,min:16,max:16},{x:75,y:20,min:10,max:16},{x:125,y:20,min:0,max:16}],h=function(){for(var a=0;a<g.length;a++)InteractiveDataDisplay.Petal.drawSample(f,g[a].x,g[a].y,g[a].min,g[a].max,"#484848");f.lineWidth=1,f.beginPath(),f.moveTo(20,45.5),f.lineTo(118,45.5),f.stroke(),f.closePath(),f.beginPath(),f.moveTo(118,45.5),f.lineTo(103.5,40.5),f.lineTo(103.5,49.5),f.lineTo(118,45.5),f.stroke(),f.closePath(),f.fill(),f.strokeStyle="black",f.fillStyle="black",f.lineWidth=1,d&&(f.fillText("X",9,49),f.fillText("X",122,49),f.beginPath(),f.moveTo(134,44.5),f.lineTo(141,44.5),f.stroke(),f.closePath(),f.beginPath(),f.moveTo(134,48.5),f.lineTo(141,48.5),f.stroke(),f.closePath(),f.beginPath(),f.moveTo(137.5,41),f.lineTo(137.5,48),f.stroke(),f.closePath(),f.fillText("",round(d,{min:0,max:d},!1),145,49))};h(),$("<div style='margin-left: 30px; margin-top: -10px'>uncertainty</div>").appendTo(c)},InteractiveDataDisplay.palettes={grayscale:new InteractiveDataDisplay.ColorPalette(!0,{min:0,max:1},[{x:0,rightColor:{h:0,s:0,l:0,a:1},leftColor:{h:0,s:0,l:0,a:1}},{x:1,rightColor:{h:0,s:0,l:1,a:1},leftColor:{h:0,s:0,l:1,a:1}}])},InteractiveDataDisplay=InteractiveDataDisplay||{},InteractiveDataDisplay.ColorPaletteEditor=function(a,b){if(!a.hasClass("idd-colorPaletteEditor")){a.addClass("idd-colorPaletteEditor"),a[0].editor=this;var c="gray",d="rgba(100,100,100,0.3)",e=b;Object.defineProperty(this,"palette",{get:function(){return e},set:function(a){e=a,o.palette=e,z()},configurable:!1});var f=function(b){a.trigger("paletteChanged",[b])},g=!1,h=!1,i=a.width(),j=10,k=20,l=$("<div></div>").height(j).width(i).addClass("idd-colorPaletteEditor-bar").appendTo(a),m=$("<div></div>").height(k).width(i).addClass("idd-colorPaletteEditor-viewer").appendTo(a),n={height:k,axisVisible:!1},o=new InteractiveDataDisplay.ColorPaletteViewer(m,e,n),p=j+m.height();a.height(p);var q=function(a){var b=InteractiveDataDisplay.ColorPalette.HSLtoRGB(a);return"rgba("+b.r+","+b.g+","+b.b+","+b.a+")"},r=function(a){var b=function(a){for(var b=a.toString(16);b.length<2;)b="0"+b;return b},c=InteractiveDataDisplay.ColorPalette.HSLtoRGB(a);return"#"+b(c.r)+b(c.g)+b(c.b)},s=function(a,b,c,d,e,f){var g=j;e&&(a.fillStyle=e,a.beginPath(),a.moveTo(b,c),a.lineTo(b+g/2,c),a.lineTo(b+g/2,c+g),a.fill()),f&&(a.fillStyle=f,a.beginPath(),a.moveTo(b+g/2,c),a.lineTo(b+g,c),a.lineTo(b+g/2,c+g),a.fill()),a.strokeStyle=d,a.beginPath(),a.moveTo(b,c),a.lineTo(b+g,c),a.lineTo(b+g/2,c+g),a.closePath(),a.stroke()},t=$("<canvas height='"+j+"px'width='"+i+"px' style='display: block'></canvas>").css("position","absolute").appendTo(l),u=function(){t[0].getContext("2d").clearRect(0,0,i,j)},v=function(){if(h){var a=$(".idd-colorPaletteEditor-colorPicker",l);if(a.length>0){var b=$.data(a[0],"onClick");b&&$(window).off("click",b),$(".idd-colorPaletteEditor-colorPicker",l).remove()}h=!1}},w=function(a,b,c){v(),h=!0;var d=60,e=20,f=$("<div></div>").addClass("idd-colorPaletteEditor-colorPicker").css({position:"absolute",left:a-d/2,top:j}).appendTo(l);$("<span>Color:</span>").css("margin-right",10).appendTo(f);var g=$("<input type=color></input>").width(d).height(e).val(r(b)).change(function(){var a=g.val(),b=InteractiveDataDisplay.ColorPalette.colorFromString(a),d=InteractiveDataDisplay.ColorPalette.RGBtoHSL(b);c(d),v()}).appendTo(f),i=function(a){$(a.target).hasClass("idd-colorPaletteEditor-colorPicker")||f.has($(a.target)).length>0||(v(),a.stopPropagation())};$(window).click(i),$.data(f[0],"onClick",i)},x=function(a){var b=t.offset(),c=a.offset().left+a.width()/2-b.left;return(e.range.max-e.range.min)/i*c+e.range.min},y=function(b,h,k,m){var n=i/(e.range.max-e.range.min),r=n*(b.x-e.range.min),y=n*(h-e.range.min),A=n*(k-e.range.min),B=j,C=$("<div style='position:absolute;'></div>").addClass("idd-colorPaletteEditor-marker").width(B).height(B).appendTo(l),D=$("<canvas height='"+B+"px'width='"+B+"px' style='display: block'></canvas>").appendTo(C);if(C.css("left",r-B/2),m){var E=t.offset(),F=!1;C.draggable({axis:"x",containment:[E.left+y-B/2,E.top,E.left+A-B/2,E.top+B],start:function(a){g=!0,F=!1,v(),u();var b=t.offset();$(a.target).draggable("option","containment",[b.left+y-B/2,b.top,b.left+A-B/2,b.top+B])},drag:function(e){var f=a.offset(),g=e.pageY-f.top;if(g<0||g>p){if(!F){var h=D[0].getContext("2d");h.clearRect(0,0,B,B),s(h,0,0,c,d,d),F=!0}}else if(F){var h=D[0].getContext("2d");h.clearRect(0,0,B,B),s(h,0,0,"black",b.leftColor&&q(b.leftColor),b.rightColor&&q(b.rightColor)),F=!1}},stop:function(c){g=!1;var d=a.offset(),h=c.pageY-d.top;if(h<0||h>p){for(var i=0;i<e.points.length;i++)if(e.points[i].x==b.x){e.points.splice(i,1),f(e),o.palette=e;break}}else{var j=x(C);j>e.range.min&&j<e.range.max&&(b.x=j,f(e),o.palette=e)}z()}})}C.click(function(a){w(r,b.rightColor?b.rightColor:b.leftColor,function(a){b.leftColor&&(b.leftColor=a),b.rightColor&&(b.rightColor=a),o.palette=e,f(e),z()}),a.stopPropagation()});var G=D[0].getContext("2d");s(G,0,0,"black",b.leftColor&&q(b.leftColor),b.rightColor&&q(b.rightColor))},z=function(){g=!1,v();var a=$(".idd-colorPaletteEditor-marker",l);if(a.filter(".ui-draggable").each(function(){$(this).draggable("destroy")}),a.remove(),e.points.length>0){var b=e.range.min,c=e.points[1].x;y(e.points[0],b,c,!1)}if(e.points.length>1){var b=e.points[e.points.length-2].x,c=e.range.max;y(e.points[e.points.length-1],b,c,!1)}for(var d=1;d<e.points.length-1;d++){var b=e.points[d-1].x,c=e.points[d+1].x;y(e.points[d],b,c,!0)}},A=function(a){var b=e.points;if(!(b[0].x>=a.x||b[b.length-1].x<=a.x)){for(var c,d=1;d<b.length;d++){if(a.x==b[d].x)return;if(a.x<b[d].x){c=b.slice(),c.splice(d,0,a);break}}e=new InteractiveDataDisplay.ColorPalette(e.isNormalized,e.range,c),o.palette=e,f(e),z()}};t.mousemove(function(a){if(!g&&!h){var b=t.offset(),e=a.pageX-b.left,f=t[0].getContext("2d");f.clearRect(0,0,i,j),s(f,e-j/2,0,c,d,d)}}),t.mouseleave(function(){u()}),t.click(function(a){if(!g&&!h){var b=t.offset(),c=a.pageX-b.left,d=(e.range.max-e.range.min)/i,f=d*c+e.range.min,j=e.getHsla(f);A({x:f,leftColor:j,rightColor:j})}}),z()}},InteractiveDataDisplay.Gestures={},InteractiveDataDisplay.Gestures.FullEventList=["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","touchcancel","gesturestart","gesturechange","gestureend","MSGestureStart","MSGestureChange","MSGestureEnd","MSGestureCancel","MSPointerDown"],InteractiveDataDisplay.Gestures.zoomLevelFactor=1.4,InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin=function(a,b){var c=function(a){for(var b=0,c=0;a;)b+=a.offsetLeft,c+=a.offsetTop,a=a.offsetParent;return{left:b,top:c}},d=c(a[0]);return{x:b.pageX-d.left,y:b.pageY-d.top}},InteractiveDataDisplay.Gestures.PanGesture=function(a,b,c){this.Type="Pan",this.Source=c,this.xOffset=a,this.yOffset=b},InteractiveDataDisplay.Gestures.ZoomGesture=function(a,b,c,d){this.Type="Zoom",this.Source=d,this.xOrigin=a,this.yOrigin=b,this.scaleFactor=c},InteractiveDataDisplay.Gestures.PinGesture=function(a){this.Type="Pin",this.Source=a},InteractiveDataDisplay.Gestures.createPanSubject=function(a){var b=$(document),c=Rx.Observable.fromEvent(a,"mousedown"),d=Rx.Observable.fromEvent(a,"mousemove"),e=Rx.Observable.fromEvent(b,"mouseup"),f=d.skip(1).zip(d,function(a,b){return new InteractiveDataDisplay.Gestures.PanGesture(a.clientX-b.clientX,a.clientY-b.clientY,"Mouse")}),g=e;return c.selectMany(function(a){return f.takeUntil(g)})},InteractiveDataDisplay.Gestures.createPinSubject=function(a){return Rx.Observable.fromEvent(a,"mousedown").select(function(a){return new InteractiveDataDisplay.Gestures.PinGesture("Mouse")})},InteractiveDataDisplay.Gestures.createZoomSubject=function(a){a.unbind("mousewheel"),a.mousewheel(function(b,c){b.preventDefault();var d=jQuery.Event("xbrowserwheel");d.delta=c,d.origin=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(a,b),a.trigger(d)});var b=Rx.Observable.fromEvent(a,"xbrowserwheel"),c=b.zip(b,function(a){return new InteractiveDataDisplay.Gestures.ZoomGesture(a.origin.x,a.origin.y,a.delta>0?1/InteractiveDataDisplay.Gestures.zoomLevelFactor:1*InteractiveDataDisplay.Gestures.zoomLevelFactor,"Mouse")}),d=Rx.Observable.fromEvent(a,"dblclick");d.zip(d,function(b){var c=InteractiveDataDisplay.Gestures.getXBrowserMouseOrigin(a,b);return new InteractiveDataDisplay.Gestures.ZoomGesture(c.x,c.y,1/InteractiveDataDisplay.Gestures.zoomLevelFactor,"Mouse")});return c},InteractiveDataDisplay.Gestures.createTouchPanSubject=function(a){var b=$(document),c=Rx.Observable.fromEvent(a,"touchstart"),d=Rx.Observable.fromEvent(a,"touchmove"),e=Rx.Observable.fromEvent(b,"touchend"),f=Rx.Observable.fromEvent(b,"touchcancel");return c.selectMany(function(a){return d.takeUntil(e.merge(f)).skip(1).zip(d,function(a,b){return{left:a.originalEvent,right:b.originalEvent}}).where(function(a){return 1==a.left.targetTouches.length&&1==a.right.targetTouches.length&&1==a.left.changedTouches.length&&1==a.right.changedTouches.length}).select(function(a){return new InteractiveDataDisplay.Gestures.PanGesture(a.left.targetTouches[0].pageX-a.right.targetTouches[0].pageX,a.left.targetTouches[0].pageY-a.right.targetTouches[0].pageY,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPinSubject=function(a){return Rx.Observable.fromEvent(a,"touchstart").select(function(a){return new InteractiveDataDisplay.Gestures.PinGesture("Touch")})},InteractiveDataDisplay.Gestures.createTouchZoomSubject=function(a){var b=$(document),c=Rx.Observable.fromEvent(a,"touchstart"),d=Rx.Observable.fromEvent(a,"touchmove"),e=Rx.Observable.fromEvent(b,"touchend"),f=Rx.Observable.fromEvent(b,"touchcancel");return c.selectMany(function(a){return d.takeUntil(e.merge(f)).skip(1).zip(d,function(a,b){return{left:a.originalEvent,right:b.originalEvent}}).where(function(a){return 2==a.left.targetTouches.length&&2==a.right.targetTouches.length}).select(function(a){var b=Math.sqrt((a.left.targetTouches[0].pageX-a.left.targetTouches[1].pageX)*(a.left.targetTouches[0].pageX-a.left.targetTouches[1].pageX)+(a.left.targetTouches[0].pageY-a.left.targetTouches[1].pageY)*(a.left.targetTouches[0].pageY-a.left.targetTouches[1].pageY)),c=Math.sqrt((a.right.targetTouches[0].pageX-a.right.targetTouches[1].pageX)*(a.right.targetTouches[0].pageX-a.right.targetTouches[1].pageX)+(a.right.targetTouches[0].pageY-a.right.targetTouches[1].pageY)*(a.right.targetTouches[0].pageY-a.right.targetTouches[1].pageY)),d=b/c,e={x:Math.abs(a.right.targetTouches[1].pageX-a.right.targetTouches[0].pageX),y:Math.abs(a.right.targetTouches[1].pageY-a.right.targetTouches[0].pageY)};return new InteractiveDataDisplay.Gestures.ZoomGesture(e.x,e.y,1/d,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPanSubjectWin8=function(a){var b=Rx.Observable.fromEvent(a,"MSGestureStart"),c=Rx.Observable.fromEvent(a,"MSGestureChange"),d=Rx.Observable.fromEvent($(document),"MSGestureEnd");return b.selectMany(function(a){var b=c.startWith({
originalEvent:{offsetX:a.originalEvent.offsetX,offsetY:a.originalEvent.offsetY}});return b.takeUntil(d).skip(1).zip(b,function(a,b){return{left:a.originalEvent,right:b.originalEvent}}).where(function(a){return a.left.scale===a.right.scale&&a.left.detail!=a.left.MSGESTURE_FLAG_INERTIA&&a.right.detail!=a.right.MSGESTURE_FLAG_INERTIA}).select(function(a){return new InteractiveDataDisplay.Gestures.PanGesture(a.left.offsetX-a.right.offsetX,a.left.offsetY-a.right.offsetY,"Touch")})})},InteractiveDataDisplay.Gestures.createTouchPinSubjectWin8=function(a){return Rx.Observable.fromEvent(a,"MSPointerDown").select(function(a){return new InteractiveDataDisplay.Gestures.PinGesture("Touch")})},InteractiveDataDisplay.Gestures.createTouchZoomSubjectWin8=function(a){var b=Rx.Observable.fromEvent(a,"MSGestureStart"),c=Rx.Observable.fromEvent(a,"MSGestureChange"),d=Rx.Observable.fromEvent(a,"MSGestureEnd");return b.selectMany(function(a){return c.takeUntil(d).where(function(a){return 1!==a.originalEvent.scale&&0!==a.originalEvent.scale&&a.originalEvent.detail!=a.originalEvent.MSGESTURE_FLAG_INERTIA}).select(function(b){return new InteractiveDataDisplay.Gestures.ZoomGesture(a.originalEvent.offsetX,a.originalEvent.offsetY,1/b.originalEvent.scale,"Touch")})})},InteractiveDataDisplay.Gestures.GesturesPool=function(){var a=[];this.addMSGestureSource=function(b){a.forEach(function(a){}),a.push(b),b.addEventListener("MSPointerDown",function(a){if(void 0===b.gesture){var c=new MSGesture;c.target=b,b.gesture=c}b.gesture.addPointer(a.pointerId)},!1)}},InteractiveDataDisplay.Gestures.GesturesPool=new InteractiveDataDisplay.Gestures.GesturesPool,InteractiveDataDisplay.Gestures.getGesturesStream=function(a){var b,c,d;if(window.navigator.msPointerEnabled&&"undefined"!=typeof MSGesture){var e=a[0];InteractiveDataDisplay.Gestures.GesturesPool.addMSGestureSource(e),b=InteractiveDataDisplay.Gestures.createTouchPanSubjectWin8(a);var f=InteractiveDataDisplay.Gestures.createTouchZoomSubjectWin8(a),g=InteractiveDataDisplay.Gestures.createZoomSubject(a);c=f.merge(g),d=InteractiveDataDisplay.Gestures.createTouchPinSubjectWin8(a)}else b=InteractiveDataDisplay.Gestures.createPanSubject(a),c=InteractiveDataDisplay.Gestures.createZoomSubject(a),d=InteractiveDataDisplay.Gestures.createPinSubject(a);var h=d.merge(b.merge(c));return"ontouchstart"in document.documentElement&&(b=InteractiveDataDisplay.Gestures.createTouchPanSubject(a),c=InteractiveDataDisplay.Gestures.createTouchZoomSubject(a),d=InteractiveDataDisplay.Gestures.createTouchPinSubject(a),h=h.merge(d.merge(b.merge(c)))),h},InteractiveDataDisplay.Gestures.applyHorizontalBehavior=function(a){return a.select(function(a){return"Pan"==a.Type?a.yOffset=0:"Zoom"==a.Type&&(a.preventVertical=!0),a})},InteractiveDataDisplay.Gestures.applyVerticalBehavior=function(a){return a.select(function(a){return"Pan"==a.Type?a.xOffset=0:"Zoom"==a.Type&&(a.preventHorizontal=!0),a})},InteractiveDataDisplay=void 0===InteractiveDataDisplay?{}:InteractiveDataDisplay,InteractiveDataDisplay.DataTransform=function(a,b,c,d){this.dataToPlot=a,this.plotToData=b,this.domain=c||{isInDomain:function(a){return!0}},this.type=d};var mercator_maxPhi=85.05112878,mercator_R=mercator_maxPhi/Math.log(Math.tan(mercator_maxPhi*Math.PI/360+Math.PI/4));InteractiveDataDisplay.mercatorTransform=new InteractiveDataDisplay.DataTransform(function(a){return a>=-mercator_maxPhi&&a<=mercator_maxPhi?mercator_R*Math.log(Math.tan(Math.PI*(a+90)/360)):a},function(a){return-mercator_maxPhi<=a&&a<=mercator_maxPhi?360*Math.atan(Math.exp(a/mercator_R))/Math.PI-90:a},void 0,"mercator"),Math.LOGE10=Math.log(10),InteractiveDataDisplay.logTransform=new InteractiveDataDisplay.DataTransform(function(a){return Math.log(a)/Math.LOGE10},function(a){return Math.pow(10,a)},{isInDomain:function(a){return a>1e-8}},"log10"),InteractiveDataDisplay.identityTransform=new InteractiveDataDisplay.DataTransform(function(a){return a},function(a){return a},{isInDomain:function(a){return!0}},"identity"),InteractiveDataDisplay.AnimationBase=function(){var a=void 0,b=this;this.isInAnimation=!1;var c=Rx.Observable.create(function(b){return a=b,function(){}});Object.defineProperty(this,"currentObserver",{get:function(){return a},configurable:!1}),Object.defineProperty(this,"currentObservable",{get:function(){return c},configurable:!1}),this.targetPlotRect=void 0,this.getCurrentPlotRect=function(){},this.stop=function(){b.isInAnimation&&(b.isInAnimation=!1),a&&(a.onNext({plotRect:b.getCurrentPlotRect(),isLast:!0}),a.onCompleted(),a=void 0),this.additionalStopRutines()},this.additionalStopRutines=function(){},this.animate=function(a,b){}},InteractiveDataDisplay.PanZoomAnimation=function(){this.base=InteractiveDataDisplay.AnimationBase,this.base();var a=this,b=void 0,c=void 0,d=void 0,e=new Date,f=void 0,g=void 0,h=void 0,i=0,j=void 0,k=void 0,l=0,m=0;this.getCurrentPlotRect=function(){return f},Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return g},configurable:!1});var n=function(){var b=a.currentObserver;if(b){var g=new Date,j=g.getTime()-e.getTime(),n=k*j,o=d.x-f.x,p=d.y-f.y,q=Math.max(d.width/1e3,Math.sqrt(o*o+p*p)),r=f.x+q*n*h.x,s=f.y+q*n*h.y,t=(d.width-f.width)*n+f.width,u=(d.height-f.height)*n+f.height;e=g,o=r-c.x,p=s-c.y;var v=Math.sqrt(o*o+p*p),w=t-c.width,x=u-c.height;v>=i||Math.abs(w)>Math.abs(l)||Math.abs(x)>Math.abs(m)?(a.isInAnimation=!1,f=d,a.stop()):(f={x:r,y:s,width:t,height:u},a.currentPlotRect=f,b.onNext({plotRect:f,isLast:!1}))}},o=function(){n(),a.isInAnimation&&(j=setTimeout(function(){o()},1e3/60))};this.animate=function(b,e){1.2!=InteractiveDataDisplay.Gestures.zoomLevelFactor&&(InteractiveDataDisplay.Gestures.zoomLevelFactor=1.2),void 0!==j&&(clearTimeout(j),j=void 0),g=e;var n=b();c=void 0===f?n.plotRect:f,d=e,f=c,h={x:d.x-c.x,y:d.y-c.y},i=Math.sqrt(h.x*h.x+h.y*h.y),h=i>1e-10?{x:h.x/i,y:h.y/i}:{x:0,y:0},l=e.width-c.width,m=e.height-c.height,k=0!=l||0!=m?.008:.009,a.isInAnimation=!0,o()},this.additionalStopRutines=function(){void 0!==j&&(clearTimeout(j),j=void 0),a.isInAnimation=!1,b=void 0,c=void 0,startCS=void 0,d=void 0,e=new Date,f=void 0,g=void 0,h=void 0,i=0,startScreenCenter=void 0,previousFrameScreenCenter=void 0,endScreenCenter=void 0,j=void 0,l=0,m=0}},InteractiveDataDisplay.PanZoomAnimation.prototype=new InteractiveDataDisplay.AnimationBase,InteractiveDataDisplay.Utils.getPlotRectForMap=function(a,b){var c=85.05112878,d=void 0===b?{width:a.getWidth(),height:a.getHeight()}:b,e=a.getCenter(),f=d.width,g=d.height,h=30,i=a.tryLocationToPixel({latitude:0,longitude:e.longitude},Microsoft.Maps.PixelReference.control),j=a.tryLocationToPixel({latitude:0,longitude:e.longitude+h},Microsoft.Maps.PixelReference.control),k=j.x-i.x;k<0&&(k=i.x-a.tryLocationToPixel({latitude:0,longitude:e.longitude-h},Microsoft.Maps.PixelReference.control).x);var l=k/h,m=e.longitude-i.x/l,n=e.longitude+(f-i.x)/l,o=a.getBounds(),p=o.getNorth(),q=o.getSouth(),r=0;if(p>=c){p=c;r=a.tryLocationToPixel({latitude:p,longitude:e.longitude},Microsoft.Maps.PixelReference.control).y}var s=0;if(q<=-c){q=-c;s=g-a.tryLocationToPixel({latitude:q,longitude:e.longitude},Microsoft.Maps.PixelReference.control).y}var t=n-m;t<0&&(t=o.width);var u={y:q,x:m,width:t,height:p-q},v=InteractiveDataDisplay.mercatorTransform.dataToPlot(u.y),w=InteractiveDataDisplay.mercatorTransform.dataToPlot(u.y+u.height);if(u.y=v,u.height=w-v,0!=s||0!=r){var x=g-r-s,y=u.height/x,z=s*y,A=r*y,B=u.y-z,C=u.y+u.height+A;u.y=B,u.height=C-B}return u},InteractiveDataDisplay.BingMapsAnimation=function(a){this.base=InteractiveDataDisplay.AnimationBase,this.base();var b=this,c=a,d=void 0,e=void 0,f=new Date,g=void 0,h=void 0,i=void 0,j=0,k=void 0,l=void 0,m=0,n=0,o=!1;Object.defineProperty(this,"previousEstimatedPlotRect",{get:function(){return h},configurable:!1});var p=function(){if(b.currentObserver){var a=new Date,c=a.getTime()-f.getTime(),h=l*c,k=e.x-g.x,m=e.y-g.y,n=Math.max(e.width/1e3,Math.sqrt(k*k+m*m)),o=g.x+n*h*i.x,p=g.y+n*h*i.y,q=(e.width-g.width)*h+g.width,r=(e.height-g.height)*h+g.height;f=a,k=o-d.x,m=p-d.y,Math.sqrt(k*k+m*m)>=j?(b.isInAnimation=!1,u(e),b.stop()):(g={x:o,y:p,width:q,height:r},b.currentPlotRect=g,u(g))}},q=function(){p(),b.isInAnimation&&(k=setTimeout(function(){q()},1e3/60))};this.animate=function(a,c,f){if(1.4!=InteractiveDataDisplay.Gestures.zoomLevelFactor&&(InteractiveDataDisplay.Gestures.zoomLevelFactor=1.4),void 0!==k&&(clearTimeout(k),k=void 0),h=c,b.isInAnimation=!0,f&&f.isFirstFrame&&w(!0),f&&"Pan"==f.gestureType){o=!1;var m=a();d=void 0===g?m.plotRect:g,e=c,g=d,i={x:e.x-d.x,y:e.y-d.y},j=Math.sqrt(i.x*i.x+i.y*i.y),i=j>1e-10?{x:i.x/j,y:i.y/j}:{x:0,y:0},l=.008,q()}else o=!0,u(c)};var r=function(a,b,c){var d=Math.max(1,Math.log(b.width/a.width*360/256)/Math.log(2)),e=InteractiveDataDisplay.mercatorTransform.plotToData(a.y),f=InteractiveDataDisplay.mercatorTransform.plotToData(a.y+a.height),g=Math.max(1,Math.log(b.height/(f-e)*180/256)/Math.log(2));return!0===c&&(d=Math.ceil(d)-1,g=Math.ceil(g)),Math.min(d,g)},s=function(a,b){return{width:360*b.width/(256*Math.pow(2,a)),height:180*b.height/(256*Math.pow(2,a))}};this.setMapView=function(a,b){var d=b;void 0===b&&(d={width:c.getWidth(),height:c.getHeight()});var e=r(a,d,!0),f=(c.getZoom(),{x:a.x+a.width/2,y:InteractiveDataDisplay.mercatorTransform.plotToData(a.y+a.height/2)});c.setView({center:new Microsoft.Maps.Location(f.y,f.x),zoom:e,animate:!1})};var t=0,u=function(a){var d,e=c.getZoom()+t;t=0,d=o?r(a,{width:c.getWidth(),height:c.getHeight()}):e;var f={x:a.x+a.width/2,y:InteractiveDataDisplay.mercatorTransform.plotToData(a.y+a.height/2)};if(o)if(e>1||d>e){var g=Math.round(d),i=s(g,{width:c.getWidth(),height:c.getHeight()});if(a.zoomOrigin)var j={x:a.zoomOrigin.x,y:InteractiveDataDisplay.mercatorTransform.plotToData(a.zoomOrigin.y)},k={x:j.x-f.x,y:j.y-f.y},l={x:i.width/a.width,y:i.height/a.height},m={x:j.x-k.x*l.x,y:j.y-k.y*l.y};else var m=f;c.setView({center:new Microsoft.Maps.Location(m.y,m.x),zoom:d,animate:!0})}else w(),h=b.getCurrentPlotRect(),b.stop();else c.setView({center:new Microsoft.Maps.Location(f.y,f.x),zoom:d,animate:!1})},v=function(){return InteractiveDataDisplay.Utils.getPlotRectForMap(c)};this.getCurrentPlotRect=function(){return v(c.getBounds(),c.getCenter())};var w=function(a){var c=b.currentObserver;if(void 0!==c){var d=b.getCurrentPlotRect(),e={plotRect:d,isLast:!1};void 0!==a&&(e.syncUpdate=a),c.onNext(e)}};Microsoft.Maps.Events.addHandler(c,"viewchange",function(a){w()}),Microsoft.Maps.Events.addHandler(c,"viewchangeend",function(a){h=b.getCurrentPlotRect(),o||!b.isInAnimation?b.stop():w()}),this.additionalStopRutines=function(){void 0!==k&&(clearTimeout(k),k=void 0),b.isInAnimation=!1,d=void 0,e=void 0,h=void 0,f=new Date,g=void 0,i=void 0,j=0,k=void 0,m=0,n=0}},InteractiveDataDisplay.BingMapsAnimation.prototype=new InteractiveDataDisplay.AnimationBase,InteractiveDataDisplay.Event=InteractiveDataDisplay.Event||{},InteractiveDataDisplay.Event.widthScaleChanged=jQuery.Event("widthScaleChanged"),InteractiveDataDisplay.Navigation=function(a,b){var c=a,d=this;c.master.host.on("visibleRectChanged",function(a){var b=c.screenSize.width,d=c.screenSize.width;ct=c.coordinateTransform,vis=ct.getPlotRect({x:0,y:0,width:b,height:d});var e=b/vis.width;c.master.host.trigger(InteractiveDataDisplay.Event.widthScaleChanged,{widthScale:e})});var e=function(){var a=c.screenSize,b=c.coordinateTransform;return{plotRect:b.getPlotRect({x:0,y:0,width:a.width,height:a.height}),screenSize:a,cs:b}},f=function(a,c){b(a,c)},g=void 0,h=void 0,i=void 0,j=void 0;Object.defineProperty(this,"animation",{get:function(){return i},set:function(a){d.stop(),i=a},configurable:!1});var k=InteractiveDataDisplay.NavigationUtils.calcPannedRect,l=InteractiveDataDisplay.NavigationUtils.calcZoomedRect;Object.defineProperty(this,"widthScale",{get:function(){return c.coordinateTransform.getScale().x},set:function(a){d.stop();var b=c.visibleRect,e=c.screenSize.width,f=b.width/b.height,g={x:b.x+.5*b.width,y:b.y+.5*b.height},h=e/a,i=h/f,j={x:g.x-.5*h,y:g.y-.5*i,width:h,height:i};d.setVisibleRect(j,!1,{suppressScaleChangeNotification:!0})},configurable:!1});var m=function(){if(i)return i.currentObservable.subscribe(function(a){a.isLast&&(c.isInAnimation=!1);var b={syncUpdate:a.syncUpdate};f(a.plotRect,b)},function(a){},function(){})};this.setVisibleRect=function(a,b,g){if(d.stop(),j=a,b)d.animation.isInAnimation||m(),c.isInAnimation=!0,d.animation.animate(e,a);else{var h=a;d.animation&&d.animation.constraint&&(h=d.animation.constraint(h)),f(h,g)}};var n=function(a){var b,g,h=c.screenSize,i=void 0!==d.animation?d.animation.previousEstimatedPlotRect:j;if(void 0!==i?(b=InteractiveDataDisplay.Utils.calcCSWithPadding(i,{width:h.width,height:h.height},{left:0,top:0,bottom:0,right:0},c.aspectRatio),g=i):(b=c.coordinateTransform,g=b.getPlotRect({x:0,y:0,width:h.width,height:h.height})),"Pin"==a.Type)return void(d.animation&&d.animation.isInAnimation&&d.stop());var n=void 0;if("Pan"==a.Type?(n=k(g,h,a),j=n):"Zoom"==a.Type&&(n=l(g,b,a),n.width<1e-9&&(n.width=g.width,n.x=g.x),n.height<1e-9&&(n.height=g.height,n.y=g.y),j=n),n)if(d.animation){var o=!d.animation.isInAnimation;o&&m(),c.isInAnimation=!0,d.animation.animate(e,n,{gestureType:a.Type,isFirstFrame:o})}else f(n)};this.stop=function(){c.isInAnimation=!1,j=void 0,d.animation&&d.animation.stop()},Object.defineProperty(this,"gestureSource",{get:function(){return g},set:function(a){g!=a&&(h&&h.dispose(),void 0!==(g=a)&&(h=g.subscribe(function(a){n(a)})))},configurable:!1}),d.animation=new InteractiveDataDisplay.PanZoomAnimation},InteractiveDataDisplay.NavigationUtils={},InteractiveDataDisplay.NavigationUtils.SuppressDefaultMultitouch=function(){if(navigator.userAgent.match(/(iPhone|iPod|iPad)/)&&document.addEventListener("touchmove",function(a){a.preventDefault()},!1),-1!=navigator.userAgent.indexOf("Mac")){document.getElementsByTagName("body")[0].style.overflow="hidden"}},InteractiveDataDisplay.NavigationUtils.calcPannedRect=function(a,b,c){var d={x:a.width/b.width,y:a.height/b.height},e=c.xOffset*d.x,f=-c.yOffset*d.y;return{x:a.x-e,y:a.y-f,width:a.width,height:a.height}},InteractiveDataDisplay.NavigationUtils.calcZoomedRect=function(a,b,c){var d=b.getScale(),e=b.plotToScreenX(a.x+a.width/2),f=b.plotToScreenY(a.y+a.height/2),g=c.preventHorizontal?0:c.xOrigin-e,h=c.preventVertical?0:c.yOrigin-f,i={x:a.x+g/d.x,y:a.y-h/d.y,width:a.width,height:a.height},j=a.width*(c.preventHorizontal?1:c.scaleFactor),k=a.height*(c.preventVertical?1:c.scaleFactor),l=i.x+i.width/2-j/2,m=i.y+i.height/2-k/2;return{x:l-c.scaleFactor*g/d.x,y:m+c.scaleFactor*h/d.y,width:j,height:k,zoomOrigin:{x:b.screenToPlotX(c.xOrigin),y:b.screenToPlotY(c.yOrigin)}}},InteractiveDataDisplay.SharedRenderWorker=function(a,b){var c=!!window.Worker;!c&&window.console&&console.log("Web workers are not available");var d=null;try{d=c?new Worker(a):null}catch(i){console.error("Error creating Web worker from "+a+": "+i.message)}var e=!1,f=[],g=function(a,b){for(var c=f.length,d=0;d<c;d++)if(f[d].source==a)return f[d];if(!b){var e={source:a,pendingTask:void 0,index:c};return f.push(e),e}},h=function(a){var b=f.length,c=0;if(a){c=a.index;for(var d=c+1;d<b;d++)if(f[d].pendingTask)return f[d];for(var d=0;d<c;d++)if(f[d].pendingTask)return f[d];if(f[c].pendingTask)return f[c]}else for(var d=0;d<b;d++)if(f[d].pendingTask)return f[d]};d&&(d.onmessage=function(a){var c=a.data,g=f[c.sourceIndex],i=h(g);i?(e=!0,d.postMessage(i.pendingTask),i.pendingTask=void 0):e=!1,b&&b(g.source,c)},d.onerror=function(a){var b=a.message+" ("+a.filename+":"+a.lineno+")";"object"==typeof console&&console.log(b)}),this.enqueue=function(a,b){var c=g(b);a.sourceIndex=c.index,e?c.pendingTask=a:(e=!0,c.pendingTask=void 0,d.postMessage(a))},this.cancelPending=function(a){var b=g(a,!0);b&&(b.pendingTask=void 0)},c||(this.enqueue=function(a,b){},this.cancelPending=function(a){})},
InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64="SW50ZXJhY3RpdmVEYXRhRGlzcGxheSA9IHR5cGVvZiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5ID09ICd1bmRlZmluZWQnID8ge30gOiBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5Ow0KIA0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtID0gZnVuY3Rpb24gKGRhdGFUb1Bsb3QsIHBsb3RUb0RhdGEsIGRvbWFpbiwgdHlwZSkgew0KICAgIHRoaXMuZGF0YVRvUGxvdCA9IGRhdGFUb1Bsb3Q7DQogICAgdGhpcy5wbG90VG9EYXRhID0gcGxvdFRvRGF0YTsNCg0KICAgIHRoaXMuZG9tYWluID0gZG9tYWluIHx8IHsNCiAgICAgICAgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHZhbHVlKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICB0aGlzLnR5cGUgPSB0eXBlOw0KfTsNCg0KdmFyIG1lcmNhdG9yX21heFBoaSA9IDg1LjA1MTEyODc4OyAvLzg3LjExNDc1NzYzNjMzODQ7IC8vIGRlZw0KdmFyIG1lcmNhdG9yX1IgPSBtZXJjYXRvcl9tYXhQaGkgLyBNYXRoLmxvZyhNYXRoLnRhbihtZXJjYXRvcl9tYXhQaGkgKiBNYXRoLlBJIC8gMzYwLjAgKyBNYXRoLlBJIC8gNCkpOw0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5tZXJjYXRvclRyYW5zZm9ybSA9IG5ldyBJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LkRhdGFUcmFuc2Zvcm0oDQogICAgZnVuY3Rpb24gKHBoaV9kZWcpIHsNCiAgICAgICAgaWYgKHBoaV9kZWcgPj0gLW1lcmNhdG9yX21heFBoaSAmJiBwaGlfZGVnIDw9IG1lcmNhdG9yX21heFBoaSkNCiAgICAgICAgICAgIHJldHVybiBtZXJjYXRvcl9SICogTWF0aC5sb2coTWF0aC50YW4oTWF0aC5QSSAqIChwaGlfZGVnICsgOTApIC8gMzYwKSk7DQogICAgICAgIGVsc2UgcmV0dXJuIHBoaV9kZWc7DQogICAgfSwNCiAgICBmdW5jdGlvbiAoeSkgew0KICAgICAgICBpZiAoLW1lcmNhdG9yX21heFBoaSA8PSB5ICYmIHkgPD0gbWVyY2F0b3JfbWF4UGhpKSB7DQogICAgICAgICAgICByZXR1cm4gMzYwICogTWF0aC5hdGFuKE1hdGguZXhwKHkgLyBtZXJjYXRvcl9SKSkgLyBNYXRoLlBJIC0gOTA7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHk7DQogICAgfSwNCiAgICB1bmRlZmluZWQsDQogICAgIm1lcmNhdG9yIg0KKTsNCg0KDQpNYXRoLkxPR0UxMCA9IE1hdGgubG9nKDEwKTsNCg0KSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5sb2dUcmFuc2Zvcm0gPSBuZXcgSW50ZXJhY3RpdmVEYXRhRGlzcGxheS5EYXRhVHJhbnNmb3JtKA0KICAgIGZ1bmN0aW9uICh4X2QpIHsNCiAgICAgICAgcmV0dXJuIE1hdGgubG9nKHhfZCkgLyBNYXRoLkxPR0UxMDsNCiAgICB9LA0KICAgIGZ1bmN0aW9uICh4X3ApIHsNCiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLCB4X3ApOw0KICAgIH0sDQogICAgeyBpc0luRG9tYWluOiBmdW5jdGlvbiAoeCkgeyByZXR1cm4geCA+IDAuMDAwMDAwMDE7IH0gfSwNCiAgICAibG9nMTAiDQopOw0KDQpJbnRlcmFjdGl2ZURhdGFEaXNwbGF5LmlkZW50aXR5VHJhbnNmb3JtID0gbmV3IEludGVyYWN0aXZlRGF0YURpc3BsYXkuRGF0YVRyYW5zZm9ybSgNCiAgICBmdW5jdGlvbiAoeF9kKSB7IHJldHVybiB4X2Q7IH0sDQogICAgZnVuY3Rpb24gKHhfcCkgeyByZXR1cm4geF9wOyB9LA0KICAgIHsgaXNJbkRvbWFpbjogZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHRydWUgfSB9LA0KICAgICJpZGVudGl0eSINCik7O3NlbGYub25tZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgdmFyIHhzY2FsZSA9IGV2ZW50LmRhdGEuc2NhbGVYLCB4b2Zmc2V0ID0gZXZlbnQuZGF0YS5vZmZzZXRYLCB5c2NhbGUgPSBldmVudC5kYXRhLnNjYWxlWSwgeW9mZnNldCA9IGV2ZW50LmRhdGEub2Zmc2V0WTsNCiAgICB2YXIgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWTsNCiAgICB2YXIgaGFzZHRYLCBoYXNkdFk7DQoNCiAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEueERhdGFUcmFuc2Zvcm0gPT0gJ3N0cmluZycpIHsNCiAgICAgICAgdmFyIGR0ID0gZ2V0RGF0YVRyYW5zZm9ybShldmVudC5kYXRhLnhEYXRhVHJhbnNmb3JtKTsNCiAgICAgICAgdmFyIGYgPSBkdC5kYXRhVG9QbG90Ow0KICAgICAgICBoYXNkdFggPSB0cnVlOw0KICAgICAgICBkYXRhVG9TY3JlZW5YID0gZnVuY3Rpb24gKHgpIHsNCiAgICAgICAgICAgIHJldHVybiBmKHgpICogeHNjYWxlICsgeG9mZnNldDsNCiAgICAgICAgfTsNCiAgICB9IGVsc2Ugew0KICAgICAgICBoYXNkdFggPSBmYWxzZTsNCiAgICAgICAgZGF0YVRvU2NyZWVuWCA9IGZ1bmN0aW9uICh4KSB7DQogICAgICAgICAgICByZXR1cm4geHNjYWxlICogeCArIHhvZmZzZXQ7DQogICAgICAgIH07DQogICAgfQ0KICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YS55RGF0YVRyYW5zZm9ybSA9PSAnc3RyaW5nJykgew0KICAgICAgICB2YXIgZHQgPSBnZXREYXRhVHJhbnNmb3JtKGV2ZW50LmRhdGEueURhdGFUcmFuc2Zvcm0pOw0KICAgICAgICB2YXIgZiA9IGR0LmRhdGFUb1Bsb3Q7DQogICAgICAgIGhhc2R0WSA9IHRydWU7DQogICAgICAgIGRhdGFUb1NjcmVlblkgPSBmdW5jdGlvbiAoeSkgew0KICAgICAgICAgICAgcmV0dXJuIHlvZmZzZXQgLSBmKHkpICogeXNjYWxlOw0KICAgICAgICB9Ow0KICAgIH0gZWxzZSB7DQogICAgICAgIGhhc2R0WSA9IGZhbHNlOw0KICAgICAgICBkYXRhVG9TY3JlZW5ZID0gZnVuY3Rpb24gKHkpIHsNCiAgICAgICAgICAgIHJldHVybiB5b2Zmc2V0IC0geSAqIHlzY2FsZTsNCiAgICAgICAgfTsNCiAgICB9DQoNCiAgICB2YXIgd2lkdGggPSBldmVudC5kYXRhLndpZHRoOw0KICAgIHZhciBoZWlnaHQgPSBldmVudC5kYXRhLmhlaWdodDsNCg0KICAgIGlmIChldmVudC5kYXRhLngubGVuZ3RoICE9IGV2ZW50LmRhdGEuZi5sZW5ndGgpIHsNCiAgICAgICAgcmVuZGVyTWF0cml4KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIGRhdGFUb1NjcmVlblksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9IGVsc2Ugew0KICAgICAgICB2YXIgc2NyZWVuVG9EYXRhWCwgc2NyZWVuVG9EYXRhWTsNCiAgICAgICAgeHNjYWxlX3IgPSAxIC8geHNjYWxlOw0KICAgICAgICB5c2NhbGVfciA9IDEgLyB5c2NhbGU7DQogICAgICAgIGlmIChoYXNkdFgpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVggPSBmdW5jdGlvbiAoeHMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeHMgLSB4b2Zmc2V0KSAqIHhzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFYID0gZnVuY3Rpb24gKHhzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh4cyAtIHhvZmZzZXQpICogeHNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIGlmIChoYXNkdFkpIHsNCiAgICAgICAgICAgIHZhciBwbG90VG9EYXRhID0gZHQucGxvdFRvRGF0YTsNCiAgICAgICAgICAgIHNjcmVlblRvRGF0YVkgPSBmdW5jdGlvbiAoeXMpIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gcGxvdFRvRGF0YSgoeW9mZnNldCAtIHlzKSAqIHlzY2FsZV9yKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzY3JlZW5Ub0RhdGFZID0gZnVuY3Rpb24gKHlzKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICh5b2Zmc2V0IC0geXMpICogeXNjYWxlX3I7DQogICAgICAgICAgICB9Ow0KICAgICAgICB9DQogICAgICAgIHJlbmRlckdyYWRpZW50KGV2ZW50LmRhdGEuaW1hZ2UsIHdpZHRoLCBoZWlnaHQsIGV2ZW50LmRhdGEueCwgZXZlbnQuZGF0YS55LCBldmVudC5kYXRhLmYsIGV2ZW50LmRhdGEuZm1pbiwgZXZlbnQuZGF0YS5mbWF4LCBldmVudC5kYXRhLnBhbGV0dGUsIGV2ZW50LmRhdGEucGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc2R0WCwgaGFzZHRZKTsNCiAgICB9DQogICAgZXZlbnQuZGF0YS54ID0gdW5kZWZpbmVkOw0KICAgIGV2ZW50LmRhdGEueSA9IHVuZGVmaW5lZDsNCiAgICBldmVudC5kYXRhLmYgPSB1bmRlZmluZWQ7DQogICAgZXZlbnQuZGF0YS5wYWxldHRlID0gdW5kZWZpbmVkOw0KICAgIHNlbGYucG9zdE1lc3NhZ2UoZXZlbnQuZGF0YSk7DQp9Ow0KDQp2YXIgZ2V0RGF0YVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0eXBlKSB7DQogICAgaWYgKHR5cGUgPT0gJ21lcmNhdG9yJykNCiAgICAgICAgcmV0dXJuIEludGVyYWN0aXZlRGF0YURpc3BsYXkubWVyY2F0b3JUcmFuc2Zvcm07DQogICAgdGhyb3cgJ1Vua25vd24gZGF0YSB0cmFuc2Zvcm0nOw0KfTsNCg0KDQp2YXIgcmVuZGVyTWF0cml4ID0gZnVuY3Rpb24gKGltYWdlLCB3aWR0aCwgaGVpZ2h0LCB4LCB5LCBmLCBmbWluLCBmbWF4LCBwYWxldHRlLCBwbG90UmVjdCwgZGF0YVRvU2NyZWVuWCwgZGF0YVRvU2NyZWVuWSwgaGFzRGF0YVRyYW5zZm9ybVgsIGhhc0RhdGFUcmFuc2Zvcm1ZKSB7DQogICAgdmFyIG4gPSB4Lmxlbmd0aDsNCiAgICB2YXIgbSA9IHkubGVuZ3RoOw0KICAgIHZhciBpbWFnZURhdGEgPSBpbWFnZS5kYXRhOw0KICAgIHZhciB3ID0gd2lkdGg7DQogICAgdmFyIGggPSBoZWlnaHQ7DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICBmb3IgKHZhciBpID0gaTA7IGkgPCBuICYmIGNlbGxSaWdodF9zIDwgdzsgaSsrKSB7DQogICAgICAgIC8vIGkwIGlzIHRoZSByaWdodCB2aXNpYmxlIGVkZ2Ugb2YgdGhlIGNlbGwNCiAgICAgICAgeDAgPSB4W2kgLSAxXTsNCiAgICAgICAgdmFyIHgxID0geFtpXTsNCg0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KDQogICAgICAgIGNlbGxSaWdodF9zID0gTWF0aC5jZWlsKGRhdGFUb1NjcmVlblgoeDEpKTsNCiAgICAgICAgaWYgKGNlbGxMZWZ0X3MgPCAwKSBjZWxsTGVmdF9zID0gMDsNCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGNlbGxSaWdodF9zID0gdzsNCg0KICAgICAgICAvL2lmIChpID09IG4gLSAxKSBjZWxsUmlnaHRfcysrOw0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MgLSBjZWxsTGVmdF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgIHkwID0geVtqMCAtIDFdOw0KICAgICAgICB2YXIgY2VsbEJvdHRvbV9zID0gMCwNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3JbajAgLSAxXTsNCiAgICAgICAgZm9yICh2YXIgaiA9IGowOyBqIDwgbSAmJiBjZWxsQm90dG9tX3MgPj0gMDsgaisrKSB7DQogICAgICAgICAgICB5MCA9IHlbaiAtIDFdOw0KICAgICAgICAgICAgdmFyIHkxID0geVtqXTsNCg0KICAgICAgICAgICAgaWYgKHkwICE9IHkwIHx8IHkxICE9IHkxKSB7DQogICAgICAgICAgICAgICAgY2VsbFRvcF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zKQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IGNlbGxUb3BfczsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICBjZWxsQm90dG9tX3MgPSB5c2NyW2ogLSAxXTsNCiAgICAgICAgICAgIGNlbGxUb3BfcyA9IHlzY3Jbal07DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDwgMCkgY2VsbFRvcF9zID0gLTE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zID49IGgpIGNlbGxCb3R0b21fcyA9IGggLSAxOw0KDQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIC0gY2VsbEJvdHRvbV9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICB2YXIgX2YgPSBmW2kgLSAxXVtqIC0gMV07DQogICAgICAgICAgICBpZiAoX2YgIT0gX2YpIGNvbnRpbnVlOw0KICAgICAgICAgICAgdmFyIHBhbGV0dGVWYWwgPSBwYWxldHRlSyAqIChfZiAtIGZtaW4pOw0KICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgIGlmIChrIDwgMCkgayA9IDA7DQogICAgICAgICAgICBlbHNlIGlmIChrID4gY29sTikgayA9IGNvbE47DQogICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbCB3aXRoIHNhbWUgY29sb3INCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgeHMgPSBjZWxsTGVmdF9zOyB4cyA8IGNlbGxSaWdodF9zOyB4cysrKSB7DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAxXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAyXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2sgKyAzXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoY2VsbFRvcF9zIDw9IDApIGJyZWFrOw0KICAgICAgICB9DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBicmVhazsNCiAgICB9DQp9Ow0KDQoNCnZhciByZW5kZXJHcmFkaWVudCA9IGZ1bmN0aW9uIChpbWFnZSwgd2lkdGgsIGhlaWdodCwgeCwgeSwgZiwgZm1pbiwgZm1heCwgcGFsZXR0ZSwgcGxvdFJlY3QsIGRhdGFUb1NjcmVlblgsIHNjcmVlblRvRGF0YVgsIGRhdGFUb1NjcmVlblksIHNjcmVlblRvRGF0YVksIGhhc0RhdGFUcmFuc2Zvcm1YLCBoYXNEYXRhVHJhbnNmb3JtWSkgew0KICAgIHZhciBuID0geC5sZW5ndGg7DQogICAgdmFyIG0gPSB5Lmxlbmd0aDsNCiAgICB2YXIgaW1hZ2VEYXRhID0gaW1hZ2UuZGF0YTsNCiAgICB2YXIgdyA9IHdpZHRoOw0KICAgIHZhciBoID0gaGVpZ2h0Ow0KDQogICAgLy8gcHJlY29tcHV0aW5nIHkgaW4gc2NyZWVuIGNvb3JkaW5hdGVzOg0KICAgIHZhciB5c2NyID0gbmV3IEZsb2F0MzJBcnJheShtKTsNCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG07IGkrKykNCiAgICAgICAgeXNjcltpXSA9IGRhdGFUb1NjcmVlblkoeVtpXSkgfCAwOyAvLyBmbG9vcjsNCg0KICAgIC8vIHByZXBhcmluZyBzY3JlZW4gdG8gZGF0YSBtYXBwaW5nDQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVggPSBuZXcgRmxvYXQzMkFycmF5KHcpOw0KICAgIGZvciAodmFyIHhzID0gMDsgeHMgPCB3OyB4cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVhbeHNdID0gc2NyZWVuVG9EYXRhWCh4cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQogICAgdmFyIG1hcFNjcmVlblRvRGF0YVkgPSBuZXcgRmxvYXQzMkFycmF5KGgpOw0KICAgIGZvciAodmFyIHlzID0gMDsgeXMgPCBoOyB5cysrKSB7DQogICAgICAgIG1hcFNjcmVlblRvRGF0YVlbeXNdID0gc2NyZWVuVG9EYXRhWSh5cyArIDAuNSk7IC8vIHRvZG86IG1ha2UgaW5saW5lIHRyYW5zZm9ybSBmb3IgbGluZWFyIGNhc2UNCiAgICB9DQoNCiAgICB2YXIgaTAsIGowOw0KICAgIHZhciB4MCwgeTA7IC8vIGluIGRhdGEgc3BhY2UNCg0KICAgIC8vIHN0YXJ0IGNlbGwNCiAgICB2YXIgbGVmdHAgPSBwbG90UmVjdC54Ow0KICAgIHZhciByaWdodHAgPSBsZWZ0cCArIHBsb3RSZWN0LndpZHRoOw0KICAgIGlmIChoYXNEYXRhVHJhbnNmb3JtWCkgew0KICAgICAgICBmb3IgKGkwID0gMDsgaTAgPCBuOyBpMCsrKSB7DQogICAgICAgICAgICBpZiAoZGF0YVRvU2NyZWVuWCh4W2kwXSkgPj0gMCkgew0KICAgICAgICAgICAgICAgIGlmIChpMCA9PSAwKSBpMCsrOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgICAgZm9yIChpMCA9IDA7IGkwIDwgbjsgaTArKykgew0KICAgICAgICAgICAgaWYgKHhbaTBdID49IGxlZnRwKSB7DQogICAgICAgICAgICAgICAgaWYgKGkwID09IDApIGkwKys7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGkwID09IG4pIHJldHVybjsNCg0KICAgIHZhciBib3R0b21wID0gcGxvdFJlY3QueTsNCiAgICB2YXIgdG9wcCA9IGJvdHRvbXAgKyBwbG90UmVjdC5oZWlnaHQ7DQogICAgZm9yIChqMCA9IDA7IGowIDwgbTsgajArKykgew0KICAgICAgICBpZiAoeXNjcltqMF0gPCBoKSB7DQogICAgICAgICAgICBpZiAoajAgPT0gMCkgajArKzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChqMCA9PSBtKSByZXR1cm47DQoNCiAgICAvLyByZW5kZXJpbmcgZnJvbSBsZWZ0IHRvIHJpZ2h0LCBib3R0b20gdG8gdG9wDQogICAgdmFyIGNlbGxMZWZ0X3MgPSAwLCBjZWxsUmlnaHRfcyA9IDA7DQoNCiAgICB2YXIgaXNOb3JtYWxpemVkID0gcGFsZXR0ZS5pc05vcm1hbGl6ZWQ7DQogICAgdmFyIGNvbG9ycyA9IHBhbGV0dGUuY29sb3JzOw0KICAgIHZhciBjb2xOID0gKGNvbG9ycy5sZW5ndGggPj4gMikgLSAxOw0KICAgIGlmICghaXNOb3JtYWxpemVkKSB7DQogICAgICAgIGZtYXggPSBwYWxldHRlLnJhbmdlLm1heDsNCiAgICAgICAgZm1pbiA9IHBhbGV0dGUucmFuZ2UubWluOw0KICAgIH0NCiAgICB2YXIgcGFsZXR0ZUsgPSBmbWF4ICE9PSBmbWluID8gMS4wIC8gKGZtYXggLSBmbWluKSA6IDA7DQoNCiAgICB2YXIgZmxiLCBmbHQsIGZydCwgZnJiOw0KICAgIHZhciBmaSwgZmkxOw0KDQogICAgLy8gcmVuZGVyaW5nIHRoZSBpbWFnZQ0KICAgIGZvciAodmFyIGkgPSBpMDsgaSA8IG4gJiYgY2VsbFJpZ2h0X3MgPCB3OyBpKyspIHsNCiAgICAgICAgLy8gaTAgaXMgdGhlIHJpZ2h0IHZpc2libGUgZWRnZSBvZiB0aGUgY2VsbA0KICAgICAgICB4MCA9IHhbaSAtIDFdOw0KICAgICAgICB2YXIgeDEgPSB4W2ldOw0KICAgICAgICBpZiAoeDAgIT0geDAgfHwgeDEgIT0geDEpIHsgLy8gYSAhPSBhICBlcXVpdi4gaXNOYU4oYSkNCiAgICAgICAgICAgIGNlbGxSaWdodF9zID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoY2VsbFJpZ2h0X3MpDQogICAgICAgICAgICBjZWxsTGVmdF9zID0gY2VsbFJpZ2h0X3M7DQogICAgICAgIGVsc2UNCiAgICAgICAgICAgIGNlbGxMZWZ0X3MgPSBNYXRoLmNlaWwoZGF0YVRvU2NyZWVuWCh4MCkpOw0KICAgICAgICBjZWxsUmlnaHRfcyA9IE1hdGguY2VpbChkYXRhVG9TY3JlZW5YKHgxKSk7DQogICAgICAgIGlmIChjZWxsTGVmdF9zIDwgMCkgY2VsbExlZnRfcyA9IDA7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyA+PSB3KSBjZWxsUmlnaHRfcyA9IHc7DQogICAgICAgIGlmIChjZWxsUmlnaHRfcyAtIGNlbGxMZWZ0X3MgPT0gMCkgY29udGludWU7DQoNCiAgICAgICAgdmFyIGNlbGxCb3R0b21fcyA9IDAsIGNlbGxUb3BfcyA9IDA7DQogICAgICAgIGZpID0gZltpXTsNCiAgICAgICAgZmkxID0gZltpIC0gMV07DQogICAgICAgIGZvciAodmFyIGogPSBqMDsgaiA8IG0gJiYgY2VsbEJvdHRvbV9zID49IDA7IGorKykgew0KICAgICAgICAgICAgeTAgPSB5W2ogLSAxXTsNCiAgICAgICAgICAgIHZhciB5MSA9IHlbal07DQogICAgICAgICAgICBpZiAoeTAgIT0geTAgfHwgeTEgIT0geTEpIHsNCiAgICAgICAgICAgICAgICBjZWxsVG9wX3MgPSB1bmRlZmluZWQ7DQogICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MpDQogICAgICAgICAgICAgICAgY2VsbEJvdHRvbV9zID0gY2VsbFRvcF9zOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICAgIGNlbGxCb3R0b21fcyA9IHlzY3JbaiAtIDFdOw0KICAgICAgICAgICAgY2VsbFRvcF9zID0geXNjcltqXTsNCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPCAwKSBjZWxsVG9wX3MgPSAtMTsNCiAgICAgICAgICAgIGlmIChjZWxsQm90dG9tX3MgPj0gaCkgY2VsbEJvdHRvbV9zID0gaCAtIDE7DQogICAgICAgICAgICBpZiAoY2VsbEJvdHRvbV9zIC0gY2VsbFRvcF9zID09IDApIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAvLyBmaWxscyB0aGUgY2VsbA0KICAgICAgICAgICAgZmx0ID0gZmkxW2pdOw0KICAgICAgICAgICAgZmxiID0gZmkxW2ogLSAxXTsNCiAgICAgICAgICAgIGZydCA9IGZpW2pdOw0KICAgICAgICAgICAgZnJiID0gZmlbaiAtIDFdOw0KDQogICAgICAgICAgICBpZiAoZmx0ICE9IGZsdCB8fCBmbGIgIT0gZmxiIHx8IGZydCAhPSBmcnQgfHwgZnJiICE9IGZyYikNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCg0KICAgICAgICAgICAgdmFyIGt5TGVmdCA9IChmbHQgLSBmbGIpIC8gKHkxIC0geTApOw0KICAgICAgICAgICAgdmFyIGt5UmlnaHQgPSAoZnJ0IC0gZnJiKSAvICh5MSAtIHkwKTsNCiAgICAgICAgICAgIGZvciAodmFyIHlzID0gY2VsbFRvcF9zICsgMTsgeXMgPD0gY2VsbEJvdHRvbV9zOyB5cysrKSB7DQogICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gKHcgKiB5cyArIGNlbGxMZWZ0X3MpIDw8IDI7DQogICAgICAgICAgICAgICAgdmFyIF95ID0gbWFwU2NyZWVuVG9EYXRhWVt5c107DQogICAgICAgICAgICAgICAgdmFyIGZsZWZ0ID0ga3lMZWZ0ICogKF95IC0geTApICsgZmxiOw0KICAgICAgICAgICAgICAgIHZhciBmcmlnaHQgPSBreVJpZ2h0ICogKF95IC0geTApICsgZnJiOw0KICAgICAgICAgICAgICAgIHZhciBreCA9IChmcmlnaHQgLSBmbGVmdCkgLyAoeDEgLSB4MCk7DQoNCiAgICAgICAgICAgICAgICBmb3IgKHZhciB4cyA9IGNlbGxMZWZ0X3M7IHhzIDwgY2VsbFJpZ2h0X3M7IHhzKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIF94ID0gbWFwU2NyZWVuVG9EYXRhWFt4c107DQogICAgICAgICAgICAgICAgICAgIHZhciBfZiA9IGt4ICogKF94IC0geDApICsgZmxlZnQ7DQogICAgICAgICAgICAgICAgICAgIHZhciBwYWxldHRlVmFsID0gcGFsZXR0ZUsgKiAoX2YgLSBmbWluKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSAocGFsZXR0ZVZhbCAqIGNvbE4pIHwgMDsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGsgPCAwKSBrID0gMDsNCiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoayA+IGNvbE4pIGsgPSBjb2xOOw0KICAgICAgICAgICAgICAgICAgICBrID0gayA8PCAyOw0KDQogICAgICAgICAgICAgICAgICAgIC8vdmFyIGNvbG9yID0gZ2V0Q29sb3IocGFsZXR0ZVZhbCk7DQogICAgICAgICAgICAgICAgICAgIC8vaWYgKHhzID09IGNlbGxMZWZ0X3MgfHwgeHMgPT0gY2VsbFJpZ2h0X3MgLSAxIHx8ICAvKiB1bmNvbW1lbnQgdG8gZHJhdyB0aGUgYm9yZGVyIG9mIGNlbGxzICovDQogICAgICAgICAgICAgICAgICAgIC8vICAgIHlzID09IGNlbGxUb3BfcyArIDEgfHwgeXMgPT0gY2VsbEJvdHRvbV9zKQ0KICAgICAgICAgICAgICAgICAgICAvLyAgICBjb2xvciA9IHsgYTogMSwgcjogMCwgZzogMCwgYjogMjU1IH07DQoNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2srK107DQogICAgICAgICAgICAgICAgICAgIGltYWdlRGF0YVtpbmRleCsrXSA9IGNvbG9yc1trKytdOw0KICAgICAgICAgICAgICAgICAgICBpbWFnZURhdGFbaW5kZXgrK10gPSBjb2xvcnNbaysrXTsNCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VEYXRhW2luZGV4KytdID0gY29sb3JzW2tdOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjZWxsVG9wX3MgPD0gMCkgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgaWYgKGNlbGxSaWdodF9zID49IHcpIGJyZWFrOw0KICAgIH0NCn07DQo=",InteractiveDataDisplay.Figure=function(a,b){if(void 0!==b)throw"Figure cannot be a dependent plot";if(a){var c;a&&(c=$("<div data-idd-plot='plot' data-idd-placement='center'></div>"),c.css("z-index",InteractiveDataDisplay.ZIndexNavigationLayer).css("background-color","rgba(0,0,0,0)"));var d=a.children().toArray();c.appendTo(a),this.base=InteractiveDataDisplay.Plot,this.base(a,b,c);var e=this;c.dblclick(function(){e.master.fitToView()});var f=function(a){var b=a.css("position");return"static"==b?a.css("position","relative"):"inherit"==b&&a.css("position","relative"),void 0!==b&&""!=b||a.css("position","relative"),"relative"==a.css("position")},g=[],h=[],i=[],j=[],k=[],l=function(a,b){if(a.attr("data-idd-axis")){var c=InteractiveDataDisplay.InitializeAxis(a,b);a.axis=c,a.dblclick(function(){"bottom"==placement||"top"==placement?e.master.fitToViewX():e.master.fitToViewY()})}},m=function(a,b,c){var d=$("<div></div>");d.appendTo(e.host).addClass("idd-figure-container"),d.content=a,a.appendTo(d);var f=a.attr("data-idd-placement"),l=function(a){if(c){var b=q(c,a);a.splice(b.index,0,d)}else a.push(d)};"left"==f?l(g):"bottom"==f?l(h):"center"==f?l(i):"right"==f?l(k):"top"==f&&l(j),f&&d.attr("data-idd-placement",f)};this.getAxes=function(a){if(a){var b;if("top"==a?b=jQuery.grep(j,function(b){if(b.content&&b.content.axis&&b.content.axis.mode==a)return b.content.axis}):"bottom"==a?b=jQuery.grep(h,function(b){if(b.content&&b.content.axis&&b.content.axis.mode==a)return b.content.axis}):"left"==a?b=jQuery.grep(g,function(b){if(b.content&&b.content.axis&&b.content.axis.mode==a)return b.content.axis}):"right"==a&&(b=jQuery.grep(k,function(b){if(b.content&&b.content.axis&&b.content.axis.mode==a)return b.content.axis})),b&&b.length>0){for(var c=0;c<b.length;c++)b[c]=b[c].content.axis;return b}}else{var d=g.concat(h).concat(k).concat(j),b=jQuery.grep(d,function(a){if(a.content&&a.content.axis)return a.content.axis});if(b&&b.length>0){for(var c=0;c<b.length;c++)b[c]=b[c].content.axis;return b}}},this.get=function(a){var b=InteractiveDataDisplay.Figure.prototype.get.call(this,a);{if(b)return b;var c=this.getAxes();if(c)for(var d=0;d<c.length;d++)if(c[d].host[0].id==a||c[d].host[0]==a)return c[d]}},d.forEach(function(a){var b=$(a);f(b)&&(m(b),l(b))});var n=function(a,b,c,d,g){var h=$(a);if(!h.is("div"))throw"Only DIVs can be added to figure!";if(void 0!==b){if("top"!=b&&"bottom"!=b&&"center"!=b&&"left"!=b&&"right"!=b)throw"Placement is incorrect!";h.attr("data-idd-placement",b)}return f(h)&&void 0!==h.attr("data-idd-placement")?m(h,c,g):g?h.insertBefore(g):h.appendTo(e.host),void 0!==d&&d||e.requestUpdateLayout(),h};this.addDiv=function(a,b){return n(a,b)[0]};var o=function(a){var b=[],c=[];return a.forEach(function(a){0==a.children().toArray().length?b.push(a):c.push(a)}),b.forEach(function(a){a.remove()}),c},p=function(a,b){var c=jQuery.grep(b,function(b){return b==a});return c&&c.length>0},q=function(a,b){for(var c=0;c<b.length;c++)if(b[c].content[0]==a)return{pack:a,index:c};throw"Pack not found"},r=function(a,b){var c=jQuery.grep(b,function(b){return b.content[0]==a});return c&&c.length>0};this.removeDiv=function(a){if(void 0===a)throw"Unable to remove undefined object!";var b=this.host.children().toArray();if(!(p(a,b)||r(a,g)||r(a,h)||r(a,i)||r(a,k)||r(a,j)))throw"Specified div doesn't belong to figure!";var c=$(a);c.remove(),c.attr("data-idd-placement")&&("left"==c.attr("data-idd-placement")?g=o(g):"bottom"==c.attr("data-idd-placement")?h=o(h):"center"==c.attr("data-idd-placement")?i=o(i):"right"==c.attr("data-idd-placement")?k=o(k):"top"==c.attr("data-idd-placement")&&(j=o(j))),e.requestUpdateLayout()},this.addAxis=function(a,b,c,d){var e=void 0===b?"numeric":b,f=n('<div data-idd-axis="'+e+'"></div>',a,c,!1,d);return l(f,c),f},this.getTooltip=function(a,b,c,d){var f=e.getAxes(),g=!1,h=new Array;if(f)for(var i=0;i<f.length;i++){var j=f[i];if(j.getToolTip){g=!0;var k;k="left"==f[i].mode||"right"==f[i].mode?b:a;var l=f[i].getToolTip(k);l&&h.push(l)}}if(g){var m=$("<div></div>").addClass("idd-tooltip-compositevalue");return m.append($("<div>"+h.join(", ")+"</div>")),m}};var s;if(this.measure=function(a){var b=(e.screenSize.width!==a.width||(e.screenSize.height,a.height),this.fit(a));s={x:0,y:0,width:a.width,height:a.height};var c=function(a,b,c,d,e,f){for(var g=0,h=a.length,i=h-1;i>=0;i--){var j=a[i],k=j.content;if(j.width(b),f&&j.css("top",d(g)),j.css("left",e),void 0!==k.axis){k.width(b);k.axis.update(c);var l=k.height();j.height()!==l&&j.height(l),g+=j.height()}else g+=j.height();f||j.css("top",d(g))}return g},d=function(a,b,c,d,e,f){for(var g=0,h=a.length,i=h-1;i>=0;i--){var j=a[i],k=j.content;if(j.height(b),k.height(b),f&&j.css("left",d(g)),j.css("top",e),void 0!==k.axis){k.height(b);k.axis.update(c);var l=k.width();j.width()!==l&&j.width(l),g+=j.width()}else g+=j.width();f||j.css("left",d(g))}return g},f=0,l=0,m=0;l=c(j,a.width,{min:b.x,max:b.x+b.width},function(a){return a},0,!0),m=c(h,a.width,{min:b.x,max:b.x+b.width},function(b){return a.height-b},0,!1),f=l+m;var n=0,o=0,p=0;o=d(g,a.height-f,{min:b.y,max:b.y+b.height},function(a){return a},l,!0),p=d(k,a.height-f,{min:b.y,max:b.y+b.height},function(b){return a.width-b},l,!1),n=o+p;var q={width:a.width-n,height:a.height-f};q.width<0&&(q.width=0),q.height<0&&(q.height=0),void 0!==e.mapControl&&e.mapControl.setOptions({width:q.width,height:q.height}),b=this.fit(q,!0),i.forEach(function(a){a.width(q.width),a.height(q.height),a.css("top",l),a.css("left",o)}),this.children.forEach(function(a){var b=a.host;b.width(q.width),b.height(q.height),b.css("top",l),b.css("left",o)});var r=0,t=0;if(r=c(j,q.width,{min:b.x,max:b.x+b.width},function(a){return a},o,!0),t=c(h,q.width,{min:b.x,max:b.x+b.width},function(b){return a.height-b},o,!1),r!=l)for(var u=l/r,v=0,w=0;w<j.length;w++){B=j[w];var x="scaleY("+u+") translate(0px,"+v+"px)",y="0% 0%";B.css("-webkit-transform",x),B.css("-webkit-transform-origin",y),B.css("-moz-transform",x),B.css("-moz-transform-origin",y),B.css("-o-transform",x),B.css("-o-transform-origin",y),B.css("-ms-transform",x),B.css("-ms-transform-origin",y),B.css("transform",x),B.css("transform-origin",y),v+=B.height()*(u-1)}else j.forEach(function(a){a.css("-ms-transform",""),a.css("-webkit-transform",""),a.css("-moz-transform",""),a.css("-o-transform",""),a.css("transform","")});if(m!=t)for(var u=m/t,v=0,w=0;w<h.length;w++){B=h[w];var x="scaleY("+u+") translate(0px,"+-v+"px)",y="0% 0%";B.css("-webkit-transform",x),B.css("-webkit-transform-origin",y),B.css("-moz-transform",x),B.css("-moz-transform-origin",y),B.css("-o-transform",x),B.css("-o-transform-origin",y),B.css("-ms-transform",x),B.css("-ms-transform-origin",y),B.css("transform",x),B.css("transform-origin",y),v+=B.height()*(u-1)}else h.forEach(function(a){a.css("-ms-transform",""),a.css("-webkit-transform",""),a.css("-moz-transform",""),a.css("-o-transform",""),a.css("transform","")});var z=0,A=0;if(z=d(g,a.height-f,{min:b.y,max:b.y+b.height},function(a){return a},l,!0),A=d(k,a.height-f,{min:b.y,max:b.y+b.height},function(b){return a.width-b},l,!1),z+A,o!=z)for(var u=o/z,v=0,w=0;w<g.length;w++){var B=g[w],x="scaleX("+u+") translate("+v+"px, 0px)",y="0% 0%";B.css("-webkit-transform",x),B.css("-webkit-transform-origin",y),B.css("-moz-transform",x),B.css("-moz-transform-origin",y),B.css("-o-transform",x),B.css("-o-transform-origin",y),B.css("-ms-transform",x),B.css("-ms-transform-origin",y),B.css("transform",x),B.css("transform-origin",y),v+=B.width()*(u-1)}else g.forEach(function(a){a.css("-ms-transform",""),a.css("-webkit-transform",""),a.css("-moz-transform",""),a.css("-o-transform",""),a.css("transform","")});if(p!=A)for(var u=p/A,v=0,w=0;w<k.length;w++){var B=k[w],x="scaleX("+u+") translate("+-v+"px, 0px)",y="100% 0%";B.css("-webkit-transform",x),B.css("-webkit-transform-origin",y),B.css("-moz-transform",x),B.css("-moz-transform-origin",y),B.css("-o-transform",x),B.css("-o-transform-origin",y),B.css("-ms-transform",x),B.css("-ms-transform-origin",y),B.css("transform",x),B.css("transform-origin",y),v+=B.width()*(u-1)}else k.forEach(function(a){a.css("-ms-transform",""),a.css("-webkit-transform",""),a.css("-moz-transform",""),a.css("-o-transform",""),a.css("transform","")});return q},this.arrange=function(a){InteractiveDataDisplay.Figure.prototype.arrange.call(this,a)},this.exportContentToSvg=function(a,b,c){for(var d=function(a,b){var c=a instanceof jQuery?window.getComputedStyle(a[0],null):window.getComputedStyle(a,null),d=c?c.getPropertyValue("transform"):void 0,e=c?c.getPropertyValue("padding-bottom"):void 0,f=c?parseFloat(c.getPropertyValue("font-size")):void 0,g=c?c.getPropertyValue("font-family"):void 0,h=c?c.getPropertyValue("font-weight"):void 0,i=c?c.getPropertyValue("text-align"):void 0;"center"==i&&(i="middle"),"left"==i&&(i="start"),"right"==i&&(i="end");var j,k;$(a).hasClass("idd-verticalTitle-inner")?(j=$(a).parent().width(),k=$(a).parent().height()):(j=$(a).width(),k=$(a).height());var l=$(a).text().trim(),m=b.text(l).font({family:g,size:f,weight:h,anchor:i});"middle"==i?m.translate(j/2,-k/2):"end"==i?m.translate(j,-k/2):m.translate(0,-k/2),"none"!=d&&void 0!=d&&(e=void 0!=e?parseFloat(e.substring(0,e.length-2)):0,m.attr({transform:d}),m.translate(-e,k/2))},e=c.group(),f=0,i=g.length;--i>=0;){var l=g[i],m=e.group();if(m.translate(f,0),f+=l.width(),l.content)if(l.content.axis)l.content.axis.renderToSvg(m);else{var n=$("div.idd-verticalTitle-inner",l.content),o=1===n.length&&0===n[0].children.length;o&&d(n,m)}}for(var p=c.group(),q=0,i=j.length;--i>=0;){var l=j[i],m=p.group();if(m.translate(f,q),q+=l.height(),l.content)if(l.content.axis)l.content.axis.renderToSvg(m);else{var o=!0;$(l.content).contents().each(function(){3!=this.nodeType&&(o=!1)}),o&&d(l.content,m)}}e.translate(0,q);for(var r=c.group(),s=q+b.height,i=0;i<h.length;i++){var l=h[i],m=r.group();if(m.translate(f,s),s+=l.height(),l.content)if(l.content.axis)l.content.axis.renderToSvg(m);else{var o=!0;$(l.content).contents().each(function(){3!=this.nodeType&&(o=!1)}),o&&d(l.content,m)}}for(var t=c.group(),u=f+b.width,i=0;i<k.length;i++){var l=k[i],m=t.group();if(m.translate(u,q),u+=l.width(),l.content)if(l.content.axis)l.content.axis.renderToSvg(m);else{var n=$("div.idd-verticalTitle-inner",l.content),o=1===n.length&&0===n[0].children.length;o&&d(n,m)}}var v=c.group();v.viewbox(0,0,b.width,b.height).translate(f,q),InteractiveDataDisplay.Figure.prototype.exportContentToSvg.call(this,a,b,v)},this.requestUpdateLayout(),"true"===a.attr("data-idd-navigation-enabled")){var t=InteractiveDataDisplay.Gestures.getGesturesStream(this.centralPart);this.navigation.gestureSource=t}var u=$("<div></div>").prependTo(this.centralPart),v=new InteractiveDataDisplay.Legend(this,u,!0);u.css("float","right"),Object.defineProperty(this,"legend",{get:function(){return v},configurable:!1}),InteractiveDataDisplay.Gestures.FullEventList.forEach(function(a){u[0].addEventListener(a,function(a){a.stopPropagation()},!1)});var w={};InteractiveDataDisplay.Utils.readStyle(a,w);var x=w.isLegendVisible;x?"true"==x?v.isVisible=!0:"false"==x&&(v.isVisible=!1):v.isVisible=!1}},InteractiveDataDisplay.Figure.prototype=new InteractiveDataDisplay.Plot,InteractiveDataDisplay.Chart=function(a,b){if(a){if(void 0!==b)throw"Chart cannot be a dependent plot";var c=$("<div data-idd-plot='grid' data-idd-placement='center'></div>").prependTo(a),d=$('<div data-idd-axis="numeric" data-idd-placement="left"></div>').prependTo(a),e=$('<div data-idd-axis="numeric" data-idd-placement="bottom"></div>').prependTo(a);this.base=InteractiveDataDisplay.Figure,this.base(a,b);var f=this,g=this.get(c[0]);e.axis=g.xAxis=this.get(e[0]),d.axis=g.yAxis=this.get(d[0]);var h=function(){var a=InteractiveDataDisplay.Gestures.getGesturesStream(f.centralPart),b=InteractiveDataDisplay.Gestures.applyHorizontalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(e)),c=InteractiveDataDisplay.Gestures.applyVerticalBehavior(InteractiveDataDisplay.Gestures.getGesturesStream(d));f.navigation.gestureSource=a.merge(b.merge(c))};this.changeXAxis=function(a,b){var c=e;e=f.addAxis("bottom",a,b,e[0]),f.removeDiv(c[0]),c.axis.destroy(),g.xAxis=this.get(e[0]),e.axis.dataTransform=f.xDataTransform},this.changeYAxis=function(a,b){var c=d;d=f.addAxis("left",a,b,d[0]),f.removeDiv(c[0]),c.axis.destroy(),g.yAxis=this.get(d[0]),d.axis.dataTransform=f.yDataTransform},this.onDataTranformChangedCore=function(a){if("y"==a){var b=InteractiveDataDisplay.TicksRenderer.getAxisType(f.yDataTransform);if(d.axis.host.attr("data-idd-axis")==b)"log"!=b&&(d.axis.dataTransform=f.yDataTransform);else{var c=d;d=f.addAxis("left",b,!0,d[0]),f.removeDiv(c[0]),c.axis.destroy(),g.yAxis=this.get(d[0])}f.enumAll(f,function(a){a!=f&&(a.yDataTransform=f.yDataTransform)})}else if("x"==a){var b=InteractiveDataDisplay.TicksRenderer.getAxisType(f.xDataTransform);if(e.axis.host.attr("data-idd-axis")==b)"log"!=b&&(e.axis.dataTransform=f.xDataTransform);else{var c=e;e=f.addAxis("bottom",b,!0,e[0]),f.removeDiv(c[0]),c.axis.destroy(),g.xAxis=this.get(e[0])}f.enumAll(f,function(a){a!=f&&(a.xDataTransform=f.xDataTransform)})}},this.fireChildrenChanged=function(a){"add"==a.type&&(f.xDataTransform&&(a.plot.xDataTransform=f.xDataTransform),f.yDataTransform&&(a.plot.yDataTransform=f.yDataTransform)),this.host.trigger(InteractiveDataDisplay.Event.childrenChanged,a)},this.exportToSvg=function(b,c,d){if(!SVG.supported)throw"SVG is not supported";var c=this.screenSize,b=this.coordinateTransform.getPlotRect({x:0,y:0,width:c.width,height:c.height}),e=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=SVG(e).size(a.width(),a.height()),g=d.group();this.exportContentToSvg(b,c,g);var h=d.group(),i=a.width()+20;return f.legend.isVisible&&(h.add(this.exportLegendToSvg(f.legend.Host[0])).translate(i,20),d.size(200+i,a.height())),d};var i={}
;InteractiveDataDisplay.Utils.readStyle(a,i);i.isLegendVisible||(f.legend.isVisible=!0),h()}},InteractiveDataDisplay.Chart.prototype=new InteractiveDataDisplay.Figure,InteractiveDataDisplay.LabelPlot=function(a,b){this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b);var c=[],d=[],e=[],f=[],g={x:120,y:25},h=[];this.getData=function(){for(var a=[],b=c.length,g=0;g<b;g++)a.push({text:c[g],position:{x:d[g],y:e[g]},placement:f[g]});return a},this.draw=function(a){if(a){for(var b=a.length,g=[],i=[],j=[],k=[],l=0;l<b;l++)g.push(a[l].text),i.push(a[l].position.x),j.push(a[l].position.y),a[l].placement?k.push(a[l].placement):k.push("center"),h.push(0);c=g,d=i,e=j,f=k}this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var a=this.xDataTransform&&this.xDataTransform.dataToPlot,b=this.yDataTransform&&this.yDataTransform.dataToPlot;if(d.length>0&&e.length>0){var c=InteractiveDataDisplay.Utils.getMinMax(d),f=InteractiveDataDisplay.Utils.getMinMax(e),g=c.min-.2,h=c.max+.2,i=f.min,j=f.max;return a&&(g=a(g),h=a(h)),b&&(i=b(i),j=b(j)),{x:g,y:i,width:h-g,height:j-i}}},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(a,b){InteractiveDataDisplay.LabelPlot.prototype.renderCore.call(this,a,b);var i=this.getContext(!0),j=c.length;if(0!=j)for(var k=this.getTransform(),l=k.dataToScreenX,m=k.dataToScreenY,n=0;n<j;n++){var o={x:l(d[n]),y:m(e[n])};"left"==f[n]?o={x:l(d[n])-g.x,y:m(e[n])}:"right"==f[n]?o={x:l(d[n])+g.x,y:m(e[n])}:"top"==f[n]?o={x:l(d[n]),y:m(e[n])-g.y}:"bottom"==f[n]&&(o={x:l(d[n]),y:m(e[n])+g.y});var p=window.getComputedStyle(document.body,null),q=p?parseFloat(p.getPropertyValue("font-size")):void 0,r=p?p.getPropertyValue("font-family"):void 0,s=p?p.getPropertyValue("font-weight"):void 0,t=o.x-.5*g.x,u=o.y;i.fillStyle="black",i.font=s+" "+q+"px "+r,i.textALign="center";for(var v=c[n],w=i.measureText(v).width;w>g.x;)v=v.substring(0,v.length-1),w=i.measureText(v).width;h[n]=(g.x-w)/2,i.fillText(v,t+h[n],u)}},this.renderCoreSvg=function(a,b,i){var j=c.length;if(j>0){for(var k=b.height,l=b.width,m=this.coordinateTransform.plotToScreenX,n=this.coordinateTransform.plotToScreenY,o=this.xDataTransform&&this.xDataTransform.dataToPlot,p=this.yDataTransform&&this.yDataTransform.dataToPlot,q=o?function(a){return m(o(a))}:m,r=p?function(a){return n(p(a))}:n,s=i.group(),t=0;t<j;t++){var u=window.getComputedStyle(document.body,null),v=u?parseFloat(u.getPropertyValue("font-size")):void 0,w=u?u.getPropertyValue("font-family"):void 0,x=u?u.getPropertyValue("font-weight"):void 0,y={x:q(d[t]),y:r(e[t])};"left"==f[t]?y={x:q(d[t])-g.x,y:r(e[t])}:"right"==f[t]?y={x:q(d[t])+g.x,y:r(e[t])}:"top"==f[t]?y={x:q(d[t]),y:r(e[t])-g.y}:"bottom"==f[t]&&(y={x:q(d[t]),y:r(e[t])+g.y});var z=y.x-.5*g.x,A=y.y-.9*g.y,B=s.group();B.size(g.x,g.y);B.text(c[t]).font({family:w,size:v,weight:x});B.translate(z+h[t],A),B.clipWith(B.rect(g.x,g.y))}s.clipWith(s.rect(l,k))}}},InteractiveDataDisplay.LabelPlot.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.MaxMarkersPerAnimationFrame=3e3,InteractiveDataDisplay.Markers=function(a,b){if(this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b),a){var c={},d=void 0,e={},f={},g=void 0,h=!1,i={},j=this,k=function(){void 0!=j.mapControl&&void 0!=g&&(g.forEach(function(a){var b=j.mapControl.entities.indexOf(a);b>=0&&j.mapControl.entities.removeAt(b)}),g=void 0)},l=function(){if(void 0!==e.x&&void 0!==e.y){var a=e.x,b=e.y;if(InteractiveDataDisplay.Utils.isArray(a)&&InteractiveDataDisplay.Utils.isArray(b)){var c=Math.min(a.length,b.length);if(c<=InteractiveDataDisplay.MaxMarkersPerAnimationFrame){g=new Array(c);for(var d=0;d<c;d++){var f=new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(b[d],a[d]),{visible:!1,htmlContent:'<div style="background-color: white; opacity: 0.5; width: 10px; height: 10px"></div>',anchor:new Microsoft.Maps.Point(5,5)});g[d]=f,j.mapControl.entities.push(f)}}}}},m=function(a){var b={},c={},d=-1;for(var e in a){var f=a[e];InteractiveDataDisplay.Utils.isArray(f)?((f.length<d||-1===d)&&(d=f.length),b[e]=f):c[e]=f}return{arrays:b,scalars:c,length:-1===d?0:d}};this.getDataCopy=function(){return c},this.draw=function(a,b){if(void 0==a||null==a)throw"The argument 'data' is undefined or null";c=a;var g;if(void 0===a.shape||null==a.shape)g=InteractiveDataDisplay.Markers.shapes.box;else if("string"==typeof a.shape){if(void 0==(g=InteractiveDataDisplay.Markers.shapes[a.shape]))throw"The given marker shape is unknown"}else{if("object"!=typeof a.shape||null==a.shape||"function"!=typeof a.shape.draw)throw"The argument 'data' is incorrect: value of the property 'shape' must be a string, a MarkerShape object, undefined or null";g=a.shape}d=g;var h=$.extend({},a);void 0!=g.prepare&&g.prepare(h),k(),e=h,f={},this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.setTitles(b,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(a,b){var c=this.xDataTransform&&this.xDataTransform.dataToPlot,f=this.yDataTransform&&this.yDataTransform.dataToPlot;if(d&&(void 0!==d.getBoundingBox||void 0!==d.getPlotBoundingBox)&&e){if(0==e.x.length)return;var g=m(e),h=g.length,i=g.arrays,k=g.scalars,l=void 0;if(d.hasOwnProperty("getBoundingBox")){for(var n=0;n<h;n++){for(var o in i)k[o]=i[o][n];var p=d.getBoundingBox(k);l=InteractiveDataDisplay.Utils.unionRects(l,p)}if(c){var q=c(l.x),r=c(l.x+l.width);l.x=q,l.width=r-q}if(f){var s=f(l.y),t=f(l.y+l.height);l.y=s,l.height=t-s}}else{if(!d.hasOwnProperty("getPlotBoundingBox"))throw"Shape does not have neither getBoundingBox nor getPlotBoundingBox";for(var u=j.getTransform(),n=0;n<h;n++){for(var o in i)k[o]=i[o][n];var v=d.getPlotBoundingBox(k,u);l=InteractiveDataDisplay.Utils.unionRects(l,v)}}return l}if(void 0!==e.x&&void 0!==e.y)return InteractiveDataDisplay.Utils.getBoundingBoxForArrays(e.x,e.y,c,f)},this.getLocalPadding=function(){if(d&&void 0!==d.getPadding)return d.getPadding(e);var a=0;return{left:a,right:a,top:a,bottom:a}},this.renderCore=function(a,b){if(InteractiveDataDisplay.Markers.prototype.renderCore.call(this,a,b),void 0!=d){var c=this.getTransform(),i=!j.master.isInAnimation||void 0===j.master.mapControl;if(void 0!==j.mapControl&&(void 0===g&&l(),void 0!==g&&(j.master.isInAnimation&&!h?(g.forEach(function(a){a.setOptions({visible:!0})}),h=!0):!j.master.isInAnimation&&h&&(g.forEach(function(a){a.setOptions({visible:!1})}),h=!1))),i){var k=this.getContext(!0);f=e,void 0!==d.preRender&&(f=d.preRender(e,a,b,c,k));for(var n=m(f),o=n.length,p=n.arrays,q=n.scalars,r=0;r<o;r++){for(var s in p)q[s]=p[s][r];d.draw(q,a,b,c,k,r)}}}},this.renderCoreSvg=function(a,b,c){if(void 0!=d&&void 0!=d.renderSvg){var f=this.getTransform();d.renderSvg(a,b,c,e,f)}},this.findToolTipMarkers=function(a,b,e,g){if(void 0==d||void 0===d.hitTest||void 0==f)return[];for(var h=this.getTransform(),j={x:h.dataToScreenX(a),y:h.dataToScreenY(b)},k={x:a,y:b},l=m(f),n=l.length,o=l.arrays,p=l.scalars,q=[],r=0;r<n;r++){for(var s in o)p[s]=o[s][r];if(d.hitTest(p,h,j,k)&&"number"==typeof p.indices){var t=p.indices,u={};if(d.getTooltipData)u=d.getTooltipData(c,t);else{for(var s in c){var v=c[s];InteractiveDataDisplay.Utils.isArray(v)&&t<v.length&&(i[s]=new InteractiveDataDisplay.AdaptiveFormatter(v),u[s]=i[s].toString(v[t]))}u.index=t}q.push(u)}}return q},this.getTooltip=function(a,b,c,d){var e=this;if(this.isVisible&&!this.isErrorVisible){var f=e.findToolTipMarkers(a,b,c,d),g=function(a){var b=$("<div></div>").addClass("idd-tooltip-compositevalue");for(var c in a)if(a.hasOwnProperty(c)){var d=e.getTitle(c),f=void 0;"object"==typeof a[c]&&(f=g(a[c])),f?b.append($("<div>"+d+":</div>")).append(f):b.append($("<div>"+d+": "+a[c]+"</div>"))}return b};if(f.length>0){var h=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(e.name||"markers").appendTo(h),f.forEach(function(a){g(a).addClass("idd-tooltip-itemvalues").appendTo(h)}),h}}},this.getLegend=function(){var a=$("<span></span>"),b={thumbnail:$("<canvas></canvas>"),content:$("<div></div>")},c=function(){a.empty(),d&&void 0!==d.getLegend&&(b.content.empty(),d.getLegend(e,j.getTitle,b)),a.text(j.name)};return this.host.bind("appearanceChanged",c),c(),{name:a,legend:b,onLegendRemove:function(){j.host.unbind("appearanceChanged",c),a.empty()}}},this.buildSvgLegend=function(a,b){var c=this,f={thumbnail:b.group(),content:b.group()};a.height=30,d&&void 0!==d.buildSvgLegendElements&&(f=d.buildSvgLegendElements(a,b,e,c.getTitle)),b.rect(a.width,a.height).fill({color:"white",opacity:0}),b.add(f.thumbnail.translate(5,5));var g=window.getComputedStyle(a.legendDiv.children[0].children[1],null),h=parseFloat(g.getPropertyValue("font-size")),i=g.getPropertyValue("font-family");b.add(b.text(c.name).font({family:i,size:h}).translate(40,0)),b.add(f.content.translate(5,30))},this.onDataTransformChanged=function(a){this.invalidateLocalBounds(),InteractiveDataDisplay.Markers.prototype.onDataTransformChanged.call(this,a)};var n=InteractiveDataDisplay.Utils.getDataSourceFunction(a,InteractiveDataDisplay.readCsv),o=n(a);o&&void 0!==o.y&&("bars"==o.shape&&(barWidthFloat=parseFloat(o.barWidth),isNaN(barWidthFloat)?(void 0===o.barWidth?console.error("barWidth parameter of BarChart plot should be set"):console.error("barWidth parameter of BarChart plot should be a number"),o.barWidth=void 0):o.barWidth=barWidthFloat),this.draw(o))}},InteractiveDataDisplay.Markers.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.Markers.defaults={color:"#4169ed",colorPalette:InteractiveDataDisplay.palettes.grayscale,border:"#000000",size:10},InteractiveDataDisplay.Markers.shapes=InteractiveDataDisplay.Markers.shapes||{},function(){var a={prepare:function(a){var b=a.shape?a.shape.toLowerCase():"box";if("box"==b)a.shape=1;else if("circle"==b)a.shape=2;else if("diamond"==b)a.shape=3;else if("cross"==b)a.shape=4;else{if("triangle"!=b)throw"Unexpected value of property 'shape'";a.shape=5}if(void 0==a.y||null==a.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.y))throw"The property 'y' must be an array of numbers";var c=a.y.length,d=new Int8Array(c);if(InteractiveDataDisplay.Utils.maskNaN(d,a.y),void 0==a.x)a.x=InteractiveDataDisplay.Utils.range(0,c-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(a.x.length!=c)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(d,a.x)}if(void 0!=a.border&&"none"!=a.border||(a.border=null),void 0==a.color&&(a.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(a.color)){if(a.color.length!=c)throw"Length of the array 'color' is different than length of the array 'y'";if(c>0&&"string"!=typeof a.color[0]){var e=a.colorPalette;if(void 0==e&&(e=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof e&&(e=new InteractiveDataDisplay.ColorPalette.parse(e)),void 0!=e&&e.isNormalized){var f=InteractiveDataDisplay.Utils.getMinMax(a.color);f=InteractiveDataDisplay.Utils.makeNonEqual(f),e=e.absolute(f.min,f.max)}a.colorPalette=e;for(var g=new Array(c),h=0;h<c;h++){var i=a.color[h];if(i!=i)d[h]=1;else{var j=e.getRgba(i);g[h]="rgba("+j.r+","+j.g+","+j.b+","+j.a+")"}}a.color=g}a.individualColors=!0}else a.individualColors=!1;var k=new Array(c);if(void 0==a.size&&(a.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(a.size)){if(a.size.length!=c)throw"Length of the array 'size' is different than length of the array 'y'";if(void 0!=a.sizePalette){var e=InteractiveDataDisplay.SizePalette.Create(a.sizePalette);if(e.isNormalized){var f=InteractiveDataDisplay.Utils.getMinMax(a.size);f=InteractiveDataDisplay.Utils.makeNonEqual(f),e=new InteractiveDataDisplay.SizePalette(!1,e.sizeRange,f)}a.sizePalette=e;for(var h=0;h<c;h++){var l=a.size[h];l!=l?d[h]=1:k[h]=e.getSize(l)}}else k=a.size,a.sizeMax=InteractiveDataDisplay.Utils.getMax(a.size)}else{for(var h=0;h<c;h++)k[h]=a.size;a.sizeMax=a.size}a.size=k;for(var m=0,h=0;h<c;h++)1===d[h]&&m++;if(m>0){m=c-m,a.x=InteractiveDataDisplay.Utils.applyMask(d,a.x,m),a.y=InteractiveDataDisplay.Utils.applyMask(d,a.y,m),a.size=InteractiveDataDisplay.Utils.applyMask(d,a.size,m),a.individualColors&&(a.color=InteractiveDataDisplay.Utils.applyMask(d,a.color,m));for(var n=Array(m),h=0,o=0;h<c;h++)0===d[h]&&(n[o++]=h);a.indices=n}else a.indices=InteractiveDataDisplay.Utils.range(0,c-1)},preRender:function(a,b,c,d,e){return a.individualColors||(e.fillStyle=a.color),null!=a.border&&(e.strokeStyle=a.border),a},draw:function(a,b,c,d,e,f){a.individualColors&&(e.fillStyle=a.color);var g=null!=a.border,h=d.dataToScreenX(a.x),i=d.dataToScreenY(a.y),j=c.width,k=c.height,l=a.size,m=l/2;if(!(h-m>j||h+m<0||i-m>k||i+m<0))switch(a.shape){case 1:e.fillRect(h-m,i-m,l,l),g&&e.strokeRect(h-m,i-m,l,l);break;case 2:e.beginPath(),e.arc(h,i,m,0,2*Math.PI),e.fill(),g&&e.stroke();break;case 3:e.beginPath(),e.moveTo(h-m,i),e.lineTo(h,i-m),e.lineTo(h+m,i),e.lineTo(h,i+m),e.closePath(),e.fill(),g&&e.stroke();break;case 4:var n=l/3,o=n/2;g?(e.beginPath(),e.moveTo(h-m,i-o),e.lineTo(h-o,i-o),e.lineTo(h-o,i-m),e.lineTo(h+o,i-m),e.lineTo(h+o,i-o),e.lineTo(h+m,i-o),e.lineTo(h+m,i+o),e.lineTo(h+o,i+o),e.lineTo(h+o,i+m),e.lineTo(h-o,i+m),e.lineTo(h-o,i+o),e.lineTo(h-m,i+o),e.closePath(),e.fill(),e.stroke()):(e.fillRect(h-o,i-m,n,l),e.fillRect(h-m,i-o,l,n));break;case 5:e.beginPath(),e.moveTo(h-m,i+m),e.lineTo(h,i-m),e.lineTo(h+m,i+m),e.closePath(),e.fill(),g&&e.stroke()}},getPadding:function(a){var b=a.sizeMax/2;return{left:b,right:b,top:b,bottom:b}},hitTest:function(a,b,c,d){var e=function(a,b){for(var c=function(a,b,c){var d={x:c.x-b.x,y:c.y-b.y},e={x:a.x-b.x,y:a.y-b.y},f=d.x*e.y-d.y*e.x;return f>0?1:f<0?2:0},d=b.length,e=0;e<d;e++)if(1!=c(a,b[e],b[(e+1)%d]))return!1;return!0},f=b.dataToScreenX(a.x),g=b.dataToScreenY(a.y),h=c.x,i=c.y,j=a.size,k=j/2;if(c.x>=f-k&&c.x<=f+k&&c.y>=g-k&&c.y<=g+k)switch(a.shape){case 1:return!0;case 2:return(f-h)*(f-h)+(g-i)*(g-i)<=k*k;case 3:return e({x:h,y:i},[{x:f-k,y:g},{x:f,y:g-k},{x:f+k,y:g},{x:f,y:g+k}]);case 4:var l=j/3,m=l/2;return e({x:h,y:i},[{x:f-m,y:g+k},{x:f-m,y:g-k},{x:f+m,y:g-k},{x:f+m,y:g+k}])||e({x:h,y:i},[{x:f-k,y:g+m},{x:f-k,y:g-m},{x:f+k,y:g-m},{x:f+k,y:g+m}]);case 5:return e({x:h,y:i},[{x:f-k,y:g+k},{x:f,y:g-k},{x:f+k,y:g+k}])}},getLegend:function(a,b,c){var d=c.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"))),(isNaN(e)||0==e)&&(e=14);var f=c.thumbnail,g=!0,h=1.5*e,i=h/2+1,j=i;f[0].width=f[0].height=h+2;var k=f[0].style,l=f.get(0).getContext("2d");l.clearRect(0,0,f[0].width,f[0].height);var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=0,D=function(){if(t=h,a.sizePalette){var c=b("size");if(0==C){v=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),y=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(v),w=v[0].style;var e=$("<div style='width: 170px; color: rgb(0,0,0)'></div>").appendTo(v);x=new InteractiveDataDisplay.SizePaletteViewer(e),C=2}else y.text(c);x.palette=InteractiveDataDisplay.SizePalette.Create(a.sizePalette)}u=t/2},E=function(){if(p=!1,a.individualColors&&a.colorPalette){var c=b("color");if(0==B){q=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),z=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(q),r=q[0].style;var e=$("<div style='width: 170px; color: rgb(0,0,0); '></div>").appendTo(q);s=new InteractiveDataDisplay.ColorPaletteViewer(e),B=2}else z.text(c);s.palette=a.colorPalette,1==B&&(r.display="block",B=2)}else 2==B&&(r.display="none",B=1);a.individualColors?(o="#000000",n="#ffffff",p=!0):(n=a.color,o=n,null!=a.border&&(p=!0,o=a.border))},F=function(){switch(2==A&&(m.display="none",A=1),l.clearRect(0,0,h+2,h+2),l.strokeStyle=o,l.fillStyle=n,a.shape){case 1:l.fillRect(i-u,j-u,t,t),p&&l.strokeRect(i-u,j-u,t,t);break;case 2:l.beginPath(),l.arc(i,j,u,0,2*Math.PI),l.fill(),p&&l.stroke();break;case 3:l.beginPath(),l.moveTo(i-u,j),l.lineTo(i,j-u),l.lineTo(i+u,j),l.lineTo(i,j+u),l.closePath(),l.fill(),p&&l.stroke();break;case 4:var b=t/3,c=b/2;p?(l.beginPath(),l.moveTo(i-u,j-c),l.lineTo(i-c,j-c),l.lineTo(i-c,j-u),l.lineTo(i+c,j-u),l.lineTo(i+c,j-c),l.lineTo(i+u,j-c),l.lineTo(i+u,j+c),l.lineTo(i+c,j+c),l.lineTo(i+c,j+u),l.lineTo(i-c,j+u),l.lineTo(i-c,j+c),l.lineTo(i-u,j+c),l.closePath(),l.fill(),l.stroke()):(l.fillRect(i-c,j-u,b,t),l.fillRect(i-u,j-c,t,b));break;case 5:l.beginPath(),l.moveTo(i-u,j+u),l.lineTo(i,j-u),l.lineTo(i+u,j+u),l.closePath(),l.fill(),p&&l.stroke()}g||(k.display="inline-block",g=!0)};E(),D(),F()},renderSvg:function(a,b,c,d,e){var f=d.y.length;if(0!=f){var g,h,i=c.group(),j=e.dataToScreenX,k=e.dataToScreenY,l=b.width,m=b.height,n=0;(function(){for(var a=null==d.border?"none":d.border;n<f;n++){g=j(d.x[n]),h=k(d.y[n]);var b=d.size[n],c=b/2;c1=g-c>l||g+c<0||h-c>m||h+c<0;var e=d.individualColors?d.color[n]:d.color;if(!c1)if(1==d.shape)i.rect(d.size[n],d.size[n]).translate(g-c,h-c).fill(e).style({stroke:a});else if(2==d.shape)i.circle(d.size[n]).translate(g-c,h-c).style({fill:e,stroke:a});else if(3==d.shape)i.rect(d.size[n]/Math.sqrt(2),d.size[n]/Math.sqrt(2)).translate(g,h-c).style({fill:e,stroke:a}).rotate(45);else if(4==d.shape){var o=b/6;i.polyline([[-c,-o],[-o,-o],[-o,-c],[o,-c],[o,-o],[c,-o],[c,o],[o,o],[o,c],[-o,c],[-o,o],[-c,o],[-c,-o]]).translate(g,h).style({fill:e,stroke:a})}else if(5==d.shape){var p=Math.sqrt(3)/6*b;i.polyline([[g-c,h+p],[g,h-2*p],[g+c,h+p],[g-c,h+p]]).style({fill:e,stroke:a})}}i.clipWith(i.rect(l,m))})()}},buildSvgLegendElements:function(a,b,c,d){var e=b.group(),f=b.group(),g=12,h=1.5*g,i=h/2+1,j=i,k=h/2;switch(c.individualColors?(border="#000000",color="#ffffff"):(color=c.color,border="none",null!=c.border&&(border=c.border)),c.shape){case 1:e.rect(h,h).translate(i-k,j-k).fill({color:color,opacity:1}).stroke(border);break;case 2:e.circle(h).translate(i-k,j-k).fill(color).stroke(border);break;case 3:e.rect(h/Math.sqrt(2),h/Math.sqrt(2)).translate(i,j-k).fill(color).stroke(border).rotate(45);break;case 4:var l=h/6;e.polyline([[-k,-l],[-l,-l],[-l,-k],[l,-k],[l,-l],[k,-l],[k,l],[l,l],[l,k],[-l,k],[-l,l],[-k,l],[-k,-l]]).translate(i,j).fill(color).stroke(border);break;case 5:var m=Math.sqrt(3)/6*h;e.polyline([[i-k,j+m],[i,j-2*m],[i+k,j+m],[i-k,j+m]]).fill(color).stroke(border)}var n=0,o=a.legendDiv.children[1],p=c.individualColors&&c.colorPalette,q=(c.sizePalette,o&&a.legendDiv.children[1].children[0]&&a.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(a.legendDiv.children[1].children[0].children[0],null):void 0);g=q?parseFloat(q.getPropertyValue("font-size")):void 0,fontFamily=q?q.getPropertyValue("font-family"):void 0;var r=q?q.getPropertyValue("font-weight"):void 0;if(p){var s=d("color");f.text(s).font({family:fontFamily,size:g,weight:r});var t=b.group(),u=a.width,v=20;InteractiveDataDisplay.SvgColorPaletteViewer(t,c.colorPalette,a.legendDiv.children[1].children[0].children[1],{width:u,height:v}),t.translate(5,50),n=50+v,a.height+=50+v}if(c.sizePalette){var w=d("size");f.add(b.text(w).font({family:fontFamily,size:g,weight:r}).translate(0,n));var x=b.group(),u=a.width,v=35,y=p?a.legendDiv.children[1].children[1].children[1]:a.legendDiv.children[1].children[0].children[1];InteractiveDataDisplay.SvgSizePaletteViewer(x,c.sizePalette,y,{width:u,height:v}),x.translate(5,50+n),a.height+=50+v}return b.front(),{thumbnail:e,content:f}}};InteractiveDataDisplay.Markers.shapes.box=a,InteractiveDataDisplay.Markers.shapes.circle=a,InteractiveDataDisplay.Markers.shapes.diamond=a,InteractiveDataDisplay.Markers.shapes.cross=a,InteractiveDataDisplay.Markers.shapes.triangle=a}(),InteractiveDataDisplay.Petal={prepare:function(a){if(!a.maxDelta){for(var b=0;isNaN(a.size.upper95[b])||isNaN(a.size.lower95[b]);)b++;var c=a.size.upper95[b]-a.size.lower95[b];for(b++;b<a.size.upper95.length;b++)isNaN(a.size.upper95[b])||isNaN(a.size.lower95[b])||(c=Math.max(c,a.size.upper95[b]-a.size.lower95[b]));a.maxDelta=c}if(void 0==a.y||null==a.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.y))throw"The property 'y' must be an array of numbers";var d=a.y.length,e=new Int8Array(d);if(InteractiveDataDisplay.Utils.maskNaN(e,a.y),void 0==a.x)a.x=InteractiveDataDisplay.Utils.range(0,d-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(a.x.length!=d)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(e,a.x)}if(void 0!=a.border&&"none"!=a.border||(a.border=null),void 0==a.color&&(a.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(a.color)){if(a.color.length!=d)throw"Length of the array 'color' is different than length of the array 'y'";if(d>0&&"string"!=typeof a.color[0]){var f=a.colorPalette;if(void 0==f&&(f=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof f&&(f=new InteractiveDataDisplay.ColorPalette.parse(f)),void 0!=f&&f.isNormalized){var g=InteractiveDataDisplay.Utils.getMinMax(a.color);g=InteractiveDataDisplay.Utils.makeNonEqual(g),f=f.absolute(g.min,g.max)}a.colorPalette=f;for(var h=new Array(d),b=0;b<d;b++){var i=a.color[b];if(i!=i)e[b]=1;else{var j=f.getRgba(i);h[b]="rgba("+j.r+","+j.g+","+j.b+","+j.a+")"}}a.color=h}a.individualColors=!0}else a.individualColors=!1;var k=new Array(d);if(InteractiveDataDisplay.Utils.isArray(a.size.lower95)&&InteractiveDataDisplay.Utils.isArray(a.size.upper95)){if(a.size.lower95.length!=d&&a.size.upper95.length!=d)throw"Length of the array 'size' is different than length of the array 'y'";if(d>0&&"number"==typeof a.size.lower95[0]&&"number"==typeof a.size.upper95[0]){for(var l=[],m=[],b=0;b<d;b++){var n=a.size.upper95[b],o=a.size.lower95[b];n!=n||o!=o?e[b]=1:(l[b]=a.size.upper95[b],m[b]=a.size.lower95[b])}a.upper95=l,a.lower95=m}}a.size="15.0";for(var b=0;b<d;b++)k[b]=a.size;a.sizeMax=a.size,a.size=k;for(var p=0,b=0;b<d;b++)1===e[b]&&p++;if(p>0){p=d-p,a.x=InteractiveDataDisplay.Utils.applyMask(e,a.x,p),a.y=InteractiveDataDisplay.Utils.applyMask(e,a.y,p),a.size=InteractiveDataDisplay.Utils.applyMask(e,a.size,p),a.upper95=InteractiveDataDisplay.Utils.applyMask(e,a.upper95,p),a.lower95=InteractiveDataDisplay.Utils.applyMask(e,a.lower95,p),a.individualColors&&(a.color=InteractiveDataDisplay.Utils.applyMask(e,a.color,p));for(var q=Array(p),b=0,r=0;b<d;b++)0===e[b]&&(q[r++]=b);a.indices=q}else a.indices=InteractiveDataDisplay.Utils.range(0,d-1)},preRender:function(a,b,c,d,e){return a.individualColors||(e.fillStyle=a.color),null!=a.border&&(e.strokeStyle=a.border),a},draw:function(a,b,c,d,e){var f=d.dataToScreenX(a.x),g=d.dataToScreenY(a.y);if(!(f>c.width||f<0||g>c.height||g<0)){var h=a.size/2,i=h*(1-(a.upper95-a.lower95)/a.maxDelta);a.maxDelta<=0&&(i=NaN),InteractiveDataDisplay.Petal.drawSample(e,f,g,i,h,a.color)}},drawSample:function(a,b,c,d,e,f){var g,h,i=Math.random()*Math.PI*2;isNaN(d)?(g=0,h=e,a.fillStyle="rgba(0, 0, 0, 0.2)"):(g=(e-d)/2,h=(e+d)/2,a.fillStyle=f),a.strokeStyle="black",a.beginPath();for(var j=200,k=2*Math.PI/j,l=0;l<j;l++){var m=k*l,n=g*Math.sin(6*m+i)+h;0==l?a.moveTo(b+n*Math.cos(m),c+n*Math.sin(m)):a.lineTo(b+n*Math.cos(m),c+n*Math.sin(m))}a.stroke(),a.closePath(),a.fill(),a.strokeStyle="gray",a.beginPath(),a.arc(b,c,1,0,2*Math.PI),a.stroke(),a.closePath()},hitTest:function(a,b,c,d){var e=b.dataToScreenX(a.x),f=b.dataToScreenY(a.y),g=a.size/2;return!(c.x<e-g||c.x>e+g)&&!(c.y<f-g||c.y>f+g)},getLegend:function(a,b,c){var d=c.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"))),(isNaN(e)||0==e)&&(e=14);var f=c.thumbnail,g=1.5*e,h=g/2+1,i=g/2+1;f[0].width=f[0].height=g+2;var j=(f[0].style,f.get(0).getContext("2d"));j.clearRect(0,0,f[0].width,f[0].height);var k,l,m,n,o,p,q,r,s,t,u,v,w,x=0,y=0,z=function(){q=g;var a=b("size");if(0==y){s=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),v=$("<div class='idd-legend-item-property'></div>").text(a).appendTo(s),t=s[0].style;var c=$("<div style='width: 170px;'></div>").appendTo(s);u=new InteractiveDataDisplay.UncertaintySizePaletteViewer(c),y=2}else v.text(a);r=q/2},A=function(){if(m=!1,a.individualColors&&a.colorPalette){var c=b("color");if(0==x){n=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),w=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(n),o=n[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(n);p=new InteractiveDataDisplay.ColorPaletteViewer(e),x=2}else w.text(c);p.palette=a.colorPalette,1==x&&(o.display="block",x=2)}else 2==x&&(o.display="none",x=1);a.individualColors?(l="#000000",k="#ffffff",m=!0):(k=a.color,l=k,null!=a.border&&(m=!0,l=a.border))},B=function(){InteractiveDataDisplay.Petal.drawSample(j,h,i,r/2,r,"gray")};A(),z(),B()},getTooltipData:function(a,b){var c={},d={};return InteractiveDataDisplay.Utils.isArray(a.x)&&b<a.x.length&&(d.x=new InteractiveDataDisplay.AdaptiveFormatter(a.x),c.x=d.x.toString(a.x[b])),InteractiveDataDisplay.Utils.isArray(a.y)&&b<a.y.length&&(d.y=new InteractiveDataDisplay.AdaptiveFormatter(a.y),c.y=d.y.toString(a.y[b])),InteractiveDataDisplay.Utils.isArray(a.color)&&b<a.color.length&&(d.color=new InteractiveDataDisplay.AdaptiveFormatter(a.color),c.color=d.color.toString(a.color[b])),a.size&&(c.size={},InteractiveDataDisplay.Utils.isArray(a.size.lower95)&&b<a.size.lower95.length&&(d.lower95=new InteractiveDataDisplay.AdaptiveFormatter(a.size.lower95),c.size["lower 95%"]=d.lower95.toString(a.size.lower95[b])),InteractiveDataDisplay.Utils.isArray(a.size.upper95)&&b<a.size.upper95.length&&(d.upper95=new InteractiveDataDisplay.AdaptiveFormatter(a.size.upper95),c.size["upper 95%"]=d.upper95.toString(a.size.upper95[b]))),c.index=b,c},renderSvg:function(a,b,c,d,e){var f=d.y.length;if(0!=f){var g,h,i=c.group(),j=e.dataToScreenX,k=e.dataToScreenY,l=b.width,m=b.height,n=0,o=d.size[0];for(null==d.border||d.border;n<f;n++){g=j(d.x[n]),h=k(d.y[n]);var p=o/2,q=p*(1-(d.upper95[n]-d.lower95[n])/d.maxDelta),r=d.color[n];if(c1=g>l||g<0||h>m||h<0,!c1){var s,t,u=Math.random()*Math.PI*2;s=(p-q)/2,t=(p+q)/2;for(var v=200,w=2*Math.PI/v,x=[],y=0;y<v;y++){var z=w*y,A=s*Math.sin(6*z+u)+t;x.push([g+A*Math.cos(z),h+A*Math.sin(z)])}i.polyline(x).fill(r).stroke("black"),i.circle(2).translate(g-1,h-1).fill("gray").stroke({width:2,color:"gray"})}}i.clipWith(i.rect(l,m))}}},InteractiveDataDisplay.BullEye={prepare:function(a){if(a.bullEyeShape=a.bullEyeShape?a.bullEyeShape.toLowerCase():"circle",void 0==a.y||null==a.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.y))throw"The property 'y' must be an array of numbers";var b=a.y.length,c=new Int8Array(b);if(InteractiveDataDisplay.Utils.maskNaN(c,a.y),void 0==a.x)a.x=InteractiveDataDisplay.Utils.range(0,b-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(a.x.length!=b)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(c,a.x)}if(void 0!=a.border&&"none"!=a.border||(a.border=null),InteractiveDataDisplay.Utils.isArray(a.color.lower95)&&InteractiveDataDisplay.Utils.isArray(a.color.upper95)){if(a.color.lower95.length!=b&&a.color.upper95.length!=b)throw"Length of the array 'color' is different than length of the array 'y'";if(b>0&&void 0!==a.color.lower95[0]&&"string"!=typeof a.color.upper95[0]){var d=a.colorPalette;if(void 0==d&&(d=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof d&&(d=new InteractiveDataDisplay.ColorPalette.parse(d)),void 0!=d&&d.isNormalized){var e={min:InteractiveDataDisplay.Utils.getMin(a.color.lower95),max:InteractiveDataDisplay.Utils.getMax(a.color.upper95)};e=InteractiveDataDisplay.Utils.makeNonEqual(e),d=d.absolute(e.min,e.max)}a.colorPalette=d;for(var f=[],g=[],h=0;h<b;h++){var i=a.color.upper95[h],j=a.color.lower95[h];if(i!=i||j!=j)c[h]=1;else{var k=d.getRgba(i),l=d.getRgba(j);f[h]="rgba("+k.r+","+k.g+","+k.b+","+k.a+")",g[h]="rgba("+l.r+","+l.g+","+l.b+","+l.a+")"}}a.upper95=f,a.lower95=g}a.individualColors=!0}else a.individualColors=!1;var m=new Array(b);if(void 0==a.size&&(a.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(a.size)){if(a.size.length!=b)throw"Length of the array 'size' is different than length of the array 'y'";if(void 0!=a.sizePalette){var d=InteractiveDataDisplay.SizePalette.Create(a.sizePalette);if(d.isNormalized){var e=InteractiveDataDisplay.Utils.getMinMax(a.size);e=InteractiveDataDisplay.Utils.makeNonEqual(e),d=new InteractiveDataDisplay.SizePalette(!1,d.sizeRange,e)}a.sizePalette=d;for(var h=0;h<b;h++){var n=a.size[h];n!=n?c[h]=1:m[h]=d.getSize(n)}}else a.sizeMax=InteractiveDataDisplay.Utils.getMax(a.size)}else{for(var h=0;h<b;h++)m[h]=a.size;a.sizeMax=a.size}a.size=m;for(var o=0,h=0;h<b;h++)1===c[h]&&o++;if(o>0){o=b-o,a.x=InteractiveDataDisplay.Utils.applyMask(c,a.x,o),a.y=InteractiveDataDisplay.Utils.applyMask(c,a.y,o),a.size=InteractiveDataDisplay.Utils.applyMask(c,a.size,o),a.individualColors&&(a.upper95=InteractiveDataDisplay.Utils.applyMask(c,a.upper95,o),a.lower95=InteractiveDataDisplay.Utils.applyMask(c,a.lower95,o));for(var p=Array(o),h=0,q=0;h<b;h++)0===c[h]&&(p[q++]=h);a.indices=p}else a.indices=InteractiveDataDisplay.Utils.range(0,b-1)},preRender:function(a,b,c,d,e){return null!=a.border&&(e.strokeStyle=a.border),a},draw:function(a,b,c,d,e){var f=(a.y_mean,a.upper95),g=a.lower95,h=a.size,i=h/2,j=d.dataToScreenX(a.x),k=d.dataToScreenY(a.y);j+i<0||j-i>c.width||k+i<0||k-i>c.height||(InteractiveDataDisplay.BullEye.drawBullEye(e,a.bullEyeShape,j,k,h,h,f),InteractiveDataDisplay.BullEye.drawBullEye(e,a.bullEyeShape,j,k,i,i,g))},drawBullEye:function(a,b,c,d,e,f,g,h){var i=e,j=f,k="none"!==h;a.strokeStyle=void 0!==h?h:"black",a.fillStyle=void 0!==g?g:"black";var l=c,m=d,n=Math.min(i,j),o=.5*n;switch(a.clearRect(0,0,i,j),b){case"box":k&&a.strokeRect(l-o,m-o,n,n),a.fillRect(l-o,m-o,n,n);break;case"circle":a.beginPath(),a.arc(l,m,o,0,2*Math.PI),k&&a.stroke(),a.fill();break;case"diamond":a.beginPath(),a.moveTo(l-o,m),a.lineTo(l,m-o),a.lineTo(l+o,m),a.lineTo(l,m+o),a.closePath(),k&&a.stroke(),a.fill();break;case"cross":var p=n/3,q=p/2;a.beginPath(),a.moveTo(l-o,m-q),a.lineTo(l-q,m-q),a.lineTo(l-q,m-o),a.lineTo(l+q,m-o),a.lineTo(l+q,m-q),a.lineTo(l+o,m-q),a.lineTo(l+o,m+q),a.lineTo(l+q,m+q),a.lineTo(l+q,m+o),a.lineTo(l-q,m+o),a.lineTo(l-q,m+q),a.lineTo(l-o,m+q),a.closePath(),k&&a.stroke(),a.fill();break;case"triangle":var r=Math.sqrt(3)/6*n;a.beginPath(),a.moveTo(l-o,m+r),a.lineTo(l,m-2*r),a.lineTo(l+o,m+r),a.closePath(),k&&a.stroke(),a.fill()}},hitTest:function(a,b,c,d){var e=b.dataToScreenX(a.x),f=b.dataToScreenY(a.y);return c.x>e-a.size/2&&c.x<e+a.size/2&&c.y>f-a.size/2&&c.y<f+a.size/2},getPadding:function(a){var b=0;return{left:b,right:b,top:b,bottom:b}},getLegend:function(a,b,c){var d=c.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"))),(isNaN(e)||0==e)&&(e=14);var f=c.thumbnail,g=1.5*e,h=g/2+1,i=g/2+1;f[0].width=f[0].height=g+2;var j=(f[0].style,f.get(0).getContext("2d"));j.clearRect(0,0,f[0].width,f[0].height);var k,l,m,n,o,p,q,r,s,t,u,v,w,x=0,y=0,z=function(){if(q=g,a.sizePalette){var c=b("size");if(0==y){s=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),v=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(s),t=s[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(s);u=new InteractiveDataDisplay.SizePaletteViewer(e),y=2
}else v.text(c);u.palette=InteractiveDataDisplay.SizePalette.Create(a.sizePalette)}r=q/2},A=function(){if(m=!1,a.individualColors&&a.colorPalette){var c=b("color");if(0==x){n=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),w=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(n),o=n[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(n);p=new InteractiveDataDisplay.ColorPaletteViewer(e),x=2}else w.text(c);p.palette=a.colorPalette,1==x&&(o.display="block",x=2)}else 2==x&&(o.display="none",x=1);a.individualColors?(l="#000000",k="#ffffff",m=!0):(k=a.color,l=k,null!=a.border&&(m=!0,l=a.border))},B=function(){InteractiveDataDisplay.BullEye.drawBullEye(j,a.bullEyeShape,h,i,q,q,"gray","gray")};A(),z(),B()},getTooltipData:function(a,b){var c={},d={};return InteractiveDataDisplay.Utils.isArray(a.x)&&b<a.x.length&&(d.x=new InteractiveDataDisplay.AdaptiveFormatter(a.x),c.x=d.x.toString(a.x[b])),InteractiveDataDisplay.Utils.isArray(a.y)&&b<a.y.length&&(d.y=new InteractiveDataDisplay.AdaptiveFormatter(a.y),c.y=d.y.toString(a.y[b])),a.color&&(c.color={},InteractiveDataDisplay.Utils.isArray(a.color.lower95)&&b<a.color.lower95.length&&(d.lower95=new InteractiveDataDisplay.AdaptiveFormatter(a.color.lower95),c.color["lower 95%"]=d.lower95.toString(a.color.lower95[b])),InteractiveDataDisplay.Utils.isArray(a.color.upper95)&&b<a.color.upper95.length&&(d.upper95=new InteractiveDataDisplay.AdaptiveFormatter(a.color.upper95),c.color["upper 95%"]=d.upper95.toString(a.color.upper95[b]))),InteractiveDataDisplay.Utils.isArray(a.size)&&b<a.size.length&&(d.size=new InteractiveDataDisplay.AdaptiveFormatter(a.size),c.size=d.size.toString(a.size[b])),c.index=b,c},renderSvg:function(a,b,c,d,e){var f=d.y.length;if(0!=f){for(var g,h,i=c.group(),j=e.dataToScreenX,k=e.dataToScreenY,l=b.width,m=b.height,n=0,o=d.size[0],p=.5*o,q=.5*p;n<f;n++){g=j(d.x[n]),h=k(d.y[n]),c1=g+p<0||g-p>l||h+p<0||h-p>m;var r=d.individualColors?d.upper95[n]:d.upper95,s=d.individualColors?d.lower95[n]:d.lower95;if(!c1)switch(d.bullEyeShape){case"box":i.rect(o,o).translate(g-p,h-p).fill(r).stroke({width:.5,color:"black"}),i.rect(p,p).translate(g-q,h-q).fill(s).stroke({width:.5,color:"black"});break;case"circle":i.circle(o).translate(g-p,h-p).fill(r).stroke({width:.5,color:"black"}),i.circle(p).translate(g-q,h-q).fill(s).stroke({width:.5,color:"black"});break;case"diamond":i.rect(o/Math.sqrt(2),o/Math.sqrt(2)).translate(g,h-p).fill(r).stroke({width:.5,color:"black"}).rotate(45),i.rect(p/Math.sqrt(2),p/Math.sqrt(2)).translate(g,h-q).fill(s).stroke({width:.5,color:"black"}).rotate(45);break;case"cross":var t=o/6,u=p/6;i.polyline([[-p,-t],[-t,-t],[-t,-p],[t,-p],[t,-t],[p,-t],[p,t],[t,t],[t,p],[-t,p],[-t,t],[-p,t],[-p,-t]]).translate(g,h).fill(r).stroke({width:.5,color:"black"}),i.polyline([[-q,-u],[-u,-u],[-u,-q],[u,-q],[u,-u],[q,-u],[q,u],[u,u],[u,q],[-u,q],[-u,u],[-q,u],[-q,-u]]).translate(g,h).fill(s).stroke({width:.5,color:"black"});break;case"triangle":var v=Math.sqrt(3)/6*o,w=Math.sqrt(3)/6*p;i.polyline([[-p,v],[0,2*-v],[p,v],[-p,v]]).translate(g,h).fill(r).stroke({width:.5,color:"black"}),i.polyline([[-q,w],[0,2*-w],[q,w],[-q,w]]).translate(g,h).fill(s).stroke({width:.5,color:"black"})}}i.clipWith(i.rect(l,m))}}},InteractiveDataDisplay.BoxWhisker={prepare:function(a){if(void 0==a.y.median||null==a.y.median)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.y.median))throw"The property 'y' must be an array of numbers";var b=a.y.median.length,c=new Int8Array(b);if(InteractiveDataDisplay.Utils.maskNaN(c,a.y.median),void 0==a.x)a.x=InteractiveDataDisplay.Utils.range(0,b-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(a.x.length!=b)throw"Length of the array which is a value of the property 'x' differs from lenght of 'y'";InteractiveDataDisplay.Utils.maskNaN(c,a.x)}void 0!=a.border&&"none"!=a.border||(a.border=null),void 0!=a.thickness&&"none"!=a.thickness||(a.thickness=2),void 0==a.color&&(a.color=InteractiveDataDisplay.Markers.defaults.color);var d=new Array(b);if(void 0==a.size&&(a.size=InteractiveDataDisplay.Markers.defaults.size),InteractiveDataDisplay.Utils.isArray(a.y.lower95)&&InteractiveDataDisplay.Utils.isArray(a.y.upper95)){if(a.y.lower95.length!=b&&a.y.upper95.length!=b)throw"Length of the array 'y' is different than length of the array 'y'";if(b>0&&"number"==typeof a.y.lower95[0]&&"number"==typeof a.y.upper95[0]){for(var e=[],f=[],g=0;g<b;g++){var h=a.y.upper95[g],i=a.y.lower95[g];h!=h||i!=i?c[g]=1:(e[g]=a.y.upper95[g],f[g]=a.y.lower95[g])}a.upper95=e,a.lower95=f}}if(InteractiveDataDisplay.Utils.isArray(a.y.lower68)&&InteractiveDataDisplay.Utils.isArray(a.y.upper68)){if(a.y.lower68.length!=b&&a.y.upper68.length!=b)throw"Length of the array 'y' is different than length of the array 'y'";if(b>0&&"number"==typeof a.y.lower68[0]&&"number"==typeof a.y.upper68[0]){for(var j=[],k=[],g=0;g<b;g++){var l=a.y.upper68[g],m=a.y.lower68[g];l!=l||m!=m?c[g]=1:(j[g]=a.y.upper68[g],k[g]=a.y.lower68[g])}a.upper68=j,a.lower68=k}}for(var g=0;g<b;g++)d[g]=a.size;a.sizeMax=a.size,a.size=d;for(var n=0,g=0;g<b;g++)1===c[g]&&n++;if(n>0){n=b-n,a.x=InteractiveDataDisplay.Utils.applyMask(c,a.x,n),a.y=InteractiveDataDisplay.Utils.applyMask(c,a.y.median,n),a.size=InteractiveDataDisplay.Utils.applyMask(c,a.size,n),a.upper95=InteractiveDataDisplay.Utils.applyMask(c,a.upper95,n),a.lower95=InteractiveDataDisplay.Utils.applyMask(c,a.lower95,n),a.upper68=InteractiveDataDisplay.Utils.applyMask(c,a.upper68,n),a.lower68=InteractiveDataDisplay.Utils.applyMask(c,a.lower68,n);for(var o=Array(n),g=0,p=0;g<b;g++)0===c[g]&&(o[p++]=g);a.indices=o}else a.y=a.y.median,a.indices=InteractiveDataDisplay.Utils.range(0,b-1)},preRender:function(a,b,c,d,e){return e.fillStyle=a.color,null!=a.border&&(e.strokeStyle=a.border),a},draw:function(a,b,c,d,e){var f=a.size,g=f/2,h=d.dataToScreenX(a.x),i=d.dataToScreenY(a.upper68),j=d.dataToScreenY(a.lower68),k=d.dataToScreenY(a.upper95),l=d.dataToScreenY(a.lower95),m=d.dataToScreenY(a.y);e.beginPath(),e.strokeStyle=void 0===a.border?"black":a.border,e.lineWidth=a.thickness,a.color&&e.fillRect(h-g,j,f,i-j),e.strokeRect(h-g,j,f,i-j),e.moveTo(h-g,k),e.lineTo(h+g,k),e.moveTo(h,k),e.lineTo(h,i),e.moveTo(h,j),e.lineTo(h,l),e.moveTo(h-g,l),e.lineTo(h+g,l),e.moveTo(h-g,m),e.lineTo(h+g,m),e.stroke(),void 0!==a.y_min&&(e.beginPath(),e.arc(h,d.dataToScreenY(a.y_min),g/2,0,2*Math.PI),e.stroke()),void 0!==a.y_max&&(e.beginPath(),e.arc(h,d.dataToScreenY(a.y_max),g/2,0,2*Math.PI),e.stroke())},hitTest:function(a,b,c,d){var e=b.dataToScreenX(a.x),f=b.dataToScreenY(void 0===a.y_min?a.lower95:a.y_min),g=b.dataToScreenY(void 0===a.y_max?a.upper95:a.y_max);return c.x>e-a.size/2&&c.x<e+a.size/2&&c.y>g&&c.y<f},getBoundingBox:function(a){var b=(a.size,a.x),c=a.lower95?a.lower95:a.lower68?a.lower68:a.y,d=a.upper95?a.upper95:a.upper68?a.upper68:a.y;return{x:b,y:c,width:0,height:Math.abs(d-c)}},getPadding:function(a){var b=0;return{left:b,right:b,top:b,bottom:b}},getLegend:function(a,b,c){var d=c.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"))),(isNaN(e)||0==e)&&(e=14);var f=c.thumbnail,g=1.5*e,h=g/2+1,i=g/2+1;f[0].width=f[0].height=g+2;var j,k,l,m,n,o,p,q,r,s,t,u,v,w=(f[0].style,f.get(0).getContext("2d")),x=0,y=0,z=function(){if(p=g,a.sizePalette){var c=b("size");if(0==y){r=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),u=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(r),s=r[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(r);t=new InteractiveDataDisplay.SizePaletteViewer(e),y=2}else u.text(c);t.palette=InteractiveDataDisplay.SizePalette.Create(a.sizePalette)}q=p/2},A=function(){if(l=!1,a.individualColors&&a.colorPalette){var c=b("color");if(0==x){m=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),v=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(m),n=m[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(m);o=new InteractiveDataDisplay.ColorPaletteViewer(e),x=2}else v.text(c);o.palette=a.colorPalette,1==x&&(n.display="block",x=2)}else 2==x&&(n.display="none",x=1);a.individualColors?(k="#000000",j="#ffffff",l=!0):(j=a.color,k=j,null!=a.border&&(l=!0,k=a.border))},B=function(){var b="string"==typeof a.color?a.color:"gray",c="string"==typeof a.border?a.border:"gray",d="none"!==c;w.strokeStyle=void 0!==c?c:"black",w.fillStyle=void 0!==b?b:"black";var e=.5*p,f=.5*e;w.clearRect(0,0,p,p),w.fillRect(h-e,i-f,p,e),d&&w.strokeRect(h-e,i-f,p,e),w.beginPath(),w.moveTo(h-e,i+e),w.lineTo(h+e,i+e),w.moveTo(h-e,i-e),w.lineTo(h+e,i-e),w.moveTo(h,i+e),w.lineTo(h,i+f),w.moveTo(h,i-e),w.lineTo(h,i-f),w.closePath(),d&&w.stroke(),d&&(w.beginPath(),w.moveTo(h-e,i),w.lineTo(h+e,i),w.stroke())};A(),z(),B()},getTooltipData:function(a,b){var c={},d={};return InteractiveDataDisplay.Utils.isArray(a.x)&&b<a.x.length&&(d.x=new InteractiveDataDisplay.AdaptiveFormatter(a.x),c.x=d.x.toString(a.x[b])),a.y&&(c.y={},InteractiveDataDisplay.Utils.isArray(a.y.median)&&b<a.y.median.length&&(d.median=new InteractiveDataDisplay.AdaptiveFormatter(a.y.median),c.y.median=d.median.toString(a.y.median[b])),InteractiveDataDisplay.Utils.isArray(a.y.lower95)&&b<a.y.lower95.length&&(d.lower95=new InteractiveDataDisplay.AdaptiveFormatter(a.y.lower95),c.y["lower 95%"]=d.lower95.toString(a.y.lower95[b])),InteractiveDataDisplay.Utils.isArray(a.y.upper95)&&b<a.y.upper95.length&&(d.upper95=new InteractiveDataDisplay.AdaptiveFormatter(a.y.upper95),c.y["upper 95%"]=d.upper95.toString(a.y.upper95[b])),InteractiveDataDisplay.Utils.isArray(a.y.lower68)&&b<a.y.lower68.length&&(d.lower68=new InteractiveDataDisplay.AdaptiveFormatter(a.y.lower68),c.y["lower 68%"]=d.lower68.toString(a.y.lower68[b])),InteractiveDataDisplay.Utils.isArray(a.y.upper68)&&b<a.y.upper68.length&&(d.upper68=new InteractiveDataDisplay.AdaptiveFormatter(a.y.upper68),c.y["upper 68%"]=d.upper68.toString(a.y.upper68[b]))),InteractiveDataDisplay.Utils.isArray(a.size)&&b<a.size.length&&(d.size=new InteractiveDataDisplay.AdaptiveFormatter(a.size),c.size=d.size.toString(a.size[b])),c.index=b,c},renderSvg:function(a,b,c,d,e){var f=d.y.length;if(0!=f){for(var g,h,i,j,k,l,m,n=c.group(),o=e.dataToScreenX,p=e.dataToScreenY,q=b.width,r=b.height,s=0,t=d.size[0],u=t/2,v=d.color,w=null==d.border?"none":d.border,x=d.thickness;s<f;s++)g=o(d.x[s]),h=p(d.y[s]),i=d.upper68?p(d.upper68[s]):void 0,j=d.lower68?p(d.lower68[s]):void 0,k=d.upper95?p(d.upper95[s]):void 0,l=d.lower95?p(d.lower95[s]):void 0,m=p(d.y[s]),c1=g<0||g>q||h<0||h>r,c1||(void 0!=k&&void 0!=l&&(n.polyline([[g-u,k],[g+u,k]]).style({fill:"none",stroke:w,"stroke-width":x}),n.polyline([[g,k],[g,l]]).style({fill:"none",stroke:w,"stroke-width":x}),n.polyline([[g-u,l],[g+u,l]]).style({fill:"none",stroke:w,"stroke-width":x})),void 0!=i&&void 0!=j&&n.rect(t,Math.abs(i-j)).translate(g-u,i).fill(v).style({fill:v,stroke:w,"stroke-width":x}),n.polyline([[g-u,m],[g+u,m]]).style({fill:"none",stroke:w,"stroke-width":x}));n.clipWith(n.rect(q,r))}}},InteractiveDataDisplay.Bars={prepare:function(a){var b,c;if("h"==a.orientation){if(void 0==a.x||null==a.x)throw"The mandatory property 'x' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(b=a.x.length,c=new Int8Array(b),InteractiveDataDisplay.Utils.maskNaN(c,a.x),void 0==a.y)a.y=InteractiveDataDisplay.Utils.range(0,b-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.y))throw"The property 'x' must be an array of numbers";if(a.y.length!=b)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";InteractiveDataDisplay.Utils.maskNaN(c,a.y)}}else{if(void 0==a.y||null==a.y)throw"The mandatory property 'y' is undefined or null";if(!InteractiveDataDisplay.Utils.isArray(a.y))throw"The property 'y' must be an array of numbers";if(b=a.y.length,c=new Int8Array(b),InteractiveDataDisplay.Utils.maskNaN(c,a.y),void 0==a.x)a.x=InteractiveDataDisplay.Utils.range(0,b-1);else{if(!InteractiveDataDisplay.Utils.isArray(a.x))throw"The property 'x' must be an array of numbers";if(a.x.length!=b)throw"Length of the array which is a value of the property 'x' differs from length of 'y'";InteractiveDataDisplay.Utils.maskNaN(c,a.x)}}if(void 0!=a.border&&"none"!=a.border||(a.border=null),void 0!=a.shadow&&"none"!=a.shadow||(a.shadow=null),void 0==a.color&&(a.color=InteractiveDataDisplay.Markers.defaults.color),InteractiveDataDisplay.Utils.isArray(a.color)){if(a.color.length!=b)throw"Length of the array 'color' is different than length of the array 'y'";if(b>0&&"string"!=typeof a.color[0]){var d=a.colorPalette;if(void 0==d&&(d=InteractiveDataDisplay.Markers.defaults.colorPalette),"string"==typeof d&&(d=new InteractiveDataDisplay.ColorPalette.parse(d)),void 0!=d&&d.isNormalized){var e=InteractiveDataDisplay.Utils.getMinMax(a.color);e=InteractiveDataDisplay.Utils.makeNonEqual(e),d=d.absolute(e.min,e.max)}a.colorPalette=d;for(var f=new Array(b),g=0;g<b;g++){var h=a.color[g];if(h!=h)c[g]=1;else{var i=d.getRgba(h);f[g]="rgba("+i.r+","+i.g+","+i.b+","+i.a+")"}}a.color=f}a.individualColors=!0}else a.individualColors=!1;for(var j=0,g=0;g<b;g++)1===c[g]&&j++;if(j>0){j=b-j,a.x=InteractiveDataDisplay.Utils.applyMask(c,a.x,j),a.y=InteractiveDataDisplay.Utils.applyMask(c,a.y,j),a.individualColors&&(a.color=InteractiveDataDisplay.Utils.applyMask(c,a.color,j));for(var k=Array(j),g=0,l=0;g<b;g++)0===c[g]&&(k[l++]=g);a.indices=k}else a.indices=InteractiveDataDisplay.Utils.range(0,b-1)},draw:function(a,b,c,d,e){var f,g,h,i,j,k;if("h"==a.orientation){if(f=d.dataToScreenX(0),g=d.dataToScreenX(a.x),f>g){var l=g;g=f,f=l}if(f>c.width||g<0)return;if(k=d.plotToScreenY(a.barWidth)-d.plotToScreenY(0),i=d.dataToScreenY(a.y)-k/2,(h=d.dataToScreenY(a.y)+k/2)>c.height||i<0)return}else{if(j=d.plotToScreenX(a.barWidth)-d.plotToScreenX(0),f=d.dataToScreenX(a.x)-j/2,g=d.dataToScreenX(a.x)+j/2,f>c.width||g<0)return;if(i=d.dataToScreenY(0),(h=d.dataToScreenY(a.y))>i){var l=i;i=h,h=l}if(h>c.height||i<0)return}a.shadow&&(e.fillStyle=a.shadow,e.fillRect(f+2,h+2,g-f,i-h)),e.fillStyle=a.color,e.fillRect(f,h,g-f,i-h),a.border&&(e.strokeStyle=a.border,e.strokeRect(f,h,g-f,i-h))},getPlotBoundingBox:function(a,b){var c,d,e,f,g=a.barWidth,h=b.dataToPlotX,i=b.dataToPlotY;return void 0===h&&(h=function(a){return a}),void 0===i&&(i=function(a){return a}),"h"==a.orientation?(c=h(Math.min(0,a.x)),d=i(a.y)-g/2,e=h(Math.abs(a.x)),f=g):(c=h(a.x)-g/2,d=i(Math.min(0,a.y)),e=g,f=i(Math.abs(a.y))),{x:c,y:d,width:e,height:f}},hitTest:function(a,b,c,d){var e=a.barWidth,f="h"==a.orientation?Math.min(0,a.x):a.x-e/2,g="h"==a.orientation?a.y-e/2:Math.min(0,a.y);return"h"==a.orientation?!(d.x<f||d.x>f+Math.abs(a.x))&&!(d.y<g||d.y>g+e):!(d.x<f||d.x>f+e)&&!(d.y<g||d.y>g+Math.abs(a.y))},getLegend:function(a,b,c){var d=c.content,e=14;document.defaultView&&document.defaultView.getComputedStyle&&(e=parseFloat(document.defaultView.getComputedStyle(d[0],null).getPropertyValue("font-size"))),(isNaN(e)||0==e)&&(e=14);var f=c.thumbnail,g=1.5*e,h=g/3-.5,i=g/3*2,j=g,k=g/2,l=0,m=g/3,n=1;f[0].width=f[0].height=g+2;var o,p,q,r,s,t,u,v,w,x=(f[0].style,f.get(0).getContext("2d")),y=0,z=function(){if(q=!1,s=!1,a.individualColors&&a.colorPalette){var c=b("color");if(0==y){t=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px'></div>").appendTo(d),w=$("<div class='idd-legend-item-property'></div>").text(c).appendTo(t),u=t[0].style;var e=$("<div style='width: 170px;'></div>").appendTo(t);v=new InteractiveDataDisplay.ColorPaletteViewer(e),y=2}else w.text(c);v.palette=a.colorPalette,1==y&&(u.display="block",y=2)}else 2==y&&(u.display="none",y=1);a.individualColors?(p="#000000",o="#ffffff",q=!0,r="grey",s=!0):(o=a.color,p=o,r="none",null!=a.border&&(q=!0,p=a.border),null!=a.shadow&&(s=!0,r=a.shadow))},A=function(){var b="string"==typeof a.color?a.color:"lightgray",c="string"==typeof a.border?a.border:"gray",d="string"==typeof a.shadow?a.shadow:"gray",e="none"!==c;x.clearRect(0,0,g,g),d&&(x.fillStyle=d,x.fillRect(0+n,k+n,h,g-k),h+=1,x.fillRect(h+n,l+n,i-h,g-l),i+=1,x.fillRect(i+n,m+n,j-i,g-m)),x.strokeStyle=void 0!==c?c:"black",x.fillStyle=void 0!==b?b:"black",x.fillStyle=b,x.fillRect(0,k,h,g-k),x.fillRect(h,l,i-h,g-l),x.fillRect(i,m,j-i,g-m),e&&(x.strokeStyle=c,x.strokeRect(0,k,h,g-k),x.strokeRect(h,l,i-h,g-l),x.strokeRect(i,m,j-i,g-m))};z(),A()},renderSvg:function(a,b,c,d,e){var f=d.y.length;if(0!=f){for(var g,h,i,j,k,l=c.group(),m=e.dataToScreenX,n=e.dataToScreenY,o=b.width,p=b.height,q=0,r=d.barWidth,s=r/2,t=null==d.border?"none":d.border,u=null==d.shadow?"none":d.shadow;q<f;q++){if("h"==d.orientation){if(g=m(0),h=m(d.x[q]),i=n(d.y[q]+s),j=n(d.y[q]-s),g>h){var v=h;h=g,g=v}}else if(g=m(d.x[q]-s),h=m(d.x[q]+s),i=n(d.y[q]),j=n(0),i>j){var v=j;j=i,i=v}k=d.individualColors?d.color[q]:d.color,c1=h<0||g>o||j<0||i>p,c1||(l.polyline([[g+2,j+2],[g+2,i+2],[h+2,i+2],[h+2,j+2],[g+2,j+2]]).fill(u),l.polyline([[g,j],[g,i],[h,i],[h,j],[g,j]]).fill(k).stroke({width:1,color:t}))}l.clipWith(l.rect(o,p))}},buildSvgLegendElements:function(a,b,c,d){var e=b.group(),f=b.group(),g=12,h=1.5*g,i=h/3-.5,j=h/3*2,k=h,l=h/2,m=0,n=h/3,o=1,p="none";c.individualColors?(border="#000000",color="lightgrey",p="grey"):(color=c.color,border="none",null!=c.border&&(border=c.border),null!=c.shadow&&(p=c.shadow)),e.polyline([[o,h+o],[o,l+o],[i+o,l+o],[i+o,h+o],[o,h+o]]).fill(p),e.polyline([[0,h],[0,l],[i,l],[i,h],[0,h]]).fill(color).stroke({width:.2,color:border}),i+=1,e.polyline([[i+o,h+o],[i+o,m+o],[j+o,m+o],[j+o,h+o],[i+o,h+o]]).fill(p),e.polyline([[i,h],[i,m],[j,m],[j,h],[i,h]]).fill(color).stroke({width:.2,color:border}),j+=1,e.polyline([[j+o,h+o],[j+o,n+o],[k+o,n+o],[k+o,h+o],[j+o,h+o]]).fill(p),e.polyline([[j,h],[j,n],[k,n],[k,h],[j,h]]).fill(color).stroke({width:.2,color:border});var q=a.legendDiv.children[1],r=c.individualColors&&c.colorPalette,s=q&&a.legendDiv.children[1].children[0]&&a.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(a.legendDiv.children[1].children[0].children[0],null):void 0,g=s?parseFloat(s.getPropertyValue("font-size")):void 0,t=s?s.getPropertyValue("font-family"):void 0,u=s?s.getPropertyValue("font-weight"):void 0;if(r){var v=d("color");f.text(v).font({family:t,size:g,weight:u});var w=b.group(),x=a.width,y=20;InteractiveDataDisplay.SvgColorPaletteViewer(w,c.colorPalette,a.legendDiv.children[1].children[0].children[1],{width:x,height:y}),w.translate(5,50),shiftsizePalette=50+y,a.height+=50+y}return b.front(),{thumbnail:e,content:f}}},InteractiveDataDisplay.Markers.shapes.boxwhisker=InteractiveDataDisplay.BoxWhisker,InteractiveDataDisplay.Markers.shapes.petals=InteractiveDataDisplay.Petal,InteractiveDataDisplay.Markers.shapes.bulleye=InteractiveDataDisplay.BullEye,InteractiveDataDisplay.Markers.shapes.bars=InteractiveDataDisplay.Bars,InteractiveDataDisplay.Area=function(a,b){var c="rgba(65, 105, 237, 0.4)",d=InteractiveDataDisplay.Utils.getDataSourceFunction(a,InteractiveDataDisplay.readCsv),e=d(a);this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b);var f,g,h,i=c;e&&(i=void 0!==e.fill?e.fill:c),this.draw=function(a){var b=a.y1;if(!b)throw"Data series y1 is undefined";var d=b.length,e=a.y2;if(!e)throw"Data series y2 is undefined";if(e.length!==d)throw"Data series y1 and y2 have different lengths";var j=a.x;if(j||(j=InteractiveDataDisplay.Utils.range(0,d-1)),j.length!==d)throw"Data series x and y1, y2 have different lengths";g=b,h=e,f=j,i=void 0!==a.fill?a.fill:c,this.invalidateLocalBounds(),this.requestNextFrameOrUpdate(),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var a=this.xDataTransform&&this.xDataTransform.dataToPlot,b=this.yDataTransform&&this.yDataTransform.dataToPlot,c=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(f,g,a,b),d=InteractiveDataDisplay.Utils.getBoundingBoxForArrays(f,h,a,b);return InteractiveDataDisplay.Utils.unionRects(c,d)},this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.getTooltip=function(a,b,c,d){if(void 0!==f&&void 0!=g&&void 0!=h){if(0!=g.length&&this.isVisible){var e=this.getContext(!1);if(void 0!==e){for(var i=this.getTransform(),j={x:i.dataToScreenX(a),y:i.dataToScreenY(b)},k=e.getImageData(j.x-1,j.y-1,3,3),l=0,m=0;m<k.data.length;m++)0===k.data[m]&&l++;if(l!==k.data.length){var n=$("<div></div>");return $("<div></div>").addClass("idd-tooltip-name").text(this.name||"area").appendTo(n),n}}}}},this.renderCore=function(a,b){InteractiveDataDisplay.Area.prototype.renderCore.call(this,a,b);var c=this.getContext(!0);InteractiveDataDisplay.Area.render.call(this,f,g,h,i,a,b,c)},this.renderCoreSvg=function(a,b,c){InteractiveDataDisplay.Area.renderSvg.call(this,a,b,c,f,g,h,i)};this.onDataTransformChanged=function(a){this.invalidateLocalBounds(),InteractiveDataDisplay.Area.prototype.onDataTransformChanged.call(this,a)},Object.defineProperty(this,"fill",{get:function(){return i},set:function(a){a!=i&&(i=a,this.fireAppearanceChanged("fill"),this.requestNextFrameOrUpdate())},configurable:!1}),this.getLegend=function(){var a=this,b=$("<canvas></canvas>");b[0].width=40,b[0].height=40;var c=b.get(0).getContext("2d");c.globalAlpha=1,c.strokeStyle=i,c.fillStyle=i,c.beginPath(),c.moveTo(0,0),c.lineTo(0,10),c.lineTo(30,40),c.lineTo(40,40),c.lineTo(40,30),c.lineTo(10,0),c.lineTo(0,0),c.fill(),c.stroke(),c.closePath();var d=$("<span></span>"),e=function(){d.text(a.name)};e(),this.host.bind("appearanceChanged",function(a,d){d&&"name"!=d||e(),c.clearRect(0,0,b[0].width,b[0].height),c.strokeStyle=i,c.fillStyle=i,c.beginPath(),c.moveTo(0,0),c.lineTo(0,10),c.lineTo(30,40),c.lineTo(40,40),c.lineTo(40,30),c.lineTo(10,0),c.lineTo(0,0),c.fill(),c.stroke(),c.closePath()});var a=this;return{name:d,legend:{thumbnail:b,content:void 0},onLegendRemove:function(){a.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(a,b){var c=this;a.height=30,b.add(b.rect(a.width,a.height).fill("white").opacity(.5));var d=InteractiveDataDisplay.ColorPalette.colorFromString(i),e="rgb("+d.r+","+d.g+","+d.b+")";b.add(b.polyline([[0,0],[0,4.5],[13.5,18],[18,18],[18,13.5],[4.5,0],[0,0]]).fill(e).opacity(d.a).translate(5,5));var f=window.getComputedStyle(a.legendDiv.children[0].children[1],null),g=parseFloat(f.getPropertyValue("font-size")),h=f.getPropertyValue("font-family"),j=f?f.getPropertyValue("font-weight"):void 0;b.add(b.text(c.name).font({family:h,size:g,weight:j}).translate(40,0)),b.front()},e&&e.x&&e.y1&&e.y2&&this.draw(e)},InteractiveDataDisplay.Area.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.Area.render=function(a,b,c,d,e,f,g){if(void 0!==a&&void 0!=b&&void 0!=c){var h=b.length;if(0!=h){var i=this.getTransform(),j=i.dataToScreenX,k=i.dataToScreenY;g.fillStyle=d;for(var l=[],m=void 0,n=0;n<h;n++)isNaN(a[n])||isNaN(b[n])||isNaN(c[n])?void 0===m?m=n:(l.push([m,n]),m=void 0):void 0===m?m=n:n===h-1&&(l.push([m,n]),m=void 0);for(var o=l.length,n=0;n<o;n++){g.beginPath();var p=l[n];g.moveTo(j(a[p[0]]),k(b[p[0]]));for(var q=p[0]+1;q<=p[1];q++)g.lineTo(j(a[q]),k(b[q]));for(var q=p[1];q>=p[0];q--)g.lineTo(j(a[q]),k(c[q]));g.fill()}}}},InteractiveDataDisplay.Area.renderSvg=function(a,b,c,d,e,f,g){if(void 0!==d&&void 0!=e&&void 0!=f){var h=e.length;if(0!=h){for(var i=this.getTransform(),j=i.dataToScreenX,k=i.dataToScreenY,l=c.group(),m=b.width,n=b.height,o=[],p=void 0,q=0;q<h;q++)isNaN(d[q])||isNaN(e[q])||isNaN(f[q])?void 0!==p&&(o.push([p,q-1]),p=void 0):void 0===p?p=q:q===h-1&&(o.push([p,q]),p=void 0);for(var r=[],s=o.length,t=InteractiveDataDisplay.ColorPalette.colorFromString(g),u="rgb("+t.r+","+t.g+","+t.b+")",q=0;q<s;q++){var v=o[q];r=[],r.push([j(d[v[0]]),k(e[v[0]])]);for(var w=v[0]+1;w<=v[1];w++)r.push([j(d[w]),k(e[w])]);for(var w=v[1];w>=v[0];w--)r.push([j(d[w]),k(f[w])]);r.push([j(d[v[0]]),k(e[v[0]])]),l.polyline(r).fill(u).opacity(t.a)}l.clipWith(l.rect(m,n))}}},InteractiveDataDisplay.heatmapBackgroundRenderer=void 0,InteractiveDataDisplay.Heatmap=function(a,b){var c=InteractiveDataDisplay.Utils.getDataSourceFunction(a,InteractiveDataDisplay.readCsv2d),d=c(a);if(d&&void 0!==d.y&&void 0!==d.values){var e=d.y,f=d.values,g=e.length,h=f.length;if(g>1&&h>0&&e[0]>e[1]){e.reverse();for(var i=0;i<g;i++)f[i].reverse()}}if(this.base=InteractiveDataDisplay.CanvasPlot,this.base(a,b),a){void 0==InteractiveDataDisplay.heatmapBackgroundRenderer&&(InteractiveDataDisplay.heatmapBackgroundRenderer=new InteractiveDataDisplay.SharedRenderWorker(function(){var a;if(void 0===InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64||/PhantomJS/.test(window.navigator.userAgent)||InteractiveDataDisplay.Utils.getIEVersion()>0)a=InteractiveDataDisplay.HeatmapworkerPath?InteractiveDataDisplay.HeatmapworkerPath+"idd.heatmapworker.js":"idd.heatmapworker.js";else{var b=new Blob([window.atob(InteractiveDataDisplay.heatmapBackgroundRendererCodeBase64)],{type:"text/javascript"});a=window.URL.createObjectURL(b)}return a}(),function(a,b){a.onRenderTaskCompleted(b)}));var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=function(a){if(a)try{z="string"==typeof a?InteractiveDataDisplay.ColorPalette.parse(a):a,B=InteractiveDataDisplay.ColorPalette.toArray(z,512)}catch(b){window.console&&console.error("Failed to initialize the palette")}},L=function(a){x=Math.min(1,Math.max(0,a))},M=document.createElement("canvas");L(d&&void 0!==d.opacity?parseFloat(d.opacity):1),K(d&&void 0!==d.colorPalette?d.colorPalette:InteractiveDataDisplay.palettes.grayscale);var N,O=function(a){var b=a.length;if(!(b<1)){var c=a[0].length;if(!(c<1)){var d,e;d=e=a[0][0];for(var f=0;f<b;f++)for(var g=a[f],h=0;h<c;h++){var i=g[h];i==i&&((i>e||isNaN(e))&&(e=i),(i<d||isNaN(d))&&(d=i))}return{min:d,max:e}}}},P=this,Q=function(a,b,c,d){if(!a||!b||!c)return{};if(!a.length||!b.length||c.v&&!c.v.length||c.m&&(!c.m.length||!c.lb68.length||!c.ub68.length))return{};a=Array.prototype.slice.call(a),b=Array.prototype.slice.call(b),c.v?c.v=Array.prototype.slice.call(c.v):c.m&&(c.m=Array.prototype.slice.call(c.m),c.lb68=Array.prototype.slice.call(c.lb68),c.ub68=Array.prototype.slice.call(c.ub68)),!c.v||a.length===b.length&&a.length===c.v.length&&b.length===c.v.length?!c.m||a.length===b.length&&a.length===c.m.length&&b.length===c.m.length&&c.m.length===c.lb68.length&&c.m.length===c.ub68.length||(a.length=b.length=c.m.length=c.lb68.length=c.ub68.length=Math.min(a.length,b.length,c.m.length,c.lb68.length,c.ub68.length)):a.length=b.length=c.v.length=Math.min(a.length,b.length,c.v.length);var e,f=a.map(function(a,b){return{v:a,i:b}}),g=b.map(function(a,b){return{v:a,i:b}}),h=f.sort(function(a,b){return a.v<b.v?-1:a.v>b.v?1:0}),i=g.sort(function(a,b){return a.v<b.v?-1:a.v>b.v?1:0}),j=h.filter(function(a,b){return!b||a.v!=h[b-1].v}).map(function(a){return a.v}),k=i.filter(function(a,b){return!b||a.v!=i[b-1].v}).map(function(a){return a.v}),l=[],m=[];e=0,h.forEach(function(a,b){return l[a.i]=b?a.v!=h[b-1].v?++e:e:0}),e=0,i.forEach(function(a,b){return m[a.i]=b?a.v!=i[b-1].v?++e:e:0});var n,o,p,q,r=function(a,b){for(var c=[],d=0;d<a;++d){c[d]=[];for(var e=0;e<b;++e)c[d][e]=NaN}return c};if(c.v)for(n=r(j.length,k.length),e=0;e<c.v.length;++e)n[l[e]][m[e]]=c.v[e];else for(o=r(j.length,k.length),p=r(j.length,k.length),q=r(j.length,k.length),e=0;e<c.m.length;++e)o[l[e]][m[e]]=c.m[e],p[l[e]][m[e]]=c.lb68[e],q[l[e]][m[e]]=c.ub68[e];if(d){if(j.length>=2){var s=[];s.push(j[0]-(j[1]-j[0])/2);var o;for(o=1;o<j.length;o++)s.push(j[o]-(j[o]-j[o-1])/2);s.push(j[j.length-1]+(j[j.length-1]-j[j.length-2])/2),j=s}if(k.length>=2){var t=[];t.push(k[0]-(k[1]-k[0])/2);var u;for(u=1;u<k.length;u++)t.push(k[u]-(k[u]-k[u-1])/2);t.push(k[k.length-1]+(k[k.length-1]-k[k.length-2])/2),k=t}}return{x:j,y:k,values:n,m:o,l68:p,u68:q}},R=function(){var a=O(m);q=a.min,r=a.max,s&&(q=Math.max(q,t),r=Math.max(r,t),v=InteractiveDataDisplay.Utils.log10(q),w=InteractiveDataDisplay.Utils.log10(r))};if(this.onRenderTaskCompleted=function(a){N=a,M.width===N.width&&M.height===N.height||(M.width=N.width,M.height=N.height),M.getContext("2d").putImageData(N.image,0,0),P.requestNextFrame()},this.draw=function(a,b){var c=a.values;if(!c)throw"Data series f is undefined";var d=void 0!==c.median&&!InteractiveDataDisplay.Utils.isArray(c.median[0])||!InteractiveDataDisplay.Utils.isArray(c[0]),e=a.x,f=a.y;if(void 0==D&&void 0==C&&(D=a.interval),C=a.interval,s=void 0!==a.logPalette&&a.logPalette,t=a.logTolerance?a.logTolerance:1e-12,c.median){if(void 0==E){var g=$("<div></div>").attr("data-idd-name","heatmap__nav_").appendTo(this.host);E=new InteractiveDataDisplay.Heatmap(g,this.master),E.getLegend=function(){},this.addChild(E),E.getTooltip=function(a,b,c,d){}}if(d){var h=Q(e,f,{v:void 0,m:c.median,lb68:c.lower68,ub68:c.upper68},"discrete"===a.treatAs);l=h.x,k=h.y,m=h.m,p=h.m,o=h.l68,n=h.u68,E.x=h.x,E.y=h.y,E.f_median=h.m,E.f_l68=h.l68,E.f_u68=h.u68}else l=e,k=f,m=c.median,p=c.median,o=c.lower68,n=c.upper68,E.x=h.x,E.y=h.y,E.f_median=c.median68,E.f_l68=c.lower68,E.f_u68=c.upper68;C&&V()}else if(E&&E.remove(),E=void 0,d){var h=Q(e,f,{v:c},"discrete"===a.treatAs);l=h.x,k=h.y,m=h.values}else m=c,l=e,k=f;if(s){u=new Array(m.length);for(var i=0;i<m.length;i++)for(var j=m[i],q=u[i]=new Float32Array(j.length),r=0;r<j.length;r++)q[r]=InteractiveDataDisplay.Utils.log10(j[r])}F=void 0,G=void 0,H=void 0,I=void 0;var v=p?p.length:m.length,w=p?p[0].length:m[0].length;if(l){if(l.length!=v&&l.length!=v+1)throw"Data series x must have length equal or one more than length of data series f by first dimension"}else l=InteractiveDataDisplay.Utils.range(0,v);if(k){if(k.length!=w&&k.length!=w+1)throw"Data series y must have length equal or one more than length of data series f by second dimension"}else k=InteractiveDataDisplay.Utils.range(0,w);if(l.length==v){if(k.length!=w)throw"Data series y must have length equal to length of data series f by second dimension";y="gradient"}else{if(k.length!=w+1)throw"Data series y must have length equal to one more than length of data series f by second dimension";y="matrix"}if(l.length<2)throw"Data series x must have at least 2 elements by each dimension";if(k.length<2)throw"Data series y must have at least 2 elements by each dimension";a&&void 0!==a.opacity&&L(parseFloat(a.opacity)),a&&void 0!==a.colorPalette&&K(a.colorPalette),z.isNormalized&&R(),A=!0;var x=this.invalidateLocalBounds(),B=this.getLocalBounds();InteractiveDataDisplay.Utils.equalRect(x,B)?this.requestNextFrame():this.requestNextFrameOrUpdate(),this.setTitles(b,!0),this.fireAppearanceChanged()},this.computeLocalBounds=function(){var a;if(l&&k){var b,c,d,e,f,g=l.length,h=k.length;for(f=0;f<g&&(b=l[f])!=b;f++);for(f=g;--f>=0&&(c=l[f])!=c;);for(f=0;f<h&&(d=k[f])!=d;f++);for(f=h;--f>=0&&(e=k[f])!=e;);var i=this.xDataTransform&&this.xDataTransform.dataToPlot,j=this.yDataTransform&&this.yDataTransform.dataToPlot;i&&(b=i(b),c=i(c)),j&&(d=j(d),e=j(e)),a={x:Math.min(b,c),y:Math.min(d,e),width:Math.abs(c-b),height:Math.abs(e-d)}}return a},"undefined"==typeof Modernizr||!a||Modernizr.webworkers&&Modernizr.postmessage){var S=void 0,T=void 0;this.renderCore=function(a,c){InteractiveDataDisplay.Heatmap.prototype.renderCore.call(this,a,c);var d=this.getContext(!0);if(void 0!=l&&void 0!=k&&void 0!=m){var e=this.coordinateTransform,f=e.plotToScreenX,g=e.plotToScreenY,h=this.getLocalBounds(),i=InteractiveDataDisplay.Utils.intersect(h,a);if(i){var n=!0;if(void 0!==b.mapControl){var o=h.x,p=h.x+h.width/2,t=h.x+h.width;if(void 0===S){var y=120,C={fillColor:new Microsoft.Maps.Color(y,y,y,y),strokeColor:new Microsoft.Maps.Color(y,y,y,y),strokeThickness:0}
;S=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),o),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),o)],C),T=new Microsoft.Maps.Polygon([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),t),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),t),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),p)],C),b.mapControl.entities.push(S),b.mapControl.entities.push(T)}A&&(S.setLocations([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),o),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),o)]),T.setLocations([new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),p),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y),t),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),t),new Microsoft.Maps.Location(InteractiveDataDisplay.mercatorTransform.plotToData(h.y+h.height),p)])),n=!b.isInAnimation,S.setOptions({visible:b.isInAnimation}),T.setOptions({visible:b.isInAnimation})}if(n){var D={left:Math.floor(f(i.x)),width:Math.ceil(e.plotToScreenWidth(i.width)),top:Math.floor(g(i.y+i.height)),height:Math.ceil(e.plotToScreenHeight(i.height))},E=e.getScale(),F=e.getOffset();if(d.fillStyle="rgba(200,200,200,0.3)",d.fillRect(D.left,D.top,D.width,D.height),N){if(InteractiveDataDisplay.Utils.intersect(N.plotRect,a)){var G,H=f(N.plotRect.x),I=g(N.plotRect.y+N.plotRect.height);if(1!=x&&(G=d.globalAlpha,d.globalAlpha=x),E.x!=N.scaleX||E.y!=N.scaleY){var J=E.x/N.scaleX,K=E.y/N.scaleY;d.drawImage(M,0,0,N.image.width,N.image.height,H,I,J*N.image.width,K*N.image.height)}else d.drawImage(M,H,I);1!=x&&(d.globalAlpha=G)}}if(A||!this.master.isInAnimation&&(!N||N.scaleX!=E.x||N.scaleY!=E.y||!InteractiveDataDisplay.Utils.includes(N.plotRect,i))){j&&j.width===D.width&&j.height===D.height||(j=d.createImageData(D.width,D.height));var L={image:j,width:j.width,height:j.height,x:l,y:k,f:s?u:m,fmin:s?v:q,fmax:s?w:r,plotRect:i,scaleX:E.x,scaleY:E.y,offsetX:F.x-D.left,offsetY:F.y-D.top,palette:{isNormalized:z.isNormalized,range:z.range,points:z.points,colors:B},xDataTransform:this.xDataTransform&&this.xDataTransform.type,yDataTransform:this.yDataTransform&&this.yDataTransform.type};InteractiveDataDisplay.heatmapBackgroundRenderer.enqueue(L,this),A=!1}}}}},this.renderCoreSvg=function(a,b,c){var d=c.group();if(void 0!=l&&void 0!=k&&void 0!=m){var e=(b.width,b.height,this.coordinateTransform),f=e.plotToScreenX,g=e.plotToScreenY,h=this.getLocalBounds(),i=InteractiveDataDisplay.Utils.intersect(h,a);if(i){var n={left:Math.floor(f(i.x)),width:Math.ceil(e.plotToScreenWidth(i.width)),top:Math.floor(g(i.y+i.height)),height:Math.ceil(e.plotToScreenHeight(i.height))},o=M.toDataURL("image/png");d.image(o,j.width,j.height).opacity(x).clipWith(d.rect(n.width,n.height)),d.translate(n.left,n.top)}}},this.onIsRenderedChanged=function(){this.isRendered||InteractiveDataDisplay.heatmapBackgroundRenderer.cancelPending(this)},this.onDataTransformChanged=function(a){this.invalidateLocalBounds(),InteractiveDataDisplay.Heatmap.prototype.onDataTransformChanged.call(this,a)};var U=function(a,b){var c=l.length,d=k.length;if(0!=c&&0!=d&&!(a<l[0]||b<k[0]||a>l[c-1]||b>k[d-1])){var e;for(e=1;e<c;e++)if(a<=l[e]){if(isNaN(l[e-1]))return NaN;break}var f;for(f=1;f<d;f++)if(b<=k[f]){if(isNaN(k[f-1]))return NaN;break}return e>=c||f>=d?NaN:{iLeft:e-1,jBottom:f-1}}};this.getValue=function(a,b,c){var d=l.length,e=k.length;if(0==d||0==e)return null;var f=U(a,b);if(void 0==f)return null;if(f!=f)return"<div>"+(this.name||"heatmap")+": (unknown value)</div>";var g;if("gradient"===y){var h,i,j,m;if(i=c[f.iLeft][f.jBottom+1],h=c[f.iLeft][f.jBottom],j=c[f.iLeft+1][f.jBottom+1],m=c[f.iLeft+1][f.jBottom],isNaN(i)||isNaN(h)||isNaN(j)||isNaN(m))g=NaN;else{var n=k[f.jBottom],o=k[f.jBottom+1],p=(i-h)/(o-n),q=(j-m)/(o-n),r=p*(b-n)+h,s=q*(b-n)+m,t=l[f.iLeft];g=(s-r)/(l[f.iLeft+1]-t)*(a-t)+r}}else g=c[f.iLeft][f.jBottom];return g};var V=function(){for(var a=E.f_median,b=new Array(a.length),c=0;c<a.length;c++){var d=a[c];b[c]=new Array(d.length);for(var e=0;e<d.length;e++)b[c][e]=E.f_l68[c][e]<C.max&&E.f_u68[c][e]>C.min?0:1}E.draw({x:E.x,y:E.y,values:b,opacity:.5,colorPalette:InteractiveDataDisplay.ColorPalette.parse("0=#00000000=#00000080=1")}),E.isVisible=!0};this.getTooltip=function(a,b,c,d,e){if(void 0!==m){var f=this;if(this.isVisible&&!this.IsErrorVisible){var g={x:a,y:b};if(void 0===n||void 0===o||void 0===p){var h=O(m);F=InteractiveDataDisplay.AdaptiveFormatter(h.min,h.max);var i=$("<div></div>");$("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(i);var j=this.getValue(g.x,g.y,m,y);if(null==j)return;var k=this.getTitle("values");return $("<div>"+k+": "+F.toString(j)+"</div>").appendTo(i),i}var h=O(p);G=InteractiveDataDisplay.AdaptiveFormatter(h.min,h.max),h=O(o),H=InteractiveDataDisplay.AdaptiveFormatter(h.min,h.max),h=O(n),I=InteractiveDataDisplay.AdaptiveFormatter(h.min,h.max);var i=$("<div></div>");$("<div></div>").addClass("idd-tooltip-name").text(this.name||"heatmap").appendTo(i);var l=this.getValue(g.x,g.y,o),q=this.getValue(g.x,g.y,n),r=this.getValue(g.x,g.y,p);if(null!=l&&null!=q&&null!=r){var k=this.getTitle("values"),s=$("<div></div>").addClass("idd-tooltip-compositevalue");s.append($("<div>median: "+G.toString(r)+"</div>")),s.append($("<div>lower 68%: "+H.toString(l)+"</div>")),s.append($("<div>upper 68%: "+I.toString(q)+"</div>"));var t=$("<div></div>");t.append($("<div>"+k+":</div>")).append(s),t.appendTo(i);var u=$("<div></div>").css("display","inline-block").appendTo(i),v=$("<div></div>").addClass("checkButton").appendTo(u);return C&&(e?C!=D?(C={min:l,max:q},$(".checkButton").removeClass("checkButton-checked"),v.addClass("checkButton-checked"),this.fireAppearanceChanged("interval")):$(".checkButton").removeClass("checkButton-checked"):($(".checkButton").removeClass("checkButton-checked"),v.addClass("checkButton-checked")),V()),v.click(function(){v.hasClass("checkButton-checked")?(v.removeClass("checkButton-checked"),D?(C=D,V()):(C=void 0,E.isVisible=!1)):($(".checkButton").removeClass("checkButton-checked"),v.addClass("checkButton-checked"),C={min:l,max:q},V()),f.fireAppearanceChanged("interval")}),$($("<span style='margin-left:3px;'>highlight similar</span>")).appendTo(u),i}}}},Object.defineProperty(this,"palette",{get:function(){return z},set:function(a){if(a!=z){if(!a)throw"Heatmap palette is undefined";z&&a.isNormalized&&!z.isNormalized&&m&&R(),K(a),N=void 0,this.fireAppearanceChanged("palette"),this.requestNextFrame()}},configurable:!1}),Object.defineProperty(this,"opacity",{get:function(){return x},set:function(a){if(!a)throw"Heatmap opacity is undefined";a!=x&&(L(a),this.fireAppearanceChanged("opacity"),this.requestNextFrame())},configurable:!1}),Object.defineProperty(this,"mode",{get:function(){return y},configurable:!1}),this.getLegend=function(){var a=$("<canvas></canvas>"),b=$("<div></div>"),c=this,d=$("<span></span>"),e=function(){d.text(c.name)};e();var f,g,h,i=0;g=$("<div class='idd-legend-item-palette'></div>").appendTo(b);var j,k,l=function(){j=c.getTitle("values"),0==i?(g.empty(),k=$("<div class='idd-legend-item-property'></div>").text(j).appendTo(g),h=$("<div style='width: 170px; margin-top: 5px; margin-bottom: 5px;'></div>").appendTo(g),f=new InteractiveDataDisplay.ColorPaletteViewer(h,z,{logAxis:s}),i=2):k.text(j),z&&z.isNormalized&&(f.dataRange={min:q,max:r})};l();var m,n=function(){void 0==C&&m?m.empty():C&&(J=InteractiveDataDisplay.AdaptiveFormatter(C.min,C.max),m?m.text("highlighted interval: "+J.toString(C.min)+", "+J.toString(C.max)):m=$("<div style='font-size:14px;'>highlighted interval: "+J.toString(C.min)+", "+J.toString(C.max)+"</div>").appendTo(b))};return n(),this.host.bind("appearanceChanged",function(a,b){b&&"name"!=b||e(),b&&"interval"!=b||n(),b&&"values"!=b&&"colorPalette"!=b||(i=0,l()),b&&"palette"!=b||(f.palette=z);var c=f.dataRange;z&&z.isNormalized&&(void 0==c||c.min!=q||c.max!=r)&&(f.dataRange={min:q,max:r})}),{name:d,legend:{thumbnail:a,content:b},onLegendRemove:function(){c.host.unbind("appearanceChanged")}}},this.buildSvgLegend=function(a,b){var c=this;a.height=30,b.add(b.rect(a.width,a.height).fill("white").opacity(.5));var d=window.getComputedStyle(a.legendDiv.children[0].children[1],null),e=parseFloat(d.getPropertyValue("font-size")),f=d.getPropertyValue("font-family"),g=d?d.getPropertyValue("font-weight"):void 0;b.add(b.text(c.name).font({family:f,size:e,weight:g}).translate(40,0));var h=a.legendDiv.children[1];d=h&&a.legendDiv.children[1].children[0]&&a.legendDiv.children[1].children[0].children[0]?window.getComputedStyle(a.legendDiv.children[1].children[0].children[0],null):void 0,e=d?parseFloat(d.getPropertyValue("font-size")):void 0,f=d?d.getPropertyValue("font-family"):void 0,g=d?d.getPropertyValue("font-weight"):void 0;var i=b.group(),j=c.getTitle("values");i.text(j).font({family:f,size:e,weight:g}),i.translate(5,30);var k=b.group(),l=a.width,m=20;if(InteractiveDataDisplay.SvgColorPaletteViewer(k,z,a.legendDiv.children[1].children[0].children[1],{width:l,height:m}),k.translate(5,50),a.height+=50+m,C){d=h&&a.legendDiv.children[1].children[1]&&a.legendDiv.children[1].children[1]?window.getComputedStyle(a.legendDiv.children[1].children[1],null):void 0,e=d?parseFloat(d.getPropertyValue("font-size")):void 0,f=d?d.getPropertyValue("font-family"):void 0,g=d?d.getPropertyValue("font-weight"):void 0;var n=b.group(),o=$(a.legendDiv.children[1].children[1]).text();n.add(n.text(o).font({family:f,size:e,weight:g}));var l=a.width,m=25;n.translate(5,100),a.height+=50+m}b.front()},d&&void 0!==d.values&&this.draw(d)}else{var W=a[0].parentElement;if(W){for(var X=!1,i=0;i<W.childNodes.length;i++)if($(W.childNodes[i]).hasClass("nowebworkers")){X=!0;break}a[0].removeAttribute("data-idd-plot"),a[0].innerText="",X?a[0].innerText="":(a[0].innerText=" Heatmap cannot be rendered: browser does not support web workers.",a.addClass("nowebworkers"))}}}},InteractiveDataDisplay.Heatmap.prototype=new InteractiveDataDisplay.CanvasPlot,InteractiveDataDisplay.register("heatmap",function(a,b){return new InteractiveDataDisplay.Heatmap(a,b)}),InteractiveDataDisplay.NavigationPanel=function(a,b,c){var d=37,e=38,f=39,g=40,h=107,i=109,j=189,k=187;if(b.attr("tabindex","0"),b.addClass("idd-navigation-container"),a.legend){var l=$("<div></div>").appendTo(b);a.legend.isVisible?l.addClass("idd-onscreennavigation-showlegend"):l.addClass("idd-onscreennavigation-hidelegend"),l.click(function(){a.legend.isVisible?(a.legend.isVisible=!1,l.removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(a.legend.isVisible=!0,l.removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend"))})}var m;c?(m=$('<a style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(b),m.attr("href",c)):m=$('<a href="https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines" style="display:block" target="_blank"></div>').addClass("idd-onscreennavigation-help").appendTo(b);var n=$("<div></div>").addClass("idd-onscreennavigation-exportsvg").appendTo(b),o=$("<div></div>").addClass("idd-onscreennavigation-navigationlockpressed").appendTo(b),p=$("<div style='overflow: hidden; height: 0px'></div>").appendTo(b),q=$("<div></div>").addClass("idd-onscreennavigation-panner").appendTo(p),r=$("<div></div>").addClass("idd-onscreennavigation-zoomin").appendTo(p),s=$("<div></div>").addClass("idd-onscreennavigation-zoomout").appendTo(p),t=$("<div></div>").addClass("idd-onscreennavigation-fit").appendTo(p),u=$("<div></div>").addClass("idd-onscreennavigation-logscale").appendTo(p),v=void 0,w=Rx.Observable.create(function(a){return v=a,function(){v=void 0}});n.click(function(){try{var b=(new Blob,a.exportToSvg()),c=new Blob([b.svg()]);saveAs(c,"chart.svg")}catch(d){throw d.message}});var x=function(a){var b=void 0,c=function(c){if(c!==b){switch(c){case 0:a.xDataTransform=void 0,a.yDataTransform=void 0;break;case 1:a.xDataTransform=InteractiveDataDisplay.logTransform,a.yDataTransform=void 0;break;case 2:a.xDataTransform=void 0,a.yDataTransform=InteractiveDataDisplay.logTransform;break;case 3:a.xDataTransform=InteractiveDataDisplay.logTransform,a.yDataTransform=InteractiveDataDisplay.logTransform}b=c}};this.switch=function(){if(!a.mapControl){var b=(1+((a.xDataTransform?1:0)|(a.yDataTransform?2:0)))%4;return c(b),a.isAutoFitEnabled=!0,b}}},y=new x(a);u.click(function(b){var c=y.switch(),d=a.navigation.gestureSource;a.navigation.gestureSource=d?w.merge(d):w,$(this).trigger("axisChanged",[c])});var z=void 0;z=void 0!==a.navigation.gestureSource?w.merge(a.navigation.gestureSource):w,a.navigation.gestureSource=z;var A=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.PanGesture(10,0,"Mouse"))},B=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.PanGesture(-10,0,"Mouse"))},C=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.PanGesture(0,10,"Mouse"))},D=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.PanGesture(0,-10,"Mouse"))},E=function(){return void 0===a.mapControl?InteractiveDataDisplay.Gestures.zoomLevelFactor:3},F=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.ZoomGesture(a.centralPart.width()/2,a.centralPart.height()/2,1/E(),"Mouse"))},G=function(){v&&v.onNext(new InteractiveDataDisplay.Gestures.ZoomGesture(a.centralPart.width()/2,a.centralPart.height()/2,E(),"Mouse"))},H=a.navigation.gestureSource;a.navigation.gestureSource=void 0,o.click(function(){void 0!==a.navigation.gestureSource?(a.navigation.gestureSource=void 0,o.removeClass("idd-onscreennavigation-navigationlock").addClass("idd-onscreennavigation-navigationlockpressed"),p.animate({height:0},200)):(a.navigation.gestureSource=H,o.removeClass("idd-onscreennavigation-navigationlockpressed").addClass("idd-onscreennavigation-navigationlock"),p.animate({height:225},200)),$(this).trigger("classChanged")}),s.dblclick(function(a){a.stopPropagation()}),s.click(function(a){a.stopPropagation(),G()}),r.dblclick(function(a){a.stopPropagation()}),r.click(function(a){a.stopPropagation(),F()}),a.isAutoFitEnabled&&t.attr("class","idd-onscreennavigation-fit-pressed"),t.click(function(){a.isAutoFitEnabled=!a.isAutoFitEnabled}),a.host.on("isAutoFitEnabledChanged",function(){a.isAutoFitEnabled?t.attr("class","idd-onscreennavigation-fit-pressed"):t.attr("class","idd-onscreennavigation-fit")}),b.keydown(function(a){var b=a.which;b==d?(A(),a.preventDefault()):b==e?(C(),a.preventDefault()):b==f?(B(),a.preventDefault()):b==g?(D(),a.preventDefault()):b==h||b==k?(F(),a.preventDefault()):b!=i&&b!=j||(G(),a.preventDefault())});var I,J={x:0,y:0};q.mousedown(function(a){var b=q.offset(),c=q.outerWidth()/2;J.x=(a.pageX-b.left-c)/c,J.y=(a.pageY-b.top-c)/c,J.x*J.x+J.y*J.y>1||($(document).on("mousemove",K),q.removeClass("idd-onscreennavigation-panner").addClass("idd-onscreennavigation-panner-moved"),I=setInterval(function(){v.onNext(new InteractiveDataDisplay.Gestures.PanGesture(-10*J.x,-10*J.y,"Mouse"))},25))}),$(document).mouseup(function(){$(document).off("mousemove",K),I&&clearInterval(I),q.removeClass("idd-onscreennavigation-panner-moved").addClass("idd-onscreennavigation-panner")});var K=function(a){var b=q.offset(),c=q.outerWidth()/2;J.x=(a.pageX-b.left-c)/c,J.y=(a.pageY-b.top-c)/c};this.remove=function(){a.navigation.gestureSource=H,b.removeClass("idd-navigation-container"),b[0].innerHTML=""}},InteractiveDataDisplay.BingMaps=InteractiveDataDisplay.BingMaps||{},InteractiveDataDisplay.BingMaps.ESRI=InteractiveDataDisplay.BingMaps.ESRI||{},InteractiveDataDisplay.BingMaps.ESRI.GetWorldTopo=function(){function a(a){return"http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetDeLorme=function(){function a(a){return"http://server.arcgisonline.com/ArcGIS/rest/services/Specialty/DeLorme_World_Base_Map/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldImagery=function(){function a(a){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetOceanBasemap=function(){function a(a){return"http://services.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetNationalGeographicMap=function(){function a(a){return"http://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldShadedRelief=function(){function a(a){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.ESRI.GetWorldTerrainBase=function(){function a(a){return"http://services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/"+a.levelOfDetail+"/"+a.y+"/"+a.x}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMaps.OpenStreetMap=InteractiveDataDisplay.BingMaps.OpenStreet||{},InteractiveDataDisplay.BingMaps.OpenStreetMap.GetTileSource=function(){function a(a){return"http://tile.openstreetmap.org/"+a.levelOfDetail+"/"+a.x+"/"+a.y+".png"}return new Microsoft.Maps.TileSource({uriConstructor:a})},InteractiveDataDisplay.BingMapsPlot=function(a,b){if(a){var c=$('<div style="position: absolute"></div>').prependTo(a);this.base=InteractiveDataDisplay.Plot,this.base(a,b);var d=this;if("undefined"==typeof Microsoft)$("<p></p>").css("margin",15).css("word-wrap","break-word").text("BingMaps script is unavailable. Check your internet connection.").appendTo(a);else{var e=void 0,f=void 0;0===d.children.length&&(e=$('<div style="position: absolute;"></div>').appendTo(a),e.css("z-index",InteractiveDataDisplay.ZIndexNavigationLayer),f=$("<canvas></canvas>").appendTo(e));this.mapKey=a.attr("data-idd-mapKey");var g=new Microsoft.Maps.Map(c[0],{credentials:d.mapKey,mapTypeId:Microsoft.Maps.MapTypeId.aerial,enableClickableLogo:!1,enableSearchLogo:!1,showCopyright:!1,showDashboard:!1,showLogo:!1,disablePanning:!0,disableZooming:!0,width:a.width(),height:a.height()});Object.defineProperty(this,"map",{get:function(){return g},configurable:!1});var h=new InteractiveDataDisplay.BingMapsAnimation(g);this.arrange=function(a){InteractiveDataDisplay.BingMapsPlot.prototype.arrange.call(this,a),g.width=a.width,g.height=a.height},this.setMap=function(a){if(g.setMapType(Microsoft.Maps.MapTypeId.mercator),g.entities.clear(),a)if(a instanceof Microsoft.Maps.TileSource){var b=new Microsoft.Maps.TileLayer({mercator:a,opacity:1});g.entities.push(b)}else g.setMapType(a)},this.constraint=function(a,b,c){if(!0===c){var d=g.getWidth(),e=g.getHeight();return d<=1||e<=1?a:(h.setMapView(a,b),mapRect=InteractiveDataDisplay.Utils.getPlotRectForMap(g),mapRect)}return a},this.arrange=function(a){InteractiveDataDisplay.CanvasPlot.prototype.arrange.call(this,a),void 0!==e&&(e.width(a.width),e.height(a.height),f[0].width=a.width,f[0].height=a.height)},h.constraint=this.constraint,d.navigation.animation=h,this.selfMapRefresh()}}},InteractiveDataDisplay.BingMapsPlot.prototype=new InteractiveDataDisplay.Plot;var InteractiveDataDisplay;!function(a){function b(){function b(a,b){for(var e=0;e<d.length;++e)d[e](c,a,b)}var c=this,d=[];this.subscribe=function(a){return d.push(a),function(){var b=d.indexOf(a);b>=0&&d.splice(b,1)}};var e=function(a){return null!=a&&void 0!=a&&"undefined"!=a},f=sessionStorage.getItem("plotRect"),g=e(f)?JSON.parse(f):void 0;Object.defineProperty(this,"plotRect",{get:function(){return g},set:function(a){a!=g&&(g=a,sessionStorage.setItem("plotRect",JSON.stringify(g)),b("plotRect"))},configurable:!1,enumerable:!0});var h=sessionStorage.getItem("isAutoFit"),i=!e(h)||JSON.parse(h);Object.defineProperty(this,"isAutoFit",{get:function(){return i},set:function(a){a!=i&&(i=a,sessionStorage.setItem("isAutoFit",JSON.stringify(i)),b("isAutoFit"))},configurable:!1,enumerable:!0});var j=sessionStorage.getItem("selectedPlots"),k=e(j)?JSON.parse(j):[];Object.defineProperty(this,"selectedPlots",{get:function(){return k},set:function(a){a!=k&&(k=a,sessionStorage.setItem("selectedPlots",JSON.stringify(k)),b("selectedPlots"))},configurable:!1,enumerable:!0});var l=sessionStorage.getItem("probes"),m=e(l)?new a.ProbesVM(JSON.parse(l)):new a.ProbesVM(void 0);m.subscribe(function(a){sessionStorage.setItem("probes",JSON.stringify(m.getProbes())),b("probes")}),Object.defineProperty(this,"probesViewModel",{get:function(){return m},configurable:!1,enumerable:!0});var n=sessionStorage.getItem("isLegendShown"),o=!!e(n)&&JSON.parse(n);Object.defineProperty(this,"isLegendShown",{get:function(){return o},set:function(a){a!=o&&(o=a,sessionStorage.setItem("isLegendShown",JSON.stringify(o)),b("isLegendShown"))},configurable:!1,enumerable:!0});var p=sessionStorage.getItem("isNavigationPanelOpen"),q=!!e(p)&&JSON.parse(p);Object.defineProperty(this,"isNavigationPanelOpen",{get:function(){return q},set:function(a){a!=q&&(q=a,sessionStorage.setItem("isNavigationPanelOpen",JSON.stringify(q)),b("isNavigationPanelOpen"))},configurable:!1,enumerable:!0});var r=sessionStorage.getItem("isLogAxis"),s=e(r)?JSON.parse(r):0;Object.defineProperty(this,"isLogAxis",{get:function(){return s},set:function(a){a!=s&&(s=a,sessionStorage.setItem("isLogAxis",JSON.stringify(s)),b("isLogAxis"))},configurable:!1,enumerable:!0});var t=sessionStorage.getItem("mapType"),u=e(t)?JSON.parse(t):void 0;Object.defineProperty(this,"mapType",{get:function(){return u},set:function(a){a!=u&&(u=a,sessionStorage.setItem("mapType",JSON.stringify(u)),b("mapType"))},configurable:!1,enumerable:!0});var v=sessionStorage.getItem("xDataTransform"),w=e(v)?JSON.parse(v):void 0;Object.defineProperty(this,"xDataTransform",{get:function(){return w},set:function(a){a!=w&&(w=a,sessionStorage.setItem("xDataTransform",JSON.stringify(w)),b("xDataTransform"))},configurable:!1,enumerable:!0});var x=sessionStorage.getItem("yDataTransform"),y=e(x)?JSON.parse(x):void 0;Object.defineProperty(this,"yDataTransform",{get:function(){return y},set:function(a){a!=y&&(y=a,sessionStorage.setItem("yDataTransform",JSON.stringify(y)),b("yDataTransform"))},configurable:!1,enumerable:!0});var z={};Object.defineProperty(this,"uncertaintyRange",{get:function(){return z},set:function(a){a!=z&&(z=a,b("uncertaintyRange"))},configurable:!1,enumerable:!0})}function c(){function b(a,b){for(var e=0;e<d.length;++e)d[e](c,a,b)}var c=this,d=[];this.subscribe=function(a){d.push(a)},this.unsubscribe=function(a){d=d.filter(function(b){return b!==a})};var e={};Object.defineProperty(this,"ranges",{get:function(){return e},configurable:!1,enumerable:!0});var f=new a.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotXFormatter",{get:function(){return f},set:function(a){a!=f&&(f=a,b("plotXFormatter"))},configurable:!1,enumerable:!0});var g=new a.AdaptiveFormatter(0,1);Object.defineProperty(this,"plotYFormatter",{get:function(){return g},set:function(a){a!=g&&(g=a,b("plotYFormatter"))},configurable:!1,enumerable:!0}),this.setRangesForPlot=function(a,c){e[a]=c,b("ranges",{id:a})}}a.PersistentViewState=b,a.TransientViewState=c}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){a.PlotRegistry={}}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){function b(a,b,c,d){a.empty();var e=void 0!==d?d:1,f=$("<canvas width='"+40*e+"' height='"+40*e+"'></canvas>").appendTo(a),g=f.get(0).getContext("2d");g.globalAlpha=.9;var h=new Image;h.onload=function(){if(g.drawImage(h,0,0,40*e,40*e),void 0!==b){g.fillStyle="white";var a=(b<10?14:11)*e;g.font=a+"px Arial";var c=(b<10?16:13)*e;g.fillText(b,c,20*e)}},h.src=c?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAApdJREFUaEPtWc1KW0EUDrjL+9RVN2ZVNC1SaBdREewmYkW00NI+QVEkxJ+2/iBq1KX2CVrJM3Tj1ifIG9yebzhnvFxO4iR3Zm4C94Nvk8yc7zs/czOXVEower3eFLHqyCneVjxghk11iYkjsbbYRCDOJqzxfw+Pyf5NdyCxRtbz3viJQJDFrfG9624yv36STC8eDiTWYK2SSJwkIMSCxkSrc5/MrOyrZgextnKQtK/u04mETwICLGSEl75equaG4fK3TpwkEJgFjGB97ZdqaBS++XgcNgkE5MDezQuDJkHB8KQwAj7Gph8z41Rl+XxAJYim+jiwmrBP4mBzAn66QEFs9Ud52gzL2ocDf11ABYim+nh2a4IhCC1OIF8XaLOtvsuPlOXCnttnffh249RPFyQBXAE0oZCEZvwEHKr8wrETxSTgkWUCQJlADhaTQHmIn+g1Afyo4LaoCWnUquxaeTBzM82VgL1K7F78UcVCsHX5V8znv9BRgOhj5GV8BJIAWvpu60wV9EloeBkfAQWxYxSjC6nq5x8fAQWyXXjV/KEK+yBie62+AJUgmi6EfC/w9h6ggQLaLsyu+n+pR8wg1RegIsRgZyHI7GdBgW0XGp/PVSOjsPHlImz1BagM0XsXolRfQAK2C5vbd6qhYYgYUaovQIWIpgsQrq8dqcZciL0p8+GrL4AQC+YapaijkwUJ2lHa2vmtGhxE7Ik6OlmgYkQ7Su8/ud+TsLaQ0ckCwmzAGHq5/PydH2vGwrwABtiI0zWj0LnvBzJiz8PG91vVOIjvUtWPP/f9gEoS7Shp/yHgs7EanSxgiI0Zo3OrP615/KMz1uYFMMYGjeHXzbbhRJgXwCAbFdOTY14Ao0Qc7DQnw3yJoVCp/AcXkU+yAO498gAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC45bDN+TgAAAylJREFUaEPVmdtOMjEUhX0Wn9CHwkPQeIxwwQ0SD1eaqIkHghEidxD1Dfrvb0KT+ScLpu0UEy6+xL1ou9fedGbKuNVqtTYaKW4SUkzl9/d329ipYVvNTUWKsWBqYW5guBoYk60QKYaCiYWZwc/PjxuNRu729tZdXl66drvtdnd3C/gbjc8+Pj4cY5mzmNuoECmGQGJv/PHx0R0fHzvTg2Ds09NTuZDkIqRYhzf/9fXlzs/PpckQLi4u3HQ6bVSEFFfhzb+/v7v9/X1pLAbWGA6HyUVIcRll8+xt07LAWqlFSFHhzbNtcnS+CmumbCcpKmzRHS66Jnu+Dq6JxYW9Y7H0UUWKVegIneFuY/FaeX5+jvoWpFiFjtCZmFtlKicnJ1HfghTL0Ak6wkPK4iAODg6CtGXwsCMnuS2WvjxSLEMnjOIpavGfcHd3RwFB34IUy/gCOApYvJKQLoeM6XQ6+QvgPGPxn3B4eJi/gJwPrjrIlb2Avb09mWwdkCt7AUdHRzLZOiBX9gK63a5MVibXRUyu7AVwa7P4T8h9Gy0eZJwWLQ5CdTmk856Yk6kUq9CJ7+/vKBOpkINc5LRY+ikjxSosZrh+vy+T5oQc5MpdQLGNPj8/ZdKckINc5LRY+ikjRQUdMYozu8VrgbXJQS6LpY8qUlTQEWPw8vIik+fg9fU1qvsgxWXQGc7qp6en0kATzs7Oon+NgRSXQWfo0NvbmzTRBF4UsDY5LJb5FVJcBR0yiiOvxVmIOT5XkeIq6JAxmEwm0kwKrMWarG2xzLsMKdZBpwx3fX0tDcVwc3OT3H2QYh10yhjM5/NGp1TmsgZrsaZpMt8qpBiCLyLmjFSlyStFjxRDscTFVrq6upIGV8Ec5rKGxXL9EKQYCp0ziq0U+3q96dbxSDEGXwRnmJDfzYwZj8dZzIMUY/FF3N/fS9NlGJPLPEgxBTNUHDN6vZ40Dnxm4xrv+zJSTIGOGoPZbFa83zTtP9D4jDGMZU4OpJiKL6L6PwT+RsttHqTYBF8EhzOLC1IPaiFIsSm+iIeHBwfrMg9SzMGiCB50sBbzIMVNQoqbhBQ3h9bWP/HfsYvIwP9AAAAAAElFTkSuQmCC"}function c(a,c){var d=a,e=$("<div></div>").addClass("dragPoint").addClass("probe").appendTo(d);e.draggable({containment:"document",scroll:!1,zIndex:2500,helper:function(){var a=$("<div></div>").addClass("dragPoint");return b(a),a},appendTo:c}),e.mousedown(function(a){a.stopPropagation()})}function d(b,c,d){a.NavigationPanel(c,b,"https://github.com/predictionmachines/InteractiveDataDisplay/wiki/UI-Guidelines#chartviewer");var e=b.find(".idd-onscreennavigation-showlegend");e.remove(),e=b.find(".idd-onscreennavigation-hidelegend"),e.remove();var f=($("<div></div>").addClass("idd-onscreennavigation-hidelegend").prependTo(b),b.find(".idd-onscreennavigation-navigationlockpressed"));d.isNavigationPanelOpen&&$(f).click(),$(f).bind("classChanged",function(){d.isNavigationPanelOpen=$(this).hasClass("idd-onscreennavigation-navigationlock")});for(var g=b.find(".idd-onscreennavigation-logscale"),h=0;h<d.isLogAxis;h++)$(g).click();$(g).on("axisChanged",function(a,b){d.isLogAxis=b})}a.createSmallProbe=b,a.ProbePull=c,a.OnScreenNavigation=d}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){var b=function(){function b(b,c,d,e){this.currentPlots={},this.div=b;var f=this,g=this.iddDiv=$("<div data-idd-plot='chart'></div>").appendTo(b);g.width(b.width()),g.height(b.height());var h=this.iddChart=a.asPlot(g);h.legend.isVisible=!1,h.isToolTipEnabled=!0,h.doFitOnDataTransformChanged=!1;var i=$("<div></div>").addClass("dsv-onscreennavigationcontainer").attr("data-idd-placement","center").appendTo(c),j=$("<div></div>").addClass("dsv-onscreennavigation").appendTo(i),k=(new a.OnScreenNavigation(j,h,d),$("<div></div>").attr("data-idd-name","draggableMarkers").appendTo(h.host)),l=new a.DOMPlot(k,h);l.order=9007199254740991,h.addChild(l),this.persistentViewState=d,h.navigation.setVisibleRect(this.persistentViewState.plotRect,!1,{suppressNotifyBoundPlots:!0}),h.isAutoFitEnabled=this.persistentViewState.isAutoFit,d.probesViewModel.getProbeContent=function(a){for(var b=h.children,c=[],d=0;d<b.length;d++)if(b[d].isVisible){var e=b[d].xDataTransform&&b[d].xDataTransform.domain&&b[d].xDataTransform.domain.isInDomain&&b[d].xDataTransform.domain.isInDomain(a.location.x)?b[d].xDataTransform.dataToPlot(a.location.x):a.location.x,f=b[d].yDataTransform&&b[d].yDataTransform.domain&&b[d].yDataTransform.domain.isInDomain&&b[d].yDataTransform.domain.isInDomain(a.location.y)?b[d].yDataTransform.dataToPlot(a.location.y):a.location.y,g=b[d].getTooltip(a.location.x,a.location.y,e,f,!0);void 0!==g&&c.push(g)}return c.length>0?c:void 0};var m=function(b){var c=b.id,e=b.location.x,f=b.location.y,g=$("<div></div>");g.addClass("dragPoint"),l.add(g[0],"none",e,f,void 0,void 0,.5,.92);var h=l.domElements,i=h[h.length-1];i.id=c,g.draggable({containment:l.master.centralPart[0],scroll:!1,opacity:.9,stop:function(a,b){var e={x:i._x,y:i._y};d.probesViewModel.updateProbe(c,e)}}),b.selected?a.createSmallProbe(g,c,"#365C95"):a.createSmallProbe(g,c)};l.host.droppable({accept:".probe",tolerance:"fit",drop:function(a,b){var c=($(this).offset(),{x:b.position.left+b.draggable.width()/2,y:b.position.top+b.draggable.height()}),e=l.coordinateTransform,f=h.xDataTransform?h.xDataTransform.plotToData(e.screenToPlotX(c.x)):e.screenToPlotX(c.x),g=h.yDataTransform?h.yDataTransform.plotToData(e.screenToPlotY(c.y)):e.screenToPlotY(c.y),i=d.probesViewModel.addProbe({x:f,y:g});m({id:i,location:{x:f,y:g}})}}),d.probesViewModel.subscribe(function(b){var c=b.probe;switch(b.status){case"fit":for(var d=1e-7,e=l.domElements,f=0;f<e.length;f++){var g=e[f];if(g.id===c.id){var i=h.visibleRect,j=h.xDataTransform?h.xDataTransform.dataToPlot(g._x):g._x,k=h.yDataTransform?h.yDataTransform.dataToPlot(g._y):g._y;(Math.abs(j-i.x-i.width/2)>d||Math.abs(k-i.y-i.height/2)>d)&&h.navigation.setVisibleRect({x:j-i.width/2,y:k-i.height/2,width:i.width,height:i.height},!0);break}}break;case"remove":for(var e=l.domElements,f=0;f<e.length;f++){var g=e[f];if(g.id===c.id){l.remove(g);break}}break;case"unselected":for(var e=l.domElements,f=0;f<e.length;f++){var m=e[f];a.createSmallProbe(m,m.id)}break;case"selected":for(var e=l.domElements,f=0;f<e.length;f++){var m=e[f];m.id===c.id?a.createSmallProbe(m,m.id,"#365C95"):a.createSmallProbe(m,m.id)}}});for(var n=d.probesViewModel.getProbes(),o=0;o<n.length;o++)m(n[o]);g.on("visibleChanged",function(){var a=[];for(var b in f.currentPlots){var c=f.currentPlots[b],d=c.Plots;d&&d.length>0&&(d[0].isVisible||a.push(c.Id))}f.persistentViewState.selectedPlots=a}),g.on("isAutoFitEnabledChanged",function(){d.isAutoFit=h.isAutoFitEnabled}),g.on("visibleRectChanged",function(){var b=h.visibleRect
;e.plotXFormatter=new a.AdaptiveFormatter(b.x,b.x+b.width),e.plotYFormatter=new a.AdaptiveFormatter(b.y,b.y+b.height),d.plotRect=b,void 0!==d.probesViewModel&&d.probesViewModel.refresh()})}return b.prototype.setupPlotsVisibility=function(){for(var a in this.currentPlots){var b=this.currentPlots[a],c=b.Plots;if(c)for(var d=-1==this.initiallySelectedPlots.indexOf(b.Id),e=0;e<c.length;++e)c[e].isVisible=d}},b.prototype.checkLatLon=function(b){var c=function(a){var b=a.toLowerCase();return"lat"===b||"latitude"===b},d=function(a){var b=a.toLowerCase();return"lon"===b||"longitude"===b};return void 0!==b.x&&d(a.getTitle(b,"x"))&&void 0!==b.y&&c(a.getTitle(b,"y"))},b.prototype.addPlot=function(b){var c=a.PlotRegistry[b.Definition.kind]?a.PlotRegistry[b.Definition.kind]:a.PlotRegistry.fallback;b.Plots=c.initialize(b.Definition,this.persistentViewState,this.iddChart);try{c.draw(b.Plots,b.Definition)}catch(d){void 0!==b.Plots&&b.Plots.forEach(function(a){a.remove()}),c=a.PlotRegistry.fallback,b.Definition.error=d.message,b.Plots=c.initialize(b.Definition,this.persistentViewState,this.iddChart),c.draw(b.Plots,b.Definition)}},b.prototype.updateAxes=function(){var b="",c="",d=[],e=[];for(var f in this.currentPlots){var g=this.currentPlots[f],h=g.Definition;if(h.x){for(var i=a.getTitle(h,"x"),j=!1,k=0;k<d.length;k++)if(d[k]===i){j=!0;break}j||(d.push(i),""!==b&&(b+=", "),b+=i)}if(h.y){for(var l=a.getTitle(h,"y"),j=!1,k=0;k<e.length;k++)if(e[k]===l){j=!0;break}j||(e.push(l),""!==c&&(c+=", "),c+=l)}}""!==b?(void 0===this.xAxisTitle&&(this.xAxisTitle=$(this.iddChart.addDiv('<div style="font-size: larger; text-align: center"></div>',"bottom"))),this.xAxisTitle.text(b)):void 0!==this.xAxisTitle&&(this.iddChart.removeDiv(this.xAxisTitle[0]),this.xAxisTitle.remove(),this.xAxisTitle=void 0),""!==c?(void 0===this.yAxisTitle&&(this.yAxisTitle=$(this.iddChart.addDiv('<div class="idd-verticalTitle" style="font-size: larger;"></div>',"left"))),this.yAxisTitle.text(c)):void 0!==this.yAxisTitle&&(this.iddChart.removeDiv(this.yAxisTitle[0]),this.yAxisTitle.remove(),this.yAxisTitle=void 0)},b.prototype.createMap=function(){var b=$("<div></div>").attr("data-idd-name","bingMaps").css("z-index",0).prependTo(this.iddChart.host),c=new a.BingMapsPlot(b,this.iddChart);return c.order=9007199254740991,this.iddChart.addChild(c),c},b.prototype.updateMap=function(){var b=!1,c=!0;for(var d in this.currentPlots){var e=this.currentPlots[d];b=(c||b)&&this.checkLatLon(e.Definition),c=!1}b&&"undefined"!=typeof Microsoft?(void 0===this.bingMapsPlot?(this.bingMapsPlot=this.createMap(),this.persistentViewState.mapType?this.bingMapsPlot.setMap(this.persistentViewState.mapType):this.bingMapsPlot.setMap(Microsoft.Maps.MapTypeId.road)):this.persistentViewState.mapType&&this.bingMapsPlot.setMap(this.persistentViewState.mapType),this.iddChart.yDataTransform=a.mercatorTransform,this.iddChart.xDataTransform=void 0,this.bingMapsPlot.navigation.animation.setMapView(this.persistentViewState.plotRect,this.iddChart.screenSize)):void 0!==this.bingMapsPlot&&(this.bingMapsPlot.remove(),this.bingMapsPlot=void 0,this.iddChart.yDataTransform=void 0)},b.prototype.draw=function(b){var c=this;this.currentPlots=a.updateBag(this.currentPlots,b,function(b,d,e){return d.Definition.kind==e.Definition.kind?(a.syncProps(d.Definition,e.Definition)&&a.PlotRegistry[d.Definition.kind].draw(d.Plots,d.Definition),d):(void 0!==d.Plots&&d.Plots.forEach(function(a){a.remove()}),c.addPlot(e),e)},function(a,b){return c.addPlot(b),b},function(a,b){void 0!==b.Plots&&b.Plots.forEach(function(a){a.remove()})}),this.updateAxes(),this.updateMap(),this.persistentViewState.probesViewModel.refresh();var d=0;for(var e in this.currentPlots){var f=this.currentPlots[e];f.ZIndex&&(d=Math.max(f.ZIndex,d))}for(var e in this.currentPlots){var f=this.currentPlots[e];if(f.ZIndex||(f.ZIndex=++d),f.Plots)for(var g=0;g<f.Plots.length;++g){var h=f.Plots[g];h.host.css("z-index",f.ZIndex),h.requestNextFrameOrUpdate()}}return this.persistentViewState.selectedPlots&&(this.initiallySelectedPlots=this.persistentViewState.selectedPlots,this.setupPlotsVisibility()),this.currentPlots},b.prototype.updateLayout=function(){this.iddDiv.width(this.div.width()),this.iddDiv.height(this.div.height()),this.iddChart.updateLayout(),void 0!==this.bingMapsPlot&&this.iddChart.navigation.setVisibleRect(this.iddChart.visibleRect,!1)},b}();a.PlotViewer=b}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){function b(b,c,d,e){b.addClass("dsv-plotlist");var f=$("<div></div>").appendTo(b),g=new a.Legend(c.iddChart,f,!1,!0);c.iddChart.host.bind("visibleChanged",function(){d.probesViewModel.refresh(d.probesViewModel.getProbes())}),d.probesViewModel.refresh(d.probesViewModel.getProbes());var h=$("<div></div>").addClass("probes").appendTo(b),i=$("<div style='width:240px; margin-bottom: 16px'></div>").appendTo(h),j=$("<div></div>").addClass("dsv-onscreennavigation-probepull").appendTo(i),k=(new a.ProbePull(j,c.iddChart.centralPart),$("<div style='width: 195px; display:inline-block'></div>").appendTo(i));$("<div style='width:180px; height:1px; margin-bottom:6px; float:right; margin-top: 8px; background-color:lightgrey'></div>").appendTo(k),$("<div style='float:left; margin-left:15px;font-family: Segoe UI;font-size: 12px;color:grey; margin-bottom:16px'>Probes</div>").appendTo(k);var l=$("<div></div>").addClass("probes-list").appendTo(h);l[0].style.display="none";new a.ProbesControl(h,l,d,e);this.remove=function(){c.iddChart.host.bind("visibleChanged"),g.remove()}}a.PlotList=b}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){var b=function(){function b(b){this.rightPanelExtraShift=3,this.navigationPanelShift=65,this.minWidthToShowLeftPanel=540,this.plotList=void 0,this.viewState=void 0;var c=this,d=this.controlDiv=$(b);this.persistentViewState=this.viewState=new a.PersistentViewState,this.transientViewState=new a.TransientViewState;var e=d.width(),f=d.height();0===e&&d.width(400),0===f&&d.height(400);var g=$("<div class='dsv-visualizaition-control'></div>");d.append(g);var h=$("<div class='dsv-leftpanelcontainer'></div>");g.append(h);var i=$("<div class='dsv-rightpanel'></div>");g.append(i);var j=$("<div class='dsv-leftpanel'></div>");h.append(j),j.append($("<div class='plotlist'></div>")),i.append($("<div class='dsv-visualization-preview'></div>"));var k=$("<div class='dsv-navigation-container'></div>").appendTo(g);k.addClass("no-print");var l=this.rightpanel=d.find(".dsv-rightpanel"),m=d.find(".dsv-leftpanel"),n=this.leftPanelContainer=d.find(".dsv-leftpanelcontainer"),o=this.persistentViewState.isLegendShown;this.plotViewer=new a.PlotViewer(d.find(".dsv-visualization-preview"),k,this.persistentViewState,this.transientViewState);var p=d.find(".plotlist");this.plotList=new a.PlotList(p,this.plotViewer,this.persistentViewState,this.transientViewState),this.plotList.isEditable=!1,this.plotViewer.iddChart.exportToSvg=function(a,b,c){if(!SVG.supported)throw"SVG is not supported";var b=this.screenSize,a=this.coordinateTransform.getPlotRect({x:0,y:0,width:b.width,height:b.height}),d=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=SVG(d).size(this.host.width(),this.host.height()),e=c.group();this.exportContentToSvg(a,b,e);var f=c.group(),g=this.host.width();return o&&(f.add(this.exportLegendToSvg(this.legend.div[0])).translate(g,30),c.size(200+g,this.host.height())),c};var q=k[0].children[0].firstChild.firstChild;$(q).click(function(){o?(o=!1,c.persistentViewState.isLegendShown=!1,m.hide(),$(q).removeClass("idd-onscreennavigation-showlegend").addClass("idd-onscreennavigation-hidelegend")):(o=!0,c.persistentViewState.isLegendShown=!0,m.show(),$(q).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")),l.width(d.width()-n.width()-c.rightPanelExtraShift-c.navigationPanelShift),c.plotViewer.updateLayout(),c.persistentViewState.probesViewModel.refresh()}),o?(m.show(),$(q).removeClass("idd-onscreennavigation-hidelegend").addClass("idd-onscreennavigation-showlegend")):m.hide(),l.width(d.width()-n.width()-this.rightPanelExtraShift-this.navigationPanelShift),$(window).resize(function(){c.updateLayout()}),this.updateLayout()}return b.prototype.update=function(a){var b={};for(var c in a){var d=a[c];null!=d?(b[c]={Id:c,Definition:d},null!==d.displayName&&void 0!==d.displayName||(d=$.extend(!1,{},d),d.displayName=c,b[c].Definition=d)):b[c]=null}b=this.plotViewer.draw(b)},b.prototype.updateLayout=function(){var a=0;this.controlDiv.width()<this.minWidthToShowLeftPanel&&void 0!==this.leftPanelContainer?this.leftPanelContainer.hide():void 0!==this.leftPanelContainer&&(this.leftPanelContainer.show(),a=this.leftPanelContainer.width()),this.rightpanel.width(this.controlDiv.width()-a-this.rightPanelExtraShift-this.navigationPanelShift),this.plotViewer.updateLayout(),this.persistentViewState.probesViewModel.refresh()},b.prototype.dispose=function(){this.plotList.remove(),this.controlDiv.children().remove()},b}();a.ChartViewerControl=b}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){function b(a){var b=this,c=0,d=[],e=[],f=function(a,b){if(d.length>0)for(var c=0;c<d.length;c++)d[c]({probe:a,status:b})};if(this.subscribe=function(a){d.push(a)},this.clear=function(){for(var a=e.slice(0),c=0;c<a.length;c++)b.removeProbe(a[c].id)},this.addProbe=function(a){var b={id:++c,location:a,selected:!1};return e.push(b),f(b,"add"),b.id},this.removeProbe=function(a){for(var b=void 0,c=0;c<e.length;c++){var d=e[c];if(d.id==a){b=d;break}}void 0!==b&&(e=e.filter(function(a){return a!==b}),f(b,"remove"))},this.updateProbe=function(a,b){for(var c=void 0,d=0;d<e.length;d++){var g=e[d];if(g.id==a){c=g;break}}void 0!==c&&(c.location=b,f(c,"update"))},this.selectProbe=function(a){if(-1===a){for(var b=0;b<e.length;b++){var c=e[b];c.selected=!1}return void f(void 0,"unselected")}for(var d=void 0,b=0;b<e.length;b++){var c=e[b];c.id==a?(d=c,d.selected=!0):c.selected=!1}void 0!==d&&f(d,"selected")},this.fitToProbe=function(a){for(var b=void 0,c=0;c<e.length;c++){var d=e[c];d.id==a&&(b=d,f(b,"fit"))}},this.getProbes=function(){return e.slice(0)},this.getProbeContent=function(a){},this.refresh=function(){void 0!==b.onRefresh&&b.onRefresh(e.slice(0))},void 0!==a)for(var g=0;g<a.length;g++){var h={id:a[g].id,location:{x:a[g].location.x,y:a[g].location.y},selected:a[g].selected};e.push(h),h.id>c&&(c=h.id)}}function c(b,c,d,e){var f=d.probesViewModel,g=c,h=[],i=function(g){b[0].style.display="block";var h=$("<div></div>").addClass("probeCard");!0===g.selected&&h.addClass("probeCard-selected");var i=.6,j=$("<div></div>").addClass("probeHeader").appendTo(h).height(40*i),k=$("<div></div>").addClass("probe").css("float","left").css("margin-right",3).width(40*i).height(40*i).appendTo(j);g.selected?a.createSmallProbe(k,g.id,"#365C95",i):a.createSmallProbe(k,g.id,void 0,i),$("<div></div>").addClass("probeHeader-name").text(e.plotXFormatter.toString(g.location.x)+", "+e.plotYFormatter.toString(g.location.y)).appendTo(j);var l=$("<div></div>").addClass("probeActionPanel").appendTo(h);$("<div></div>").addClass("probeCard-remove").appendTo(l).click(function(){f.removeProbe(g.id),void 0!==d.uncertaintyRange&&d.uncertaintyRange.probeid===g.id&&(d.uncertaintyRange=void 0),0==c[0].childNodes.length&&(c[0].style.display="none")}),$("<div></div>").addClass("probeCard-fit").appendTo(l).click(function(){f.fitToProbe(g.id)});var m=f.getProbeContent(g);if(void 0!==m)for(var n=0;n<m.length;n++){var o=$(m[n]);o.addClass("probecard-record"),o.appendTo(h)}return h},j=function(a){g.empty(),h=[];for(var b=0;b<a.length;b++){var d=a[b],e=i(d),f=$("<div></div>").css("display","inline").appendTo(g);e.appendTo(f),h.push({id:d.id,div:e,host:f})}a.length>0&&(c[0].style.display="block")};j(f.getProbes()),f.subscribe(function(a){var b=a.probe;switch(a.status){case"add":c[0].style.display="block";var d=i(a.probe),e=$("<div></div>").css("display","inline").appendTo(g);d.appendTo(e),h.push({id:b.id,div:d,host:e});break;case"remove":for(var k=0;k<h.length;k++){var l=h[k];if(l.id===b.id){l.host.remove(),h=h.filter(function(a){return a.id!==b.id}),0==c[0].childNodes.length&&(c[0].style.display="none");break}}break;case"update":for(var k=0;k<h.length;k++){var l=h[k];if(l.id===b.id){l.host.empty();var d=i(a.probe);d.appendTo(l.host),l.div=d;break}}break;case"selected":case"unselected":j(f.getProbes())}}),f.onRefresh=function(a){j(a)}}function d(b,c,d){if(d)throw"viewState argument is not supported";var e=new a.ChartViewerControl(b);return e.update(c),e}a.ProbesVM=b,a.ProbesControl=c,a.show=d}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){function b(a,b,c,d,e){var f={};for(var g in b){var h=a[g],i=b[g];void 0!==i&&(f[g]=void 0!==h?null==i?h:c(g,h,i):d(g,i))}for(var g in a){var h=a[g],i=b[g];void 0!==h&&(void 0===i&&e(g,h))}return f}function c(a,b){return a.titles&&void 0!==a.titles[b]?a.titles[b]:b}function d(a,b,c){return b[a]===c[a]||(b[a]=c[a],!1)}function e(a){return!isNaN(parseFloat(a))&&isFinite(a)}function f(a){return a===a+""}function g(a){return e(a)||f(a)}function h(b){if("object"!=typeof b||null==b)return b;if(a.Utils.isArray(b)){for(var c=[],d=0;d<b.length;d++)c.push(h(b[d]));return c}var e={};for(var f in b)e[f]=h(b[f]);return e}function i(a,b){var c=!1;for(var e in b)if(void 0===a[e]||g(a[e])&&!g(b[e]))a[e]=h(b[e]),c||(c=!0);else if(g(b[e])){var f=!d(e,a,b);c||(c=f)}else{var f=i(a[e],b[e]);c||(c=f)}var j=[];for(var k in a)if("d3Graphs"!==k&&"isPresented"!==k){var l=!1;for(var e in b)if(e===k){l=!0;break}l||(j.push(k),c||(c=!0))}j.forEach(function(b){delete a[b]});for(var m=0;m<a.length;m++)void 0==a[m]&&"function"!=typeof a&&(a.splice(m,1),m--);return c}a.updateBag=b,a.getTitle=c,a.updateProp=d,a.isNumber=e,a.isString=f,a.isStringOrNumber=g,a.deepCopyJS=h,a.syncProps=i}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){a.PlotRegistry.area={initialize:function(b,c,d){var e=$("<div></div>").attr("data-idd-name",b.displayName).appendTo(d.host),f=new a.Area(e,d.master);return d.addChild(f),d.assignChildOrder(f),[f]},draw:function(a,b){var c=a[0],d=b;c.draw(d)}}}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){function b(b,c){var d=a.Utils.getDataSourceFunction(b,a.readCsv),e=d(b);this.base=a.CanvasPlot,this.base(b,c);var f,g;e&&(f=e.kind),this.draw=function(a){f=a.kind,g=a.error,this.fireAppearanceChanged("error")},Object.defineProperty(this,"isErrorVisible",{get:function(){return!0},configurable:!0}),this.getLocalPadding=function(){return{left:0,right:0,top:0,bottom:0}},this.renderCore=function(a,b){},this.getLegend=function(){var a=this,c=$("<span></span>"),d=$("<div class='plotcard-error'></div>"),e=function(){c.text(a.name)};e();var h=function(){var a="";a=g||(f?'kind "'+f+'" is unknown':"Error plot definition!"),d.text(a)};h(),this.host.bind("appearanceChanged",function(a,b){b&&"error"!=b||h(),b&&"name"!=b||e()});var a=this;return{name:c,legend:{thumbnail:void 0,content:d},onLegendRemove:function(){a.host.unbind("appearanceChanged"),b[0].innerHTML="",b.removeClass("idd-legend-item")}}}}a.PlotRegistry.fallback={initialize:function(a,c,d){var e=$("<div></div>").attr("data-idd-name",a.displayName).appendTo(d.host),f=new b(e,d.master);return d.addChild(f),d.assignChildOrder(f),[f]},draw:function(a,b){var c={kind:b.kind,error:b.error};a[0].draw(c)}},a.FallbackPlot=b,b.prototype=new a.CanvasPlot}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){a.PlotRegistry.heatmap={initialize:function(b,c,d){var e=$("<div></div>").attr("data-idd-name",b.displayName).appendTo(d.host),f=new a.Heatmap(e,d.master);return d.addChild(f),d.assignChildOrder(f),[f]},draw:function(a,b){var c=b;a[0].draw(c,c.titles)}}}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){a.PlotRegistry.line={initialize:function(b,c,d){var e=$("<div></div>").attr("data-idd-name",b.displayName).appendTo(d.host),f=new a.Polyline(e,d.master);return d.addChild(f),d.assignChildOrder(f),[f]},draw:function(a,b){var c=a[0],d=b;c.draw(d)}}}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var InteractiveDataDisplay;!function(a){a.PlotRegistry.markers={initialize:function(b,c,d){var e=$("<div></div>").attr("data-idd-name",b.displayName).appendTo(d.host),f=new a.Markers(e,d.master);return d.addChild(f),d.assignChildOrder(f),[f]},draw:function(a,b){var c=b;a[0].draw(c,c.titles)}}}(InteractiveDataDisplay||(InteractiveDataDisplay={}));var Plot;!function(a){function b(a){var b=a;return b.kind="line",b}function c(a){var b=a;return b.kind="area",b}function d(a){var b=a;return b.kind="markers",b.shape="boxwhisker",b}function e(a){var b=a;return b.kind="markers",b}function f(a){var b=a;return b.kind="heatmap",b}!function(a){a.Box="box",a.Circle="circle",a.Diamond="diamond",a.Cross="cross",a.Triangle="triangle"}(a.MarkerShape||(a.MarkerShape={}));!function(a){a.Gradient="gradient",a.Discrete="discrete"}(a.HeatmapRenderType||(a.HeatmapRenderType={}));!function(a){a.Function="function",a.Trajectory="trajectory"}(a.LineTreatAs||(a.LineTreatAs={})),a.line=b,a.area=c,a.boxplot=d,a.markers=e,a.heatmap=f}(Plot||(Plot={}));
//# sourceMappingURL=idd.min.js.map