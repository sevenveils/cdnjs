{"version":3,"file":"appbase-js.umd.min.js","sources":["../node_modules/url-parser-lite/index.js","../src/utils/index.js","../src/core/index.js","../node_modules/querystring/decode.js","../node_modules/querystring/encode.js","../node_modules/querystring/index.js","../node_modules/node-fetch/lib/index.es.js","../node_modules/cross-fetch/dist/node-ponyfill.js","../src/core/request/fetch.js","../src/core/request/ws.js","../src/core/api/index.js","../src/core/api/get.js","../src/core/api/update.js","../src/core/api/delete.js","../src/core/api/bulk.js","../src/core/api/search.js","../src/core/api/msearch.js","../src/core/api/getStream.js","../src/core/api/searchStream.js","../node_modules/jsonify/lib/parse.js","../node_modules/jsonify/lib/stringify.js","../node_modules/json-stable-stringify/index.js","../src/core/api/searchStreamToURL.js","../src/core/api/getTypes.js","../src/core/api/getMappings.js","../src/index.js"],"sourcesContent":["function URL(url) {\n    var pattern = RegExp(\"^(([^:/?#]*)?://)?(((.*)?@)?([^/?#]*)?)([^?#]*)(\\\\?([^#]*))?(#(.*))?\");\n    var matches = url.match(pattern);\n\n    return {\n        protocol: matches[2],\n        auth: matches[5],\n        host: matches[6],\n        path: matches[7],\n        query: matches[9],\n        hash: matches[11]\n    };\n}\n\nmodule.exports = URL;\n","export function contains(string, substring) {\n  return string.indexOf(substring) !== -1;\n}\nexport function isAppbase(url) {\n  return contains(url, 'scalr.api.appbase.io');\n}\nexport function btoa(input = '') {\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  const str = input;\n  let output = '';\n\n  // eslint-disable-next-line\n  for (\n    let block = 0, charCode, i = 0, map = chars;\n    str.charAt(i | 0) || ((map = '='), i % 1); // eslint-disable-line no-bitwise\n    output += map.charAt(63 & (block >> (8 - (i % 1) * 8))) // eslint-disable-line no-bitwise\n  ) {\n    charCode = str.charCodeAt((i += 3 / 4));\n\n    if (charCode > 0xff) {\n      throw new Error(\n        '\"btoa\" failed: The string to be encoded contains characters outside of the Latin1 range.',\n      );\n    }\n\n    block = (block << 8) | charCode; // eslint-disable-line no-bitwise\n  }\n\n  return output;\n}\nexport function uuidv4() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (Math.random() * 16) | 0; // eslint-disable-line no-bitwise\n\n    const v = c === 'x' ? r : (r & 0x3) | 0x8; // eslint-disable-line no-bitwise\n    return v.toString(16);\n  });\n}\nexport function validate(object, fields) {\n  const invalid = [];\n  const emptyFor = {\n    object: null,\n    string: '',\n  };\n  const keys = Object.keys(fields);\n  keys.forEach((key) => {\n    const type = fields[key];\n    // eslint-disable-next-line\n    if (typeof object[key] !== type || object[key] === emptyFor[type]) {\n      invalid.push(key);\n    }\n  });\n  let missing = '';\n  for (let i = 0; i < invalid.length; i += 1) {\n    missing += `${invalid[i]}, `;\n  }\n  if (invalid.length > 0) {\n    return new Error(`fields missing: ${missing}`);\n  }\n\n  return true;\n}\n\nexport function removeUndefined(value) {\n  if (value || !(Object.keys(value).length === 0 && value.constructor === Object)) {\n    return JSON.parse(JSON.stringify(value));\n  }\n  return null;\n}\n\n/**\n * Send only when a connection is opened\n * @param {Object} socket\n * @param {Function} callback\n */\nexport function waitForSocketConnection(socket, callback) {\n  setTimeout(() => {\n    if (socket.readyState === 1) {\n      if (callback != null) {\n        callback();\n      }\n    } else {\n      waitForSocketConnection(socket, callback);\n    }\n  }, 5); // wait 5 ms for the connection...\n}\n","import URL from 'url-parser-lite';\nimport { isAppbase } from '../utils/index';\n/**\n * Returns an instance of Appbase client\n * @param {Object} config To configure properties\n * @param {String} config.url\n * @param {String} config.app\n * @param {String} config.credentials\n * @param {String} config.username\n * @param {String} config.password\n * A callback function which will be invoked before a fetch request made\n */\nfunction AppBase(config) {\n  const {\n auth = null, host = '', path = '', protocol = '',\n} = URL(config.url || '');\n  let url = host + path;\n\n  // Validate config and throw appropriate error\n  if (typeof url !== 'string' || url === '') {\n    throw new Error('URL not present in options.');\n  }\n  if (typeof config.app !== 'string' || config.app === '') {\n    throw new Error('App name is not present in options.');\n  }\n  if (typeof protocol !== 'string' || protocol === '') {\n    throw new Error(\n      'Protocol is not present in url. URL should be of the form https://scalr.api.appbase.io',\n    );\n  }\n  // Parse url\n  if (url.slice(-1) === '/') {\n    url = url.slice(0, -1);\n  }\n  let credentials = auth || null;\n  /**\n   * Credentials can be provided as a part of the URL,\n   * as username, password args or as a credentials argument directly */\n  if (typeof config.credentials === 'string' && config.credentials !== '') {\n    // eslint-disable-next-line\n    credentials = config.credentials;\n  } else if (\n    typeof config.username === 'string'\n    && config.username !== ''\n    && typeof config.password === 'string'\n    && config.password !== ''\n  ) {\n    credentials = `${config.username}:${config.password}`;\n  }\n\n  if (isAppbase(url) && credentials === null) {\n    throw new Error('Authentication information is not present. Did you add credentials?');\n  }\n  this.url = url;\n  this.protocol = protocol;\n  this.app = config.app;\n  this.credentials = credentials;\n  this.headers = {};\n}\nexport default AppBase;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (Array.isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return Object.keys(obj).map(function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (Array.isArray(obj[k])) {\n        return obj[k].map(function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Based on https://github.com/tmpvar/jsdom/blob/aa85b2abf07766ff7bf5c1f6daafb3726f2f2db5/lib/jsdom/living/blob.js\n// (MIT licensed)\n\nconst BUFFER = Symbol('buffer');\nconst TYPE = Symbol('type');\n\nclass Blob {\n\tconstructor() {\n\t\tthis[TYPE] = '';\n\n\t\tconst blobParts = arguments[0];\n\t\tconst options = arguments[1];\n\n\t\tconst buffers = [];\n\n\t\tif (blobParts) {\n\t\t\tconst a = blobParts;\n\t\t\tconst length = Number(a.length);\n\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\tconst element = a[i];\n\t\t\t\tlet buffer;\n\t\t\t\tif (element instanceof Buffer) {\n\t\t\t\t\tbuffer = element;\n\t\t\t\t} else if (ArrayBuffer.isView(element)) {\n\t\t\t\t\tbuffer = Buffer.from(element.buffer, element.byteOffset, element.byteLength);\n\t\t\t\t} else if (element instanceof ArrayBuffer) {\n\t\t\t\t\tbuffer = Buffer.from(element);\n\t\t\t\t} else if (element instanceof Blob) {\n\t\t\t\t\tbuffer = element[BUFFER];\n\t\t\t\t} else {\n\t\t\t\t\tbuffer = Buffer.from(typeof element === 'string' ? element : String(element));\n\t\t\t\t}\n\t\t\t\tbuffers.push(buffer);\n\t\t\t}\n\t\t}\n\n\t\tthis[BUFFER] = Buffer.concat(buffers);\n\n\t\tlet type = options && options.type !== undefined && String(options.type).toLowerCase();\n\t\tif (type && !/[^\\u0020-\\u007E]/.test(type)) {\n\t\t\tthis[TYPE] = type;\n\t\t}\n\t}\n\tget size() {\n\t\treturn this[BUFFER].length;\n\t}\n\tget type() {\n\t\treturn this[TYPE];\n\t}\n\tslice() {\n\t\tconst size = this.size;\n\n\t\tconst start = arguments[0];\n\t\tconst end = arguments[1];\n\t\tlet relativeStart, relativeEnd;\n\t\tif (start === undefined) {\n\t\t\trelativeStart = 0;\n\t\t} else if (start < 0) {\n\t\t\trelativeStart = Math.max(size + start, 0);\n\t\t} else {\n\t\t\trelativeStart = Math.min(start, size);\n\t\t}\n\t\tif (end === undefined) {\n\t\t\trelativeEnd = size;\n\t\t} else if (end < 0) {\n\t\t\trelativeEnd = Math.max(size + end, 0);\n\t\t} else {\n\t\t\trelativeEnd = Math.min(end, size);\n\t\t}\n\t\tconst span = Math.max(relativeEnd - relativeStart, 0);\n\n\t\tconst buffer = this[BUFFER];\n\t\tconst slicedBuffer = buffer.slice(relativeStart, relativeStart + span);\n\t\tconst blob = new Blob([], { type: arguments[2] });\n\t\tblob[BUFFER] = slicedBuffer;\n\t\treturn blob;\n\t}\n}\n\nObject.defineProperties(Blob.prototype, {\n\tsize: { enumerable: true },\n\ttype: { enumerable: true },\n\tslice: { enumerable: true }\n});\n\nObject.defineProperty(Blob.prototype, Symbol.toStringTag, {\n\tvalue: 'Blob',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * fetch-error.js\n *\n * FetchError interface for operational errors\n */\n\n/**\n * Create FetchError instance\n *\n * @param   String      message      Error message for human\n * @param   String      type         Error type for machine\n * @param   String      systemError  For Node.js system error\n * @return  FetchError\n */\nfunction FetchError(message, type, systemError) {\n  Error.call(this, message);\n\n  this.message = message;\n  this.type = type;\n\n  // when err.type is `system`, err.code contains system error code\n  if (systemError) {\n    this.code = this.errno = systemError.code;\n  }\n\n  // hide custom error implementation details from end-users\n  Error.captureStackTrace(this, this.constructor);\n}\n\nFetchError.prototype = Object.create(Error.prototype);\nFetchError.prototype.constructor = FetchError;\nFetchError.prototype.name = 'FetchError';\n\n/**\n * body.js\n *\n * Body interface provides common methods for Request and Response\n */\n\nconst Stream = require('stream');\n\nvar _require = require('stream');\n\nconst PassThrough = _require.PassThrough;\n\n\nlet convert;\ntry {\n\tconvert = require('encoding').convert;\n} catch (e) {}\n\nconst INTERNALS = Symbol('Body internals');\n\n/**\n * Body mixin\n *\n * Ref: https://fetch.spec.whatwg.org/#body\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nfunction Body(body) {\n\tvar _this = this;\n\n\tvar _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n\t    _ref$size = _ref.size;\n\n\tlet size = _ref$size === undefined ? 0 : _ref$size;\n\tvar _ref$timeout = _ref.timeout;\n\tlet timeout = _ref$timeout === undefined ? 0 : _ref$timeout;\n\n\tif (body == null) {\n\t\t// body is undefined or null\n\t\tbody = null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is array buffer\n\t} else if (body instanceof Stream) {\n\t\t// body is stream\n\t} else {\n\t\t// none of the above\n\t\t// coerce to string\n\t\tbody = String(body);\n\t}\n\tthis[INTERNALS] = {\n\t\tbody,\n\t\tdisturbed: false,\n\t\terror: null\n\t};\n\tthis.size = size;\n\tthis.timeout = timeout;\n\n\tif (body instanceof Stream) {\n\t\tbody.on('error', function (err) {\n\t\t\t_this[INTERNALS].error = new FetchError(`Invalid response body while trying to fetch ${_this.url}: ${err.message}`, 'system', err);\n\t\t});\n\t}\n}\n\nBody.prototype = {\n\tget body() {\n\t\treturn this[INTERNALS].body;\n\t},\n\n\tget bodyUsed() {\n\t\treturn this[INTERNALS].disturbed;\n\t},\n\n\t/**\n  * Decode response as ArrayBuffer\n  *\n  * @return  Promise\n  */\n\tarrayBuffer() {\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n\t\t});\n\t},\n\n\t/**\n  * Return raw response as Blob\n  *\n  * @return Promise\n  */\n\tblob() {\n\t\tlet ct = this.headers && this.headers.get('content-type') || '';\n\t\treturn consumeBody.call(this).then(function (buf) {\n\t\t\treturn Object.assign(\n\t\t\t// Prevent copying\n\t\t\tnew Blob([], {\n\t\t\t\ttype: ct.toLowerCase()\n\t\t\t}), {\n\t\t\t\t[BUFFER]: buf\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n  * Decode response as json\n  *\n  * @return  Promise\n  */\n\tjson() {\n\t\tvar _this2 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse(buffer.toString());\n\t\t\t} catch (err) {\n\t\t\t\treturn Body.Promise.reject(new FetchError(`invalid json response body at ${_this2.url} reason: ${err.message}`, 'invalid-json'));\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n  * Decode response as text\n  *\n  * @return  Promise\n  */\n\ttext() {\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn buffer.toString();\n\t\t});\n\t},\n\n\t/**\n  * Decode response as buffer (non-spec api)\n  *\n  * @return  Promise\n  */\n\tbuffer() {\n\t\treturn consumeBody.call(this);\n\t},\n\n\t/**\n  * Decode response as text, while automatically detecting the encoding and\n  * trying to decode to UTF-8 (non-spec api)\n  *\n  * @return  Promise\n  */\n\ttextConverted() {\n\t\tvar _this3 = this;\n\n\t\treturn consumeBody.call(this).then(function (buffer) {\n\t\t\treturn convertBody(buffer, _this3.headers);\n\t\t});\n\t}\n\n};\n\n// In browsers, all properties are enumerable.\nObject.defineProperties(Body.prototype, {\n\tbody: { enumerable: true },\n\tbodyUsed: { enumerable: true },\n\tarrayBuffer: { enumerable: true },\n\tblob: { enumerable: true },\n\tjson: { enumerable: true },\n\ttext: { enumerable: true }\n});\n\nBody.mixIn = function (proto) {\n\tfor (const name of Object.getOwnPropertyNames(Body.prototype)) {\n\t\t// istanbul ignore else: future proof\n\t\tif (!(name in proto)) {\n\t\t\tconst desc = Object.getOwnPropertyDescriptor(Body.prototype, name);\n\t\t\tObject.defineProperty(proto, name, desc);\n\t\t}\n\t}\n};\n\n/**\n * Consume and convert an entire Body to a Buffer.\n *\n * Ref: https://fetch.spec.whatwg.org/#concept-body-consume-body\n *\n * @return  Promise\n */\nfunction consumeBody() {\n\tvar _this4 = this;\n\n\tif (this[INTERNALS].disturbed) {\n\t\treturn Body.Promise.reject(new TypeError(`body used already for: ${this.url}`));\n\t}\n\n\tthis[INTERNALS].disturbed = true;\n\n\tif (this[INTERNALS].error) {\n\t\treturn Body.Promise.reject(this[INTERNALS].error);\n\t}\n\n\t// body is null\n\tif (this.body === null) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is string\n\tif (typeof this.body === 'string') {\n\t\treturn Body.Promise.resolve(Buffer.from(this.body));\n\t}\n\n\t// body is blob\n\tif (this.body instanceof Blob) {\n\t\treturn Body.Promise.resolve(this.body[BUFFER]);\n\t}\n\n\t// body is buffer\n\tif (Buffer.isBuffer(this.body)) {\n\t\treturn Body.Promise.resolve(this.body);\n\t}\n\n\t// body is buffer\n\tif (Object.prototype.toString.call(this.body) === '[object ArrayBuffer]') {\n\t\treturn Body.Promise.resolve(Buffer.from(this.body));\n\t}\n\n\t// istanbul ignore if: should never happen\n\tif (!(this.body instanceof Stream)) {\n\t\treturn Body.Promise.resolve(Buffer.alloc(0));\n\t}\n\n\t// body is stream\n\t// get ready to actually consume the body\n\tlet accum = [];\n\tlet accumBytes = 0;\n\tlet abort = false;\n\n\treturn new Body.Promise(function (resolve, reject) {\n\t\tlet resTimeout;\n\n\t\t// allow timeout on slow response body\n\t\tif (_this4.timeout) {\n\t\t\tresTimeout = setTimeout(function () {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`Response timeout while trying to fetch ${_this4.url} (over ${_this4.timeout}ms)`, 'body-timeout'));\n\t\t\t}, _this4.timeout);\n\t\t}\n\n\t\t// handle stream error, such as incorrect content-encoding\n\t\t_this4.body.on('error', function (err) {\n\t\t\treject(new FetchError(`Invalid response body while trying to fetch ${_this4.url}: ${err.message}`, 'system', err));\n\t\t});\n\n\t\t_this4.body.on('data', function (chunk) {\n\t\t\tif (abort || chunk === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (_this4.size && accumBytes + chunk.length > _this4.size) {\n\t\t\t\tabort = true;\n\t\t\t\treject(new FetchError(`content size at ${_this4.url} over limit: ${_this4.size}`, 'max-size'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\taccumBytes += chunk.length;\n\t\t\taccum.push(chunk);\n\t\t});\n\n\t\t_this4.body.on('end', function () {\n\t\t\tif (abort) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTimeout(resTimeout);\n\n\t\t\ttry {\n\t\t\t\tresolve(Buffer.concat(accum));\n\t\t\t} catch (err) {\n\t\t\t\t// handle streams that have accumulated too much data (issue #414)\n\t\t\t\treject(new FetchError(`Could not create Buffer from response body for ${_this4.url}: ${err.message}`, 'system', err));\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Detect buffer encoding and convert to target encoding\n * ref: http://www.w3.org/TR/2011/WD-html5-20110113/parsing.html#determining-the-character-encoding\n *\n * @param   Buffer  buffer    Incoming buffer\n * @param   String  encoding  Target encoding\n * @return  String\n */\nfunction convertBody(buffer, headers) {\n\tif (typeof convert !== 'function') {\n\t\tthrow new Error('The package `encoding` must be installed to use the textConverted() function');\n\t}\n\n\tconst ct = headers.get('content-type');\n\tlet charset = 'utf-8';\n\tlet res, str;\n\n\t// header\n\tif (ct) {\n\t\tres = /charset=([^;]*)/i.exec(ct);\n\t}\n\n\t// no charset in content type, peek at response body for at most 1024 bytes\n\tstr = buffer.slice(0, 1024).toString();\n\n\t// html5\n\tif (!res && str) {\n\t\tres = /<meta.+?charset=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// html4\n\tif (!res && str) {\n\t\tres = /<meta[\\s]+?http-equiv=(['\"])content-type\\1[\\s]+?content=(['\"])(.+?)\\2/i.exec(str);\n\n\t\tif (res) {\n\t\t\tres = /charset=(.*)/i.exec(res.pop());\n\t\t}\n\t}\n\n\t// xml\n\tif (!res && str) {\n\t\tres = /<\\?xml.+?encoding=(['\"])(.+?)\\1/i.exec(str);\n\t}\n\n\t// found charset\n\tif (res) {\n\t\tcharset = res.pop();\n\n\t\t// prevent decode issues when sites use incorrect encoding\n\t\t// ref: https://hsivonen.fi/encoding-menu/\n\t\tif (charset === 'gb2312' || charset === 'gbk') {\n\t\t\tcharset = 'gb18030';\n\t\t}\n\t}\n\n\t// turn raw buffers into a single utf-8 buffer\n\treturn convert(buffer, 'UTF-8', charset).toString();\n}\n\n/**\n * Detect a URLSearchParams object\n * ref: https://github.com/bitinn/node-fetch/issues/296#issuecomment-307598143\n *\n * @param   Object  obj     Object to detect by type or brand\n * @return  String\n */\nfunction isURLSearchParams(obj) {\n\t// Duck-typing as a necessary condition.\n\tif (typeof obj !== 'object' || typeof obj.append !== 'function' || typeof obj.delete !== 'function' || typeof obj.get !== 'function' || typeof obj.getAll !== 'function' || typeof obj.has !== 'function' || typeof obj.set !== 'function') {\n\t\treturn false;\n\t}\n\n\t// Brand-checking and more duck-typing as optional condition.\n\treturn obj.constructor.name === 'URLSearchParams' || Object.prototype.toString.call(obj) === '[object URLSearchParams]' || typeof obj.sort === 'function';\n}\n\n/**\n * Clone body given Res/Req instance\n *\n * @param   Mixed  instance  Response or Request instance\n * @return  Mixed\n */\nfunction clone(instance) {\n\tlet p1, p2;\n\tlet body = instance.body;\n\n\t// don't allow cloning a used body\n\tif (instance.bodyUsed) {\n\t\tthrow new Error('cannot clone body after it is used');\n\t}\n\n\t// check that body is a stream and not form-data object\n\t// note: we can't clone the form-data object without having it as a dependency\n\tif (body instanceof Stream && typeof body.getBoundary !== 'function') {\n\t\t// tee instance body\n\t\tp1 = new PassThrough();\n\t\tp2 = new PassThrough();\n\t\tbody.pipe(p1);\n\t\tbody.pipe(p2);\n\t\t// set instance body to teed body and return the other teed body\n\t\tinstance[INTERNALS].body = p1;\n\t\tbody = p2;\n\t}\n\n\treturn body;\n}\n\n/**\n * Performs the operation \"extract a `Content-Type` value from |object|\" as\n * specified in the specification:\n * https://fetch.spec.whatwg.org/#concept-bodyinit-extract\n *\n * This function assumes that instance.body is present.\n *\n * @param   Mixed  instance  Response or Request instance\n */\nfunction extractContentType(instance) {\n\tconst body = instance.body;\n\n\t// istanbul ignore if: Currently, because of a guard in Request, body\n\t// can never be null. Included here for completeness.\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn null;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn 'text/plain;charset=UTF-8';\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is a URLSearchParams\n\t\treturn 'application/x-www-form-urlencoded;charset=UTF-8';\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\treturn body.type || null;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn null;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is array buffer\n\t\treturn null;\n\t} else if (typeof body.getBoundary === 'function') {\n\t\t// detect form data input from form-data module\n\t\treturn `multipart/form-data;boundary=${body.getBoundary()}`;\n\t} else {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t}\n}\n\n/**\n * The Fetch Standard treats this as if \"total bytes\" is a property on the body.\n * For us, we have to explicitly get it with a function.\n *\n * ref: https://fetch.spec.whatwg.org/#concept-body-total-bytes\n *\n * @param   Body    instance   Instance of Body\n * @return  Number?            Number of bytes, or null if not possible\n */\nfunction getTotalBytes(instance) {\n\tconst body = instance.body;\n\n\t// istanbul ignore if: included for completion\n\n\tif (body === null) {\n\t\t// body is null\n\t\treturn 0;\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\treturn Buffer.byteLength(body);\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is URLSearchParams\n\t\treturn Buffer.byteLength(String(body));\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\treturn body.size;\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\treturn body.length;\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is array buffer\n\t\treturn body.byteLength;\n\t} else if (body && typeof body.getLengthSync === 'function') {\n\t\t// detect form data input from form-data module\n\t\tif (body._lengthRetrievers && body._lengthRetrievers.length == 0 || // 1.x\n\t\tbody.hasKnownLength && body.hasKnownLength()) {\n\t\t\t// 2.x\n\t\t\treturn body.getLengthSync();\n\t\t}\n\t\treturn null;\n\t} else {\n\t\t// body is stream\n\t\t// can't really do much about this\n\t\treturn null;\n\t}\n}\n\n/**\n * Write a Body to a Node.js WritableStream (e.g. http.Request) object.\n *\n * @param   Body    instance   Instance of Body\n * @return  Void\n */\nfunction writeToStream(dest, instance) {\n\tconst body = instance.body;\n\n\n\tif (body === null) {\n\t\t// body is null\n\t\tdest.end();\n\t} else if (typeof body === 'string') {\n\t\t// body is string\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else if (isURLSearchParams(body)) {\n\t\t// body is URLSearchParams\n\t\tdest.write(Buffer.from(String(body)));\n\t\tdest.end();\n\t} else if (body instanceof Blob) {\n\t\t// body is blob\n\t\tdest.write(body[BUFFER]);\n\t\tdest.end();\n\t} else if (Buffer.isBuffer(body)) {\n\t\t// body is buffer\n\t\tdest.write(body);\n\t\tdest.end();\n\t} else if (Object.prototype.toString.call(body) === '[object ArrayBuffer]') {\n\t\t// body is array buffer\n\t\tdest.write(Buffer.from(body));\n\t\tdest.end();\n\t} else {\n\t\t// body is stream\n\t\tbody.pipe(dest);\n\t}\n}\n\n// expose Promise\nBody.Promise = global.Promise;\n\n/**\n * headers.js\n *\n * Headers class offers convenient helpers\n */\n\nconst invalidTokenRegex = /[^\\^_`a-zA-Z\\-0-9!#$%&'*+.|~]/;\nconst invalidHeaderCharRegex = /[^\\t\\x20-\\x7e\\x80-\\xff]/;\n\nfunction validateName(name) {\n\tname = `${name}`;\n\tif (invalidTokenRegex.test(name)) {\n\t\tthrow new TypeError(`${name} is not a legal HTTP header name`);\n\t}\n}\n\nfunction validateValue(value) {\n\tvalue = `${value}`;\n\tif (invalidHeaderCharRegex.test(value)) {\n\t\tthrow new TypeError(`${value} is not a legal HTTP header value`);\n\t}\n}\n\n/**\n * Find the key in the map object given a header name.\n *\n * Returns undefined if not found.\n *\n * @param   String  name  Header name\n * @return  String|Undefined\n */\nfunction find(map, name) {\n\tname = name.toLowerCase();\n\tfor (const key in map) {\n\t\tif (key.toLowerCase() === name) {\n\t\t\treturn key;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nconst MAP = Symbol('map');\nclass Headers {\n\t/**\n  * Headers class\n  *\n  * @param   Object  headers  Response headers\n  * @return  Void\n  */\n\tconstructor() {\n\t\tlet init = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n\t\tthis[MAP] = Object.create(null);\n\n\t\tif (init instanceof Headers) {\n\t\t\tconst rawHeaders = init.raw();\n\t\t\tconst headerNames = Object.keys(rawHeaders);\n\n\t\t\tfor (const headerName of headerNames) {\n\t\t\t\tfor (const value of rawHeaders[headerName]) {\n\t\t\t\t\tthis.append(headerName, value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// We don't worry about converting prop to ByteString here as append()\n\t\t// will handle it.\n\t\tif (init == null) {\n\t\t\t// no op\n\t\t} else if (typeof init === 'object') {\n\t\t\tconst method = init[Symbol.iterator];\n\t\t\tif (method != null) {\n\t\t\t\tif (typeof method !== 'function') {\n\t\t\t\t\tthrow new TypeError('Header pairs must be iterable');\n\t\t\t\t}\n\n\t\t\t\t// sequence<sequence<ByteString>>\n\t\t\t\t// Note: per spec we have to first exhaust the lists then process them\n\t\t\t\tconst pairs = [];\n\t\t\t\tfor (const pair of init) {\n\t\t\t\t\tif (typeof pair !== 'object' || typeof pair[Symbol.iterator] !== 'function') {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be iterable');\n\t\t\t\t\t}\n\t\t\t\t\tpairs.push(Array.from(pair));\n\t\t\t\t}\n\n\t\t\t\tfor (const pair of pairs) {\n\t\t\t\t\tif (pair.length !== 2) {\n\t\t\t\t\t\tthrow new TypeError('Each header pair must be a name/value tuple');\n\t\t\t\t\t}\n\t\t\t\t\tthis.append(pair[0], pair[1]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// record<ByteString, ByteString>\n\t\t\t\tfor (const key of Object.keys(init)) {\n\t\t\t\t\tconst value = init[key];\n\t\t\t\t\tthis.append(key, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new TypeError('Provided initializer must be an object');\n\t\t}\n\t}\n\n\t/**\n  * Return combined header value given name\n  *\n  * @param   String  name  Header name\n  * @return  Mixed\n  */\n\tget(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key === undefined) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this[MAP][key].join(', ');\n\t}\n\n\t/**\n  * Iterate over all headers\n  *\n  * @param   Function  callback  Executed for each item with parameters (value, name, thisArg)\n  * @param   Boolean   thisArg   `this` context for callback function\n  * @return  Void\n  */\n\tforEach(callback) {\n\t\tlet thisArg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n\t\tlet pairs = getHeaders(this);\n\t\tlet i = 0;\n\t\twhile (i < pairs.length) {\n\t\t\tvar _pairs$i = pairs[i];\n\t\t\tconst name = _pairs$i[0],\n\t\t\t      value = _pairs$i[1];\n\n\t\t\tcallback.call(thisArg, value, name, this);\n\t\t\tpairs = getHeaders(this);\n\t\t\ti++;\n\t\t}\n\t}\n\n\t/**\n  * Overwrite header values given name\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tset(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tthis[MAP][key !== undefined ? key : name] = [value];\n\t}\n\n\t/**\n  * Append a value onto existing header\n  *\n  * @param   String  name   Header name\n  * @param   String  value  Header value\n  * @return  Void\n  */\n\tappend(name, value) {\n\t\tname = `${name}`;\n\t\tvalue = `${value}`;\n\t\tvalidateName(name);\n\t\tvalidateValue(value);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tthis[MAP][key].push(value);\n\t\t} else {\n\t\t\tthis[MAP][name] = [value];\n\t\t}\n\t}\n\n\t/**\n  * Check for header name existence\n  *\n  * @param   String   name  Header name\n  * @return  Boolean\n  */\n\thas(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\treturn find(this[MAP], name) !== undefined;\n\t}\n\n\t/**\n  * Delete all header values given name\n  *\n  * @param   String  name  Header name\n  * @return  Void\n  */\n\tdelete(name) {\n\t\tname = `${name}`;\n\t\tvalidateName(name);\n\t\tconst key = find(this[MAP], name);\n\t\tif (key !== undefined) {\n\t\t\tdelete this[MAP][key];\n\t\t}\n\t}\n\n\t/**\n  * Return raw headers (non-spec api)\n  *\n  * @return  Object\n  */\n\traw() {\n\t\treturn this[MAP];\n\t}\n\n\t/**\n  * Get an iterator on keys.\n  *\n  * @return  Iterator\n  */\n\tkeys() {\n\t\treturn createHeadersIterator(this, 'key');\n\t}\n\n\t/**\n  * Get an iterator on values.\n  *\n  * @return  Iterator\n  */\n\tvalues() {\n\t\treturn createHeadersIterator(this, 'value');\n\t}\n\n\t/**\n  * Get an iterator on entries.\n  *\n  * This is the default iterator of the Headers object.\n  *\n  * @return  Iterator\n  */\n\t[Symbol.iterator]() {\n\t\treturn createHeadersIterator(this, 'key+value');\n\t}\n}\nHeaders.prototype.entries = Headers.prototype[Symbol.iterator];\n\nObject.defineProperty(Headers.prototype, Symbol.toStringTag, {\n\tvalue: 'Headers',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Headers.prototype, {\n\tget: { enumerable: true },\n\tforEach: { enumerable: true },\n\tset: { enumerable: true },\n\tappend: { enumerable: true },\n\thas: { enumerable: true },\n\tdelete: { enumerable: true },\n\tkeys: { enumerable: true },\n\tvalues: { enumerable: true },\n\tentries: { enumerable: true }\n});\n\nfunction getHeaders(headers) {\n\tlet kind = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'key+value';\n\n\tconst keys = Object.keys(headers[MAP]).sort();\n\treturn keys.map(kind === 'key' ? function (k) {\n\t\treturn k.toLowerCase();\n\t} : kind === 'value' ? function (k) {\n\t\treturn headers[MAP][k].join(', ');\n\t} : function (k) {\n\t\treturn [k.toLowerCase(), headers[MAP][k].join(', ')];\n\t});\n}\n\nconst INTERNAL = Symbol('internal');\n\nfunction createHeadersIterator(target, kind) {\n\tconst iterator = Object.create(HeadersIteratorPrototype);\n\titerator[INTERNAL] = {\n\t\ttarget,\n\t\tkind,\n\t\tindex: 0\n\t};\n\treturn iterator;\n}\n\nconst HeadersIteratorPrototype = Object.setPrototypeOf({\n\tnext() {\n\t\t// istanbul ignore if\n\t\tif (!this || Object.getPrototypeOf(this) !== HeadersIteratorPrototype) {\n\t\t\tthrow new TypeError('Value of `this` is not a HeadersIterator');\n\t\t}\n\n\t\tvar _INTERNAL = this[INTERNAL];\n\t\tconst target = _INTERNAL.target,\n\t\t      kind = _INTERNAL.kind,\n\t\t      index = _INTERNAL.index;\n\n\t\tconst values = getHeaders(target, kind);\n\t\tconst len = values.length;\n\t\tif (index >= len) {\n\t\t\treturn {\n\t\t\t\tvalue: undefined,\n\t\t\t\tdone: true\n\t\t\t};\n\t\t}\n\n\t\tthis[INTERNAL].index = index + 1;\n\n\t\treturn {\n\t\t\tvalue: values[index],\n\t\t\tdone: false\n\t\t};\n\t}\n}, Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));\n\nObject.defineProperty(HeadersIteratorPrototype, Symbol.toStringTag, {\n\tvalue: 'HeadersIterator',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * Export the Headers object in a form that Node.js can consume.\n *\n * @param   Headers  headers\n * @return  Object\n */\nfunction exportNodeCompatibleHeaders(headers) {\n\tconst obj = Object.assign({ __proto__: null }, headers[MAP]);\n\n\t// http.request() only supports string as Host header. This hack makes\n\t// specifying custom Host header possible.\n\tconst hostHeaderKey = find(headers[MAP], 'Host');\n\tif (hostHeaderKey !== undefined) {\n\t\tobj[hostHeaderKey] = obj[hostHeaderKey][0];\n\t}\n\n\treturn obj;\n}\n\n/**\n * Create a Headers object from an object of headers, ignoring those that do\n * not conform to HTTP grammar productions.\n *\n * @param   Object  obj  Object of headers\n * @return  Headers\n */\nfunction createHeadersLenient(obj) {\n\tconst headers = new Headers();\n\tfor (const name of Object.keys(obj)) {\n\t\tif (invalidTokenRegex.test(name)) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (Array.isArray(obj[name])) {\n\t\t\tfor (const val of obj[name]) {\n\t\t\t\tif (invalidHeaderCharRegex.test(val)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (headers[MAP][name] === undefined) {\n\t\t\t\t\theaders[MAP][name] = [val];\n\t\t\t\t} else {\n\t\t\t\t\theaders[MAP][name].push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!invalidHeaderCharRegex.test(obj[name])) {\n\t\t\theaders[MAP][name] = [obj[name]];\n\t\t}\n\t}\n\treturn headers;\n}\n\n/**\n * response.js\n *\n * Response class provides content decoding\n */\n\nvar _require$1 = require('http');\n\nconst STATUS_CODES = _require$1.STATUS_CODES;\n\n\nconst INTERNALS$1 = Symbol('Response internals');\n\n/**\n * Response class\n *\n * @param   Stream  body  Readable stream\n * @param   Object  opts  Response options\n * @return  Void\n */\nclass Response {\n\tconstructor() {\n\t\tlet body = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t\tlet opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tBody.call(this, body, opts);\n\n\t\tconst status = opts.status || 200;\n\n\t\tthis[INTERNALS$1] = {\n\t\t\turl: opts.url,\n\t\t\tstatus,\n\t\t\tstatusText: opts.statusText || STATUS_CODES[status],\n\t\t\theaders: new Headers(opts.headers)\n\t\t};\n\t}\n\n\tget url() {\n\t\treturn this[INTERNALS$1].url;\n\t}\n\n\tget status() {\n\t\treturn this[INTERNALS$1].status;\n\t}\n\n\t/**\n  * Convenience property representing if the request ended normally\n  */\n\tget ok() {\n\t\treturn this[INTERNALS$1].status >= 200 && this[INTERNALS$1].status < 300;\n\t}\n\n\tget statusText() {\n\t\treturn this[INTERNALS$1].statusText;\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$1].headers;\n\t}\n\n\t/**\n  * Clone this response\n  *\n  * @return  Response\n  */\n\tclone() {\n\t\treturn new Response(clone(this), {\n\t\t\turl: this.url,\n\t\t\tstatus: this.status,\n\t\t\tstatusText: this.statusText,\n\t\t\theaders: this.headers,\n\t\t\tok: this.ok\n\t\t});\n\t}\n}\n\nBody.mixIn(Response.prototype);\n\nObject.defineProperties(Response.prototype, {\n\turl: { enumerable: true },\n\tstatus: { enumerable: true },\n\tok: { enumerable: true },\n\tstatusText: { enumerable: true },\n\theaders: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\nObject.defineProperty(Response.prototype, Symbol.toStringTag, {\n\tvalue: 'Response',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\n/**\n * request.js\n *\n * Request class contains server only options\n *\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\n */\n\nvar _require$2 = require('url');\n\nconst format_url = _require$2.format;\nconst parse_url = _require$2.parse;\n\n\nconst INTERNALS$2 = Symbol('Request internals');\n\n/**\n * Check if a value is an instance of Request.\n *\n * @param   Mixed   input\n * @return  Boolean\n */\nfunction isRequest(input) {\n\treturn typeof input === 'object' && typeof input[INTERNALS$2] === 'object';\n}\n\n/**\n * Request class\n *\n * @param   Mixed   input  Url or Request instance\n * @param   Object  init   Custom options\n * @return  Void\n */\nclass Request {\n\tconstructor(input) {\n\t\tlet init = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t\tlet parsedURL;\n\n\t\t// normalize input\n\t\tif (!isRequest(input)) {\n\t\t\tif (input && input.href) {\n\t\t\t\t// in order to support Node.js' Url objects; though WHATWG's URL objects\n\t\t\t\t// will fall into this branch also (since their `toString()` will return\n\t\t\t\t// `href` property anyway)\n\t\t\t\tparsedURL = parse_url(input.href);\n\t\t\t} else {\n\t\t\t\t// coerce input to a string before attempting to parse\n\t\t\t\tparsedURL = parse_url(`${input}`);\n\t\t\t}\n\t\t\tinput = {};\n\t\t} else {\n\t\t\tparsedURL = parse_url(input.url);\n\t\t}\n\n\t\tlet method = init.method || input.method || 'GET';\n\t\tmethod = method.toUpperCase();\n\n\t\tif ((init.body != null || isRequest(input) && input.body !== null) && (method === 'GET' || method === 'HEAD')) {\n\t\t\tthrow new TypeError('Request with GET/HEAD method cannot have body');\n\t\t}\n\n\t\tlet inputBody = init.body != null ? init.body : isRequest(input) && input.body !== null ? clone(input) : null;\n\n\t\tBody.call(this, inputBody, {\n\t\t\ttimeout: init.timeout || input.timeout || 0,\n\t\t\tsize: init.size || input.size || 0\n\t\t});\n\n\t\tconst headers = new Headers(init.headers || input.headers || {});\n\n\t\tif (init.body != null) {\n\t\t\tconst contentType = extractContentType(this);\n\t\t\tif (contentType !== null && !headers.has('Content-Type')) {\n\t\t\t\theaders.append('Content-Type', contentType);\n\t\t\t}\n\t\t}\n\n\t\tthis[INTERNALS$2] = {\n\t\t\tmethod,\n\t\t\tredirect: init.redirect || input.redirect || 'follow',\n\t\t\theaders,\n\t\t\tparsedURL\n\t\t};\n\n\t\t// node-fetch-only options\n\t\tthis.follow = init.follow !== undefined ? init.follow : input.follow !== undefined ? input.follow : 20;\n\t\tthis.compress = init.compress !== undefined ? init.compress : input.compress !== undefined ? input.compress : true;\n\t\tthis.counter = init.counter || input.counter || 0;\n\t\tthis.agent = init.agent || input.agent;\n\t}\n\n\tget method() {\n\t\treturn this[INTERNALS$2].method;\n\t}\n\n\tget url() {\n\t\treturn format_url(this[INTERNALS$2].parsedURL);\n\t}\n\n\tget headers() {\n\t\treturn this[INTERNALS$2].headers;\n\t}\n\n\tget redirect() {\n\t\treturn this[INTERNALS$2].redirect;\n\t}\n\n\t/**\n  * Clone this request\n  *\n  * @return  Request\n  */\n\tclone() {\n\t\treturn new Request(this);\n\t}\n}\n\nBody.mixIn(Request.prototype);\n\nObject.defineProperty(Request.prototype, Symbol.toStringTag, {\n\tvalue: 'Request',\n\twritable: false,\n\tenumerable: false,\n\tconfigurable: true\n});\n\nObject.defineProperties(Request.prototype, {\n\tmethod: { enumerable: true },\n\turl: { enumerable: true },\n\theaders: { enumerable: true },\n\tredirect: { enumerable: true },\n\tclone: { enumerable: true }\n});\n\n/**\n * Convert a Request to Node.js http request options.\n *\n * @param   Request  A Request instance\n * @return  Object   The options object to be passed to http.request\n */\nfunction getNodeRequestOptions(request) {\n\tconst parsedURL = request[INTERNALS$2].parsedURL;\n\tconst headers = new Headers(request[INTERNALS$2].headers);\n\n\t// fetch step 1.3\n\tif (!headers.has('Accept')) {\n\t\theaders.set('Accept', '*/*');\n\t}\n\n\t// Basic fetch\n\tif (!parsedURL.protocol || !parsedURL.hostname) {\n\t\tthrow new TypeError('Only absolute URLs are supported');\n\t}\n\n\tif (!/^https?:$/.test(parsedURL.protocol)) {\n\t\tthrow new TypeError('Only HTTP(S) protocols are supported');\n\t}\n\n\t// HTTP-network-or-cache fetch steps 2.4-2.7\n\tlet contentLengthValue = null;\n\tif (request.body == null && /^(POST|PUT)$/i.test(request.method)) {\n\t\tcontentLengthValue = '0';\n\t}\n\tif (request.body != null) {\n\t\tconst totalBytes = getTotalBytes(request);\n\t\tif (typeof totalBytes === 'number') {\n\t\t\tcontentLengthValue = String(totalBytes);\n\t\t}\n\t}\n\tif (contentLengthValue) {\n\t\theaders.set('Content-Length', contentLengthValue);\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.11\n\tif (!headers.has('User-Agent')) {\n\t\theaders.set('User-Agent', 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)');\n\t}\n\n\t// HTTP-network-or-cache fetch step 2.15\n\tif (request.compress) {\n\t\theaders.set('Accept-Encoding', 'gzip,deflate');\n\t}\n\tif (!headers.has('Connection') && !request.agent) {\n\t\theaders.set('Connection', 'close');\n\t}\n\n\t// HTTP-network fetch step 4.2\n\t// chunked encoding is handled by Node.js\n\n\treturn Object.assign({}, parsedURL, {\n\t\tmethod: request.method,\n\t\theaders: exportNodeCompatibleHeaders(headers),\n\t\tagent: request.agent\n\t});\n}\n\n/**\n * index.js\n *\n * a request API compatible with window.fetch\n *\n * All spec algorithm step numbers are based on https://fetch.spec.whatwg.org/commit-snapshots/ae716822cb3a61843226cd090eefc6589446c1d2/.\n */\n\nconst http = require('http');\nconst https = require('https');\n\nvar _require$3 = require('stream');\n\nconst PassThrough$1 = _require$3.PassThrough;\n\nvar _require2 = require('url');\n\nconst resolve_url = _require2.resolve;\n\nconst zlib = require('zlib');\n\n/**\n * Fetch function\n *\n * @param   Mixed    url   Absolute url or Request instance\n * @param   Object   opts  Fetch options\n * @return  Promise\n */\nfunction fetch(url, opts) {\n\n\t// allow custom promise\n\tif (!fetch.Promise) {\n\t\tthrow new Error('native promise missing, set fetch.Promise to your favorite alternative');\n\t}\n\n\tBody.Promise = fetch.Promise;\n\n\t// wrap http.request into fetch\n\treturn new fetch.Promise(function (resolve, reject) {\n\t\t// build request object\n\t\tconst request = new Request(url, opts);\n\t\tconst options = getNodeRequestOptions(request);\n\n\t\tconst send = (options.protocol === 'https:' ? https : http).request;\n\n\t\t// send request\n\t\tconst req = send(options);\n\t\tlet reqTimeout;\n\n\t\tfunction finalize() {\n\t\t\treq.abort();\n\t\t\tclearTimeout(reqTimeout);\n\t\t}\n\n\t\tif (request.timeout) {\n\t\t\treq.once('socket', function (socket) {\n\t\t\t\treqTimeout = setTimeout(function () {\n\t\t\t\t\treject(new FetchError(`network timeout at: ${request.url}`, 'request-timeout'));\n\t\t\t\t\tfinalize();\n\t\t\t\t}, request.timeout);\n\t\t\t});\n\t\t}\n\n\t\treq.on('error', function (err) {\n\t\t\treject(new FetchError(`request to ${request.url} failed, reason: ${err.message}`, 'system', err));\n\t\t\tfinalize();\n\t\t});\n\n\t\treq.on('response', function (res) {\n\t\t\tclearTimeout(reqTimeout);\n\n\t\t\tconst headers = createHeadersLenient(res.headers);\n\n\t\t\t// HTTP fetch step 5\n\t\t\tif (fetch.isRedirect(res.statusCode)) {\n\t\t\t\t// HTTP fetch step 5.2\n\t\t\t\tconst location = headers.get('Location');\n\n\t\t\t\t// HTTP fetch step 5.3\n\t\t\t\tconst locationURL = location === null ? null : resolve_url(request.url, location);\n\n\t\t\t\t// HTTP fetch step 5.5\n\t\t\t\tswitch (request.redirect) {\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\treject(new FetchError(`redirect mode is set to error: ${request.url}`, 'no-redirect'));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\t// node-fetch-specific step: make manual redirect a bit easier to use by setting the Location header value to the resolved URL.\n\t\t\t\t\t\tif (locationURL !== null) {\n\t\t\t\t\t\t\theaders.set('Location', locationURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'follow':\n\t\t\t\t\t\t// HTTP-redirect fetch step 2\n\t\t\t\t\t\tif (locationURL === null) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 5\n\t\t\t\t\t\tif (request.counter >= request.follow) {\n\t\t\t\t\t\t\treject(new FetchError(`maximum redirect reached at: ${request.url}`, 'max-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 6 (counter increment)\n\t\t\t\t\t\t// Create a new Request object.\n\t\t\t\t\t\tconst requestOpts = {\n\t\t\t\t\t\t\theaders: new Headers(request.headers),\n\t\t\t\t\t\t\tfollow: request.follow,\n\t\t\t\t\t\t\tcounter: request.counter + 1,\n\t\t\t\t\t\t\tagent: request.agent,\n\t\t\t\t\t\t\tcompress: request.compress,\n\t\t\t\t\t\t\tmethod: request.method,\n\t\t\t\t\t\t\tbody: request.body\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 9\n\t\t\t\t\t\tif (res.statusCode !== 303 && request.body && getTotalBytes(request) === null) {\n\t\t\t\t\t\t\treject(new FetchError('Cannot follow redirect with body being a readable stream', 'unsupported-redirect'));\n\t\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 11\n\t\t\t\t\t\tif (res.statusCode === 303 || (res.statusCode === 301 || res.statusCode === 302) && request.method === 'POST') {\n\t\t\t\t\t\t\trequestOpts.method = 'GET';\n\t\t\t\t\t\t\trequestOpts.body = undefined;\n\t\t\t\t\t\t\trequestOpts.headers.delete('content-length');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// HTTP-redirect fetch step 15\n\t\t\t\t\t\tresolve(fetch(new Request(locationURL, requestOpts)));\n\t\t\t\t\t\tfinalize();\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// prepare response\n\t\t\tlet body = res.pipe(new PassThrough$1());\n\t\t\tconst response_options = {\n\t\t\t\turl: request.url,\n\t\t\t\tstatus: res.statusCode,\n\t\t\t\tstatusText: res.statusMessage,\n\t\t\t\theaders: headers,\n\t\t\t\tsize: request.size,\n\t\t\t\ttimeout: request.timeout\n\t\t\t};\n\n\t\t\t// HTTP-network fetch step 12.1.1.3\n\t\t\tconst codings = headers.get('Content-Encoding');\n\n\t\t\t// HTTP-network fetch step 12.1.1.4: handle content codings\n\n\t\t\t// in following scenarios we ignore compression support\n\t\t\t// 1. compression support is disabled\n\t\t\t// 2. HEAD request\n\t\t\t// 3. no Content-Encoding header\n\t\t\t// 4. no content response (204)\n\t\t\t// 5. content not modified response (304)\n\t\t\tif (!request.compress || request.method === 'HEAD' || codings === null || res.statusCode === 204 || res.statusCode === 304) {\n\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For Node v6+\n\t\t\t// Be less strict when decoding compressed responses, since sometimes\n\t\t\t// servers send slightly invalid responses that are still accepted\n\t\t\t// by common browsers.\n\t\t\t// Always using Z_SYNC_FLUSH is what cURL does.\n\t\t\tconst zlibOptions = {\n\t\t\t\tflush: zlib.Z_SYNC_FLUSH,\n\t\t\t\tfinishFlush: zlib.Z_SYNC_FLUSH\n\t\t\t};\n\n\t\t\t// for gzip\n\t\t\tif (codings == 'gzip' || codings == 'x-gzip') {\n\t\t\t\tbody = body.pipe(zlib.createGunzip(zlibOptions));\n\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for deflate\n\t\t\tif (codings == 'deflate' || codings == 'x-deflate') {\n\t\t\t\t// handle the infamous raw deflate response from old servers\n\t\t\t\t// a hack for old IIS and Apache servers\n\t\t\t\tconst raw = res.pipe(new PassThrough$1());\n\t\t\t\traw.once('data', function (chunk) {\n\t\t\t\t\t// see http://stackoverflow.com/questions/37519828\n\t\t\t\t\tif ((chunk[0] & 0x0F) === 0x08) {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflate());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbody = body.pipe(zlib.createInflateRaw());\n\t\t\t\t\t}\n\t\t\t\t\tresolve(new Response(body, response_options));\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// otherwise, use response as-is\n\t\t\tresolve(new Response(body, response_options));\n\t\t});\n\n\t\twriteToStream(req, request);\n\t});\n}\n\n/**\n * Redirect code matching\n *\n * @param   Number   code  Status code\n * @return  Boolean\n */\nfetch.isRedirect = function (code) {\n\treturn code === 301 || code === 302 || code === 303 || code === 307 || code === 308;\n};\n\n// Needed for TypeScript.\nfetch.default = fetch;\n\n// expose Promise\nfetch.Promise = global.Promise;\n\nexport default fetch;\nexport { Headers, Request, Response, FetchError };\n","var nodeFetch = require('node-fetch');\nvar realFetch = nodeFetch.default || nodeFetch;\n\nvar fetch = function (url, options) {\n  // Support schemaless URIs on the server for parity with the browser.\n  // Ex: //github.com/ -> https://github.com/\n  if (/^\\/\\//.test(url)) {\n    url = 'https:' + url;\n  }\n  return realFetch.call(this, url, options);\n};\n\nfetch.polyfill = false;\n\nmodule.exports = exports = fetch;\nexports.fetch = fetch;\nexports.Headers = nodeFetch.Headers;\nexports.Request = nodeFetch.Request;\nexports.Response = nodeFetch.Response;\n\n// Needed for TypeScript.\nexports.default = fetch;\n","import querystring from 'querystring';\nimport fetch from 'cross-fetch';\nimport { btoa, removeUndefined } from '../../utils/index';\n\n/**\n * To perform fetch request\n * @param {Object} args\n * @param {String} args.method\n * @param {String} args.path\n * @param {Object} args.params\n * @param {Object} args.body\n */\nfunction fetchRequest(args) {\n  return new Promise((resolve, reject) => {\n    const parsedArgs = removeUndefined(args);\n    try {\n      const {\n method, path, params, body,\n} = parsedArgs;\n      let bodyCopy = body;\n      const contentType = path.endsWith('msearch') || path.endsWith('bulk')\n          ? 'application/x-ndjson'\n          : 'application/json';\n      const headers = Object.assign(\n        {},\n        {\n          Accept: 'application/json',\n          'Content-Type': contentType,\n        },\n        this.headers,\n      );\n      const timestamp = Date.now();\n      if (this.credentials) {\n        headers.Authorization = `Basic ${btoa(this.credentials)}`;\n      }\n      const requestOptions = {\n        method,\n        headers,\n      };\n      if (Array.isArray(bodyCopy)) {\n        let arrayBody = '';\n        bodyCopy.forEach((item) => {\n          arrayBody += JSON.stringify(item);\n          arrayBody += '\\n';\n        });\n\n        bodyCopy = arrayBody;\n      } else {\n        bodyCopy = JSON.stringify(bodyCopy) || {};\n      }\n\n      if (Object.keys(bodyCopy).length !== 0) {\n        requestOptions.body = bodyCopy;\n      }\n\n      let finalRequest = requestOptions;\n      if (this.transformRequest) {\n        finalRequest = this.transformRequest(requestOptions);\n      }\n      let responseHeaders = {};\n      return fetch(\n        `${this.protocol}://${this.url}/${this.app}/${path}?${querystring.stringify(params)}`,\n        finalRequest,\n      ).then((res) => {\n        if (res.status >= 500) {\n          return reject(res);\n        }\n        responseHeaders = res.headers;\n        return res.json().then((data) => {\n          if (res.status >= 400) {\n            return reject(res);\n          }\n          const response = Object.assign({}, data, {\n            _timestamp: timestamp,\n            _headers: responseHeaders,\n          });\n          return resolve(response);\n        });\n      });\n    } catch (e) {\n      return reject(e);\n    }\n  });\n}\nexport default fetchRequest;\n","import querystring from 'querystring';\nimport {\n uuidv4, btoa, removeUndefined, waitForSocketConnection,\n} from '../../utils/index';\n\nconst WebSocket = typeof window !== 'undefined' ? window.WebSocket : require('ws');\n\n/**\n * To connect a web socket\n * @param {Object} args\n * @param {String} args.method\n * @param {String} args.path\n * @param {Object} args.params\n * @param {Object} args.body\n */\nfunction wsRequest(args, onData, onError, onClose) {\n  try {\n    const parsedArgs = removeUndefined(args);\n    const { method, path, params } = parsedArgs;\n    let bodyCopy = args.body;\n    if (!bodyCopy || typeof bodyCopy !== 'object') {\n      bodyCopy = {};\n    }\n    const init = () => {\n      this.ws = new WebSocket(`wss://${this.url}/${this.app}`);\n      this.id = uuidv4();\n\n      this.request = {\n        id: this.id,\n        path: `${this.app}/${path}?${querystring.stringify(params)}`,\n        method,\n        body: bodyCopy,\n      };\n      if (this.credentials) {\n        this.request.authorization = `Basic ${btoa(this.credentials)}`;\n      }\n      this.result = {};\n      this.closeHandler = () => {\n        this.wsClosed();\n      };\n      this.errorHandler = (err) => {\n        this.processError(...[err]);\n      };\n      this.messageHandler = (message) => {\n        const dataObj = JSON.parse(message.data);\n        if (dataObj.body && dataObj.body.status >= 400) {\n          this.processError(...[dataObj]);\n        } else {\n          this.processMessage(...[dataObj]);\n        }\n      };\n      this.send = (request) => {\n        waitForSocketConnection(this.ws, () => {\n          try {\n            this.ws.send(JSON.stringify(request));\n          } catch (e) {\n            console.warn(e);\n          }\n        });\n      };\n      this.ws.onmessage = this.messageHandler;\n      this.ws.onerror = this.errorHandler;\n      this.ws.onclose = this.closeHandler;\n      this.send(this.request);\n      this.result.stop = this.stop;\n      this.result.reconnect = this.reconnect;\n\n      return this.result;\n    };\n    this.wsClosed = () => {\n      if (onClose) {\n        onClose();\n      }\n    };\n    this.stop = () => {\n      this.ws.onmessage = undefined;\n      this.ws.onclose = undefined;\n      this.ws.onerror = undefined;\n      this.wsClosed();\n      const unsubRequest = JSON.parse(JSON.stringify(this.request));\n      unsubRequest.unsubscribe = true;\n\n      if (this.unsubscribed !== true) {\n        this.send(unsubRequest);\n      }\n\n      this.unsubscribed = true;\n    };\n    this.reconnect = () => {\n      this.stop();\n      return wsRequest(args, onData, onError, onClose);\n    };\n    this.processError = (err) => {\n      if (onError) {\n        onError(err);\n      } else {\n        console.warn(err);\n      }\n    };\n\n    this.processMessage = (origDataObj) => {\n      const dataObj = JSON.parse(JSON.stringify(origDataObj));\n      if (!dataObj.id && dataObj.message) {\n        if (onError) {\n          onError(dataObj);\n        }\n        return;\n      }\n\n      if (dataObj.id === this.id) {\n        if (dataObj.message) {\n          delete dataObj.id;\n          if (onError) {\n            onError(dataObj);\n          }\n          return;\n        }\n\n        if (dataObj.query_id) {\n          this.query_id = dataObj.query_id;\n        }\n\n        if (dataObj.channel) {\n          this.channel = dataObj.channel;\n        }\n\n        if (dataObj.body && dataObj.body !== '') {\n          if (onData) {\n            onData(dataObj.body);\n          }\n        }\n\n        return;\n      }\n\n      if (!dataObj.id && dataObj.channel && dataObj.channel === this.channel) {\n        if (onData) {\n          onData(dataObj.event);\n        }\n      }\n    };\n    return init();\n  } catch (e) {\n    if (onError) {\n      onError(e);\n    } else {\n      console.warn(e);\n    }\n    return null;\n  }\n}\nexport default wsRequest;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Index Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n * @param {String} args.id\n */\nfunction indexApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    type: 'string',\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n  const { type, id, body } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.body;\n  delete parsedArgs.id;\n\n  let path;\n  if (id) {\n    path = `${type}/${encodeURIComponent(id)}`;\n  } else {\n    path = type;\n  }\n  return this.performFetchRequest({\n    method: 'POST',\n    path,\n    params: parsedArgs,\n    body,\n  });\n}\nexport default indexApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Get Service\n * @param {Object} args\n * @param {String} args.type\n * @param {String} args.id\n */\nfunction getApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    type: 'string',\n    id: 'string',\n  });\n\n  if (valid !== true) {\n    throw valid;\n  }\n\n  const { type, id } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.id;\n\n  const path = `${type}/${encodeURIComponent(id)}`;\n\n  return this.performFetchRequest({\n    method: 'GET',\n    path,\n    params: parsedArgs,\n  });\n}\nexport default getApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Update Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n * @param {String} args.id\n */\nfunction updateApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    type: 'string',\n    id: 'string',\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  const { type, id, body } = parsedArgs;\n  delete parsedArgs.type;\n  delete parsedArgs.id;\n  delete parsedArgs.body;\n  const path = `${type}/${encodeURIComponent(id)}/_update`;\n\n  return this.performFetchRequest({\n    method: 'POST',\n    path,\n    params: parsedArgs,\n    body,\n  });\n}\nexport default updateApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Delete Service\n * @param {Object} args\n * @param {String} args.type\n * @param {String} args.id\n */\nfunction deleteApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    type: 'string',\n    id: 'string',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  const { type, id } = parsedArgs;\n  delete parsedArgs.type;\n  delete parsedArgs.id;\n\n  const path = `${type}/${encodeURIComponent(id)}`;\n\n  return this.performFetchRequest({\n    method: 'DELETE',\n    path,\n    params: parsedArgs,\n  });\n}\nexport default deleteApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Bulk Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n */\nfunction bulkApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  const { type, body } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.body;\n\n  let path;\n  if (type) {\n    path = `${type}/_bulk`;\n  } else {\n    path = '/_bulk';\n  }\n\n  return this.performFetchRequest({\n    method: 'POST',\n    path,\n    params: parsedArgs,\n    body,\n  });\n}\nexport default bulkApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Search Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n */\nfunction searchApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  let type;\n  if (Array.isArray(parsedArgs.type)) {\n    type = parsedArgs.type.join();\n  } else {\n    // eslint-disable-next-line\n    type = parsedArgs.type;\n  }\n\n  const { body } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.body;\n\n  let path;\n  if (type) {\n    path = `${type}/_search`;\n  } else {\n    path = '_search';\n  }\n\n  return this.performFetchRequest({\n    method: 'POST',\n    path,\n    params: parsedArgs,\n    body,\n  });\n}\nexport default searchApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Msearch Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n */\nfunction msearchApi(args) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  let type;\n  if (Array.isArray(parsedArgs.type)) {\n    type = parsedArgs.type.join();\n  } else {\n    ({ type } = parsedArgs);\n  }\n\n  const { body } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.body;\n\n  let path;\n  if (type) {\n    path = `${type}/_msearch`;\n  } else {\n    path = '_msearch';\n  }\n\n  return this.performFetchRequest({\n    method: 'POST',\n    path,\n    params: parsedArgs,\n    body,\n  });\n}\nexport default msearchApi;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Stream Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Boolean} args.stream\n * @param {String} args.id\n * @param {Function} onData\n * @param {Function} onError\n * @param {Function} onClose\n */\nfunction getStream(args, ...rest) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    type: 'string',\n    id: 'string',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  const { type, id } = parsedArgs;\n\n  delete parsedArgs.type;\n  delete parsedArgs.id;\n  delete parsedArgs.stream;\n\n  if (parsedArgs.stream === true) {\n    parsedArgs.stream = 'true';\n  } else {\n    delete parsedArgs.stream;\n    parsedArgs.streamonly = 'true';\n  }\n\n  return this.performWsRequest(\n    {\n      method: 'GET',\n      path: `${type}/${encodeURIComponent(id)}`,\n      params: parsedArgs,\n    },\n    ...rest,\n  );\n}\nexport default getStream;\n","import { removeUndefined, validate } from '../../utils/index';\n\n/**\n * Search Stream\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n * @param {Boolean} args.stream\n * @param {Function} onData\n * @param {Function} onError\n * @param {Function} onClose\n */\nfunction searchStreamApi(args, ...rest) {\n  const parsedArgs = removeUndefined(args);\n  // Validate arguments\n  const valid = validate(parsedArgs, {\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  if (\n    parsedArgs.type === undefined\n    || (Array.isArray(parsedArgs.type) && parsedArgs.type.length === 0)\n  ) {\n    throw new Error('Missing fields: type');\n  }\n\n  let type;\n  if (Array.isArray(parsedArgs.type)) {\n    type = parsedArgs.type.join();\n  } else {\n    ({ type } = parsedArgs);\n  }\n\n  const { body } = parsedArgs;\n  delete parsedArgs.type;\n  delete parsedArgs.body;\n  delete parsedArgs.stream;\n\n  parsedArgs.streamonly = 'true';\n\n  return this.performWsRequest(\n    {\n      method: 'POST',\n      path: `${type}/_search`,\n      params: parsedArgs,\n      body,\n    },\n    ...rest,\n  );\n}\nexport default searchStreamApi;\n","var at, // The index of the current character\n    ch, // The current character\n    escapee = {\n        '\"':  '\"',\n        '\\\\': '\\\\',\n        '/':  '/',\n        b:    '\\b',\n        f:    '\\f',\n        n:    '\\n',\n        r:    '\\r',\n        t:    '\\t'\n    },\n    text,\n\n    error = function (m) {\n        // Call error when something is wrong.\n        throw {\n            name:    'SyntaxError',\n            message: m,\n            at:      at,\n            text:    text\n        };\n    },\n    \n    next = function (c) {\n        // If a c parameter is provided, verify that it matches the current character.\n        if (c && c !== ch) {\n            error(\"Expected '\" + c + \"' instead of '\" + ch + \"'\");\n        }\n        \n        // Get the next character. When there are no more characters,\n        // return the empty string.\n        \n        ch = text.charAt(at);\n        at += 1;\n        return ch;\n    },\n    \n    number = function () {\n        // Parse a number value.\n        var number,\n            string = '';\n        \n        if (ch === '-') {\n            string = '-';\n            next('-');\n        }\n        while (ch >= '0' && ch <= '9') {\n            string += ch;\n            next();\n        }\n        if (ch === '.') {\n            string += '.';\n            while (next() && ch >= '0' && ch <= '9') {\n                string += ch;\n            }\n        }\n        if (ch === 'e' || ch === 'E') {\n            string += ch;\n            next();\n            if (ch === '-' || ch === '+') {\n                string += ch;\n                next();\n            }\n            while (ch >= '0' && ch <= '9') {\n                string += ch;\n                next();\n            }\n        }\n        number = +string;\n        if (!isFinite(number)) {\n            error(\"Bad number\");\n        } else {\n            return number;\n        }\n    },\n    \n    string = function () {\n        // Parse a string value.\n        var hex,\n            i,\n            string = '',\n            uffff;\n        \n        // When parsing for string values, we must look for \" and \\ characters.\n        if (ch === '\"') {\n            while (next()) {\n                if (ch === '\"') {\n                    next();\n                    return string;\n                } else if (ch === '\\\\') {\n                    next();\n                    if (ch === 'u') {\n                        uffff = 0;\n                        for (i = 0; i < 4; i += 1) {\n                            hex = parseInt(next(), 16);\n                            if (!isFinite(hex)) {\n                                break;\n                            }\n                            uffff = uffff * 16 + hex;\n                        }\n                        string += String.fromCharCode(uffff);\n                    } else if (typeof escapee[ch] === 'string') {\n                        string += escapee[ch];\n                    } else {\n                        break;\n                    }\n                } else {\n                    string += ch;\n                }\n            }\n        }\n        error(\"Bad string\");\n    },\n\n    white = function () {\n\n// Skip whitespace.\n\n        while (ch && ch <= ' ') {\n            next();\n        }\n    },\n\n    word = function () {\n\n// true, false, or null.\n\n        switch (ch) {\n        case 't':\n            next('t');\n            next('r');\n            next('u');\n            next('e');\n            return true;\n        case 'f':\n            next('f');\n            next('a');\n            next('l');\n            next('s');\n            next('e');\n            return false;\n        case 'n':\n            next('n');\n            next('u');\n            next('l');\n            next('l');\n            return null;\n        }\n        error(\"Unexpected '\" + ch + \"'\");\n    },\n\n    value,  // Place holder for the value function.\n\n    array = function () {\n\n// Parse an array value.\n\n        var array = [];\n\n        if (ch === '[') {\n            next('[');\n            white();\n            if (ch === ']') {\n                next(']');\n                return array;   // empty array\n            }\n            while (ch) {\n                array.push(value());\n                white();\n                if (ch === ']') {\n                    next(']');\n                    return array;\n                }\n                next(',');\n                white();\n            }\n        }\n        error(\"Bad array\");\n    },\n\n    object = function () {\n\n// Parse an object value.\n\n        var key,\n            object = {};\n\n        if (ch === '{') {\n            next('{');\n            white();\n            if (ch === '}') {\n                next('}');\n                return object;   // empty object\n            }\n            while (ch) {\n                key = string();\n                white();\n                next(':');\n                if (Object.hasOwnProperty.call(object, key)) {\n                    error('Duplicate key \"' + key + '\"');\n                }\n                object[key] = value();\n                white();\n                if (ch === '}') {\n                    next('}');\n                    return object;\n                }\n                next(',');\n                white();\n            }\n        }\n        error(\"Bad object\");\n    };\n\nvalue = function () {\n\n// Parse a JSON value. It could be an object, an array, a string, a number,\n// or a word.\n\n    white();\n    switch (ch) {\n    case '{':\n        return object();\n    case '[':\n        return array();\n    case '\"':\n        return string();\n    case '-':\n        return number();\n    default:\n        return ch >= '0' && ch <= '9' ? number() : word();\n    }\n};\n\n// Return the json_parse function. It will have access to all of the above\n// functions and variables.\n\nmodule.exports = function (source, reviver) {\n    var result;\n    \n    text = source;\n    at = 0;\n    ch = ' ';\n    result = value();\n    white();\n    if (ch) {\n        error(\"Syntax error\");\n    }\n\n    // If there is a reviver function, we recursively walk the new structure,\n    // passing each name/value pair to the reviver function for possible\n    // transformation, starting with a temporary root object that holds the result\n    // in an empty key. If there is not a reviver function, we simply return the\n    // result.\n\n    return typeof reviver === 'function' ? (function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && typeof value === 'object') {\n            for (k in value) {\n                if (Object.prototype.hasOwnProperty.call(value, k)) {\n                    v = walk(value, k);\n                    if (v !== undefined) {\n                        value[k] = v;\n                    } else {\n                        delete value[k];\n                    }\n                }\n            }\n        }\n        return reviver.call(holder, key, value);\n    }({'': result}, '')) : result;\n};\n","var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n    escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n    gap,\n    indent,\n    meta = {    // table of character substitutions\n        '\\b': '\\\\b',\n        '\\t': '\\\\t',\n        '\\n': '\\\\n',\n        '\\f': '\\\\f',\n        '\\r': '\\\\r',\n        '\"' : '\\\\\"',\n        '\\\\': '\\\\\\\\'\n    },\n    rep;\n\nfunction quote(string) {\n    // If the string contains no control characters, no quote characters, and no\n    // backslash characters, then we can safely slap some quotes around it.\n    // Otherwise we must also replace the offending characters with safe escape\n    // sequences.\n    \n    escapable.lastIndex = 0;\n    return escapable.test(string) ? '\"' + string.replace(escapable, function (a) {\n        var c = meta[a];\n        return typeof c === 'string' ? c :\n            '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n    }) + '\"' : '\"' + string + '\"';\n}\n\nfunction str(key, holder) {\n    // Produce a string from holder[key].\n    var i,          // The loop counter.\n        k,          // The member key.\n        v,          // The member value.\n        length,\n        mind = gap,\n        partial,\n        value = holder[key];\n    \n    // If the value has a toJSON method, call it to obtain a replacement value.\n    if (value && typeof value === 'object' &&\n            typeof value.toJSON === 'function') {\n        value = value.toJSON(key);\n    }\n    \n    // If we were called with a replacer function, then call the replacer to\n    // obtain a replacement value.\n    if (typeof rep === 'function') {\n        value = rep.call(holder, key, value);\n    }\n    \n    // What happens next depends on the value's type.\n    switch (typeof value) {\n        case 'string':\n            return quote(value);\n        \n        case 'number':\n            // JSON numbers must be finite. Encode non-finite numbers as null.\n            return isFinite(value) ? String(value) : 'null';\n        \n        case 'boolean':\n        case 'null':\n            // If the value is a boolean or null, convert it to a string. Note:\n            // typeof null does not produce 'null'. The case is included here in\n            // the remote chance that this gets fixed someday.\n            return String(value);\n            \n        case 'object':\n            if (!value) return 'null';\n            gap += indent;\n            partial = [];\n            \n            // Array.isArray\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n                length = value.length;\n                for (i = 0; i < length; i += 1) {\n                    partial[i] = str(i, value) || 'null';\n                }\n                \n                // Join all of the elements together, separated with commas, and\n                // wrap them in brackets.\n                v = partial.length === 0 ? '[]' : gap ?\n                    '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']' :\n                    '[' + partial.join(',') + ']';\n                gap = mind;\n                return v;\n            }\n            \n            // If the replacer is an array, use it to select the members to be\n            // stringified.\n            if (rep && typeof rep === 'object') {\n                length = rep.length;\n                for (i = 0; i < length; i += 1) {\n                    k = rep[i];\n                    if (typeof k === 'string') {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n            else {\n                // Otherwise, iterate through all of the keys in the object.\n                for (k in value) {\n                    if (Object.prototype.hasOwnProperty.call(value, k)) {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n            \n        // Join all of the member texts together, separated with commas,\n        // and wrap them in braces.\n\n        v = partial.length === 0 ? '{}' : gap ?\n            '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + '}' :\n            '{' + partial.join(',') + '}';\n        gap = mind;\n        return v;\n    }\n}\n\nmodule.exports = function (value, replacer, space) {\n    var i;\n    gap = '';\n    indent = '';\n    \n    // If the space parameter is a number, make an indent string containing that\n    // many spaces.\n    if (typeof space === 'number') {\n        for (i = 0; i < space; i += 1) {\n            indent += ' ';\n        }\n    }\n    // If the space parameter is a string, it will be used as the indent string.\n    else if (typeof space === 'string') {\n        indent = space;\n    }\n\n    // If there is a replacer, it must be a function or an array.\n    // Otherwise, throw an error.\n    rep = replacer;\n    if (replacer && typeof replacer !== 'function'\n    && (typeof replacer !== 'object' || typeof replacer.length !== 'number')) {\n        throw new Error('JSON.stringify');\n    }\n    \n    // Make a fake root object containing our value under the key of ''.\n    // Return the result of stringifying the value.\n    return str('', {'': value});\n};\n","var json = typeof JSON !== 'undefined' ? JSON : require('jsonify');\n\nmodule.exports = function (obj, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var space = opts.space || '';\n    if (typeof space === 'number') space = Array(space+1).join(' ');\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n    var replacer = opts.replacer || function(key, value) { return value; };\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (parent, key, node, level) {\n        var indent = space ? ('\\n' + new Array(level + 1).join(space)) : '';\n        var colonSeparator = space ? ': ' : ':';\n\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        node = replacer.call(parent, key, node);\n\n        if (node === undefined) {\n            return;\n        }\n        if (typeof node !== 'object' || node === null) {\n            return json.stringify(node);\n        }\n        if (isArray(node)) {\n            var out = [];\n            for (var i = 0; i < node.length; i++) {\n                var item = stringify(node, i, node[i], level+1) || json.stringify(null);\n                out.push(indent + space + item);\n            }\n            return '[' + out.join(',') + indent + ']';\n        }\n        else {\n            if (seen.indexOf(node) !== -1) {\n                if (cycles) return json.stringify('__cycle__');\n                throw new TypeError('Converting circular structure to JSON');\n            }\n            else seen.push(node);\n\n            var keys = objectKeys(node).sort(cmp && cmp(node));\n            var out = [];\n            for (var i = 0; i < keys.length; i++) {\n                var key = keys[i];\n                var value = stringify(node, key, node[key], level+1);\n\n                if(!value) continue;\n\n                var keyValue = json.stringify(key)\n                    + colonSeparator\n                    + value;\n                ;\n                out.push(indent + space + keyValue);\n            }\n            seen.splice(seen.indexOf(node), 1);\n            return '{' + out.join(',') + indent + '}';\n        }\n    })({ '': obj }, '', obj, 0);\n};\n\nvar isArray = Array.isArray || function (x) {\n    return {}.toString.call(x) === '[object Array]';\n};\n\nvar objectKeys = Object.keys || function (obj) {\n    var has = Object.prototype.hasOwnProperty || function () { return true };\n    var keys = [];\n    for (var key in obj) {\n        if (has.call(obj, key)) keys.push(key);\n    }\n    return keys;\n};\n","import stringify from 'json-stable-stringify';\nimport { removeUndefined, validate, btoa } from '../../utils/index';\n\n/**\n * Webhook Service\n * @param {Object} args\n * @param {String} args.type\n * @param {Object} args.body\n * @param {Object} webhook\n * @param {Function} onData\n * @param {Function} onError\n * @param {Function} onClose\n */\nfunction searchStreamToURLApi(args, webhook, ...rest) {\n  const parsedArgs = removeUndefined(args);\n  let bodyCopy = parsedArgs.body;\n  let type;\n  let typeString;\n  // Validate arguments\n  let valid = validate(parsedArgs, {\n    body: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  if (\n    parsedArgs.type === undefined\n    || !(typeof parsedArgs.type === 'string' || Array.isArray(parsedArgs.type))\n    || (parsedArgs.type === '' || parsedArgs.type.length === 0)\n  ) {\n    throw new Error('fields missing: type');\n  }\n\n  valid = validate(parsedArgs.body, {\n    query: 'object',\n  });\n  if (valid !== true) {\n    throw valid;\n  }\n\n  if (Array.isArray(parsedArgs.type)) {\n    ({ type } = parsedArgs);\n    typeString = parsedArgs.type.join();\n  } else {\n    type = [parsedArgs.type];\n    typeString = parsedArgs.type;\n  }\n\n  let webhooks = [];\n  const { query } = bodyCopy;\n\n  if (typeof webhook === 'string') {\n    const webHookObj = {};\n    webHookObj.url = webhook;\n    webHookObj.method = 'GET';\n    webhooks.push(webHookObj);\n  } else if (webhook.constructor === Array) {\n    webhooks = webhook;\n  } else if (webhook === Object(webhook)) {\n    webhooks.push(webhook);\n  } else {\n    throw new Error('fields missing: second argument(webhook) is necessary');\n  }\n\n  const populateBody = () => {\n    bodyCopy = {};\n    bodyCopy.webhooks = webhooks;\n    bodyCopy.query = query;\n    bodyCopy.type = type;\n  };\n\n  populateBody();\n\n  const encode64 = btoa(stringify(query));\n  const path = `.percolator/webhooks-0-${typeString}-0-${encode64}`;\n\n  this.change = () => {\n    webhooks = [];\n\n    if (typeof parsedArgs === 'string') {\n      const webhook2 = {};\n      webhook2.url = parsedArgs;\n      webhook2.method = 'POST';\n      webhooks.push(webhook2);\n    } else if (parsedArgs.constructor === Array) {\n      webhooks = parsedArgs;\n    } else if (parsedArgs === Object(parsedArgs)) {\n      webhooks.push(parsedArgs);\n    } else {\n      throw new Error('fields missing: one of webhook or url fields is required');\n    }\n\n    populateBody();\n\n    return this.performRequest('POST');\n  };\n  this.stop = () => {\n    bodyCopy = undefined;\n    return this.performRequest('DELETE');\n  };\n  this.performRequest = (method) => {\n    const res = this.performWsRequest(\n      {\n        method,\n        path,\n        body: bodyCopy,\n      },\n      ...rest,\n    );\n\n    res.change = this.change;\n    res.stop = this.stop;\n\n    return res;\n  };\n  return this.performRequest('POST');\n}\nexport default searchStreamToURLApi;\n","/**\n * To get types\n */\nfunction getTypesService() {\n  return new Promise((resolve, reject) => {\n    try {\n      return this.performFetchRequest({\n        method: 'GET',\n        path: '_mapping',\n      }).then((data) => {\n        const types = Object.keys(data[this.app].mappings).filter(type => type !== '_default_');\n        return resolve(types);\n      });\n    } catch (e) {\n      return reject(e);\n    }\n  });\n}\nexport default getTypesService;\n","/**\n * To get mappings\n */\nfunction getMappings() {\n  return this.performFetchRequest({\n    method: 'GET',\n    path: '_mapping',\n  });\n}\nexport default getMappings;\n","import AppBaseClient from './core/index';\nimport fetchRequest from './core/request/fetch';\nimport wsRequest from './core/request/ws';\nimport indexApi from './core/api/index';\nimport getApi from './core/api/get';\nimport updateApi from './core/api/update';\nimport deleteApi from './core/api/delete';\nimport bulkApi from './core/api/bulk';\nimport searchApi from './core/api/search';\nimport msearchApi from './core/api/msearch';\nimport getStreamApi from './core/api/getStream';\nimport searchStreamApi from './core/api/searchStream';\nimport searchStreamToURLApi from './core/api/searchStreamToURL';\nimport getTypesApi from './core/api/getTypes';\nimport getMappingsApi from './core/api/getMappings';\n\nexport default function (config) {\n  const client = new AppBaseClient(config);\n\n  AppBaseClient.prototype.performFetchRequest = fetchRequest;\n\n  AppBaseClient.prototype.performWsRequest = wsRequest;\n\n  AppBaseClient.prototype.index = indexApi;\n\n  AppBaseClient.prototype.get = getApi;\n\n  AppBaseClient.prototype.update = updateApi;\n\n  AppBaseClient.prototype.delete = deleteApi;\n\n  AppBaseClient.prototype.bulk = bulkApi;\n\n  AppBaseClient.prototype.search = searchApi;\n\n  AppBaseClient.prototype.msearch = msearchApi;\n\n  AppBaseClient.prototype.getStream = getStreamApi;\n\n  AppBaseClient.prototype.searchStream = searchStreamApi;\n\n  AppBaseClient.prototype.searchStreamToURL = searchStreamToURLApi;\n\n  AppBaseClient.prototype.getTypes = getTypesApi;\n\n  AppBaseClient.prototype.getMappings = getMappingsApi;\n\n  AppBaseClient.prototype.setHeaders = function (headers) {\n    this.headers = headers;\n  };\n\n  if (typeof window !== 'undefined') {\n    window.Appbase = client;\n  }\n  return client;\n}\n"],"names":["url","pattern","RegExp","matches","match","protocol","auth","host","path","query","hash","btoa","input","str","output","charCode","block","i","map","charAt","charCodeAt","Error","validate","object","fields","invalid","emptyFor","string","Object","keys","forEach","key","type","push","missing","length","removeUndefined","value","constructor","JSON","parse","stringify","AppBase","config","URL","app","slice","credentials","username","password","substring","indexOf","isAppbase","this","headers","hasOwnProperty","obj","prop","prototype","call","qs","sep","eq","options","regexp","split","maxKeys","len","kstr","vstr","k","v","x","replace","idx","substr","decodeURIComponent","Array","isArray","stringifyPrimitive","isFinite","name","undefined","ks","encodeURIComponent","join","exports","require$$0","require$$1","BUFFER","Symbol","TYPE","Blob","[object Object]","blobParts","arguments","buffers","a","Number","element","buffer","Buffer","ArrayBuffer","isView","from","byteOffset","byteLength","String","concat","toLowerCase","test","size","start","end","relativeStart","relativeEnd","Math","max","min","span","slicedBuffer","blob","FetchError","message","systemError","code","errno","captureStackTrace","defineProperties","enumerable","defineProperty","toStringTag","writable","configurable","create","Stream","require","PassThrough","convert","e","INTERNALS","Body","body","_this","_ref","_ref$size","_ref$timeout","timeout","isURLSearchParams","isBuffer","toString","disturbed","error","on","err","consumeBody","_this4","Promise","reject","TypeError","resolve","alloc","accum","accumBytes","abort","resTimeout","setTimeout","chunk","clearTimeout","append","delete","get","getAll","has","set","sort","clone","instance","p1","p2","bodyUsed","getBoundary","pipe","getTotalBytes","getLengthSync","_lengthRetrievers","hasKnownLength","then","buf","ct","assign","_this2","_this3","res","charset","exec","pop","convertBody","arrayBuffer","json","text","mixIn","proto","getOwnPropertyNames","desc","getOwnPropertyDescriptor","global","invalidTokenRegex","invalidHeaderCharRegex","validateName","validateValue","find","MAP","Headers","init","rawHeaders","raw","headerNames","headerName","method","iterator","pairs","pair","callback","thisArg","getHeaders","_pairs$i","createHeadersIterator","kind","entries","values","INTERNAL","target","HeadersIteratorPrototype","index","setPrototypeOf","getPrototypeOf","_INTERNAL","done","STATUS_CODES","INTERNALS$1","Response","opts","status","statusText","ok","_require$2","format_url","format","parse_url","INTERNALS$2","isRequest","Request","parsedURL","href","toUpperCase","inputBody","contentType","extractContentType","redirect","follow","compress","counter","agent","getNodeRequestOptions","request","hostname","contentLengthValue","totalBytes","__proto__","hostHeaderKey","exportNodeCompatibleHeaders","http","https","PassThrough$1","resolve_url","zlib","fetch","req","send","reqTimeout","finalize","once","socket","val","createHeadersLenient","isRedirect","statusCode","location","locationURL","requestOpts","response_options","statusMessage","codings","zlibOptions","flush","Z_SYNC_FLUSH","finishFlush","createGunzip","createInflate","createInflateRaw","dest","write","writeToStream","default","realFetch","nodeFetch","polyfill","module","fetchRequest","args","parsedArgs","params","bodyCopy","endsWith","Accept","Content-Type","timestamp","Date","now","Authorization","requestOptions","arrayBody","item","finalRequest","transformRequest","responseHeaders","querystring","data","response","_timestamp","_headers","WebSocket","window","wsRequest","onData","onError","onClose","ws","id","c","r","random","authorization","result","closeHandler","wsClosed","errorHandler","processError","messageHandler","dataObj","processMessage","waitForSocketConnection","readyState","console","warn","onmessage","onerror","onclose","stop","reconnect","unsubRequest","unsubscribe","unsubscribed","origDataObj","query_id","channel","event","indexApi","valid","performFetchRequest","getApi","updateApi","deleteApi","bulkApi","searchApi","msearchApi","getStream","rest","stream","streamonly","performWsRequest","searchStreamApi","at","ch","escapee","\"","\\","/","b","f","n","t","m","next","number","hex","uffff","parseInt","fromCharCode","white","array","word","gap","indent","rep","escapable","meta","\b","\t","\n","\f","\r","quote","lastIndex","source","reviver","walk","holder","replacer","space","partial","mind","toJSON","apply","cmp","cycles","node","aobj","bobj","seen","parent","level","colonSeparator","out","objectKeys","keyValue","splice","searchStreamToURLApi","webhook","typeString","webhooks","webHookObj","populateBody","change","webhook2","performRequest","getTypesService","types","mappings","filter","getMappings","client","AppBaseClient","update","bulk","search","msearch","getStreamApi","searchStream","searchStreamToURL","getTypes","getTypesApi","getMappingsApi","setHeaders","Appbase"],"mappings":"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"}