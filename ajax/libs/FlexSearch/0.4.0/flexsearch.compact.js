/*
 FlexSearch v0.4.0
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(f,x,d){let p;(p=d.define)&&p.amd?p([],function(){return x}):(p=d.modules)?p[f.toLowerCase()]=x:"object"===typeof exports?module.exports=x:d[f]=x})("FlexSearch",function(){function f(a,b){const c=b?b.id:a&&a.id;this.id=c||0===c?c:M++;this.init(a,b);x(this,"index",function(){return this.c});x(this,"length",function(){return Object.keys(this.c).length})}function x(a,b,c){Object.defineProperty(a,b,{get:c})}function d(a){return new RegExp(a,"g")}function p(a,b){for(let c=0;c<b.length;c+=
2)a=a.replace(b[c],b[c+1]);return a}function A(a,b,c,h,g,l,e){if(b[c])return b[c];g=g?(9-(e||6))*l+(e||6)*g:l;b[c]=g;g>=e&&(a=a[9-(g+.5>>0)],a=a[c]||(a[c]=[]),a[a.length]=h);return g}function E(a,b){if(a){const c=Object.keys(a);for(let h=0,g=c.length;h<g;h++){const g=c[h],e=a[g];if(e)for(let c=0,h=e.length;c<h;c++)if(e[c]===b){1===h?delete a[g]:e.splice(c,1);break}else y(e[c])&&E(e[c],b)}}}function F(a){let b="",c="";var h="";for(let g=0;g<a.length;g++){const l=a[g];if(l!==c)if(g&&"h"===l){if(h="a"===
h||"e"===h||"i"===h||"o"===h||"u"===h||"y"===h,("a"===c||"e"===c||"i"===c||"o"===c||"u"===c||"y"===c)&&h||" "===c)b+=l}else b+=l;h=g===a.length-1?"":a[g+1];c=l}return b}function N(a,b){a=a.length-b.length;return 0>a?1:a?-1:0}function O(a,b){a=a.length-b.length;return 0>a?-1:a?1:0}function P(a,b,c,h){let g=[],l;const e=a.length;if(1<e){a.sort(O);const n=v();let q=a[0],k=q.length,r=0;for(;r<k;)n["@"+q[r++]]=1;let m,f=0,t=0;for(;++t<e;){let w=!1;const p=t===e-1;l=[];q=a[t];k=q.length;for(r=0;r<k;){m=
q[r++];var d="@"+m;if(n[d]){const a=n[d];if(a===t){if(p){if(g[f++]=c?c[d]:m,b&&f===b)return g}else n[d]=t+1;w=!0}else h&&(d=l[a]||(l[a]=[]),d[d.length]=m)}}if(!w&&!h)break}if(h&&(f=g.length,(t=l.length)&&(!b||f<b)))for(;t--;)if(m=l[t])for(r=0,k=m.length;r<k;r++)if(g[f++]=c?c["@"+m[r]]:m[r],b&&f===b)return g}else if(e)if(c)for(a=a[0],h=a.length,b&&b<h&&(h=b),g=Array(h),b=0;b<h;b++)g[b]=c["@"+a[b]];else g=a[0],b&&g.length>b&&(g=g.slice(0,b));return g}function B(a){return"string"===typeof a}function C(a){return"function"===
typeof a}function y(a){return"object"===typeof a}function D(a){return"undefined"===typeof a}function H(a){const b=Array(a);for(let c=0;c<a;c++)b[c]=v();return b}function v(){return Object.create(null)}const u={encode:"icase",b:"forward",o:!1,cache:!1,async:!1,s:!1,l:!1,threshold:0,depth:0,a:!1},I={memory:{encode:"extra",b:"strict",threshold:7},speed:{encode:"icase",b:"strict",threshold:7,depth:2},match:{encode:"extra",b:"full"},score:{encode:"extra",b:"strict",threshold:5,depth:4},balance:{encode:"balance",
b:"strict",threshold:6,depth:3},fastest:{encode:"icase",b:"strict",threshold:9,depth:1}},G=[];let M=0;const J=d("\\W+"),K={},L={};f.create=function(a){return new f(a)};f.registerMatcher=function(a){for(const b in a)a.hasOwnProperty(b)&&G.push(d(b),a[b]);return this};f.registerEncoder=function(a,b){z[a]=b.bind(z);return this};f.registerLanguage=function(a,b){K[a]=b.filter;L[a]=b.stemmer;return this};f.encode=function(a,b){return z[a](b)};f.prototype.init=function(a,b){this.m=[];if(b){var c=b.preset;
a=b}else a||(a=u),c=a.preset;b={};B(a)?(b=I[a],a={}):c&&(b=I[c]);this.b=a.tokenize||b.b||this.b||u.b;this.l=a.rtl||this.l||u.l;this.async="undefined"===typeof Promise||D(c=a.async)?this.async||u.async:c;this.threshold=D(c=a.threshold)?b.threshold||this.threshold||u.threshold:c;this.depth=D(c=a.depth)?b.depth||this.depth||u.depth:c;this.h=(c=D(c=a.encode)?b.encode||u.encode:c)&&z[c]&&z[c].bind(z)||(C(c)?c:this.h||!1);(c=a.matcher)&&this.addMatcher(c);if(c=a.filter){c=K[c]||c;b=this.h;var h=v();if(c)for(var g=
0;g<c.length;g++){var l=b?b(c[g]):c[g];h[l]=String.fromCharCode(65E3-c.length+g)}this.filter=c=h}if(c=a.stemmer){var e;b=L[c]||c;h=this.h;g=[];if(b)for(e in b)b.hasOwnProperty(e)&&(l=h?h(e):e,g.push(d("(?=.{"+(l.length+3)+",})"+l+"$"),h?h(b[e]):b[e]));this.stemmer=e=g}this.a=e=(c=a.doc)?c:this.a||u.a;this.j=H(10-(this.threshold||0));this.g=v();this.c=v();this.f=e&&v();if(e)if(a.doc=null,c=e.field,b=e.index=[],h=e.ref={},e.id=e.id.split(":"),c.constructor===Array)for(e=0;e<c.length;e++)h[c[e]]=e,c[e]=
c[e].split(":"),b[e]=new f(a),b[e].f=this.f;else h[c]=0,e.field=[c.split(":")],b[0]=new f(a),b[0].f=this.f;return this};f.prototype.encode=function(a){a&&G.length&&(a=p(a,G));a&&this.m.length&&(a=p(a,this.m));a&&this.h&&(a=this.h(a));a&&this.stemmer&&(a=p(a,this.stemmer));return a};f.prototype.addMatcher=function(a){const b=this.m;for(const c in a)a.hasOwnProperty(c)&&b.push(d(c),a[c]);return this};f.prototype.add=function(a,b,c,h,g){if(this.a&&y(a))return this.i("add",a,b);if(b&&B(b)&&(a||0===a)){var l=
"@"+a;if(this.c[l]&&!h)return this.update(a,b);if(!g){if(this.async&&"function"!==typeof importScripts){let e=this;l=new Promise(function(c){setTimeout(function(){e.add(a,b,null,h,!0);e=null;c()})});if(c)l.then(c);else return l;return this}if(c)return this.add(a,b,null,h,!0),c(),this}b=this.encode(b);if(!b.length)return this;c=this.b;g=C(c)?c(b):b.split(J);const q=v();q._ctx=v();const m=this.threshold,p=this.depth,t=this.j,w=g.length,u=this.l;for(let b=0;b<w;b++){var e=g[b];if(e){var d=e.length,n=
(u?b+1:w-b)/w,f="";switch(c){case "reverse":case "both":for(var k=d;--k;)f=e[k]+f,A(t,q,f,a,u?1:(d-k)/d,n,m);f="";case "forward":for(k=0;k<d;k++)f+=e[k],A(t,q,f,a,u?(k+1)/d:1,n,m);break;case "full":for(k=0;k<d;k++){const b=(u?k+1:d-k)/d;for(let c=d;c>k;c--)f=e.substring(k,c),A(t,q,f,a,b,n,m)}break;default:if(d=A(t,q,e,a,1,n,m),p&&1<w&&d>=m)for(d=q._ctx[e]||(q._ctx[e]=v()),e=this.g[e]||(this.g[e]=H(10-(m||0))),n=b-p,f=b+p+1,0>n&&(n=0),f>w&&(f=w);n<f;n++)n!==b&&A(e,d,g[n],a,0,10-(n<b?b-n:n-b),m)}}}this.c[l]=
1}return this};f.prototype.i=function(a,b,c){if(b.constructor===Array)for(let d=0,e=b.length;d<e;d++){if(d===e-1)return this.i(a,b[d],c);this.i(a,b[d])}else{const h=this.a.index;let e=this.a.id,f;for(var d=0;d<e.length;d++)f=(f||b)[e[d]];if("remove"===a){delete this.f["@"+f];for(let a=0,b=h.length;a<b;a++){if(a===b-1)return h[a].remove(f,c);h[a].remove(f)}}e=this.a.field;for(let l=0,q=e.length;l<q;l++){d=e[l];let k;for(var g=0;g<d.length;g++)k=(k||b)[d[g]];this.f["@"+f]=b;d=h[l];g="add"===a?d.add:
d.update;if(l===q-1)return g.call(d,f,k,c);g.call(d,f,k)}}};f.prototype.update=function(a,b,c){if(this.a&&y(a))return this.i("update",a,b);this.c["@"+a]&&B(b)&&(this.remove(a),this.add(a,b,c,!0));return this};f.prototype.remove=function(a,b,c){if(this.a&&y(a))return this.i("remove",a,b);var d="@"+a;if(this.c[d]){if(!c){if(this.async&&"function"!==typeof importScripts){let c=this;d=new Promise(function(b){setTimeout(function(){c.remove(a,null,!0);c=null;b()})});if(b)d.then(b);else return d;return this}if(b)return this.remove(a,
null,!0),b(),this}for(b=0;b<10-(this.threshold||0);b++)E(this.j[b],a);this.depth&&E(this.g,a);delete this.c[d]}return this};f.prototype.search=function(a,b,c,d){if(y(b)){if(b.constructor===Array)for(var g=0;g<b.length;g++)b[g].query=a;else b.query=a;a=b;b=0}let f=a;let e=[];if(y(a)&&a.constructor!==Array){(c=a.callback||b)&&(f.callback=null);b=a.limit;var h=a.threshold;var n=a.boost;a=a.query}if(this.a){h=this.a.ref;var p=this.a.index,k=f.field;if(k)f.field=null;else if(f.constructor===Array){var r=
f;k=[];for(var m=0;m<f.length;m++)k[m]=f[m].field}else k=Object.keys(h);if(y(k)){k.constructor===Array||(k=[k]);m=k.length;for(a=0;a<m;a++)r&&(f=r[a]),e[a]=p[h[k[a]]].search(f);return c?c(e.concat.apply([],e)):this.async?new Promise(function(a){Promise.all(e).then(function(b){a(b.concat.apply([],b))})}):e.concat.apply([],e)}return p[h[k]].search(f,c)}h||(h=this.threshold||0);C(b)?(c=b,b=1E3):b||0===b||(b=1E3);if(!d){if(this.async&&"function"!==typeof importScripts){let a=this;h=new Promise(function(c){setTimeout(function(){c(a.search(f,
b,null,!0));a=null})});if(c)h.then(c);else return h;return this}if(c)return c(this.search(f,b,null,!0)),this}if(!a||!B(a))return e;f=a;f=this.encode(f);if(!f.length)return e;c=this.b;c=C(c)?c(f):f.split(J);r=c.length;a=!0;d=[];g=v();1<r&&(this.depth?(p=!0,m=c[0],g[m]=1):c.sort(N));if(!p||(k=this.g)[m]){let b=0;n&&(h=(h||1)/n,0>n&&(b=h));for(n=p?1:0;n<r;n++){const e=c[n];if(e){if(!g[e]){const c=[];let f=!1,l=0;if(m=p?k[m]:this.j){let a;for(let d=b;d<10-h;d++)if(a=m[d][e])c[l++]=a,f=!0}if(f)d[d.length]=
1<l?c.concat.apply([],c):c[0];else{a=!1;break}g[e]=1}m=e}}}else a=!1;a&&(e=P(d,b,this.f,!1));return e};f.prototype.clear=function(){return this.destroy().init()};f.prototype.destroy=function(){this.j=this.g=this.c=null;return this};const z={icase:function(a){return a.toLowerCase()},simple:function(){const a=[d("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",d("[\u00e8\u00e9\u00ea\u00eb]"),"e",d("[\u00ec\u00ed\u00ee\u00ef]"),"i",d("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",d("[\u00f9\u00fa\u00fb\u00fc\u0171]"),
"u",d("[\u00fd\u0177\u00ff]"),"y",d("\u00f1"),"n",d("\u00e7"),"c",d("\u00df"),"s",d(" & ")," and ",d("[-/]")," ",d("[^a-z0-9 ]"),"",d("\\s+")," "];return function(b){b=p(b.toLowerCase(),a);return" "===b?"":b}}(),advanced:function(){const a=[d("ae"),"a",d("ai"),"ei",d("ay"),"ei",d("ey"),"ei",d("oe"),"o",d("ue"),"u",d("ie"),"i",d("sz"),"s",d("zs"),"s",d("sh"),"s",d("ck"),"k",d("cc"),"k",d("dt"),"t",d("ph"),"f",d("pf"),"f",d("ou"),"o",d("uo"),"u"];return function(b,c){if(!b)return b;b=this.simple(b);
2<b.length&&(b=p(b,a));c||1<b.length&&(b=F(b));return b}}(),extra:function(){const a=[d("p"),"b",d("z"),"s",d("[cgq]"),"k",d("n"),"m",d("d"),"t",d("[vw]"),"f",d("[aeiouy]"),""];return function(b){if(!b)return b;b=this.advanced(b,!0);if(1<b.length){b=b.split(" ");for(let c=0;c<b.length;c++){const d=b[c];1<d.length&&(b[c]=d[0]+p(d.substring(1),a))}b=b.join(" ");b=F(b)}return b}}(),balance:function(){const a=[d("[-/]")," ",d("[^a-z0-9 ]"),"",d("\\s+")," "];return function(b){return F(p(b.toLowerCase(),
a))}}()};return f}(!1),this);
