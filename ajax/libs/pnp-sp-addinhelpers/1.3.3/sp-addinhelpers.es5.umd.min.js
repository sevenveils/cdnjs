/**
 * @license
 * v1.3.3
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-addinhelpers"]={}),e.pnp.common,e.pnp.sp)}(this,function(e,p,o){"use strict";var t=(r.prototype.fetch=function(r,n){var s=this;if(void 0===SP||void 0===SP.RequestExecutor)throw Error("SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.");var e,t,o=r.substring(0,r.indexOf("/_api")),i=new SP.RequestExecutor(o),u={};if(n.headers&&n.headers instanceof Headers)for(t=(e=n.headers.entries()).next();!t.done;)u[t.value[0]]=t.value[1],t=e.next();else u=n.headers;return new Promise(function(t,o){var e={error:function(e){o(s.convertToResponse(e))},headers:u,method:n.method,success:function(e){t(s.convertToResponse(e))},url:r};e=n.body?p.extend(e,{body:n.body}):p.extend(e,{binaryStringRequestBody:!0}),i.executeAsync(e)})},r);function r(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var o in e.headers)e.headers[o]&&t.append(o,e.headers[o]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};var s,i,u,a=(u=o.SPRest,n(s=c,i=u),void(s.prototype=null===i?Object.create(i):(d.prototype=i.prototype,new d)),c.prototype.crossDomainSite=function(e,t){return this._cdImpl(o.Site,e,t,"site")},c.prototype.crossDomainWeb=function(e,t){return this._cdImpl(o.Web,e,t,"web")},c.prototype._cdImpl=function(e,t,o,r){if(!p.isUrlAbsolute(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!p.isUrlAbsolute(o))throw Error("The hostWebUrl parameter must be an absolute url.");var n=new e(p.combine(t,"_api/SP.AppContextSite(@target)"),r);return n.query.set("@target","'"+encodeURIComponent(o)+"'"),n.configure(this._options)},c);function d(){this.constructor=s}function c(){return null!==u&&u.apply(this,arguments)||this}var f=new a;e.SPRequestExecutorClient=t,e.SPRestAddIn=a,e.sp=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sp-addinhelpers.es5.umd.min.js.map
