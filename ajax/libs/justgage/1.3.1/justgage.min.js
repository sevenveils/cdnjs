!function(e,n){"function"==typeof define&&define.amd?define(["raphael"],function(t){return e.JustGage=n(t)}):"object"==typeof module&&module.exports?module.exports=e.JustGage=n(require("raphael")):e.JustGage=n(Raphael)}(this,function(T){function N(t,e,n,i,a){var o=i,r=!1;if(null!=t&&(null!=n&&"object"==typeof n&&t in n?(o=n[t],r=!0):null!=e&&"object"==typeof e&&t in e?(o=e[t],r=!0):o=i,!0===r&&null!=a))switch(a){case"int":o=parseInt(o,10);break;case"float":o=parseFloat(o)}return o}function O(t,e,n,i,a){var o,r,l,c,m,f,g,s,u,d,p,h,x,v,b=a&&a.ranges&&0<a.ranges.length;i=i||b;if(b){!0===a.percents&&(t=100*e);for(var M=0;M<a.ranges.length;M++)if(t>=a.ranges[M].lo&&t<=a.ranges[M].hi)return a.ranges[M].color}if(1===(o=n.length))return n[0];for(r=i?1/o:1/(o-1),l=[],M=0;M<n.length;M++)c=i?r*(M+1):r*M,m=parseInt(S(n[M]).substring(0,2),16),f=parseInt(S(n[M]).substring(2,4),16),g=parseInt(S(n[M]).substring(4,6),16),l[M]={pct:c,color:{r:m,g:f,b:g}};if(0===e)return"rgb("+[l[0].color.r,l[0].color.g,l[0].color.b].join(",")+")";for(var y=0;y<l.length;y++)if(e<=l[y].pct)return i?"rgb("+[l[y].color.r,l[y].color.g,l[y].color.b].join(",")+")":(s=l[y-1],d=(u=l[y]).pct-s.pct,h=1-(p=(e-s.pct)/d),x=p,"rgb("+[(v={r:Math.floor(s.color.r*h+u.color.r*x),g:Math.floor(s.color.g*h+u.color.g*x),b:Math.floor(s.color.b*h+u.color.b*x)}).r,v.g,v.b].join(",")+")")}function C(t){(!Y||9<Y)&&t.node.firstChild.attributes.dy&&(t.node.firstChild.attributes.dy.value=0)}function S(t){return"#"==t.charAt(0)?t.substring(1,7):t}function k(t,e){var n,i,a;for(n=Math.pow(10,e),a=" KMGTPE",i=0,1e3;(1e3<=t||t<=-1e3)&&++i<a.length;)t/=1e3;return i=a.length<=i?a.length-1:i,Math.round(t*n)/n+a[i]}function W(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")}function L(t,e){var n="";return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,"").getPropertyValue(e):t.currentStyle&&(e=e.replace(/\-(\w)/g,function(t,e){return e.toUpperCase()}),n=t.currentStyle[e]),n}JustGage=function(t){var A=this;if(A.events={},null==t)return console.log("* justgage: Make sure to pass options to the constructor!"),!1;if(null!==t.id&&void 0!==t.id){if(A.node=document.getElementById(t.id),!A.node)return console.log("* justgage: No element with id : %s found",t.id),!1}else{if(null===t.parentNode||void 0===t.parentNode)return console.log("* justgage: Make sure to pass the existing element id or parentNode to the constructor."),!1;A.node=t.parentNode}var e,n,i,a,o,r,l,c,m,f,g,s,u,d,p,h,x,v,b,M=A.node.dataset?A.node.dataset:{},y=null!==t.defaults&&void 0!==t.defaults&&t.defaults;!1!==y&&delete(t=function(t){t=t||{};for(var e=1;e<arguments.length;e++)if(arguments[e])for(var n in arguments[e])arguments[e].hasOwnProperty(n)&&(t[n]=arguments[e][n]);return t}({},t,y)).defaults,A.config={id:t.id,value:N("value",t,M,0,"float"),defaults:N("defaults",t,M,0,!1),parentNode:N("parentNode",t,M,null),width:N("width",t,M,null),height:N("height",t,M,null),valueFontColor:N("valueFontColor",t,M,"#010101"),valueFontFamily:N("valueFontFamily",t,M,"Arial"),symbol:N("symbol",t,M,""),min:N("min",t,M,0,"float"),minTxt:N("minTxt",t,M,!1),max:N("max",t,M,100,"float"),maxTxt:N("maxTxt",t,M,!1),reverse:N("reverse",t,M,!1),humanFriendlyDecimal:N("humanFriendlyDecimal",t,M,0),textRenderer:N("textRenderer",t,M,null),onAnimationEnd:N("onAnimationEnd",t,M,null),gaugeWidthScale:N("gaugeWidthScale",t,M,1),gaugeColor:N("gaugeColor",t,M,"#edebeb"),label:N("label",t,M,""),labelFontColor:N("labelFontColor",t,M,"#b3b3b3"),shadowOpacity:N("shadowOpacity",t,M,.2),shadowSize:N("shadowSize",t,M,5),shadowVerticalOffset:N("shadowVerticalOffset",t,M,3),levelColors:N("levelColors",t,M,["#a9d70b","#f9c802","#ff0000"],"array",","),startAnimationTime:N("startAnimationTime",t,M,700),startAnimationType:N("startAnimationType",t,M,">"),refreshAnimationTime:N("refreshAnimationTime",t,M,700),refreshAnimationType:N("refreshAnimationType",t,M,">"),donutStartAngle:N("donutStartAngle",t,M,90),valueMinFontSize:N("valueMinFontSize",t,M,16),labelMinFontSize:N("labelMinFontSize",t,M,10),minLabelMinFontSize:N("minLabelMinFontSize",t,M,10),maxLabelMinFontSize:N("maxLabelMinFontSize",t,M,10),hideValue:N("hideValue",t,M,!1),hideMinMax:N("hideMinMax",t,M,!1),showInnerShadow:N("showInnerShadow",t,M,!1),humanFriendly:N("humanFriendly",t,M,!1),noGradient:N("noGradient",t,M,!1),donut:N("donut",t,M,!1),relativeGaugeSize:N("relativeGaugeSize",t,M,!1),counter:N("counter",t,M,!1),decimals:N("decimals",t,M,0),customSectors:N("customSectors",t,M,{}),formatNumber:N("formatNumber",t,M,!1),pointer:N("pointer",t,M,!1),pointerOptions:N("pointerOptions",t,M,{}),displayRemaining:N("displayRemaining",t,M,!1)},A.config.value>A.config.max&&(A.config.value=A.config.max),A.config.value<A.config.min&&(A.config.value=A.config.min),A.originalValue=N("value",t,M,-1,"float"),null!==A.config.id&&null!==document.getElementById(A.config.id)?A.canvas=T(A.config.id,"100%","100%"):null!==A.config.parentNode&&(A.canvas=T(A.config.parentNode,"100%","100%")),n=!0===A.config.relativeGaugeSize?!0===A.config.donut?(A.canvas.setViewBox(0,0,200,200,!0),e=200):(A.canvas.setViewBox(0,0,200,100,!0),e=200,100):null!==A.config.width&&null!==A.config.height?(e=A.config.width,A.config.height):null!==A.config.parentNode?(A.canvas.setViewBox(0,0,200,100,!0),e=200,100):(e=1*L(document.getElementById(A.config.id),"width").slice(0,-2),1*L(document.getElementById(A.config.id),"height").slice(0,-2)),b=(v=(x=!0===A.config.donut?(n<e?i=a=n:a=i=e,l=(n-a)/2,c=16<a/6.4?a/5.4:18,s=m=(r=(e-i)/2)+i/2,u=(f=""!==A.config.label?l+a/1.85:l+a/1.7)+(g=10<a/16?a/16:10),d=10<a/16?a/16:10,p=r+i/10+i/6.666666666666667*A.config.gaugeWidthScale/2,h=u,10<a/16?a/16:10):(n<e?e<(i=2*(a=n))&&(i/=o=i/e,a/=o):a=e<n?(i=e)/2:.5*(i=e),r=(e-i)/2,l=(n-a)/2,c=a/6.5>A.config.valueMinFontSize?a/6.5:A.config.valueMinFontSize,m=r+i/2,f=l+a/1.275,g=a/16>A.config.labelMinFontSize?a/16:A.config.labelMinFontSize,s=r+i/2,u=f+c/2+5,d=a/16>A.config.minLabelMinFontSize?a/16:A.config.minLabelMinFontSize,p=r+i/10+i/6.666666666666667*A.config.gaugeWidthScale/2,h=u,a/16>A.config.maxLabelMinFontSize?a/16:A.config.maxLabelMinFontSize),r+i-i/10-i/6.666666666666667*A.config.gaugeWidthScale/2),u),A.params={canvasW:e,canvasH:n,widgetW:i,widgetH:a,dx:r,dy:l,valueFontSize:c,valueX:m,valueY:f,labelFontSize:g,labelX:s,labelY:u,minFontSize:d,minX:p,minY:h,maxFontSize:x,maxX:v,maxY:b},b=null,A.canvas.customAttributes.pki=function(t,e,n,i,a,o,r,l,c,m){var f,g,s,u,d,p;return e<0&&(n-=e,t-=e,e=0),c?(f=(1-2*(t-e)/(n-e))*Math.PI,p="M"+((u=i/2+o)-(s=(g=i/2-i/30)-i/6.666666666666667*l))+","+(d=a/2+r)+" ",p+="L"+(u-g)+","+d+" ",(n-e)/2<t&&(p+="A"+g+","+g+" 0 0 1 "+(u+g)+","+d+" "),p+="A"+g+","+g+" 0 0 1 "+(u+g*Math.cos(f))+","+(d-g*Math.sin(f))+" ",p+="L"+(u+s*Math.cos(f))+","+(d-s*Math.sin(f))+" ",(n-e)/2<t&&(p+="A"+s+","+s+" 0 0 0 "+(u+s)+","+d+" ")):(f=(1-(t-e)/(n-e))*Math.PI,p="M"+((u=i/2+o)-(s=(g=i/2-i/10)-i/6.666666666666667*l))+","+(d=a/1.25+r)+" ",p+="L"+(u-g)+","+d+" ",p+="A"+g+","+g+" 0 0 1 "+(u+g*Math.cos(f))+","+(d-g*Math.sin(f))+" ",p+="L"+(u+s*Math.cos(f))+","+(d-s*Math.sin(f))+" "),p+="A"+s+","+s+" 0 0 0 "+(u-s)+","+d+" ",{path:p+="Z "}},A.canvas.customAttributes.ndl=function(t,e,n,i,a,o,r,l,c){var m,f,g,s,u,d,p,h,x,v,b,M,y,S=3.5*i/100,F=i/15,w=i/100;return null!=A.config.pointerOptions.toplength&&null!=A.config.pointerOptions.toplength&&(S=A.config.pointerOptions.toplength),null!=A.config.pointerOptions.bottomlength&&null!=A.config.pointerOptions.bottomlength&&(F=A.config.pointerOptions.bottomlength),null!=A.config.pointerOptions.bottomwidth&&null!=A.config.pointerOptions.bottomwidth&&(w=A.config.pointerOptions.bottomwidth),y=(M=(b=(v=(x=(h=(p=(d=(u=(s=c?(m=(1-2*(t-e)/(n-e))*Math.PI,g=(f=i/2-i/30)-i/6.666666666666667*l,a/2+r):(m=(1-(t-e)/(n-e))*Math.PI,g=(f=i/2-i/10)-i/6.666666666666667*l,a/1.25+r),i/2+o+f*Math.cos(m)),a-(a-s)-f*Math.sin(m)),i/2+o+g*Math.cos(m)),a-(a-s)-g*Math.sin(m)),u+S*Math.cos(m)),d-S*Math.sin(m)),p-F*Math.cos(m)),h+F*Math.sin(m)),"M"+(b+w*Math.sin(m))+","+(M+w*Math.cos(m))+" "),y+="L"+(b-w*Math.sin(m))+","+(M-w*Math.cos(m))+" ",y+="L"+x+","+v+" ",{path:y+="Z "}},A.gauge=A.canvas.path().attr({stroke:"none",fill:A.config.gaugeColor,pki:[A.config.max,A.config.min,A.config.max,A.params.widgetW,A.params.widgetH,A.params.dx,A.params.dy,A.config.gaugeWidthScale,A.config.donut,A.config.reverse]}),A.level=A.canvas.path().attr({stroke:"none",fill:O(A.config.value,(A.config.value-A.config.min)/(A.config.max-A.config.min),A.config.levelColors,A.config.noGradient,A.config.customSectors),pki:[A.config.min,A.config.min,A.config.max,A.params.widgetW,A.params.widgetH,A.params.dx,A.params.dy,A.config.gaugeWidthScale,A.config.donut,A.config.reverse]}),A.config.donut&&A.level.transform("r"+A.config.donutStartAngle+", "+(A.params.widgetW/2+A.params.dx)+", "+(A.params.widgetH/2+A.params.dy)),A.config.pointer&&(A.needle=A.canvas.path().attr({stroke:null!==A.config.pointerOptions.stroke&&void 0!==A.config.pointerOptions.stroke?A.config.pointerOptions.stroke:"none","stroke-width":null!==A.config.pointerOptions.stroke_width&&void 0!==A.config.pointerOptions.stroke_width?A.config.pointerOptions.stroke_width:0,"stroke-linecap":null!==A.config.pointerOptions.stroke_linecap&&void 0!==A.config.pointerOptions.stroke_linecap?A.config.pointerOptions.stroke_linecap:"square",fill:null!==A.config.pointerOptions.color&&void 0!==A.config.pointerOptions.color?A.config.pointerOptions.color:"#000000",ndl:[A.config.min,A.config.min,A.config.max,A.params.widgetW,A.params.widgetH,A.params.dx,A.params.dy,A.config.gaugeWidthScale,A.config.donut]}),A.config.donut&&A.needle.transform("r"+A.config.donutStartAngle+", "+(A.params.widgetW/2+A.params.dx)+", "+(A.params.widgetH/2+A.params.dy))),A.txtValue=A.canvas.text(A.params.valueX,A.params.valueY,0),A.txtValue.attr({"font-size":A.params.valueFontSize,"font-weight":"bold","font-family":A.config.valueFontFamily,fill:A.config.valueFontColor,"fill-opacity":"0"}),C(A.txtValue,A.params.valueFontSize,A.params.valueY),A.txtLabel=A.canvas.text(A.params.labelX,A.params.labelY,A.config.label),A.txtLabel.attr({"font-size":A.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:A.config.labelFontColor,"fill-opacity":"0"}),C(A.txtLabel,A.params.labelFontSize,A.params.labelY);var S=A.config.min;A.config.reverse&&(S=A.config.max),A.txtMinimum=S,A.config.minTxt?A.txtMinimum=A.config.minTxt:A.config.humanFriendly?A.txtMinimum=k(S,A.config.humanFriendlyDecimal):A.config.formatNumber&&(A.txtMinimum=W(S)),A.txtMin=A.canvas.text(A.params.minX,A.params.minY,A.txtMinimum),A.txtMin.attr({"font-size":A.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:A.config.labelFontColor,"fill-opacity":A.config.hideMinMax||A.config.donut?"0":"1"}),C(A.txtMin,A.params.minFontSize,A.params.minY);var F=A.config.max;A.config.reverse&&(F=A.config.min),A.txtMaximum=F,A.config.maxTxt?A.txtMaximum=A.config.maxTxt:A.config.humanFriendly?A.txtMaximum=k(F,A.config.humanFriendlyDecimal):A.config.formatNumber&&(A.txtMaximum=W(F)),A.txtMax=A.canvas.text(A.params.maxX,A.params.maxY,A.txtMaximum),A.txtMax.attr({"font-size":A.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:A.config.labelFontColor,"fill-opacity":A.config.hideMinMax||A.config.donut?"0":"1"}),C(A.txtMax,A.params.maxFontSize,A.params.maxY);var w=A.canvas.canvas.childNodes[1],z="http://www.w3.org/2000/svg";"undefined"!==Y&&Y<9||("undefined"!==Y?function t(e){void 0!==document.createElementNS?e():setTimeout(function(){t(e)},100)}(function(){A.generateShadow(z,w)}):A.generateShadow(z,w)),z=null,A.config.textRenderer?A.originalValue=A.config.textRenderer(A.originalValue):A.config.humanFriendly?A.originalValue=k(A.originalValue,A.config.humanFriendlyDecimal)+A.config.symbol:A.config.formatNumber?A.originalValue=W(A.originalValue)+A.config.symbol:A.config.displayRemaining?A.originalValue=(1*(A.config.max-A.originalValue)).toFixed(A.config.decimals)+A.config.symbol:A.originalValue=(1*A.originalValue).toFixed(A.config.decimals)+A.config.symbol,!0===A.config.counter?(T.eve.on("raphael.anim.frame."+A.level.id,function(){A.events["raphael.anim.frame."+A.level.id]||(A.events["raphael.anim.frame."+A.level.id]=this);var t=A.level.attr("pki")[0];A.config.reverse&&(t=1*A.config.max+1*A.config.min-1*A.level.attr("pki")[0]),A.config.textRenderer?A.txtValue.attr("text",A.config.textRenderer(Math.floor(t))):A.config.humanFriendly?A.txtValue.attr("text",k(Math.floor(t),A.config.humanFriendlyDecimal)+A.config.symbol):A.config.formatNumber?A.txtValue.attr("text",W(Math.floor(t))+A.config.symbol):A.config.displayRemaining?A.txtValue.attr("text",(1*(A.config.max-t)).toFixed(A.config.decimals)+A.config.symbol):A.txtValue.attr("text",(1*t).toFixed(A.config.decimals)+A.config.symbol),C(A.txtValue,A.params.valueFontSize,A.params.valueY),t=null}),T.eve.on("raphael.anim.finish."+A.level.id,function(){A.events["raphael.anim.finish."+A.level.id]||(A.events["raphael.anim.finish."+A.level.id]=this),A.txtValue.attr({text:A.originalValue}),C(A.txtValue,A.params.valueFontSize,A.params.valueY)})):T.eve.on("raphael.anim.start."+A.level.id,function(){A.events["raphael.anim.start."+A.level.id]||(A.events["raphael.anim.start."+A.level.id]=this),A.txtValue.attr({text:A.originalValue}),C(A.txtValue,A.params.valueFontSize,A.params.valueY)});var V=A.config.value;A.config.reverse&&(V=1*A.config.max+1*A.config.min-1*A.config.value),A.level.animate({pki:[V,A.config.min,A.config.max,A.params.widgetW,A.params.widgetH,A.params.dx,A.params.dy,A.config.gaugeWidthScale,A.config.donut,A.config.reverse]},A.config.startAnimationTime,A.config.startAnimationType,A.config.onAnimationEnd),A.config.pointer&&A.needle.animate({ndl:[V,A.config.min,A.config.max,A.params.widgetW,A.params.widgetH,A.params.dx,A.params.dy,A.config.gaugeWidthScale,A.config.donut]},A.config.startAnimationTime,A.config.startAnimationType),A.txtValue.animate({"fill-opacity":A.config.hideValue?"0":"1"},A.config.startAnimationTime,A.config.startAnimationType),A.txtLabel.animate({"fill-opacity":"1"},A.config.startAnimationTime,A.config.startAnimationType)},JustGage.prototype.refresh=function(t,e,n,i){var a,o,r=this;e=e||null,n=n||null,null!==(i=i||null)&&(r.config.label=i,r.txtLabel.attr({text:r.config.label}),C(r.txtLabel,r.params.labelFontSize,r.params.labelY)),null!==n&&(r.config.min=n,r.txtMinimum=r.config.min,r.config.minTxt?r.txtMinimum=r.config.minTxt:r.config.humanFriendly?r.txtMinimum=k(r.config.min,r.config.humanFriendlyDecimal):r.config.formatNumber&&(r.txtMinimum=W(r.config.min)),r.config.reverse?(r.txtMax.attr({text:r.txtMinimum}),C(r.txtMax,r.params.minFontSize,r.params.minY)):(r.txtMin.attr({text:r.txtMinimum}),C(r.txtMin,r.params.minFontSize,r.params.minY))),null!==e&&(r.config.max=e,r.txtMaximum=r.config.max,r.config.maxTxt?r.txtMaximum=r.config.maxTxt:r.config.humanFriendly?r.txtMaximum=k(r.config.max,r.config.humanFriendlyDecimal):r.config.formatNumber&&(r.txtMaximum=W(r.config.max)),r.config.reverse?(r.txtMin.attr({text:r.txtMaximum}),C(r.txtMin,r.params.maxFontSize,r.params.maxY)):(r.txtMax.attr({text:r.txtMaximum}),C(r.txtMax,r.params.maxFontSize,r.params.maxY))),1*(a=t)>1*r.config.max&&(t=1*r.config.max),1*t<1*r.config.min&&(t=1*r.config.min),o=O(t,(t-r.config.min)/(r.config.max-r.config.min),r.config.levelColors,r.config.noGradient,r.config.customSectors),a=r.config.textRenderer?r.config.textRenderer(a):r.config.humanFriendly?k(a,r.config.humanFriendlyDecimal)+r.config.symbol:r.config.formatNumber?W((1*a).toFixed(r.config.decimals))+r.config.symbol:r.config.displayRemaining?(1*(r.config.max-a)).toFixed(r.config.decimals)+r.config.symbol:(1*a).toFixed(r.config.decimals)+r.config.symbol,r.originalValue=a,r.config.value=1*t,r.config.counter||(r.txtValue.attr({text:a}),C(r.txtValue,r.params.valueFontSize,r.params.valueY));var l=r.config.value;r.config.reverse&&(l=1*r.config.max+1*r.config.min-1*r.config.value),r.level.animate({pki:[l,r.config.min,r.config.max,r.params.widgetW,r.params.widgetH,r.params.dx,r.params.dy,r.config.gaugeWidthScale,r.config.donut,r.config.reverse],fill:o},r.config.refreshAnimationTime,r.config.refreshAnimationType,r.config.onAnimationEnd),r.config.pointer&&r.needle.animate({ndl:[l,r.config.min,r.config.max,r.params.widgetW,r.params.widgetH,r.params.dx,r.params.dy,r.config.gaugeWidthScale,r.config.donut]},r.config.refreshAnimationTime,r.config.refreshAnimationType),n=null},JustGage.prototype.destroy=function(){for(var t in this.node&&this.node.parentNode&&(this.node.innerHTML=""),this.events)T.eve.off(t,this.events[t])},JustGage.prototype.generateShadow=function(t,e){var n,i,a,o,r,l,c,m=this,f="inner-shadow-"+m.config.id;(n=document.createElementNS(t,"filter")).setAttribute("id",f),e.appendChild(n),(i=document.createElementNS(t,"feOffset")).setAttribute("dx",0),i.setAttribute("dy",m.config.shadowVerticalOffset),n.appendChild(i),(a=document.createElementNS(t,"feGaussianBlur")).setAttribute("result","offset-blur"),a.setAttribute("stdDeviation",m.config.shadowSize),n.appendChild(a),(o=document.createElementNS(t,"feComposite")).setAttribute("operator","out"),o.setAttribute("in","SourceGraphic"),o.setAttribute("in2","offset-blur"),o.setAttribute("result","inverse"),n.appendChild(o),(r=document.createElementNS(t,"feFlood")).setAttribute("flood-color","black"),r.setAttribute("flood-opacity",m.config.shadowOpacity),r.setAttribute("result","color"),n.appendChild(r),(l=document.createElementNS(t,"feComposite")).setAttribute("operator","in"),l.setAttribute("in","color"),l.setAttribute("in2","inverse"),l.setAttribute("result","shadow"),n.appendChild(l),(c=document.createElementNS(t,"feComposite")).setAttribute("operator","over"),c.setAttribute("in","shadow"),c.setAttribute("in2","SourceGraphic"),n.appendChild(c),m.config.showInnerShadow&&(m.canvas.canvas.childNodes[2].setAttribute("filter","url("+window.location.pathname+"#"+f+")"),m.canvas.canvas.childNodes[3].setAttribute("filter","url("+window.location.pathname+"#"+f+")")),c=null};var Y=function(){for(var t=3,e=document.createElement("div"),n=e.getElementsByTagName("i");e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",n[0];);return 4<t?t:void 0}();return JustGage});